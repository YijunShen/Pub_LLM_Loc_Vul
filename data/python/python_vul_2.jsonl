{"num": 0, "cve": "CVE-2021-4315", "des": "A vulnerability has been found in NYUCCL psiTurk up to 3.2.0 and classified as critical. This vulnerability affects unknown code of the file psiturk/experiment.py. The manipulation of the argument mode leads to improper neutralization of special elements used in a template engine. The exploit has been disclosed to the public and may be used. Upgrading to version 3.2.1 is able to address this issue. The name of the patch is 47787e15cecd66f2aa87687bf852ae0194a4335f. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-219676.", "cwe_list": ["CWE-94"], "cwe_name_lst": ["Improper Control of Generation of Code ('Code Injection')"], "url": "https://api.github.com/repos/NYUCCL/psiTurk/commits/47787e15cecd66f2aa87687bf852ae0194a4335f", "html_url": "https://github.com/NYUCCL/psiTurk/commit/47787e15cecd66f2aa87687bf852ae0194a4335f", "filename_list": ["./data/python/python_filter/0_0@NYUCCL@psiTurk@231d566ea3a76534a507dd68840524952c10d5d9@psiturk_experiment.py.txt"], "patch_list": [{"patch_file": "psiturk/experiment.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "insert_mode(page_html, mode):", "Modified_Line": "-        new_html = page_html[:match.end()] + \"&mode=\" + mode +\\\n"}]}]}
{"num": 4, "cve": "CVE-2023-0509", "des": "Improper Certificate Validation in GitHub repository pyload/pyload prior to 0.5.0b3.dev44.", "cwe_list": ["CWE-295"], "cwe_name_lst": ["Improper Certificate Validation"], "url": "https://api.github.com/repos/pyload/pyload/commits/a9098bdf7406e6faf9df3da6ff2d584e90c13bbb", "html_url": "https://github.com/pyload/pyload/commit/a9098bdf7406e6faf9df3da6ff2d584e90c13bbb", "filename_list": ["./data/python/python_filter/4_0@pyload@pyload@efdaffb9ad086440aa5a3ffa2f296c96766b2303@src_pyload_core_network_http_http_request.py.txt"], "patch_list": [{"patch_file": "src/pyload/core/network/http/http_request.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "init_handle(self):", "Modified_Line": "-        self.c.setopt(pycurl.SSL_VERIFYPEER, 0)"}]}]}
{"num": 5, "cve": "CVE-2023-23611", "des": "LTI Consumer XBlock implements the consumer side of the LTI specification enabling integration of third-party LTI provider tools. Versions 7.0.0 and above, prior to 7.2.2, are vulnerable to Missing Authorization.  Any LTI tool that is integrated with on the Open edX platform can post a grade back for any LTI XBlock so long as it knows or can guess the block location for that XBlock. An LTI tool submits scores to the edX platform for line items. The code that uploads that score to the LMS grade tables determines which XBlock to upload the grades for by reading the resource_link_id field of the associated line item. The LTI tool may submit any value for the resource_link_id field, allowing a malicious LTI tool to submit scores for any LTI XBlock on the platform. The impact is a loss of integrity for LTI XBlock grades. This issue is patched in 7.2.2. No workarounds exist.", "cwe_list": ["CWE-862"], "cwe_name_lst": ["Missing Authorization"], "url": "https://api.github.com/repos/openedx/xblock-lti-consumer/commits/252f94bd182cd0962af9251015930cb55ec515d7", "html_url": "https://github.com/openedx/xblock-lti-consumer/commit/252f94bd182cd0962af9251015930cb55ec515d7", "filename_list": ["./data/python/python_filter/5_1@openedx@xblock-lti-consumer@8da48aa3fc3614e61d2e2ded26234cc475a4805b@lti_consumer_signals_signals.py.txt"], "patch_list": [{"patch_file": "lti_consumer/signals/signals.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "publish_grade_on_score_update(sender, instance, **kwargs):  # pylint: disabl", "Modified_Line": "    if instance.grading_progress == LtiAgsScore.FULLY_GRADED \\\n-            and instance.line_item.resource_link_id \n            and instance.score_given:\n        try:\n-            block = compat.load_block_as_user(instance.line_item.resource_link_id)\n        except Exception as exc:\n            log.exception(\n                \"Error while publishing score %r to block %s to LMS: %s\",\n                instance,\n-                instance.line_item.resource_link_id,\n"}]}]}
{"num": 6, "cve": "CVE-2023-23608", "des": "Spotipy is a light weight Python library for the Spotify Web API. In versions prior to 2.22.1, if a malicious URI is passed to the library, the library can be tricked into performing an operation on a different API endpoint than intended. The code Spotipy uses to parse URIs and URLs allows an attacker to insert arbitrary characters into the path that is used for API requests. Because it is possible to include \"..\", an attacker can redirect for example a track lookup via spotifyApi.track() to an arbitrary API endpoint like playlists, but this is possible for other endpoints as well. The impact of this vulnerability depends heavily on what operations a client application performs when it handles a URI from a user and how it uses the responses it receives from the API. This issue is patched in version 2.22.1.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/spotipy-dev/spotipy/commits/b1db0b63d90eae40af32d7ee4c760c2fd581a1b4", "html_url": "https://github.com/spotipy-dev/spotipy/commit/b1db0b63d90eae40af32d7ee4c760c2fd581a1b4", "filename_list": ["./data/python/python_filter/6_0@spotipy-dev@spotipy@262e7a0443ece48ce6825f97ad9a3ed205ceb725@spotipy_client.py.txt"], "patch_list": [{"patch_file": "spotipy/client.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_get_id(self, type, id)", "Modified_Line": "-        fields = id.split(\":\")\n-        if len(fields) >= 3:\n-            if type != fields[-2]:\n-                logger.warning('Expected id of type %s but found type %s %s',\n-                               type, fields[-2], id)\n-            return fields[-1].split(\"?\")[0]\n-        fields = id.split(\"/\")\n-        if len(fields) >= 3:\n-            itype = fields[-2]\n-            if type != itype:\n-                logger.warning('Expected id of type %s but found type %s %s',\n-                               type, itype, id)\n-            return fields[-1].split(\"?\")[0]\n-        return id\n"}, {"Modified_Block_Num": "2", "Modified_Function": "_is_uri(self, uri):", "Modified_Line": "-        return uri.startswith(\"spotify:\") and len(uri.split(':')) == 3\n"}]}]}
{"num": 10, "cve": "CVE-2023-0440", "des": "Observable Discrepancy in GitHub repository healthchecks/healthchecks prior to v2.6.", "cwe_list": ["CWE-203"], "cwe_name_lst": ["Observable Discrepancy"], "url": "https://api.github.com/repos/healthchecks/healthchecks/commits/359edbd2709e27b60687061a32e19322bc971c1f", "html_url": "https://github.com/healthchecks/healthchecks/commit/359edbd2709e27b60687061a32e19322bc971c1f", "filename_list": ["./data/python/python_filter/10_0@healthchecks@healthchecks@e8c226220a9cc922f4f7ee7d167376ab2b06fd84@hc_accounts_forms.py.txt"], "patch_list": [{"patch_file": "hc/accounts/forms.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "clean_identity(self):", "Modified_Line": "-        if User.objects.filter(email=v).exists():\n-            raise forms.ValidationError(\n-                \"An account with this email address already exists.\"\n-            )\n"}]}]}
{"num": 11, "cve": "CVE-2023-0434", "des": "Improper Input Validation in GitHub repository pyload/pyload prior to 0.5.0b3.dev40.", "cwe_list": ["CWE-20"], "cwe_name_lst": ["Improper Input Validation"], "url": "https://api.github.com/repos/pyload/pyload/commits/a2b1eb1028f45ac58dea5f58593c1d3db2b4a104", "html_url": "https://github.com/pyload/pyload/commit/a2b1eb1028f45ac58dea5f58593c1d3db2b4a104", "filename_list": ["./data/python/python_filter/11_0@pyload@pyload@c602df58d05f4ea5e815b8e0565f85f41b1a445e@src_pyload_core_config_parser.py.txt"], "patch_list": [{"patch_file": "src/pyload/core/config/parser.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "cast(self, typ, value):", "Modified_Line": "        elif typ == \"time\":\n            value = \"\" if value is None else str(value)\n            if not value:\n-                value = \"0:00\"\n-            if \":\" not in value:\n                value += \":00\"\n"}]}]}
{"num": 14, "cve": "CVE-2021-32837", "des": "mechanize, a library for automatically interacting with HTTP web servers, contains a regular expression that is vulnerable to regular expression denial of service (ReDoS) prior to version 0.4.6. If a web server responds in a malicious way, then mechanize could crash. Version 0.4.6 has a patch for the issue.", "cwe_list": ["CWE-1333"], "cwe_name_lst": ["Inefficient Regular Expression Complexity"], "url": "https://api.github.com/repos/python-mechanize/mechanize/commits/dd05334448e9f39814bab044d2eaa5ef69b410d6", "html_url": "https://github.com/python-mechanize/mechanize/commit/dd05334448e9f39814bab044d2eaa5ef69b410d6", "filename_list": ["./data/python/python_filter/14_0@python-mechanize@mechanize@1af1582a3ad3ccd96fe3f40c5a5a5d0f4a568f9e@mechanize__urllib2_fork.py.txt"], "patch_list":  [{"patch_file": "mechanize/_urllib2_fork.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "-    rx = re.compile('(?:.*,)*[ \\t]*([^ \\t]+)[ \\t]+'\n-                    'realm=([\"\\'])(.*?)\\\\2', re.I)\n"}]}]}
{"num": 19, "cve": "CVE-2023-0227", "des": "Insufficient Session Expiration in GitHub repository pyload/pyload prior to 0.5.0b3.dev36.", "cwe_list": ["CWE-613"], "cwe_name_lst": ["Insufficient Session Expiration"], "url": "https://api.github.com/repos/pyload/pyload/commits/c035714c0596b704b11af0f8a669352f128ad2d9", "html_url": "https://github.com/pyload/pyload/commit/c035714c0596b704b11af0f8a669352f128ad2d9", "filename_list": ["./data/python/python_filter/19_2@pyload@pyload@a7e1616571fcb421c9b4fb1f00ab019ac69a0f1b@src_pyload_webui_app_helpers.py.txt"], "patch_list": [{"patch_file": "src/pyload/webui/app/helpers.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "is_authenticated(session=flask.session):", "Modified_Line": "-    return session.get(\"name\") and session.get(\n-        \"authenticated\"\n-    )\n"}]}]}
{"num": 21, "cve": "CVE-2023-22898", "des": "workers/extractor.py in Pandora (aka pandora-analysis/pandora) 1.3.0 allows a denial of service when an attacker submits a deeply nested ZIP archive (aka ZIP bomb).", "cwe_list": ["CWE-20"], "cwe_name_lst": ["Improper Input Validation"], "url": "https://api.github.com/repos/pandora-analysis/pandora/commits/1dc06327fdc07c56eae653e497dd137ec70d8265", "html_url": "https://github.com/pandora-analysis/pandora/commit/1dc06327fdc07c56eae653e497dd137ec70d8265", "filename_list": ["./data/python/python_filter/21_0@pandora-analysis@pandora@38a7195470e121aa484277824b37cfbf89df4e19@pandora_workers_extractor.py.txt"], "patch_list": [{"patch_file": "pandora/workers/extractor.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "analyse(self, task: Task, report: Report, manual_trigger: bool=False):", "Modified_Line": "-        while not all(t.workers_done for t in tasks):\n-            time.sleep(1)\n-\n-        if tasks:\n-            report.status = max(t.status for t in tasks)\n-            if report.status > Status.CLEAN:\n-                report.add_details('Warning', 'There are suspicious files in this archive, click on the \"Extracted\" tab for more.')\n-        elif not report.status == Status.NOTAPPLICABLE:\n"}]}]}
{"num": 33, "cve": "CVE-2023-22452", "des": "kenny2automate is a Discord bot. In the web interface for server settings, form elements were generated with Discord channel IDs as part of input names. Prior to commit a947d7c, no validation was performed to ensure that the channel IDs submitted actually belonged to the server being configured. Thus anyone who has access to the channel ID they wish to change settings for and the server settings panel for any server could change settings for the requested channel no matter which server it belonged to. Commit a947d7c resolves the issue and has been deployed to the official instance of the bot. The only workaround that exists is to disable the web config entirely by changing it to run on localhost. Note that a workaround is only necessary for those who run their own instance of the bot.", "cwe_list": ["CWE-20"], "cwe_name_lst": ["Improper Input Validation"], "url": "https://api.github.com/repos/Kenny2github/kenny2automate/commits/a947d7ce408687b587c7e6dfd6026f7c4ee31ac2", "html_url": "https://github.com/Kenny2github/kenny2automate/commit/a947d7ce408687b587c7e6dfd6026f7c4ee31ac2", "filename_list": ["./data/python/python_filter/33_0@Kenny2github@kenny2automate@a5e1ac906ad04822b8364ff2564925eb4632af54@kenny2automate_server___init__.py.txt"], "patch_list": [{"patch_file": "kenny2automate/server/__init__.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "save_server(self, request):", "Modified_Line": "        try:\n            with self.db.connection:\n                self.db.executemany(\n                    'UPDATE channels SET lang=:lang, games_ping=:ping \\\nWHERE channel_id=:channel_id',\n                    params\n                )\n                self.db.execute(\n                    'UPDATE guilds SET guild_disabled_commands=:disable_cmd, \\\nguild_disabled_cogs=:disable_cog, words_censor=:words_censor WHERE guild_id=:guild_id',\n                    otherparams\n                )\n"}]}]}
{"num": 35, "cve": "CVE-2023-25691", "des": "Improper Input Validation vulnerability in the Apache Airflow Google Provider.\n\nThis issue affects Apache Airflow Google Provider versions before 8.10.0.\n\n", "cwe_list": ["CWE-20"], "cwe_name_lst": ["Improper Input Validation"], "url": "https://api.github.com/repos/apache/airflow/commits/5e6f8eb4d5fdcaa713022ee46b1ca9bd2e3ab44e", "html_url": "https://github.com/apache/airflow/commit/5e6f8eb4d5fdcaa713022ee46b1ca9bd2e3ab44e", "filename_list": ["./data/python/python_filter/35_0@apache@airflow@cf814550275bd04326f095cc28f93663daf3404b@airflow_providers_google_cloud_hooks_cloud_sql.py.txt"], "patch_list": [{"patch_file": "airflow/providers/google/cloud/hooks/cloud_sql.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_download_sql_proxy_if_needed(self) -> None:", "Modified_Line": "-        system = platform.system().lower()\n-        processor = os.uname().machine\n-        if processor == \"x86_64\":\n-            processor = \"amd64\"\n-        if not self.sql_proxy_version:\n-            download_url = CLOUD_SQL_PROXY_DOWNLOAD_URL.format(system, processor)\n-        else:\n-            download_url = CLOUD_SQL_PROXY_VERSION_DOWNLOAD_URL.format(\n-                self.sql_proxy_version, system, processor\n-            )\n"}]}]}
{"num": 36, "cve": "CVE-2023-25692", "des": "Improper Input Validation vulnerability in the Apache Airflow Google Provider.\n\nThis issue affects Apache Airflow Google Provider versions before 8.10.0.\n\n", "cwe_list": ["CWE-20"], "cwe_name_lst": ["Improper Input Validation"], "url": "https://api.github.com/repos/apache/airflow/commits/32c571e5926983903ac8b9017c36f14137a797a5", "html_url": "https://github.com/apache/airflow/commit/32c571e5926983903ac8b9017c36f14137a797a5", "filename_list": ["./data/python/python_filter/36_1@apache@airflow@8e24387d6db177c662342245bb183bfd73fb9ee8@airflow_providers_google_cloud_hooks_cloud_sql.py.txt"], "patch_list": [{"patch_file": "airflow/providers/google/cloud/hooks/cloud_sql.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "__init__(", "Modified_Line": "-        self.sql_proxy_binary_path = self.extras.get(\"sql_proxy_binary_path\")\n"}]}]}
{"num": 38, "cve": "CVE-2023-25956", "des": "Generation of Error Message Containing Sensitive Information vulnerability in the Apache Airflow AWS Provider.\n\nThis issue affects Apache Airflow AWS Provider versions before 7.2.1.\n\n", "cwe_list": ["CWE-209"], "cwe_name_lst": ["Generation of Error Message Containing Sensitive Information"], "url": "https://api.github.com/repos/apache/airflow/commits/46d45e09cb5607ae583929f3eba1923a64631f48", "html_url": "https://github.com/apache/airflow/commit/46d45e09cb5607ae583929f3eba1923a64631f48", "filename_list": ["./data/python/python_filter/38_0@apache@airflow@f0d83c5e156f7644dec1d3d4a5e52c5a26a5fbad@airflow_providers_amazon_aws_utils_connection_wrapper.py.txt"], "patch_list": [{"patch_file": "airflow/providers/amazon/aws/utils/connection_wrapper.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_parse_s3_config(", "Modified_Line": "    config = configparser.ConfigParser()\n-    if config.read(config_file_name):  # pragma: no cover\n-        sections = config.sections()\n-    else:\n-        raise AirflowException(f\"Couldn't read {config_file_name}\")\n"}]}]}
{"num": 46, "cve": "CVE-2023-23934", "des": "Werkzeug is a comprehensive WSGI web application library. Browsers may allow \"nameless\" cookies that look like `=value` instead of `key=value`. A vulnerable browser may allow a compromised application on an adjacent subdomain to exploit this to set a cookie like `=__Host-test=bad` for another subdomain. Werkzeug prior to 2.2.3 will parse the cookie `=__Host-test=bad` as __Host-test=bad`. If a Werkzeug application is running next to a vulnerable or malicious subdomain which sets such a cookie using a vulnerable browser, the Werkzeug application will see the bad cookie value but the valid cookie key. The issue is fixed in Werkzeug 2.2.3.", "cwe_list": ["CWE-20"], "cwe_name_lst": ["Improper Input Validation"], "url": "https://api.github.com/repos/pallets/werkzeug/commits/cf275f42acad1b5950c50ffe8ef58fe62cdce028", "html_url": "https://github.com/pallets/werkzeug/commit/cf275f42acad1b5950c50ffe8ef58fe62cdce028", "filename_list": ["./data/python/python_filter/46_0@pallets@werkzeug@7c7ce5cb73f3f7d3b9c09340e4f322aeb583dbc5@src_werkzeug__internal.py.txt"], "patch_list": [{"patch_file": "src/werkzeug/_internal.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "-    (?P<key>[^=;]+)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "_cookie_parse_impl(b: bytes) -> t.Iterator[t.Tuple[bytes, bytes]]:", "Modified_Line": "-        match = _cookie_re.search(b + b\";\", i)\n-        key = match.group(\"key\").strip()\n-        value = match.group(\"val\") or b\"\"\n"}]}]}
{"num": 47, "cve": "CVE-2023-25577", "des": "Werkzeug is a comprehensive WSGI web application library. Prior to version 2.2.3, Werkzeug's multipart form data parser will parse an unlimited number of parts, including file parts. Parts can be a small amount of bytes, but each requires CPU time to parse and may use more memory as Python data. If a request can be made to an endpoint that accesses `request.data`, `request.form`, `request.files`, or `request.get_data(parse_form_data=False)`, it can cause unexpectedly high resource usage. This allows an attacker to cause a denial of service by sending crafted multipart data to an endpoint that will parse it. The amount of CPU time required can block worker processes from handling legitimate requests. The amount of RAM required can trigger an out of memory kill of the process. Unlimited file parts can use up memory and file handles. If many concurrent requests are sent continuously, this can exhaust or kill all available workers. Version 2.2.3 contains a patch for this issue.", "cwe_list": ["CWE-770"], "cwe_name_lst": ["Allocation of Resources Without Limits or Throttling"], "url": "https://api.github.com/repos/pallets/werkzeug/commits/517cac5a804e8c4dc4ed038bb20dacd038e7a9f1", "html_url": "https://github.com/pallets/werkzeug/commit/517cac5a804e8c4dc4ed038bb20dacd038e7a9f1", "filename_list": ["./data/python/python_filter/47_0@pallets@werkzeug@cf275f42acad1b5950c50ffe8ef58fe62cdce028@src_werkzeug_formparser.py.txt", "./data/python/python_filter/47_1@pallets@werkzeug@cf275f42acad1b5950c50ffe8ef58fe62cdce028@src_werkzeug_sansio_multipart.py.txt", "./data/python/python_filter/47_2@pallets@werkzeug@cf275f42acad1b5950c50ffe8ef58fe62cdce028@src_werkzeug_wrappers_request.py.txt"], "patch_list": [{"patch_file": "src/werkzeug/formparser.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "__init__(", "Modified_Line": "class FormDataParser:\n     def __init__(\n        self,\n        stream_factory: t.Optional[\"TStreamFactory\"] = None,\n        charset: str = \"utf-8\",\n        errors: str = \"replace\",\n        max_form_memory_size: t.Optional[int] = None,\n         max_content_length: t.Optional[int] = None,\n         cls: t.Optional[t.Type[MultiDict]] = None,\n         silent: bool = True,\n     ) -> None:\n         if stream_factory is None:\n             stream_factory = default_stream_factory\n        self.stream_factory = stream_factory\n        self.charset = charset\n        self.errors = errors\n        self.max_form_memory_size = max_form_memory_size\n        self.max_content_length = max_content_length\n"}]}, {"patch_file": "src/werkzeug/sansio/multipart.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": " def next_event(self) -> Event:", "Modified_Line": "            elif self.state == State.PART:\n            match = BLANK_LINE_RE.search(self.buffer, self._search_position)\n            if match is not None:\n                headers = self._parse_headers(self.buffer[: match.start()])\n                del self.buffer[: match.end()]\n                self.state = State.DATA\n                self._search_position = 0\n"}]}, {"patch_file": "src/werkzeug/wrappers/request.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "make_form_data_parser(self) -> FormDataParser:", "Modified_Line": "    def make_form_data_parser(self) -> FormDataParser:\n        return self.form_data_parser_class(\n            self._get_file_stream,\n            self.charset,\n            self.encoding_errors,\n            self.max_form_memory_size,\n            self.max_content_length,\n            self.parameter_storage_class,\n"}]}]}
{"num": 49, "cve": "CVE-2023-22735", "des": "Zulip is an open-source team collaboration tool. In versions of zulip prior to commit `2f6c5a8` but after commit `04cf68b` users could upload files with arbitrary `Content-Type` which would be served from the Zulip hostname with `Content-Disposition: inline` and no `Content-Security-Policy` header, allowing them to trick other users into executing arbitrary Javascript in the context of the Zulip application.  Among other things, this enables session theft. Only deployments which use the S3 storage (not the local-disk storage)  are affected, and only deployments which deployed commit 04cf68b45ebb5c03247a0d6453e35ffc175d55da, which has only been in `main`, not any numbered release. Users affected should upgrade from main again to deploy this fix. Switching from S3 storage to the local-disk storage would nominally mitigate this, but is likely more involved than upgrading to the latest `main` which addresses the issue.", "cwe_list": ["CWE-436"], "cwe_name_lst": ["Interpretation Conflict"], "url": "https://api.github.com/repos/zulip/zulip/commits/2f6c5a883e106aa82a570d3d1f243993284b70f3", "html_url": "https://github.com/zulip/zulip/commit/2f6c5a883e106aa82a570d3d1f243993284b70f3", "filename_list": ["./data/python/python_filter/49_1@zulip@zulip@36e97f8121a19a7955e666d24a80ea2cf3d0b75a@zerver_views_upload.py.txt"], "patch_list": [{"patch_file": "zerver/views/upload.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "serve_file(", "Modified_Line": "-    download: bool = False,\n-    mimetype, encoding = guess_type(path_id)\n-    download = download or mimetype not in INLINE_MIME_TYPES\n    if settings.LOCAL_UPLOADS_DIR is not None:\n-        return serve_local(request, path_id, download=download)\n    else:\n-        return serve_s3(request, path_id, download=download)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "serve_file_unauthed_from_token(", "Modified_Line": "    path_id = get_file_path_id_from_token(token)\n-    mimetype, encoding = guess_type(path_id)\n-    download = mimetype not in INLINE_MIME_TYPES\n    if settings.LOCAL_UPLOADS_DIR is not None:c\n-        return serve_local(request, path_id, download=download)\n    else:\n-        return serve_s3(request, path_id, download=download)\n"}]}]}
{"num": 50, "cve": "CVE-2020-36660", "des": "A vulnerability was found in paxswill EVE Ship Replacement Program 0.12.11. It has been rated as problematic. This issue affects some unknown processing of the file src/evesrp/views/api.py of the component User Information Handler. The manipulation leads to information disclosure. The attack may be initiated remotely. Upgrading to version 0.12.12 is able to address this issue. The patch is named 9e03f68e46e85ca9c9694a6971859b3ee66f0240. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-220211.", "cwe_list": ["CWE-200"], "cwe_name_lst": ["Exposure of Sensitive Information to an Unauthorized Actor"], "url": "https://api.github.com/repos/paxswill/evesrp/commits/9e03f68e46e85ca9c9694a6971859b3ee66f0240", "html_url": "https://github.com/paxswill/evesrp/commit/9e03f68e46e85ca9c9694a6971859b3ee66f0240", "filename_list": ["./data/python/python_filter/50_0@paxswill@evesrp@edf0307d6d257a09e88c26d02c24f777045e40ab@src_evesrp_views_api.py.txt"], "patch_list": [{"patch_file": "src/evesrp/views/api.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "user_detail(user_id):", "Modified_Line": "def user_detail(user_id):\n    user = User.query.get_or_404(user_id)\n    submit = map(lambda p: p.division,\n            filter(lambda p: p.permission == PermissionType.submit,\n                user.permissions))\n"}, {"Modified_Block_Num": "2", "Modified_Function": "group_detail(group_id):", "Modified_Line": "def group_detail(group_id):\n    group = Group.query.get_or_404(group_id)\n    submit = map(lambda p: p.division,\n            filter(lambda p: p.permission == PermissionType.submit,\n                group.permissions))\n"}]}]}
{"num": 55, "cve": "CVE-2023-0241", "des": "pgAdmin 4 versions prior to v6.19 contains a directory traversal vulnerability. A user of the product may change another user's settings or alter the database.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/pgadmin-org/pgadmin4/commits/64d7289c5b3831137b17bb4c5022ef4f63d2ef42", "html_url": "https://github.com/pgadmin-org/pgadmin4/commit/64d7289c5b3831137b17bb4c5022ef4f63d2ef42", "filename_list": ["./data/python/python_filter/55_4@pgadmin-org@pgadmin4@188bcbd5bb94cd0592d842b4c843be2196e300cf@web_pgadmin_utils___init__.py.txt"], "patch_list": [{"patch_file": "web/pgadmin/utils/__init__.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "dump_database_servers(output_file, selected_servers,", "Modified_Line": "-    storage_manager_path = None\n-    if not from_setup:\n-        storage_manager_path = get_storage_directory(user)\n-\n-    file_path = unquote(output_file)\n-\n-    from pgadmin.misc.file_manager import Filemanager\n-        Filemanager.check_access_permission(storage_manager_path, file_path,\n-                                            from_setup)\n    except Exception as e:\n        return _handle_error(str(e), from_setup)\n-    if storage_manager_path is not None:\n-        file_path = os.path.join(\n-            storage_manager_path,\n-            file_path.lstrip('/').lstrip('\\\\')\n-        )\n-\n"}, {"Modified_Block_Num": "2", "Modified_Function": "load_database_servers(input_file, selected_servers,", "Modified_Line": "-    storage_manager_path = None\n-    if not from_setup:\n-        storage_manager_path = get_storage_directory(user)\n-    file_path = unquote(input_file)\n-    if storage_manager_path:\n-        file_path = os.path.join(\n-            storage_manager_path,\n-            file_path.lstrip('/').lstrip('\\\\')\n-        )\n"}]}]}
{"num": 56, "cve": "CVE-2023-28627", "des": "pymedusa is an automatic video library manager for TV Shows. In versions prior 1.0.12 an attacker with access to the web interface can update the git executable path in /config/general/ > advanced settings with arbitrary OS commands. An attacker may exploit this vulnerability to take execute arbitrary OS commands as the user running the pymedusa program. Users are advised to upgrade. There are no known workarounds for this vulnerability.", "cwe_list": ["CWE-78"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "url": "https://api.github.com/repos/pymedusa/Medusa/commits/66d4be8f0872bd5ddcdc5c5a58cb014d22834a45", "html_url": "https://github.com/pymedusa/Medusa/commit/66d4be8f0872bd5ddcdc5c5a58cb014d22834a45", "filename_list": ["./data/python/python_filter/56_0@pymedusa@Medusa@d44ae910b2e6e94db608ee74221d1ce230118651@medusa_updater_github_updater.py.txt"], "patch_list": [{"patch_file": "medusa/updater/github_updater.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_find_working_git(self):", "Modified_Line": "-        if app.GIT_PATH:\n-            main_git = '\"' + app.GIT_PATH + '\"'\n-        else:\n-            main_git = 'git'\n"}]}]}
{"num": 78, "cve": "CVE-2023-1177", "des": "Path Traversal: '\\..\\filename' in GitHub repository mlflow/mlflow prior to 2.2.1.\n\n", "cwe_list": ["CWE-29"], "cwe_name_lst": ["Path Traversal: '..filename'"], "url": "https://api.github.com/repos/mlflow/mlflow/commits/7162a50c654792c21f3e4a160eb1a0e6a34f6e6e", "html_url": "https://github.com/mlflow/mlflow/commit/7162a50c654792c21f3e4a160eb1a0e6a34f6e6e", "filename_list": ["./data/python/python_filter/78_0@mlflow@mlflow@fedf876a90bdcb8d4e06b42abfc31a8df0055143@mlflow_server_handlers.py.txt"], "patch_list": [{"patch_file": "mlflow/server/handlers.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_download_artifact(artifact_path):", "Modified_Line": "-    validate_path_is_safe(validate_path_is_safe)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "_upload_artifact(artifact_path):", "Modified_Line": "-    validate_path_is_safe(validate_path_is_safe)\n"}]}]}
{"num": 82, "cve": "CVE-2023-27494", "des": "Streamlit, software for turning data scripts into web applications, had a cross-site scripting (XSS) vulnerability in versions 0.63.0 through 0.80.0. Users of hosted Streamlit app(s) were vulnerable to a reflected XSS vulnerability. An attacker could craft a malicious URL with Javascript payloads to a Streamlit app. The attacker could then trick the user into visiting the malicious URL and, if successful, the server would render the malicious javascript payload as-is, leading to XSS. Version 0.81.0 contains a patch for this vulnerability.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/streamlit/streamlit/commits/afcf880c60e5d7538936cc2d9721b9e1bc02b075", "html_url": "https://github.com/streamlit/streamlit/commit/afcf880c60e5d7538936cc2d9721b9e1bc02b075", "filename_list": ["./data/python/python_filter/82_0@streamlit@streamlit@381774112899b3949d2389884e29fea852c50905@lib_streamlit_components_v1_components.py.txt", "./data/python/python_filter/82_1@streamlit@streamlit@381774112899b3949d2389884e29fea852c50905@lib_streamlit_server_routes.py.txt"], "patch_list": [{"patch_file": "lib/streamlit/components/v1/components.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get(self, path: str) -> None:", "Modified_Line": "-            self.write(f\"{path} not found\")\n"}, {"Modified_Block_Num": "2", "Modified_Function": "get(self, path: str) -> None:", "Modified_Line": "-            self.write(f\"{path} read error: {e}\")\n"}]}, {"patch_file": "lib/streamlit/server/routes.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "validate_absolute_path(self, root, absolute_path):", "Modified_Line": "-            raise tornado.web.HTTPError(404, \"%s not found\", absolute_path)\n"}]}]}
{"num": 83, "cve": "CVE-2023-23929", "des": "vantage6 is a privacy preserving federated learning infrastructure for secure insight exchange. Currently, the refresh token is valid indefinitely. The refresh token should get a validity of 24-48 hours. A fix was released in version 3.8.0.\n", "cwe_list": ["CWE-613"], "cwe_name_lst": ["Insufficient Session Expiration"], "url": "https://api.github.com/repos/vantage6/vantage6/commits/48ebfca42359e9a6743e9598684585e2522cdce8", "html_url": "https://github.com/vantage6/vantage6/commit/48ebfca42359e9a6743e9598684585e2522cdce8", "filename_list": ["./data/python/python_filter/83_4@vantage6@vantage6@32ec34aa5f3a147a0a5622a15aaa789802b769b8@vantage6-server_vantage6_server___init__.py.txt"], "patch_list": [{"patch_file": "vantage6-server/vantage6/server/__init__.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "configure_flask(self):", "Modified_Line": "-        self.app.config['JWT_REFRESH_TOKEN_EXPIRES'] = REFRESH_TOKENS_EXPIRE\n        self.app.config['JWT_SECRET_KEY'] = self.ctx.config.get(\n            'jwt_secret_key',\n            str(uuid.uuid1())\n        )\n-        self.app.config['JWT_ACCESS_TOKEN_EXPIRES'] = JWT_ACCESS_TOKEN_EXPIRES\n"}]}]}
{"num": 84, "cve": "CVE-2023-26051", "des": "Saleor is a headless, GraphQL commerce platform delivering personalized shopping experiences. Some internal Python exceptions are not handled properly and thus are returned in API as error messages. Some messages might contain sensitive information like user email address in staff-authenticated requests.\n", "cwe_list": ["CWE-209"], "cwe_name_lst": ["Generation of Error Message Containing Sensitive Information"], "url": "https://api.github.com/repos/saleor/saleor/commits/31bce881ccccf0d79a9b14ecb6ca3138d1edeec1", "html_url": "https://github.com/saleor/saleor/commit/31bce881ccccf0d79a9b14ecb6ca3138d1edeec1", "filename_list": ["./data/python/python_filter/84_0@saleor@saleor@791372b11a119ff7108760803cad473e964d4e49@saleor_graphql_core_mutations.py.txt"], "patch_list": [{"patch_file": "saleor/graphql/core/mutations.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "mutate(cls, root, info: ResolveInfo, **data):", "Modified_Line": "        disallow_replica_in_context(info.context)\n-        setup_context_user(info.context)\n"}]}]}
{"num": 85, "cve": "CVE-2023-22738", "des": "vantage6 is a privacy preserving federated learning infrastructure for secure insight exchange. Assigning existing users to a different organizations is currently possible. It may lead to unintended access: if a user from organization A is accidentally assigned to organization B, they will retain their permissions and therefore might be able to access stuff they should not be allowed to access. This issue is patched in version 3.8.0.", "cwe_list": ["CWE-281"], "cwe_name_lst": ["Improper Preservation of Permissions"], "url": "https://api.github.com/repos/vantage6/vantage6/commits/798aca1de142a4eca175ef51112e2235642f4f24", "html_url": "https://github.com/vantage6/vantage6/commit/798aca1de142a4eca175ef51112e2235642f4f24", "filename_list": ["./data/python/python_filter/85_0@vantage6@vantage6@c66f0a2c719ace8fbf967476a276c4f78d37cc00@vantage6-server_vantage6_server_resource_user.py.txt"], "patch_list": [{"patch_file": "vantage6-server/vantage6/server/resource/user.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "patch(self, id):", "Modified_Line": "-        if data[\"organization_id\"] and \\\n-                data[\"organization_id\"] != g.user.organization_id:\n-            if not self.r.e_glo.can():\n-                return {'msg': 'You lack the permission to do that!'}, \\\n-                    HTTPStatus.UNAUTHORIZED\n-            else:\n-                # check that newly assigned organization exists\n-                org = db.Organization.get(data['organization_id'])\n-                if not org:\n-                    return {'msg': 'Organization does not exist.'}, \\\n-                        HTTPStatus.NOT_FOUND\n-                else:\n-                    log.warn(\n-                        f'Running as root and assigning (new) '\n-                        f'organization_id={data[\"organization_id\"]}'\n-                    )\n-                    user.organization_id = data[\"organization_id\"]\n"}]}]}
{"num": 87, "cve": "CVE-2023-1786", "des": "Sensitive data could be exposed in logs of cloud-init before version 23.1.2. An attacker could use this information to find hashed passwords and possibly escalate their privilege.", "cwe_list": ["CWE-532"], "cwe_name_lst": ["Insertion of Sensitive Information into Log File"], "url": "https://api.github.com/repos/canonical/cloud-init/commits/a378b7e4f47375458651c0972e7cd813f6fe0a6b", "html_url": "https://github.com/canonical/cloud-init/commit/a378b7e4f47375458651c0972e7cd813f6fe0a6b", "filename_list": ["./data/python/python_filter/87_1@canonical@cloud-init@c1b4722036a1ad3f683b7942db4d07639f88dcd2@cloudinit_sources_DataSourceVultr.py.txt"], "patch_list": [{"patch_file": "cloudinit/sources/DataSourceVultr.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_get_data(self):", "Modified_Line": "        LOG.debug(\"Machine is a Vultr instance\")\n        self.metadata = self.get_metadata()\n        self.userdata_raw = self.metadata[\"user-data\"]\n        self.get_datasource_data(self.metadata)\n-        LOG.debug(\"Vultr Vendor Config:\")\n-        LOG.debug(util.json_dumps(self.metadata[\"vendor-data\"]))\n        LOG.debug(\"SUBID: %s\", self.metadata[\"instance-id\"])\n        LOG.debug(\"Hostname: %s\", self.metadata[\"local-hostname\"])\n-        if self.userdata_raw is not None:\n-            LOG.debug(\"User-Data:\")\n-            LOG.debug(self.userdata_raw)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "", "Modified_Line": "-\n-    print(util.json_dumps(sysinfo))\n-    print(util.json_dumps(config))\n"}]}]}
{"num": 88, "cve": "CVE-2023-30629", "des": "Vyper is a Pythonic Smart Contract Language for the ethereum virtual machine. In versions 0.3.1 through 0.3.7, the Vyper compiler generates the wrong bytecode. Any contract that uses the `raw_call` with `revert_on_failure=False` and `max_outsize=0` receives the wrong response from `raw_call`. Depending on the memory garbage, the result can be either `True` or `False`. A patch is available and, as of time of publication, anticipated to be part of Vyper 0.3.8. As a workaround, one may always put  `max_outsize>0`.", "cwe_list": ["CWE-670"], "cwe_name_lst": ["Always-Incorrect Control Flow Implementation"], "url": "https://api.github.com/repos/vyperlang/vyper/commits/851f7a1b3aa2a36fd041e3d0ed38f9355a58c8ae", "html_url": "https://github.com/vyperlang/vyper/commit/851f7a1b3aa2a36fd041e3d0ed38f9355a58c8ae", "filename_list": ["./data/python/python_filter/88_0@vyperlang@vyper@25781f64bb903e0fce3291d066d65cebb42cbb56@vyper_builtins_functions.py.txt"], "patch_list": [{"patch_file": "vyper/builtins/functions.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "build_IR(self, expr, args, kwargs, context):", "Modified_Line": "-            if revert_on_failure:\n-                typ = None\n-                ret_ir = check_external_call(call_ir)\n-            else:\n-                typ = bool_ty\n-                ret_ir = call_ir\n-        return IRnode.from_list(ret_ir, typ=typ, location=MEMORY)\n"}]}]}
{"num": 89, "cve": "CVE-2023-30620", "des": "mindsdb is a Machine Learning platform to help developers build AI solutions. In affected versions an unsafe extraction is being performed using `tarfile.extractall()` from a remotely retrieved tarball. Which may lead to the writing of the extracted files to an unintended location. Sometimes, the vulnerability is called a TarSlip or a ZipSlip variant. An attacker may leverage this vulnerability to overwrite any local file which the server process has access to. There is no risk of file exposure with this vulnerability. This issue has been addressed in release `23.2.1.0 `. Users are advised to upgrade. There are no known workarounds for this vulnerability.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/mindsdb/mindsdb/commits/4419b0f0019c000db390b54d8b9d06e1d3670039", "html_url": "https://github.com/mindsdb/mindsdb/commit/4419b0f0019c000db390b54d8b9d06e1d3670039", "filename_list": ["./data/python/python_filter/89_0@mindsdb@mindsdb@e83cdc52f5ec7cd7def1e20e8973931f9cc98f60@mindsdb_api_http_namespaces_file.py.txt"], "patch_list": [{"patch_file": "mindsdb/api/http/namespaces/file.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "put(self, name: str):", "Modified_Line": "-                    f.extractall(temp_dir_path)\n"}]}]}
{"num": 90, "cve": "CVE-2023-30798", "des": "There MultipartParser usage in Encode's Starlette python framework before versions 0.25.0 allows an unauthenticated and remote attacker to specify any number of form fields or files which can cause excessive memory usage resulting in denial of service of the HTTP service.", "cwe_list": ["CWE-400"], "cwe_name_lst": ["Uncontrolled Resource Consumption"], "url": "https://api.github.com/repos/encode/starlette/commits/8c74c2c8dba7030154f8af18e016136bea1938fa", "html_url": "https://github.com/encode/starlette/commit/8c74c2c8dba7030154f8af18e016136bea1938fa", "filename_list": ["./data/python/python_filter/90_0@encode@starlette@5771a78c14d577bd1743ed2e948c91589dd30e20@starlette_formparsers.py.txt"], "patch_list": [{"patch_file": "starlette/formparsers.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "parse(self) -> FormData:", "Modified_Line": "        parser = multipart.MultipartParser(boundary, callbacks)\n-        header_field = b\"\"\n-        header_value = b\"\"\n-        content_disposition = None\n-        field_name = \"\"\n-        data = b\"\"\n-        file: typing.Optional[UploadFile] = None\n-        items: typing.List[typing.Tuple[str, typing.Union[str, UploadFile]]] = []\n-        item_headers: typing.List[typing.Tuple[bytes, bytes]] = []\n        async for chunk in self.stream:\n            parser.write(chunk)\n-            messages = list(self.messages)\n-            self.messages.clear()\n-            for message_type, message_bytes in messages:\n-                if message_type == MultiPartMessage.PART_BEGIN:\n-                    content_disposition = None\n-                    data = b\"\"\n-                    item_headers = []\n-                elif message_type == MultiPartMessage.HEADER_FIELD:\n-                    header_field += message_bytes\n-                elif message_type == MultiPartMessage.HEADER_VALUE:\n-                    header_value += message_bytes\n-                elif message_type == MultiPartMessage.HEADER_END:\n-                    field = header_field.lower()\n-                    if field == b\"content-disposition\":\n-                         content_disposition = header_value\n-                    item_headers.append((field, header_value))\n-                    header_field = b\"\"\n-                    header_value = b\"\"\n-                elif message_type == MultiPartMessage.HEADERS_FINISHED:\n-                    disposition, options = parse_options_header(content_disposition)\n-                    try:\n-                        field_name = _user_safe_decode(options[b\"name\"], charset)\n-                    except KeyError:\n-                        raise MultiPartException(\n-                            'The Content-Disposition header field \"name\" must be '\n-                            \"provided.\"\n-                        )\n-                    if b\"filename\" in options:\n-                        filename = _user_safe_decode(options[b\"filename\"], charset)\n-                        tempfile = SpooledTemporaryFile(max_size=self.max_file_size)\n-                        file = UploadFile(\n-                            file=tempfile,\n-                            size=0,\n-                            filename=filename,\n-                            headers=Headers(raw=item_headers),\n-                        )\n-                    else:\n-                        file = None\n-                elif message_type == MultiPartMessage.PART_DATA:\n-                    if file is None:\n-                        data += message_bytes\n-                    else:\n-                        await file.write(message_bytes)\n-                elif message_type == MultiPartMessage.PART_END:\n-                    if file is None:\n-                        items.append((field_name, _user_safe_decode(data, charset)))\n-                    else:\n-                        await file.seek(0)\n-                        items.append((field_name, file))\n"}]}]}
{"num": 92, "cve": "CVE-2023-2227", "des": "Improper Authorization in GitHub repository modoboa/modoboa prior to 2.1.0.", "cwe_list": ["CWE-285"], "cwe_name_lst": ["Improper Authorization"], "url": "https://api.github.com/repos/modoboa/modoboa/commits/7bcd3f6eb264d4e3e01071c97c2bac51cdd6fe97", "html_url": "https://github.com/modoboa/modoboa/commit/7bcd3f6eb264d4e3e01071c97c2bac51cdd6fe97", "filename_list": ["./data/python/python_filter/92_1@modoboa@modoboa@0317c4c40698a560eb371877f6b340ae57de1e7c@modoboa_core_api_v2_views.py.txt", "./data/python/python_filter/92_3@modoboa@modoboa@0317c4c40698a560eb371877f6b340ae57de1e7c@modoboa_parameters_api_v2_viewsets.py.txt"], "patch_list": [{"patch_file": "modoboa/core/api/v2/views.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "class ComponentsInformationAPIView(APIView):\n    throttle_classes = [UserLesserDdosUser]\n"}]}, {"patch_file": "modoboa/parameters/api/v2/viewsets.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "class ParametersViewSet(GetThrottleViewsetMixin, viewsets.ViewSet):\n    lookup_value_regex = r\"\\w+\"\n    serializer_class = None\n"}]}]}
{"num": 93, "cve": "CVE-2023-28459", "des": "pretalx 2.3.1 before 2.3.2 allows path traversal in HTML export (a non-default feature). Users were able to upload crafted HTML documents that trigger the reading of arbitrary files.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/pretalx/pretalx/commits/60722c43cf975f319e94102e6bff320723776890", "html_url": "https://github.com/pretalx/pretalx/commit/60722c43cf975f319e94102e6bff320723776890", "filename_list": ["./data/python/python_filter/93_0@pretalx@pretalx@4732e8f5592eeeb3c75233a783985158e3dd12bb@src_pretalx_agenda_management_commands_export_schedule_html.py.txt"], "patch_list": [{"patch_file": "src/pretalx/agenda/management/commands/export_schedule_html.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_mediastatic_content(url):", "Modified_Line": "    if url.startswith(settings.STATIC_URL):\n        local_path = settings.STATIC_ROOT / url[len(settings.STATIC_URL) :]\n    elif url.startswith(settings.MEDIA_URL):\n        local_path = settings.MEDIA_ROOT / url[len(settings.MEDIA_URL) :]\n    else:\n        raise FileNotFoundError()\n"}]}]}
{"num": 94, "cve": "CVE-2023-28458", "des": "pretalx 2.3.1 before 2.3.2 allows path traversal in HTML export (a non-default feature). Organizers can trigger the overwriting (with the standard pretalx 404 page content) of an arbitrary file.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/pretalx/pretalx/commits/60722c43cf975f319e94102e6bff320723776890", "html_url": "https://github.com/pretalx/pretalx/commit/60722c43cf975f319e94102e6bff320723776890", "filename_list": ["./data/python/python_filter/94_0@pretalx@pretalx@4732e8f5592eeeb3c75233a783985158e3dd12bb@src_pretalx_agenda_management_commands_export_schedule_html.py.txt"], "patch_list": [{"patch_file": "src/pretalx/agenda/management/commands/export_schedule_html.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "dump_content(destination, path, getter):", "Modified_Line": "    if path.endswith(\"/\"):\n        path = path + \"index.html\"\n-    path = Path(destination) / path.lstrip(\"/\")\n"}]}]}
{"num": 96, "cve": "CVE-2021-3429", "des": "When instructing cloud-init to set a random password for a new user account, versions before 21.2 would write that password to the world-readable log file /var/log/cloud-init-output.log. This could allow a local user to log in as another user.", "cwe_list": ["CWE-532"], "cwe_name_lst": ["Insertion of Sensitive Information into Log File"], "url": "https://api.github.com/repos/canonical/cloud-init/commits/b794d426b9ab43ea9d6371477466070d86e10668", "html_url": "https://github.com/canonical/cloud-init/commit/b794d426b9ab43ea9d6371477466070d86e10668", "filename_list": ["./data/python/python_filter/96_0@canonical@cloud-init@c6726c2bbe82b738bd0a7fb308496a497c797d5f@cloudinit_config_cc_set_passwords.py.txt"], "patch_list": [{"patch_file": "cloudinit/config/cc_set_passwords.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "handle(_name, cfg, cloud, log, args):", "Modified_Line": "        if len(randlist):\n            blurb = (\"Set the following 'random' passwords\n\",\n                     '\n'.join(randlist))\n-            sys.stderr.write(\"%s\\n%s\\n\" % blurb)\n"}]}]}
{"num": 97, "cve": "CVE-2022-2084", "des": "Sensitive data could be exposed in world readable logs of cloud-init before version 22.3 when schema failures are reported. This leak could include hashed passwords.", "cwe_list": ["CWE-532"], "cwe_name_lst": ["Insertion of Sensitive Information into Log File"], "url": "https://api.github.com/repos/canonical/cloud-init/commits/4d467b14363d800b2185b89790d57871f11ea88c", "html_url": "https://github.com/canonical/cloud-init/commit/4d467b14363d800b2185b89790d57871f11ea88c", "filename_list": ["./data/python/python_filter/97_1@canonical@cloud-init@4eab80c9db89fcdae4d16c33d8f123cfa1aa62dd@cloudinit_config_schema.py.txt"], "patch_list": [{"patch_file": "cloudinit/config/schema.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "validate_cloudconfig_schema(", "Modified_Line": "-        else:\n            messages = [\"{0}: {1}\".format(k, msg) for k, msg in errors]\n-            LOG.warning(\n-                \"Invalid cloud-config provided:\\n%s\", \"\\n\".join(messages)\n"}]}]}
{"num": 98, "cve": "CVE-2023-30797", "des": "\n\nNetflix Lemur before version 1.3.2 used insufficiently random values when generating default credentials. The insufficiently random values may allow an attacker to guess the credentials and gain access to resources managed by Lemur.\n\n\n", "cwe_list": ["CWE-330"], "cwe_name_lst": ["Use of Insufficiently Random Values"], "url": "https://api.github.com/repos/Netflix/lemur/commits/666d853212174ee7f4e6f8b3b4b389ede1872238", "html_url": "https://github.com/Netflix/lemur/commit/666d853212174ee7f4e6f8b3b4b389ede1872238", "filename_list": ["./data/python/python_filter/98_0@Netflix@lemur@f5c0c643ab2cfee2c672b0059702759bfc29913b@docker_src_lemur.conf.py.txt", "./data/python/python_filter/98_1@Netflix@lemur@f5c0c643ab2cfee2c672b0059702759bfc29913b@lemur_common_utils.py.txt"], "patch_list": [{"patch_file": "docker/src/lemur.conf.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_random_secret(length):", "Modified_Line": "-    secret_key = ''.join(random.choice(string.ascii_uppercase) for x in range(round(length / 4)))\n-    secret_key = secret_key + ''.join(random.choice(\"~!@#$%^&*()_+\") for x in range(round(length / 4)))\n-    secret_key = secret_key + ''.join(random.choice(string.ascii_lowercase) for x in range(round(length / 4)))\n-    return secret_key + ''.join(random.choice(string.digits) for x in range(round(length / 4)))\n"}]}, {"patch_file": "lemur/common/utils.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_psuedo_random_string():", "Modified_Line": "-    challenge = \"\".join(random.choice(string.ascii_uppercase) for x in range(6))  # noqa\n-    challenge += \"\".join(random.choice(\"~!@#$%^&*()_+\") for x in range(6))  # noqa\n-    challenge += \"\".join(random.choice(string.ascii_lowercase) for x in range(6))\n-    challenge += \"\".join(random.choice(string.digits) for x in range(6))  # noqa\n"},{"Modified_Block_Num": "2", "Modified_Function": "get_random_secret(length):", "Modified_Line": "-    secret_key = ''.join(random.choice(string.ascii_uppercase) for x in range(round(length / 4)))\n-    secret_key = secret_key + ''.join(random.choice(\"~!@#$%^&*()_+\") for x in range(round(length / 4)))\n-    secret_key = secret_key + ''.join(random.choice(string.ascii_lowercase) for x in range(round(length / 4)))\n-    return secret_key + ''.join(random.choice(string.digits) for x in range(round(length / 4)))\n"}]}]}
{"num": 99, "cve": "CVE-2023-30608", "des": "sqlparse is a non-validating SQL parser module for Python. In affected versions the SQL parser contains a regular expression that is vulnerable to ReDoS (Regular Expression Denial of Service). This issue was introduced by commit `e75e358`. The vulnerability may lead to Denial of Service (DoS). This issues has been fixed in sqlparse 0.4.4 by commit `c457abd5f`. Users are advised to upgrade. There are no known workarounds for this issue.", "cwe_list": ["CWE-1333"], "cwe_name_lst": ["Inefficient Regular Expression Complexity"], "url": "https://api.github.com/repos/andialbrecht/sqlparse/commits/c457abd5f097dd13fb21543381e7cfafe7d31cfb", "html_url": "https://github.com/andialbrecht/sqlparse/commit/c457abd5f097dd13fb21543381e7cfafe7d31cfb", "filename_list": ["./data/python/python_filter/99_0@andialbrecht@sqlparse@b949fdf9a1538f98b57612bef6306fc38f32aaf7@sqlparse_keywords.py.txt"], "patch_list": [{"patch_file": "sqlparse/keywords.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "-    (r\"'(''|\\\\\\\\|\\\\'|[^'])*'\", tokens.String.Single),\n-    (r'\"(\"\"|\\\\\\\\|\\\\\"|[^\"])*\"', tokens.String.Symbol),\n"}]}]}
{"num": 100, "cve": "CVE-2023-2160", "des": "Weak Password Requirements in GitHub repository modoboa/modoboa prior to 2.1.0.\n\n", "cwe_list": ["CWE-521"], "cwe_name_lst": ["Weak Password Requirements"], "url": "https://api.github.com/repos/modoboa/modoboa/commits/130257c96a2392ada795785a91178e656e27015c", "html_url": "https://github.com/modoboa/modoboa/commit/130257c96a2392ada795785a91178e656e27015c", "filename_list": ["./data/python/python_filter/100_0@modoboa@modoboa@288f62a75a7c7bbde360f5c595b51507a6b3249d@modoboa_core_forms.py.txt"], "patch_list": [{"patch_file": "modoboa/core/forms.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "clean(self):", "Modified_Line": "        newpassword = self.cleaned_data.get(\"newpassword\")\n        confirmation = self.cleaned_data.get(\"confirmation\")\n        if newpassword and confirmation:\n            if oldpassword:\n                if newpassword != confirmation:\n                    self.add_error(\"confirmation\", _(\"Passwords mismatch\"))\n                else:\n                    password_validation.validate_password(\n                        confirmation, self.instance)\n            else:\n                self.add_error(\"oldpassword\", _(\"This field is required.\"))\n        return self.cleaned_data\n"}]}]}
{"num": 104, "cve": "CVE-2023-29380", "des": "Warpinator before 1.6.0 allows remote file deletion via directory traversal in top_dir_basenames.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/linuxmint/warpinator/commits/9aae768522b7bbb09c836419893802a02221d663", "html_url": "https://github.com/linuxmint/warpinator/commit/9aae768522b7bbb09c836419893802a02221d663", "filename_list": ["./data/python/python_filter/104_2@linuxmint@warpinator@a4a0b0dfcc8175a006df888bd71b43793a99f5c5@src_transfers.py.txt"], "patch_list": [{"patch_file": "src/transfers.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "__init__(self, op):", "Modified_Line": "-        for name in op.top_dir_basenames:\n-            try:\n-                path = os.path.join(self.save_path, name)\n-                if os.path.isdir(path): # file not found is ok\n-                    shutil.rmtree(path)\n-                else:\n-                    os.remove(path)\n-            except FileNotFoundError:\n-                pass\n-            except Exception as e:\n-                logging.warning(\"Problem removing existing files.  Transfer may not succeed: %s\" % e)\n"}]}]}
{"num": 106, "cve": "CVE-2023-28623", "des": "Zulip is an open-source team collaboration tool with unique topic-based threading. In the event that 1: `ZulipLDAPAuthBackend` and an external authentication backend (any aside of `ZulipLDAPAuthBackend` and `EmailAuthBackend`) are the only ones enabled in `AUTHENTICATION_BACKENDS` in `/etc/zulip/settings.py` and 2: The organization permissions don't require invitations to join. An attacker can create a new account in the organization with an arbitrary email address in their control that's not in the organization's LDAP directory. The impact is limited to installations which have this specific combination of authentication backends as described above in addition to having `Invitations are required for joining this organization` organization permission disabled. This issue has been addressed in version 6.2. Users are advised to upgrade. Users unable to upgrade may enable the `Invitations are required for joining this organization` organization permission to prevent this issue.", "cwe_list": ["CWE-862"], "cwe_name_lst": ["Missing Authorization"], "url": "https://api.github.com/repos/zulip/zulip/commits/3df1b4dd7c210c21deb6f829df19412b74573f8d", "html_url": "https://github.com/zulip/zulip/commit/3df1b4dd7c210c21deb6f829df19412b74573f8d", "filename_list": ["./data/python/python_filter/106_0@zulip@zulip@baf9382f2405d62ae387d6be24f0c7a0938bb4af@zerver_views_registration.py.txt"], "patch_list": [{"patch_file": "zerver/views/registration.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "accounts_register(", "Modified_Line": "-                can_use_different_backend = email_auth_enabled(realm) or (\n-                    len(get_external_method_dicts(realm)) > 0\n-                )\n"}]}]}
{"num": 107, "cve": "CVE-2023-2800", "des": "Insecure Temporary File in GitHub repository huggingface/transformers prior to 4.30.0.", "cwe_list": ["CWE-377"], "cwe_name_lst": ["Insecure Temporary File"], "url": "https://api.github.com/repos/huggingface/transformers/commits/80ca92470938bbcc348e2d9cf4734c7c25cb1c43", "html_url": "https://github.com/huggingface/transformers/commit/80ca92470938bbcc348e2d9cf4734c7c25cb1c43", "filename_list": ["./data/python/python_filter/107_0@huggingface@transformers@ba6815e82438f0816726fcbd5cbbe9d1c964db4a@src_transformers_utils_hub.py.txt"], "patch_list": [{"patch_file": "src/transformers/utils/hub.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "download_url(url, proxies=None):", "Modified_Line": "-    tmp_file = tempfile.mktemp()\n"}]}]}
{"num": 108, "cve": "CVE-2023-2780", "des": "Path Traversal: '\\..\\filename' in GitHub repository mlflow/mlflow prior to 2.3.1.", "cwe_list": ["CWE-29"], "cwe_name_lst": ["Path Traversal: '..filename'"], "url": "https://api.github.com/repos/mlflow/mlflow/commits/fae77a525dd908c56d6204a4cef1c1c75b4e9857", "html_url": "https://github.com/mlflow/mlflow/commit/fae77a525dd908c56d6204a4cef1c1c75b4e9857", "filename_list": ["./data/python/python_filter/108_1@mlflow@mlflow@eae60d72425476511557c48b0a8211cdae4bc979@mlflow_server_handlers.py.txt"], "patch_list": [{"patch_file": "mlflow/server/handlers.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_validate_source(source: str, run_id: str) -> None:", "Modified_Line": "-    if not is_local_uri(source):\n-        return\n-\n-    if run_id:\n-        store = _get_tracking_store()\n-        run = store.get_run(run_id)\n-        source = pathlib.Path(local_file_uri_to_path(source)).resolve()\n-        run_artifact_dir = pathlib.Path(local_file_uri_to_path(run.info.artifact_uri)).resolve()\n-        if run_artifact_dir in [source, *source.parents]:\n-            return\n-\n-    raise MlflowException(\n-        f\"Invalid source: '{source}'. To use a local path as source, the run_id request parameter \"\n-        \"has to be specified and the local path has to be contained within the artifact directory \"\n-        \"of the run specified by the run_id.\",\n-        INVALID_PARAMETER_VALUE,\n-    )\n"}]}]}
{"num": 110, "cve": "CVE-2023-32309", "des": "PyMdown Extensions is a set of extensions for the `Python-Markdown` markdown project. In affected versions an arbitrary file read is possible when using include file syntax. By using the syntax `--8<--\"/etc/passwd\"` or `--8<--\"/proc/self/environ\"` the content of these files will be rendered in the generated documentation. Additionally, a path relative to a specified, allowed base path can also be used to render the content of a file outside the specified base paths: `--8<-- \"../../../../etc/passwd\"`. Within the Snippets extension, there exists a `base_path` option but the implementation is vulnerable to Directory Traversal. The vulnerable section exists in `get_snippet_path(self, path)` lines 155 to 174 in snippets.py. Any readable file on the host where the plugin is executing may have its content exposed. This can impact any use of Snippets that exposes the use of Snippets to external users. It is never recommended to use Snippets to process user-facing, dynamic content. It is designed to process known content on the backend under the control of the host, but if someone were to accidentally enable it for user-facing content, undesired information could be exposed. This issue has been addressed in version 10.0. Users are advised to upgrade. Users unable to upgrade may restrict relative paths by filtering input.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/facelessuser/pymdown-extensions/commits/b7bb4878d6017c03c8dc97c42d8d3bb6ee81db9d", "html_url": "https://github.com/facelessuser/pymdown-extensions/commit/b7bb4878d6017c03c8dc97c42d8d3bb6ee81db9d", "filename_list": ["./data/python/python_filter/110_1@facelessuser@pymdown-extensions@a8fb9666566dfb7e86094082860b5616885d35f4@pymdownx_snippets.py.txt"], "patch_list": [{"patch_file": "pymdownx/snippets.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "__init__(self, config, md):", "Modified_Line": "-        self.base_path = base\r\n"}, {"Modified_Block_Num": "2", "Modified_Function": "get_snippet_path(self, path):", "Modified_Line": "-                    filename = os.path.join(base, path)\r\n                    if os.path.exists(filename):\r\n                        snippet = filename\r\n                        break\r\n                else:\r\n-                    basename = os.path.basename(base)\r\n                    dirname = os.path.dirname(base)\r\n-                    if basename.lower() == path.lower():\r\n-                        filename = os.path.join(dirname, path)\r\n-                        if os.path.exists(filename):\r\n-                            snippet = filename\r\n-                            break\r\n"}]}]}
{"num": 111, "cve": "CVE-2023-32303", "des": "Planet is software that provides satellite data. The secret file stores the user's Planet API authentication information. It should only be accessible by the user, but before version 2.0.1, its permissions allowed the user's group and non-group to read the file as well. This issue was patched in version 2.0.1. As a workaround, set the secret file permissions to only user read/write by hand.\n", "cwe_list": ["CWE-732"], "cwe_name_lst": ["Incorrect Permission Assignment for Critical Resource"], "url": "https://api.github.com/repos/planetlabs/planet-client-python/commits/d71415a83119c5e89d7b80d5f940d162376ee3b7", "html_url": "https://github.com/planetlabs/planet-client-python/commit/d71415a83119c5e89d7b80d5f940d162376ee3b7", "filename_list": ["./data/python/python_filter/111_0@planetlabs@planet-client-python@9783607b2d79496f912f2da9ec60084fa43438ed@planet_auth.py.txt"], "patch_list": [{"patch_file": "planet/auth.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "__init__(self, path):", "Modified_Line": "-    def __init__(self, path):\n-        self.path = path\n"}, {"Modified_Block_Num": "2", "Modified_Function": "_write(self, contents: dict):", "Modified_Line": "-        with open(self.path, 'w') as fp:\n            fp.write(json.dumps(contents))\n"}]}]}
{"num": 112, "cve": "CVE-2023-32059", "des": "Vyper is a Pythonic smart contract language for the Ethereum virtual machine. Prior to version 0.3.8, internal calls with default arguments are compiled incorrectly. Depending on the number of arguments provided in the call, the defaults are added not right-to-left, but left-to-right. If the types are incompatible, typechecking is bypassed. The ability to pass kwargs to internal functions is an undocumented feature that is not well known about. The issue is patched in version 0.3.8.", "cwe_list": ["CWE-683"], "cwe_name_lst": ["Function Call With Incorrect Order of Arguments"], "url": "https://api.github.com/repos/vyperlang/vyper/commits/c3e68c302aa6e1429946473769dd1232145822ac", "html_url": "https://github.com/vyperlang/vyper/commit/c3e68c302aa6e1429946473769dd1232145822ac", "filename_list": ["./data/python/python_filter/112_0@vyperlang@vyper@3de1415ee77a9244eb04bdb695e249d3ec9ed868@vyper_codegen_context.py.txt"], "patch_list": [{"patch_file": "vyper/codegen/context.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "lookup_internal_function(self, method_name, args_ir, ast_source):", "Modified_Line": "-        num_kwargs = len(sig.default_args)\n-        kwargs_needed = num_kwargs - num_provided_kwargs\n-        kw_vals = list(sig.default_values.values())[:kwargs_needed]\n"}]}]}
{"num": 113, "cve": "CVE-2023-31146", "des": "Vyper is a Pythonic smart contract language for the Ethereum virtual machine. Prior to version 0.3.8, during codegen, the length word of a dynarray is written before the data, which can result in out-of-bounds array access in the case where the dynarray is on both the lhs and rhs of an assignment. The issue can cause data corruption across call frames. The expected behavior is to revert due to out-of-bounds array access. Version 0.3.8 contains a patch for this issue.", "cwe_list": ["CWE-787"], "cwe_name_lst": ["Out-of-bounds Write"], "url": "https://api.github.com/repos/vyperlang/vyper/commits/4f8289a81206f767df1900ac48f485d90fc87edb", "html_url": "https://github.com/vyperlang/vyper/commit/4f8289a81206f767df1900ac48f485d90fc87edb", "filename_list": ["./data/python/python_filter/113_0@vyperlang@vyper@92c32f8e61677f7bbd6fd95ada0b7a45da594513@vyper_codegen_core.py.txt"], "patch_list": [{"patch_file": "vyper/codegen/core.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "make_byte_array_copier(dst, src):", "Modified_Line": "ret = [\"seq\"]\n            ret.append(STORE(dst, len_))\n-            dst = bytes_data_ptr(dst)\n-            src = bytes_data_ptr(src)\n-            ret.append(copy_bytes(dst, src, len_, max_bytes))\n"}, {"Modified_Block_Num": "2", "Modified_Function": "_dynarray_make_setter(dst, src):", "Modified_Line": "    if src.value == \"multi\":\n        ret = [\"seq\"]\n-        store_length = STORE(dst, len(src.args))\n-        ann = None\n-        if src.annotation is not None:\n-            ann = f\"len({src.annotation})\"\n-        store_length = IRnode.from_list(store_length, annotation=ann)\n-        ret.append(store_length)\n        n_items = len(src.args)\n        for i in range(n_items):\n            k = IRnode.from_list(i, typ=UINT256_T)\n            dst_i = get_element_ptr(dst, k, array_bounds_check=False)\n            src_i = get_element_ptr(src, k, array_bounds_check=False)\n            ret.append(make_setter(dst_i, src_i))\n"}, {"Modified_Block_Num": "3", "Modified_Function": "_dynarray_make_setter(dst, src):", "Modified_Line": "-            ret.append(STORE(dst, count))\n            if should_loop:\n                i = IRnode.from_list(_freshname(\"copy_darray_ix\"), typ=UINT256_T)\n                loop_body = make_setter(\n                    get_element_ptr(dst, i, array_bounds_check=False),\n                    get_element_ptr(src, i, array_bounds_check=False),\n                )\n                loop_body.annotation = f\"{dst}[i] = {src}[i]\"\n                ret.append([\"repeat\", i, 0, count, src.typ.count, loop_body])\n            else:\n                element_size = src.typ.value_type.memory_bytes_required\n                n_bytes = _mul(count, element_size)\n                max_bytes = src.typ.count * element_size\n                src_ = dynarray_data_ptr(src)\n                dst_ = dynarray_data_ptr(dst)\n                ret.append(copy_bytes(dst_, src_, n_bytes, max_bytes))\n"}]}]}
{"num": 114, "cve": "CVE-2023-32058", "des": "Vyper is a Pythonic smart contract language for the Ethereum virtual machine. Prior to version 0.3.8, due to missing overflow check for loop variables, by assigning the iterator of a loop to a variable, it is possible to overflow the type of the latter. The issue seems to happen only in loops of type `for i in range(a, a + N)` as in loops of type `for i in range(start, stop)` and `for i in range(stop)`, the compiler is able to raise a `TypeMismatch` when trying to overflow the variable. The problem has been patched in version 0.3.8.", "cwe_list": ["CWE-190"], "cwe_name_lst": ["Integer Overflow or Wraparound"], "url": "https://api.github.com/repos/vyperlang/vyper/commits/3de1415ee77a9244eb04bdb695e249d3ec9ed868", "html_url": "https://github.com/vyperlang/vyper/commit/3de1415ee77a9244eb04bdb695e249d3ec9ed868", "filename_list": ["./data/python/python_filter/114_0@vyperlang@vyper@4f8289a81206f767df1900ac48f485d90fc87edb@vyper_codegen_stmt.py.txt"], "patch_list": [{"patch_file": "vyper/codegen/stmt.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_parse_For_range(self):", "Modified_Line": "        else:\n            arg1 = self.stmt.iter.args[1]\n            rounds = self._get_range_const_value(arg1.right)\n            start = Expr.parse_value_expr(arg0, self.context)\n"}]}]}
{"num": 118, "cve": "CVE-2023-25754", "des": "Privilege Context Switching Error vulnerability in Apache Software Foundation Apache Airflow.This issue affects Apache Airflow: before 2.6.0.", "cwe_list": ["CWE-270"], "cwe_name_lst": ["Privilege Context Switching Error"], "url": "https://api.github.com/repos/apache/airflow/commits/18347d36e67894604436f3ef47d273532683b473", "html_url": "https://github.com/apache/airflow/commit/18347d36e67894604436f3ef47d273532683b473", "filename_list": ["./data/python/python_filter/118_0@apache@airflow@41fade2d219c1841fafa439cc5dbb036f34ee32a@airflow_utils_log_file_task_handler.py.txt"], "patch_list": [{"patch_file": "airflow/utils/log/file_task_handler.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_prepare_log_folder(self, directory: Path):", "Modified_Line": "-        mode = 0o777\n-        directory.mkdir(mode=mode, parents=True, exist_ok=True)\n-        if directory.stat().st_mode != mode:\n-            directory.chmod(mode)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "_init_file(self, ti):", "Modified_Line": "            try:\n-                os.chmod(full_path, 0o666)\n-            except OSError:\n-                logging.warning(\"OSError while change ownership of the log file\")\n"}]}]}
{"num": 119, "cve": "CVE-2023-30861", "des": "Flask is a lightweight WSGI web application framework. When all of the following conditions are met, a response containing data intended for one client may be cached and subsequently sent by the proxy to other clients. If the proxy also caches `Set-Cookie` headers, it may send one client's `session` cookie to other clients. The severity depends on the application's use of the session and the proxy's behavior regarding cookies. The risk depends on all these conditions being met.\n\n1. The application must be hosted behind a caching proxy that does not strip cookies or ignore responses with cookies.\n2. The application sets `session.permanent = True`\n3. The application does not access or modify the session at any point during a request.\n4. `SESSION_REFRESH_EACH_REQUEST` enabled (the default).\n5. The application does not set a `Cache-Control` header to indicate that a page is private or should not be cached.\n\nThis happens because vulnerable versions of Flask only set the `Vary: Cookie` header when the session is accessed or modified, not when it is refreshed (re-sent to update the expiration) without being accessed or modified. This issue has been fixed in versions 2.3.2 and 2.2.5.", "cwe_list": ["CWE-539"], "cwe_name_lst": ["Use of Persistent Cookies Containing Sensitive Information"], "url": "https://api.github.com/repos/pallets/flask/commits/afd63b16170b7c047f5758eb910c416511e9c965", "html_url": "https://github.com/pallets/flask/commit/afd63b16170b7c047f5758eb910c416511e9c965", "filename_list": ["./data/python/python_filter/119_0@pallets@flask@a6367dac747c1e149c60767eee7e8aa9c281c58e@src_flask_sessions.py.txt"], "patch_list": [{"patch_file": "src/flask/sessions.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "save_session(", "Modified_Line": "    def save_session(\n        self, app: \"Flask\", session: SessionMixin, response: \"Response\"\n    ) -> None:\n        name = self.get_cookie_name(app)\n        domain = self.get_cookie_domain(app)\n        path = self.get_cookie_path(app)\n        secure = self.get_cookie_secure(app)\n        samesite = self.get_cookie_samesite(app)\n        httponly = self.get_cookie_httponly(app)\n        if not session:\n            if session.modified:\n                response.delete_cookie(\n                    name,\n                    domain=domain,\n                    path=path,\n                    secure=secure,\n                    samesite=samesite,\n                    httponly=httponly,\n                )\n            return\n        if session.accessed:\n            response.vary.add(\"Cookie\")\n        if not self.should_set_cookie(app, session):\n            return\n        expires = self.get_expiration_time(app, session)\n        val = self.get_signing_serializer(app).dumps(dict(session))\n        response.set_cookie(\n            name,\n            val,\n            expires=expires,\n            httponly=httponly,\n            domain=domain,\n            path=path,\n            secure=secure,\n            samesite=samesite,\n        )\n"}]}]}
{"num": 121, "cve": "CVE-2022-0273", "des": "Improper Access Control in Pypi calibreweb prior to 0.6.16.", "cwe_list": ["CWE-284"], "cwe_name_lst": ["Improper Access Control"], "url": "https://api.github.com/repos/janeczku/calibre-web/commits/0c0313f375bed7b035c8c0482bbb09599e16bfcf", "html_url": "https://github.com/janeczku/calibre-web/commit/0c0313f375bed7b035c8c0482bbb09599e16bfcf", "filename_list": ["./data/python/python_filter/121_0@janeczku@calibre-web@6bf07539788004513c3692c074ebc7ba4ce005e1@cps_shelf.py.txt"], "patch_list": [{"patch_file": "cps/shelf.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "create_edit_shelf(shelf, page_title, page, shelf_id=False):", "Modified_Line": "    sync_only_selected_shelves = current_user.kobo_only_shelves_sync\n    if request.method == \"POST\":\n        to_save = request.form.to_dict()\n-        is_public = 1 if to_save.get(\"is_public\") else 0\n"}]}]}
{"num": 122, "cve": "CVE-2022-0339", "des": "Server-Side Request Forgery (SSRF) in Pypi calibreweb prior to 0.6.16.", "cwe_list": ["CWE-918"], "cwe_name_lst": ["Server-Side Request Forgery (SSRF)"], "url": "https://api.github.com/repos/janeczku/calibre-web/commits/3b216bfa07ec7992eff03e55d61732af6df9bb92", "html_url": "https://github.com/janeczku/calibre-web/commit/3b216bfa07ec7992eff03e55d61732af6df9bb92", "filename_list": ["./data/python/python_filter/122_2@janeczku@calibre-web@e8e2f789e5f58275f230df92e0fce7cbeb798ed0@cps_kobo_auth.py.txt"], "patch_list": [{"patch_file": "cps/kobo_auth.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "inner(*args, **kwargs):", "Modified_Line": "    host_list = request.host.rsplit(':')\n    if len(host_list) == 1:\n        host = ':'.join(host_list)\n    else:\n        host = ':'.join(host_list[0:-1])\n-    if host.startswith('127.') or host.lower() == 'localhost' or host.startswith('[::ffff:7f'):\n-        warning = _('PLease access calibre-web from non localhost to get valid api_endpoint for kobo device')\n-        return render_title_template(\n-            \"generate_kobo_auth_url.html\",\n-            title=_(u\"Kobo Setup\"),\n-            warning = warning\n-        )\n-    else:\n-        # Invalidate any prevously generated Kobo Auth token for this user.\n-        auth_token = ub.session.query(ub.RemoteAuthToken).filter(\n-            ub.RemoteAuthToken.user_id == user_id\n-        ).filter(ub.RemoteAuthToken.token_type==1).first()\n-\n-        if not auth_token:\n-            auth_token = ub.RemoteAuthToken()\n-            auth_token.user_id = user_id\n-            auth_token.expiration = datetime.max\n-            auth_token.auth_token = (hexlify(urandom(16))).decode(\"utf-8\")\n-            auth_token.token_type = 1\n-\n-            ub.session.add(auth_token)\n-            ub.session_commit()\n-\n-        books = calibre_db.session.query(db.Books).join(db.Data).all()\n-\n-        for book in books:\n-            formats = [data.format for data in book.data]\n-            if not 'KEPUB' in formats and config.config_kepubifypath and 'EPUB' in formats:\n-                helper.convert_book_format(book.id, config.config_calibre_dir, 'EPUB', 'KEPUB', current_user.name)\n-\n-        return render_title_template(\n-            \"generate_kobo_auth_url.html\",\n-            title=_(u\"Kobo Setup\"),\n-            kobo_auth_url=url_for(\n-                \"kobo.TopLevelEndpoint\", auth_token=auth_token.auth_token, _external=True\n-            ),\n-            warning = False\n-        )\n"}]}]}
{"num": 124, "cve": "CVE-2021-32849", "des": "Gerapy is a distributed crawler management framework. Prior to version 0.9.9, an authenticated user could execute arbitrary commands. This issue is fixed in version 0.9.9. There are no known workarounds.", "cwe_list": ["CWE-77"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in a Command ('Command Injection')"], "url": "https://api.github.com/repos/Gerapy/Gerapy/commits/98092528a72392447fef05539fadbc4a295e9d60", "html_url": "https://github.com/Gerapy/Gerapy/commit/98092528a72392447fef05539fadbc4a295e9d60", "filename_list": ["./data/python/python_filter/124_2@Gerapy@Gerapy@a821f5dc75f027f5a2c77aa40ed23f20efe85a5c@gerapy_server_core_views.py.txt"], "patch_list": [{"patch_file": "gerapy/server/core/views.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "project_file_read(request):", "Modified_Line": "    if request.method == 'POST':\n        data = json.loads(request.body)\n        path = join(data['path'], data['label'])\n"}, {"Modified_Block_Num": "2", "Modified_Function": "project_file_update(request):", "Modified_Line": "    if request.method == 'POST':\n        data = json.loads(request.body)\n        path = join(data['path'], data['label'])\n        code = data['code']\n"}, {"Modified_Block_Num": "3", "Modified_Function": "project_file_create(request):", "Modified_Line": "    if request.method == 'POST':\n        data = json.loads(request.body)\n        path = join(data['path'], data['name'])\n"}, {"Modified_Block_Num": "4", "Modified_Function": "project_file_delete(request):", "Modified_Line": "    if request.method == 'POST':\n        data = json.loads(request.body)\n        path = join(data['path'], data['label'])\n"}, {"Modified_Block_Num": "5", "Modified_Function": "project_file_rename(request):", "Modified_Line": "    if request.method == 'POST':\n        data = json.loads(request.body)\n        pre = join(data['path'], data['pre'])\n        new = join(data['path'], data['new'])\n"}]}]}
{"num": 125, "cve": "CVE-2022-21697", "des": "Jupyter Server Proxy is a Jupyter notebook server extension to proxy web services. Versions of Jupyter Server Proxy prior to 3.2.1 are vulnerable to Server-Side Request Forgery (SSRF). Any user deploying Jupyter Server or Notebook with jupyter-proxy-server extension enabled is affected. A lack of input validation allows authenticated clients to proxy requests to other hosts, bypassing the `allowed_hosts` check. Because authentication is required, which already grants permissions to make the same requests via kernel or terminal execution, this is considered low to moderate severity. Users may upgrade to version 3.2.1 to receive a patch or, as a workaround, install the patch manually.", "cwe_list": ["CWE-918"], "cwe_name_lst": ["Server-Side Request Forgery (SSRF)"], "url": "https://api.github.com/repos/jupyterhub/jupyter-server-proxy/commits/fd31930bacd12188c448c886e0783529436b99eb", "html_url": "https://github.com/jupyterhub/jupyter-server-proxy/commit/fd31930bacd12188c448c886e0783529436b99eb", "filename_list": ["./data/python/python_filter/125_0@jupyterhub@jupyter-server-proxy@8610a3bca22f913467e2dbfac8aee2ab6ba5648f@jupyter_server_proxy_handlers.py.txt"], "patch_list": [{"patch_file": "jupyter_server_proxy/handlers.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_client_uri(self, protocol, host, port, proxied_path):", "Modified_Line": "    def get_client_uri(self, protocol, host, port, proxied_path):\n-        context_path = self._get_context_path(host, port)\n        if self.absolute_url:\n            client_path = url_path_join(context_path, proxied_path)\n        else:\n            client_path = proxied_path\n"}, {"Modified_Block_Num": "2", "Modified_Function": "setup_handlers(web_app, serverproxy_config):", "Modified_Line": "-    web_app.add_handlers('.*', [\n-        (\n-            url_path_join(\n-                web_app.settings['base_url'],\n-                r'/proxy/([^/]*):(\\d+)(.*)',\n            },\n-            RemoteProxyHandler,\n-            {\n-                'absolute_url': False,\n-                'host_allowlist': host_allowlist,\n-                'rewrite_response': rewrite_response,\n-            }\n-        ),\n-        (\n-            url_path_join(\n-                web_app.settings['base_url'],\n-                r'/proxy/absolute/([^/]*):(\\d+)(.*)',\n            },\n-            RemoteProxyHandler,\n-            {\n-                'absolute_url': True,\n-                'host_allowlist': host_allowlist,\n-                'rewrite_response': rewrite_response,\n-            }\n-        ),\n-        (\n-            url_path_join(\n-                web_app.settings['base_url'],\n-                r'/proxy/(\\d+)(.*)',\n            },\n-            LocalProxyHandler,\n-            {\n-                'absolute_url': False,\n-                'rewrite_response': rewrite_response,\n-            },\n-        ),\n-        (\n-            url_path_join(\n-                web_app.settings['base_url'],\n-                r'/proxy/absolute/(\\d+)(.*)',\n            },\n-            LocalProxyHandler,\n-            {\n-                'absolute_url': True,\n-                'rewrite_response': rewrite_response,\n-            },\n-        ),\n-    ])\n"}]}]}
{"num": 129, "cve": "CVE-2022-21683", "des": "Wagtail is a Django based content management system focused on flexibility and user experience. When notifications for new replies in comment threads are sent, they are sent to all users who have replied or commented anywhere on the site, rather than only in the relevant threads. This means that a user could listen in to new comment replies on pages they have not have editing access to, as long as they have left a comment or reply somewhere on the site. A patched version has been released as Wagtail 2.15.2, which restores the intended behaviour - to send notifications for new replies to the participants in the active thread only (editing permissions are not considered). New comments can be disabled by setting `WAGTAILADMIN_COMMENTS_ENABLED = False` in the Django settings file.", "cwe_list": ["CWE-200"], "cwe_name_lst": ["Exposure of Sensitive Information to an Unauthorized Actor"], "url": "https://api.github.com/repos/wagtail/wagtail/commits/5fe901e5d86ed02dbbb63039a897582951266afd", "html_url": "https://github.com/wagtail/wagtail/commit/5fe901e5d86ed02dbbb63039a897582951266afd", "filename_list": ["./data/python/python_filter/129_0@wagtail@wagtail@335ece5f962e72364a8a75ca179a036cdca1a4ac@wagtail_admin_views_pages_edit.py.txt"], "patch_list": [{"patch_file": "wagtail/admin/views/pages/edit.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "send_commenting_notifications(self, changes):", "Modified_Line": "-        thread_users = get_user_model().objects.exclude(pk=self.request.user.pk).exclude(pk__in=subscribers.values_list('user_id', flat=True)).prefetch_related(\n            Prefetch('comment_replies', queryset=replies),\n            Prefetch(COMMENTS_RELATION_NAME, queryset=comments)\n-        ).exclude(\n-            Q(comment_replies__isnull=True) & Q(**{('%s__isnull' % COMMENTS_RELATION_NAME): True})\n"}]}]}
{"num": 131, "cve": "CVE-2021-3842", "des": "nltk is vulnerable to Inefficient Regular Expression Complexity", "cwe_list": ["CWE-1333"], "cwe_name_lst": ["Inefficient Regular Expression Complexity"], "url": "https://api.github.com/repos/nltk/nltk/commits/2a50a3edc9d35f57ae42a921c621edc160877f4d", "html_url": "https://github.com/nltk/nltk/commit/2a50a3edc9d35f57ae42a921c621edc160877f4d", "filename_list": ["./data/python/python_filter/131_0@nltk@nltk@8ed8b708eda2bb3b9277939c7999d348779b4a5b@nltk_parse_malt.py.txt", "./data/python/python_filter/131_1@nltk@nltk@8ed8b708eda2bb3b9277939c7999d348779b4a5b@nltk_sem_glue.py.txt"], "patch_list": [{"patch_file": "nltk/parse/malt.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "malt_regex_tagger():", "Modified_Line": "-            (r\"^-?[0-9]+(.[0-9]+)?$\", \"CD\"),  # cardinal numbers\n"}]}]}
{"num": 133, "cve": "CVE-2022-21706", "des": "Zulip is an open-source team collaboration tool with topic-based threading. Zulip Server version 2.0.0 and above are vulnerable to insufficient access control with multi-use invitations. A Zulip Server deployment which hosts multiple organizations is vulnerable to an attack where an invitation created in one organization (potentially as a role with elevated permissions) can be used to join any other organization. This bypasses any restrictions on required domains on users' email addresses, may be used to gain access to organizations which are only accessible by invitation, and may be used to gain access with elevated privileges. This issue has been patched in release 4.10. There are no known workarounds for this issue. ### Patches _Has the problem been patched? What versions should users upgrade to?_ ### Workarounds _Is there a way for users to fix or remediate the vulnerability without upgrading?_ ### References _Are there any links users can visit to find out more?_ ### For more information If you have any questions or comments about this advisory, you can discuss them on the [developer community Zulip server](https://zulip.com/developer-community/), or email the [Zulip security team](mailto:security@zulip.com).", "cwe_list": ["NVD-CWE-Other"], "cwe_name_lst": ["none"], "url": "https://api.github.com/repos/zulip/zulip/commits/88917019f03860609114082cdc0f31a561503f9e", "html_url": "https://github.com/zulip/zulip/commit/88917019f03860609114082cdc0f31a561503f9e", "filename_list": ["./data/python/python_filter/133_0@zulip@zulip@d5db254ca8167995a1654d1c45ffc74b2fade39a@zerver_views_auth.py.txt"], "patch_list": [{"patch_file": "zerver/views/auth.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "maybe_send_to_registration(", "Modified_Line": "    multiuse_obj: Optional[MultiuseInvite] = None\n-    realm: Optional[Realm] = None\n    from_multiuse_invite = False\n    if multiuse_object_key:\n        from_multiuse_invite = True\n        try:\n            multiuse_obj = get_object_from_key(multiuse_object_key, [Confirmation.MULTIUSE_INVITE])\n        except ConfirmationKeyException as exception:\n            return render_confirmation_key_error(request, exception)\n        assert multiuse_obj is not None\n-        realm = multiuse_obj.realm\n        invited_as = multiuse_obj.invited_as\n    else:\n-        try:\n-            realm = get_realm(get_subdomain(request))\n-        except Realm.DoesNotExist:\n-            pass\n"}]}]}
{"num": 134, "cve": "CVE-2022-24710", "des": "Weblate is a copyleft software web-based continuous localization system. Versions prior to 4.11 do not properly neutralize user input used in user name and language fields. Due to this improper neutralization it is possible to perform cross-site scripting via these fields. The issues were fixed in the 4.11 release. Users unable to upgrade are advised to add their own neutralize logic.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/WeblateOrg/weblate/commits/22d577b1f1e88665a88b4569380148030e0f8389", "html_url": "https://github.com/WeblateOrg/weblate/commit/22d577b1f1e88665a88b4569380148030e0f8389", "filename_list": ["./data/python/python_filter/134_0@WeblateOrg@weblate@0df9304d2c05e5f8af33070f52537ff2bf7767f5@weblate_trans_views_reports.py.txt"], "patch_list": [{"patch_file": "weblate/trans/views/reports.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_credits(request, project=None, component=None):", "Modified_Line": "-        result.append(language_format.format(name))\n        result.append(            translator_start-            + \"\\n\".join(translator_format.format(*t) for t in translators)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "get_counts(request, project=None, component=None):", "Modified_Line": "-                    cell_name.format(item[\"name\"] or \"Anonymous\"),\n-                    cell_name.format(item[\"email\"] or \"\"),\n"}]}]}
{"num": 137, "cve": "CVE-2022-23651", "des": "b2-sdk-python is a python library to access cloud storage provided by backblaze. Linux and Mac releases of the SDK version 1.14.0 and below contain a key disclosure vulnerability that, in certain conditions, can be exploited by local attackers through a time-of-check-time-of-use (TOCTOU) race condition. SDK users of the SqliteAccountInfo format are vulnerable while users of the InMemoryAccountInfo format are safe. The SqliteAccountInfo saves API keys (and bucket name-to-id mapping) in a local database file ($XDG_CONFIG_HOME/b2/account_info, ~/.b2_account_info or a user-defined path). When first created, the file is world readable and is (typically a few milliseconds) later altered to be private to the user. If the directory containing the file is readable by a local attacker then during the brief period between file creation and permission modification, a local attacker can race to open the file and maintain a handle to it. This allows the local attacker to read the contents after the file after the sensitive information has been saved to it. Consumers of this SDK who rely on it to save data using SqliteAccountInfo class should upgrade to the latest version of the SDK. Those who believe a local user might have opened a handle using this race condition, should remove the affected database files and regenerate all application keys. Users should upgrade to b2-sdk-python 1.14.1 or later.", "cwe_list": ["CWE-367"], "cwe_name_lst": ["Time-of-check Time-of-use (TOCTOU) Race Condition"], "url": "https://api.github.com/repos/Backblaze/b2-sdk-python/commits/62476638986e5b6d7459aca5ef8ce220760226e0", "html_url": "https://github.com/Backblaze/b2-sdk-python/commit/62476638986e5b6d7459aca5ef8ce220760226e0", "filename_list": ["./data/python/python_filter/137_0@Backblaze@b2-sdk-python@146aaa6e30632ec249160d1c843aaa11c539f669@b2sdk_account_info_sqlite_account_info.py.txt"], "patch_list": [{"patch_file": "b2sdk/account_info/sqlite_account_info.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_create_database(self, last_upgrade_to_run):", "Modified_Line": "-        os.chmod(self.filename, stat.S_IRUSR | stat.S_IWUSR)\n"}]}]}
{"num": 138, "cve": "CVE-2022-0736", "des": "Insecure Temporary File in GitHub repository mlflow/mlflow prior to 1.23.1.", "cwe_list": ["CWE-377"], "cwe_name_lst": ["Insecure Temporary File"], "url": "https://api.github.com/repos/mlflow/mlflow/commits/61984e6843d2e59235d82a580c529920cd8f3711", "html_url": "https://github.com/mlflow/mlflow/commit/61984e6843d2e59235d82a580c529920cd8f3711", "filename_list": ["./data/python/python_filter/138_0@mlflow@mlflow@271750bc2a65f469956a11499c022df138c6d0f6@mlflow_utils_file_utils.py.txt"], "patch_list": [{"patch_file": "mlflow/utils/file_utils.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "make_tarfile(output_filename, source_dir, archive_name, custom_filter=None):", "Modified_Line": "    try:\n        with tarfile.open(unzipped_filename, \"w\") as tar:\n            tar.add(source_dir, arcname=archive_name, filter=_filter_timestamps)\n        with gzip.GzipFile(\n            filename=\"\", fileobj=open(output_filename, \"wb\"), mode=\"wb\", mtime=0\n        ) as gzipped_tar, open(unzipped_filename, \"rb\") as tar:\n            gzipped_tar.write(tar.read())\n    finally:\n-        os.remove(unzipped_filename)\n"}]}]}
{"num": 139, "cve": "CVE-2022-23604", "des": "x26-Cogs is a repository of cogs made by Twentysix for the Red Discord bot. Among these cogs is the Defender cog, a tool for Discord server moderation. A vulnerability in the Defender cog prior to version 1.10.0 allows users with admin privileges to issue commands as other users who share the same server. If a bot owner shares the same server as the attacker, it is possible for the attacker to issue bot-owner restricted commands. The issue has been patched in version 1.10.0. One may unload the Defender cog as a workaround.", "cwe_list": ["CWE-269"], "cwe_name_lst": ["Improper Privilege Management"], "url": "https://api.github.com/repos/Twentysix26/x26-Cogs/commits/72dd9323cb4c90f3a5accac7087605375d178246", "html_url": "https://github.com/Twentysix26/x26-Cogs/commit/72dd9323cb4c90f3a5accac7087605375d178246", "filename_list": ["./data/python/python_filter/139_0@Twentysix26@x26-Cogs@6c604ce46715bebd30d02d1df25f9bd962d28cbe@defender_core_warden_rule.py.txt"], "patch_list": [{"patch_file": "defender/core/warden/rule.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "issue_command(params: models.IssueCommand):", "Modified_Line": "            issuer = guild.get_member(params.issue_as)\n            msg_obj = df_cache.get_msg_obj()\n            if message is None and params.destination is None:\n            else:\n                else: \n                    params.destination = safe_sub(params.destination)\n"}]}]}
{"num": 141, "cve": "CVE-2022-21712", "des": "twisted is an event-driven networking engine written in Python. In affected versions twisted exposes cookies and authorization headers when following cross-origin redirects. This issue is present in the `twited.web.RedirectAgent` and `twisted.web. BrowserLikeRedirectAgent` functions. Users are advised to upgrade. There are no known workarounds.", "cwe_list": ["CWE-346"], "cwe_name_lst": ["Origin Validation Error"], "url": "https://api.github.com/repos/twisted/twisted/commits/af8fe78542a6f2bf2235ccee8158d9c88d31e8e2", "html_url": "https://github.com/twisted/twisted/commit/af8fe78542a6f2bf2235ccee8158d9c88d31e8e2", "filename_list": ["./data/python/python_filter/141_0@twisted@twisted@7039a20e8a56c000cb95262ac02b3195349759d1@src_twisted_web_client.py.txt"], "patch_list": [{"patch_file": "src/twisted/web/client.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_handleRedirect(self, response, method, uri, headers, redirectCount):", "Modified_Line": "        location = self._resolveLocation(uri, locationHeaders[0])\n        deferred = self._agent.request(method, location, headers)\n"}]}]}
{"num": 160, "cve": "CVE-2022-23607", "des": "treq is an HTTP library inspired by requests but written on top of Twisted's Agents. Treq's request methods (`treq.get`, `treq.post`, etc.) and `treq.client.HTTPClient` constructor accept cookies as a dictionary. Such cookies are not bound to a single domain, and are therefore sent to *every* domain (\"supercookies\"). This can potentially cause sensitive information to leak upon an HTTP redirect to a different domain., e.g. should `https://example.com` redirect to `http://cloudstorageprovider.com` the latter will receive the cookie `session`. Treq 2021.1.0 and later bind cookies given to request methods (`treq.request`, `treq.get`, `HTTPClient.request`, `HTTPClient.get`, etc.) to the origin of the *url* parameter. Users are advised to upgrade. For users unable to upgrade Instead of passing a dictionary as the *cookies* argument, pass a `http.cookiejar.CookieJar` instance with properly domain- and scheme-scoped cookies in it.", "cwe_list": ["CWE-425"], "cwe_name_lst": ["Direct Request ('Forced Browsing')"], "url": "https://api.github.com/repos/twisted/treq/commits/1da6022cc880bbcff59321abe02bf8498b89efb2", "html_url": "https://github.com/twisted/treq/commit/1da6022cc880bbcff59321abe02bf8498b89efb2", "filename_list": ["./data/python/python_filter/160_0@twisted@treq@d89d553240f1c1e434bb137e5ce53877c54285e6@src_treq_client.py.txt"], "patch_list": [{"patch_file": "src/treq/client.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "__init__(self, agent, cookiejar=None,", "Modified_Line": "-        self._cookiejar = cookiejar or cookiejar_from_dict({})\n"}]}]}
{"num": 161, "cve": "CVE-2022-24303", "des": "Pillow before 9.0.1 allows attackers to delete files because spaces in temporary pathnames are mishandled.", "cwe_list": ["NVD-CWE-noinfo"], "cwe_name_lst": ["none"], "url": "https://api.github.com/repos/python-pillow/Pillow/commits/427221ef5f19157001bf8b1ad7cfe0b905ca8c26", "html_url": "https://github.com/python-pillow/Pillow/commit/427221ef5f19157001bf8b1ad7cfe0b905ca8c26", "filename_list": ["./data/python/python_filter/161_0@python-pillow@Pillow@c930be0758ac02cf15a2b8d5409d50d443550581@src_PIL_ImageShow.py.txt"], "patch_list": [{"patch_file": "src/PIL/ImageShow.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "show_file(self, file, **options):", "Modified_Line": "-        fd, path = tempfile.mkstemp()\n-        with os.fdopen(fd, \"w\") as f:\n-            f.write(file)\n-        with open(path) as f:\n-            subprocess.Popen(\n-                [\"im=$(cat); open -a Preview.app $im; sleep 20; rm -f $im\"],\n-                shell=True,\n-                stdin=f,\n-            )\n-        os.remove(path)\n"}]}]}
{"num": 162, "cve": "CVE-2022-0315", "des": "Insecure Temporary File in GitHub repository horovod/horovod prior to 0.24.0.", "cwe_list": ["CWE-668"], "cwe_name_lst": ["Exposure of Resource to Wrong Sphere"], "url": "https://api.github.com/repos/horovod/horovod/commits/b96ecae4dc69fc0a83c7c2d3f1dde600c20a1b41", "html_url": "https://github.com/horovod/horovod/commit/b96ecae4dc69fc0a83c7c2d3f1dde600c20a1b41", "filename_list": ["./data/python/python_filter/162_0@horovod@horovod@655353fc345b6a2512839a5bfc7086a5c7c614cf@horovod_runner_js_run.py.txt"], "patch_list": [{"patch_file": "horovod/runner/js_run.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "generate_jsrun_rankfile(settings, path=None):", "Modified_Line": "-    path = tempfile.mktemp() if path is None else path\n"}]}]}
{"num": 163, "cve": "CVE-2022-24757", "des": "The Jupyter Server provides the backend (i.e. the core services, APIs, and REST endpoints) for Jupyter web applications. Prior to version 1.15.4, unauthorized actors can access sensitive information from server logs. Anytime a 5xx error is triggered, the auth cookie and other header values are recorded in Jupyter Server logs by default. Considering these logs do not require root access, an attacker can monitor these logs, steal sensitive auth/cookie information, and gain access to the Jupyter server. Jupyter Server version 1.15.4 contains a patch for this issue. There are currently no known workarounds.", "cwe_list": ["CWE-532"], "cwe_name_lst": ["Insertion of Sensitive Information into Log File"], "url": "https://api.github.com/repos/jupyter-server/jupyter_server/commits/a5683aca0b0e412672ac6218d09f74d44ca0de5a", "html_url": "https://github.com/jupyter-server/jupyter_server/commit/a5683aca0b0e412672ac6218d09f74d44ca0de5a", "filename_list": ["./data/python/python_filter/163_0@jupyter-server@jupyter_server@e4a3141b82c6f8e9972e598e1b464a66677df227@jupyter_server_log.py.txt"], "patch_list": [{"patch_file": "jupyter_server/log.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "log_request(handler):", "Modified_Line": "    if status >= 500 and status != 502:\n-        log_method(json.dumps(dict(request.headers), indent=2))\n"}]}]}
{"num": 165, "cve": "CVE-2022-24751", "des": "Zulip is an open source group chat application. Starting with version 4.0 and prior to version 4.11, Zulip is vulnerable to a race condition during account deactivation, where a simultaneous access by the user being deactivated may, in rare cases, allow continued access by the deactivated user. A patch is available in version 4.11 on the 4.x branch and version 5.0-rc1 on the 5.x branch. Upgrading to a fixed version will, as a side effect, deactivate any cached sessions that may have been leaked through this bug. There are currently no known workarounds.", "cwe_list": ["CWE-362"], "cwe_name_lst": ["Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')"], "url": "https://api.github.com/repos/zulip/zulip/commits/62ba8e455d8f460001d9fb486a6dabfd1ed67717", "html_url": "https://github.com/zulip/zulip/commit/62ba8e455d8f460001d9fb486a6dabfd1ed67717", "filename_list": ["./data/python/python_filter/165_0@zulip@zulip@7650b5a972d0d87d712e025cf44d4560a021095a@zerver_lib_actions.py.txt"], "patch_list": [{"patch_file": "zerver/lib/actions.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "do_deactivate_user(", "Modified_Line": "    with transaction.atomic():\n-        delete_user_sessions(user_profile)\n"}]}]}
{"num": 168, "cve": "CVE-2022-0932", "des": "Missing Authorization in GitHub repository saleor/saleor prior to 3.1.2.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/saleor/saleor/commits/521dfd6394f3926a77c60d8633c058e16d0f916d", "html_url": "https://github.com/saleor/saleor/commit/521dfd6394f3926a77c60d8633c058e16d0f916d", "filename_list": ["./data/python/python_filter/168_0@saleor@saleor@035bf705cee15553c31fca5d918df5c438817e67@saleor_graphql_account_types.py.txt"], "patch_list": [{"patch_file": "saleor/graphql/account/types.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_resolve_orders(orders):", "Modified_Line": "-                orders = list(\n-                    filter(lambda order: order.status != OrderStatus.DRAFT, orders)\n-                )\n"}]}]}
{"num": 169, "cve": "CVE-2022-0860", "des": "Improper Authorization in GitHub repository cobbler/cobbler prior to 3.3.2.", "cwe_list": ["CWE-285"], "cwe_name_lst": ["Improper Authorization"], "url": "https://api.github.com/repos/cobbler/cobbler/commits/9044aa990a94752fa5bd5a24051adde099280bfa", "html_url": "https://github.com/cobbler/cobbler/commit/9044aa990a94752fa5bd5a24051adde099280bfa", "filename_list": ["./data/python/python_filter/169_0@cobbler@cobbler@817aea8654cce2cad0941f0986d7b03716cee4e6@cobbler_modules_authentication_pam.py.txt"], "patch_list": [{"patch_file": "cobbler/modules/authentication/pam.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "authenticate(api_handle, username: str, password: str) -> bool:", "Modified_Line": "    retval = PAM_AUTHENTICATE(handle, 0)\n"}]}]}
{"num": 170, "cve": "CVE-2021-3733", "des": "There's a flaw in urllib's AbstractBasicAuthHandler class. An attacker who controls a malicious HTTP server that an HTTP client (such as web browser) connects to, could trigger a Regular Expression Denial of Service (ReDOS) during an authentication request with a specially crafted payload that is sent by the server to the client. The greatest threat that this flaw poses is to application availability.", "cwe_list": ["CWE-400"], "cwe_name_lst": ["Uncontrolled Resource Consumption"], "url": "https://api.github.com/repos/python/cpython/commits/7215d1ae25525c92b026166f9d5cac85fb1defe1", "html_url": "https://github.com/python/cpython/commit/7215d1ae25525c92b026166f9d5cac85fb1defe1", "filename_list": ["./data/python/python_filter/170_0@python@cpython@d36d6a9c1808e87628ebaa855d4bec80130189f4@Lib_urllib_request.py.txt"], "patch_list": [{"patch_file": "Lib/urllib/request.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "-                    '([^ \\t]+)' # scheme like \"Basic\"\n"}]}]}
{"num": 171, "cve": "CVE-2022-0767", "des": "Server-Side Request Forgery (SSRF) in GitHub repository janeczku/calibre-web prior to 0.6.17.", "cwe_list": ["CWE-918"], "cwe_name_lst": ["Server-Side Request Forgery (SSRF)"], "url": "https://api.github.com/repos/janeczku/calibre-web/commits/965352c8d96c9eae7a6867ff76b0db137d04b0b8", "html_url": "https://github.com/janeczku/calibre-web/commit/965352c8d96c9eae7a6867ff76b0db137d04b0b8", "filename_list": ["./data/python/python_filter/171_0@janeczku@calibre-web@8007e450b3178f517b83b0989744c6df38867932@cps_helper.py.txt"], "patch_list": [{"patch_file": "cps/helper.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "save_cover_from_url(url, book_path):", "Modified_Line": "-        img = requests.get(url, timeout=(10, 200))\n        img.raise_for_status()\n        return save_cover(img, book_path)\n"}]}]}
{"num": 172, "cve": "CVE-2022-0766", "des": "Server-Side Request Forgery (SSRF) in GitHub repository janeczku/calibre-web prior to 0.6.17.", "cwe_list": ["CWE-918"], "cwe_name_lst": ["Server-Side Request Forgery (SSRF)"], "url": "https://api.github.com/repos/janeczku/calibre-web/commits/965352c8d96c9eae7a6867ff76b0db137d04b0b8", "html_url": "https://github.com/janeczku/calibre-web/commit/965352c8d96c9eae7a6867ff76b0db137d04b0b8", "filename_list": ["./data/python/python_filter/172_0@janeczku@calibre-web@8007e450b3178f517b83b0989744c6df38867932@cps_helper.py.txt"], "patch_list": [{"patch_file": "cps/helper.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "save_cover_from_url(url, book_path):", "Modified_Line": "    try:\n        if not cli.allow_localhost:\n            ipc = socket.getaddrinfo(urlparse(url).hostname, 0)[0][4][0]\n-            if ip.startswith(\"127.\") or ip.startswith('::ffff:7f') or ip == \"::1\":\n                log.error(\"Localhost was accessed for cover upload\")\n                return False, _(\"You are not allowed to access localhost for cover uploads\")\n"}]}]}
{"num": 173, "cve": "CVE-2022-0697", "des": "Open Redirect in GitHub repository archivy/archivy prior to 1.7.0.", "cwe_list": ["CWE-601"], "cwe_name_lst": ["URL Redirection to Untrusted Site ('Open Redirect')"], "url": "https://api.github.com/repos/archivy/archivy/commits/2d8cb29853190d42572b36deb61127e68d6be574", "html_url": "https://github.com/archivy/archivy/commit/2d8cb29853190d42572b36deb61127e68d6be574", "filename_list": ["./data/python/python_filter/173_1@archivy@archivy@fa389e7d59f91980693965830839d6de1f1db45f@archivy_routes.py.txt"], "patch_list": [{"patch_file": "archivy/routes.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "login():", "Modified_Line": "            next_url = request.args.get(\"next\")\n-            return redirect(next_url or \"/\")\n"}]}]}
{"num": 179, "cve": "CVE-2022-24900", "des": "Piano LED Visualizer is software that allows LED lights to light up as a person plays a piano connected to a computer. Version 1.3 and prior are vulnerable to a path traversal attack. The `os.path.join` call is unsafe for use with untrusted input. When the `os.path.join` call encounters an absolute path, it ignores all the parameters it has encountered till that point and starts working with the new absolute path. Since the \"malicious\" parameter represents an absolute path, the result of `os.path.join` ignores the static directory completely. Hence, untrusted input is passed via the `os.path.join` call to `flask.send_file` can lead to path traversal attacks. A patch with a fix is available on the `master` branch of the GitHub repository. This can also be fixed by preventing flow of untrusted data to the vulnerable `send_file` function. In case the application logic necessiates this behaviour, one can either use the `flask.safe_join` to join untrusted paths or replace `flask.send_file` calls with `flask.send_from_directory` calls.", "cwe_list": ["CWE-668"], "cwe_name_lst": ["Exposure of Resource to Wrong Sphere"], "url": "https://api.github.com/repos/onlaj/Piano-LED-Visualizer/commits/3f10602323cd8184e1c69a76b815655597bf0ee5", "html_url": "https://github.com/onlaj/Piano-LED-Visualizer/commit/3f10602323cd8184e1c69a76b815655597bf0ee5", "filename_list": ["./data/python/python_filter/179_0@onlaj@Piano-LED-Visualizer@6a732caa812c83a807c711f3d091af99209cae7b@webinterface_views_api.py.txt"], "patch_list": [{"patch_file": "webinterface/views_api.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "change_setting():", "Modified_Line": "    if setting_name == \"download_song\":\n        else:\n-            return send_file(\"../Songs/\" + value, mimetype='application/x-csv', attachment_filename=value,\n"}, {"Modified_Block_Num": "2", "Modified_Function": "change_setting():", "Modified_Line": "    if setting_name == \"download_sheet_music\":\n        else:\n-            return send_file(\"../Songs/\" + value.replace(\".mid\", \".abc\"), mimetype='application/x-csv',\n"}]}]}
{"num": 180, "cve": "CVE-2022-1531", "des": "SQL injection vulnerability in ARAX-UI Synonym Lookup functionality in GitHub repository rtxteam/rtx prior to checkpoint_2022-04-20 . This vulnerability is critical as it can lead to remote code execution and thus complete server takeover.", "cwe_list": ["CWE-89"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "url": "https://api.github.com/repos/RTXteam/RTX/commits/fa2797e656e3dba18f990a2db1f0f029d41f1921", "html_url": "https://github.com/RTXteam/RTX/commit/fa2797e656e3dba18f990a2db1f0f029d41f1921", "filename_list": ["./data/python/python_filter/180_0@RTXteam@RTX@12b9fa79bbe71299dfe3e9211239b381153014df@code_autocomplete_rtxcomplete.py.txt"], "patch_list": [{"patch_file": "code/autocomplete/rtxcomplete.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_nodes_like(word,requested_limit):", "Modified_Line": "        if found_fragment is None:\n-            cursor.execute(\"INSERT INTO cached_fragments(fragment) VALUES(?)\", (word,))\n-            fragment_id = cursor.lastrowid\n"}]}]}
{"num": 182, "cve": "CVE-2022-0645", "des": "Open redirect vulnerability via endpoint authorize_and_redirect/?redirect= in GitHub repository posthog/posthog prior to 1.34.1.", "cwe_list": ["CWE-601"], "cwe_name_lst": ["URL Redirection to Untrusted Site ('Open Redirect')"], "url": "https://api.github.com/repos/PostHog/posthog/commits/859d8ed9ac7c5026db09714a26c85c1458abb038", "html_url": "https://github.com/PostHog/posthog/commit/859d8ed9ac7c5026db09714a26c85c1458abb038", "filename_list": ["./data/python/python_filter/182_1@PostHog@posthog@b88c4d1e3739efe350e74059ad9a7d0d9a49d10f@posthog_urls.py.txt"], "patch_list": [{"patch_file": "posthog/urls.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "authorize_and_redirect(request):", "Modified_Line": "    if not request.GET.get(\"redirect\"):\n        return HttpResponse(\"You need to pass a url to ?redirect=\", status=401)\n    if not request.META.get(\"HTTP_REFERER\"):\n        return HttpResponse('You need to make a request that includes the \"Referer\" header.', status=400)\n    referer_url = urlparse(request.META[\"HTTP_REFERER\"])\n    redirect_url = urlparse(request.GET[\"redirect\"])\n"}]}]}
{"num": 186, "cve": "CVE-2022-24787", "des": "Vyper is a Pythonic Smart Contract Language for the Ethereum Virtual Machine. In version 0.3.1 and prior, bytestrings can have dirty bytes in them, resulting in the word-for-word comparisons giving incorrect results. Even without dirty nonzero bytes, two bytestrings can compare to equal if one ends with `\"\\x00\"` because there is no comparison of the length. A patch is available and expected to be part of the 0.3.2 release. There are currently no known workarounds.", "cwe_list": ["CWE-697"], "cwe_name_lst": ["Incorrect Comparison"], "url": "https://api.github.com/repos/vyperlang/vyper/commits/2c73f8352635c0a433423a5b94740de1a118e508", "html_url": "https://github.com/vyperlang/vyper/commit/2c73f8352635c0a433423a5b94740de1a118e508", "filename_list": ["./data/python/python_filter/186_1@vyperlang@vyper@0807a6073b3f5329723e7f88431e1f1d3a15c1cf@vyper_codegen_expr.py.txt"], "patch_list": [{"patch_file": "vyper/codegen/expr.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "parse_Compare(self):", "Modified_Line": "            left = Expr(self.expr.left, self.context).ir_node\n            right = Expr(self.expr.right, self.context).ir_node\n-            length_mismatch = left.typ.maxlen != right.typ.maxlen\n-            left_over_32 = left.typ.maxlen > 32\n-            right_over_32 = right.typ.maxlen > 32\n-\n-            if length_mismatch or left_over_32 or right_over_32:\n-                left_keccak = keccak256_helper(self.expr, left, self.context)\n-                right_keccak = keccak256_helper(self.expr, right, self.context)\n-                if op == \"eq\" or op == \"ne\":\n-                    return IRnode.from_list([op, left_keccak, right_keccak], typ=\"bool\")\n-\n-                else:\n-                    return\n-                def load_bytearray(side):\n-                    return LOAD(bytes_data_ptr(side))\n-\n-                return IRnode.from_list(\n-                    [op, load_bytearray(left), load_bytearray(right)],\n-                    typ=\"bool\",\n-                )\n"}]}]}
{"num": 188, "cve": "CVE-2022-1813", "des": "OS Command Injection in GitHub repository yogeshojha/rengine prior to 1.2.0.", "cwe_list": ["CWE-78"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "url": "https://api.github.com/repos/yogeshojha/rengine/commits/8277cec0f008a0451371a92e7e0bf082ab3f0c34", "html_url": "https://github.com/yogeshojha/rengine/commit/8277cec0f008a0451371a92e7e0bf082ab3f0c34", "filename_list": ["./data/python/python_filter/188_0@yogeshojha@rengine@72a5fb2eb766c7b0334a3420af7576a60c95b182@web_reNgine_common_func.py.txt"], "patch_list": [{"patch_file": "web/reNgine/common_func.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_cms_details(url):", "Modified_Line": "-    cms_detector_command = 'python3 /usr/src/github/CMSeeK/cmseek.py -u {} --random-agent --batch --follow-redirect'.format(url)\n-    os.system(cms_detector_command)\n"}]}]}
{"num": 189, "cve": "CVE-2022-29216", "des": "TensorFlow is an open source platform for machine learning. Prior to versions 2.9.0, 2.8.1, 2.7.2, and 2.6.4, TensorFlow's `saved_model_cli` tool is vulnerable to a code injection. This can be used to open a reverse shell. This code path was maintained for compatibility reasons as the maintainers had several test cases where numpy expressions were used as arguments. However, given that the tool is always run manually, the impact of this is still not severe. The maintainers have now removed the `safe=False` argument, so all parsing is done without calling `eval`. The patch is available in versions 2.9.0, 2.8.1, 2.7.2, and 2.6.4.", "cwe_list": ["CWE-94"], "cwe_name_lst": ["Improper Control of Generation of Code ('Code Injection')"], "url": "https://api.github.com/repos/tensorflow/tensorflow/commits/c5da7af048611aa29e9382371f0aed5018516cac", "html_url": "https://github.com/tensorflow/tensorflow/commit/c5da7af048611aa29e9382371f0aed5018516cac", "filename_list": ["./data/python/python_filter/189_0@tensorflow@tensorflow@0f239549382ac16ff7642138172631c3f52e3fff@tensorflow_python_tools_saved_model_cli.py.txt"], "patch_list": [{"patch_file": "tensorflow/python/tools/saved_model_cli.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "load_inputs_from_input_arg_string(inputs_str, input_exprs_str,", "Modified_Line": "-  input_exprs = preprocess_input_exprs_arg_string(input_exprs_str, safe=False)\n"}]}]}
{"num": 195, "cve": "CVE-2022-29202", "des": "TensorFlow is an open source platform for machine learning. Prior to versions 2.9.0, 2.8.1, 2.7.2, and 2.6.4, the implementation of `tf.ragged.constant` does not fully validate the input arguments. This results in a denial of service by consuming all available memory. Versions 2.9.0, 2.8.1, 2.7.2, and 2.6.4 contain a patch for this issue.", "cwe_list": ["CWE-1284"], "cwe_name_lst": ["Improper Validation of Specified Quantity in Input"], "url": "https://api.github.com/repos/tensorflow/tensorflow/commits/bd4d5583ff9c8df26d47a23e508208844297310e", "html_url": "https://github.com/tensorflow/tensorflow/commit/bd4d5583ff9c8df26d47a23e508208844297310e", "filename_list": ["./data/python/python_filter/195_0@tensorflow@tensorflow@e74ef072ecd54ca54f3940ce9b98af796ded2a1a@tensorflow_python_ops_ragged_ragged_factory_ops.py.txt"], "patch_list": [{"patch_file": "tensorflow/python/ops/ragged/ragged_factory_ops.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_constant_value(ragged_factory, inner_factory, pylist, dtype, ragged_rank,", "Modified_Line": "  scalar_depth, max_depth = _find_scalar_and_max_depth(pylist)\n  if scalar_depth is not None:\n    if max_depth > scalar_depth:\n      raise ValueError(\"Invalid pylist=%r: empty list nesting is greater \"\n                       \"than scalar value nesting\" % pylist)\n"}]}]}
{"num": 199, "cve": "CVE-2022-1806", "des": "Cross-site Scripting (XSS) - Reflected in GitHub repository rtxteam/rtx prior to checkpoint_2022-05-18.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/RTXteam/RTX/commits/9bb109b0014f952f315c7b89e0f29a9ba84ee04c", "html_url": "https://github.com/RTXteam/RTX/commit/9bb109b0014f952f315c7b89e0f29a9ba84ee04c", "filename_list": ["./data/python/python_filter/199_0@RTXteam@RTX@ebdb3856d3ce23df62fd7fc3186d3f5f13ea4337@code_autocomplete_server.py.txt"], "patch_list": [{"patch_file": "code/autocomplete/server.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get(self, arg,word=None):", "Modified_Line": "        try:\n            limit = self.get_argument(\"limit\")\n            word = self.get_argument(\"word\")\n-            callback = self.get_argument(\"callback\")\n            result = rtxcomplete.prefix(word,limit)\n-            result = callback+\"(\"+json.dumps(result)+\");\"\n"}]}]}
{"num": 201, "cve": "CVE-2022-1430", "des": "Cross-site Scripting (XSS) - DOM in GitHub repository octoprint/octoprint prior to 1.8.0.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/OctoPrint/OctoPrint/commits/8087528e4a7ddd15c7d95ff662deb5ef7de90045", "html_url": "https://github.com/OctoPrint/OctoPrint/commit/8087528e4a7ddd15c7d95ff662deb5ef7de90045", "filename_list": ["./data/python/python_filter/201_0@OctoPrint@OctoPrint@700034d028ff3518b563a7b4ba4dacc920142d07@src_octoprint_server_views.py.txt"], "patch_list": [{"patch_file": "src/octoprint/server/views.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": " login():", "Modified_Line": "-    redirect_url = request.args.get(\"redirect\", request.script_root + url_for(\"index\"))\n"}]}]}
{"num": 202, "cve": "CVE-2022-1053", "des": "Keylime does not enforce that the agent registrar data is the same when the tenant uses it for validation of the EK and identity quote and the verifier for validating the integrity quote. This allows an attacker to use one AK, EK pair from a real TPM to pass EK validation and give the verifier an AK of a software TPM. A successful attack breaks the entire chain of trust because a not validated AK is used by the verifier. This issue is worse if the validation happens first and then the agent gets added to the verifier because the timing is easier and the verifier does not validate the regcount entry being equal to 1,", "cwe_list": ["CWE-20"], "cwe_name_lst": ["Improper Input Validation"], "url": "https://api.github.com/repos/keylime/keylime/commits/bd5de712acdd77860e7dc58969181e16c7a8dc5d", "html_url": "https://github.com/keylime/keylime/commit/bd5de712acdd77860e7dc58969181e16c7a8dc5d", "filename_list": ["./data/python/python_filter/202_0@keylime@keylime@7631bbfe44a75911e5abeda7845c4f937c4a33cd@keylime_cloud_verifier_tornado.py.txt"], "patch_list": [{"patch_file": "keylime/cloud_verifier_tornado.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "post(self):", "Modified_Line": "-                    registrar_client.init_client_tls('cloud_verifier')\n-                    registrar_data = registrar_client.getData(config.get(\"cloud_verifier\", \"registrar_ip\"),\n-                                                              config.get(\"cloud_verifier\", \"registrar_port\"), agent_id)\n-                    if registrar_data is None:\n-                        web_util.echo_json_response(self, 400,\n-                                                    f\"Data for agent {agent_id} could not be found in registrar!\")\n-                        logger.warning(\"Data for agent %s could not be found in registrar!\", agent_id)\n-                        return\n-\n-                    agent_data['mtls_cert'] = registrar_data.get('mtls_cert', None)\n-                    agent_data['ak_tpm'] = registrar_data['aik_tpm']\n-                    if registrar_data.get('mtls_cert', None) is None and agent_data['supported_version'] != \"1.0\":\n"}, {"Modified_Block_Num": "2", "Modified_Function": "post(self):", "Modified_Line": "-                        mtls_cert = registrar_data.get('mtls_cert', None)\n"}]}]}
{"num": 203, "cve": "CVE-2022-1592", "des": "Server-Side Request Forgery in scout in GitHub repository clinical-genomics/scout prior to v4.42. An attacker could make the application perform arbitrary requests to fishing steal cookie, request to private area, or lead to xss...", "cwe_list": ["CWE-918"], "cwe_name_lst": ["Server-Side Request Forgery (SSRF)"], "url": "https://api.github.com/repos/Clinical-Genomics/scout/commits/b0ef15f4737d0c801154c1991b52ff5cab4f5c83", "html_url": "https://github.com/Clinical-Genomics/scout/commit/b0ef15f4737d0c801154c1991b52ff5cab4f5c83", "filename_list": ["./data/python/python_filter/203_1@Clinical-Genomics@scout@51a838dd1df58dbb965cd39f6f146a5243ba207a@scout_server_blueprints_alignviewers_views.py.txt"], "patch_list": [{"patch_file": "scout/server/blueprints/alignviewers/views.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "remote_cors(remote_url):", "Modified_Line": "@alignviewers_bp.route(\"/remote/cors/<path:remote_url>\", methods=[\"OPTIONS\", \"GET\"])\ndef remote_cors(remote_url):\n    resp = requests.request(\n        method=request.method,\n        url=remote_url,\n        headers={key: value for (key, value) in request.headers if key != \"Host\"},\n        data=request.get_data(),\n        cookies=request.cookies,\n        allow_redirects=True,\n    )\n"}, {"Modified_Block_Num": "2", "Modified_Function": "remote_static():", "Modified_Line": "@alignviewers_bp.route(\"/remote/static\", methods=[\"OPTIONS\", \"GET\"])\ndef remote_static():\n    \"\"\"Stream *large* static files with special requirements.\"\"\"\n    file_path = request.args.get(\"file\") or \".\"\n-    if current_user.is_authenticated is False or file_path not in session.get(\"igv_tracks\", []):\n-        LOG.warning(f\"{file_path} not in {session.get('igv_tracks', [])}\")\n"}]}]}
{"num": 205, "cve": "CVE-2022-31052", "des": "Synapse is an open source home server implementation for the Matrix chat network. In versions prior to 1.61.1 URL previews of some web pages can exhaust the available stack space for the Synapse process due to unbounded recursion. This is sometimes recoverable and leads to an error for the request causing the problem, but in other cases the Synapse process may crash altogether. It is possible to exploit this maliciously, either by malicious users on the homeserver, or by remote users sending URLs that a local user's client may automatically request a URL preview for. Remote users are not able to exploit this directly, because the URL preview endpoint is authenticated. Deployments with `url_preview_enabled: false` set in configuration are not affected. Deployments with `url_preview_enabled: true` set in configuration **are** affected. Deployments with no configuration value set for `url_preview_enabled` are not affected, because the default is `false`. Administrators of homeservers with URL previews enabled are advised to upgrade to v1.61.1 or higher. Users unable to upgrade should set `url_preview_enabled` to false.", "cwe_list": ["CWE-674"], "cwe_name_lst": ["Uncontrolled Recursion"], "url": "https://api.github.com/repos/matrix-org/synapse/commits/fa1308061802ac7b7d20e954ba7372c5ac292333", "html_url": "https://github.com/matrix-org/synapse/commit/fa1308061802ac7b7d20e954ba7372c5ac292333", "filename_list": ["./data/python/python_filter/205_0@matrix-org@synapse@21e6c0ed644a5306d945632af0afe005c90f4649@synapse_rest_media_v1_preview_html.py.txt"], "patch_list": [{"patch_file": "synapse/rest/media/v1/preview_html.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_iterate_over_text(", "Modified_Line": "    tree: \"etree.Element\", *tags_to_ignore: Union[str, \"etree.Comment\"]\n) -> Generator[str, None, None]:\n-    elements = iter([tree])\n-    while True:\n-        el = next(elements, None)\n-        if el is None:\n-            return\n        if isinstance(el, str):\n            yield el\n        elif el.tag not in tags_to_ignore:\n            if el.get(\"role\") in ARIA_ROLES_TO_IGNORE:\n                continue\n            if el.text:\n                yield el.text\n-            elements = itertools.chain(\n-                itertools.chain.from_iterable(  # Basically a flatmap\n-                    [child, child.tail] if child.tail else [child]\n-                    for child in el.iterchildren()\n-                ),\n-                elements,\n-            )\n"}]}]}
{"num": 212, "cve": "CVE-2022-23071", "des": "In Recipes, versions 0.9.1 through 1.2.5 are vulnerable to Server Side Request Forgery (SSRF), in the Import Recipe functionality. When an attacker enters the localhost URL, a low privileged attacker can access/read the internal file system to access sensitive information.", "cwe_list": ["CWE-918"], "cwe_name_lst": ["Server-Side Request Forgery (SSRF)"], "url": "https://api.github.com/repos/TandoorRecipes/recipes/commits/d48fe26a3529cc1ee903ffb2758dfd8f7efaba8c", "html_url": "https://github.com/TandoorRecipes/recipes/commit/d48fe26a3529cc1ee903ffb2758dfd8f7efaba8c", "filename_list": ["./data/python/python_filter/212_0@TandoorRecipes@recipes@7fd5fca0cfd89098063b37d94877ef4953769e71@cookbook_integration_cookbookapp.py.txt", "./data/python/python_filter/212_1@TandoorRecipes@recipes@7fd5fca0cfd89098063b37d94877ef4953769e71@cookbook_integration_cookmate.py.txt", "./data/python/python_filter/212_2@TandoorRecipes@recipes@7fd5fca0cfd89098063b37d94877ef4953769e71@cookbook_integration_recettetek.py.txt", "./data/python/python_filter/212_3@TandoorRecipes@recipes@7fd5fca0cfd89098063b37d94877ef4953769e71@cookbook_integration_recipesage.py.txt", "./data/python/python_filter/212_4@TandoorRecipes@recipes@7fd5fca0cfd89098063b37d94877ef4953769e71@cookbook_provider_dropbox.py.txt", "./data/python/python_filter/212_6@TandoorRecipes@recipes@7fd5fca0cfd89098063b37d94877ef4953769e71@cookbook_views_api.py.txt"], "patch_list": [{"patch_file": "cookbook/integration/cookbookapp.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_recipe_from_file(self, file):", "Modified_Line": "-                response = requests.get(images[0])\n-                self.import_recipe_image(recipe, BytesIO(response.content))\n"}]}, {"patch_file": "cookbook/integration/cookmate.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_recipe_from_file(self, file):", "Modified_Line": "-                response = requests.get(recipe_xml.find('imageurl').text.strip())\n"}]}, {"patch_file": "cookbook/integration/recettetek.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_recipe_from_file(self, file):", "Modified_Line": "-                    response = requests.get(file['originalPicture'])\n-                    if imghdr.what(BytesIO(response.content)) is not None:\n-                        self.import_recipe_image(recipe, BytesIO(response.content), filetype=get_filetype(file['originalPicture']))\n-                    else:\n-                        raise Exception(\"Original image failed to download.\")\n"}]}, {"patch_file": "cookbook/integration/recipesage.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_recipe_from_file(self, file):", "Modified_Line": "-                response = requests.get(file['image'][0])\n-                self.import_recipe_image(recipe, BytesIO(response.content))\n"}]}, {"patch_file": "cookbook/provider/dropbox.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_file(recipe):", "Modified_Line": "-        response = requests.get(recipe.link.replace('www.dropbox.', 'dl.dropboxusercontent.'))\n-        return io.BytesIO(response.content)\n"}]},{"patch_file": "cookbook/views/api.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "image(self, request, pk):", "Modified_Line": "-                    response = requests.get(serializer.validated_data['image_url'])\n-                    image = File(io.BytesIO(response.content))\n-                    filetype = mimetypes.guess_extension(response.headers['content-type']) or filetype\n"}, {"Modified_Block_Num": "2", "Modified_Function": "recipe_from_source(request):", "Modified_Line": "-            data = requests.get(url, headers=external_request_headers).content\n"}]}]}
{"num": 216, "cve": "CVE-2020-25459", "des": "An issue was discovered in function sync_tree in hetero_decision_tree_guest.py in WeBank FATE (Federated AI Technology Enabler) 0.1 through 1.4.2 allows attackers to read sensitive information during the training process of machine learning joint modeling.", "cwe_list": ["CWE-668"], "cwe_name_lst": ["Exposure of Resource to Wrong Sphere"], "url": "https://api.github.com/repos/FederatedAI/FATE/commits/6feccf6d752184a6f9365d56a76fe627983e7139", "html_url": "https://github.com/FederatedAI/FATE/commit/6feccf6d752184a6f9365d56a76fe627983e7139", "filename_list": ["./data/python/python_filter/216_0@FederatedAI@FATE@67708d5d327e736d80e2f6726968cf02a926310e@federatedml_tree_hetero_hetero_decision_tree_guest.py.txt"], "patch_list": [{"patch_file": "federatedml/tree/hetero/hetero_decision_tree_guest.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "redispatch_node(self, dep=-1, max_depth_reach=False):", "Modified_Line": "        LOGGER.info(\"sync tree to host\")\n-        self.transfer_inst.tree.remote(self.tree_,\n"}]}]}
{"num": 217, "cve": "CVE-2022-31041", "des": "Open Forms is an application for creating and publishing smart forms. Open Forms supports file uploads as one of the form field types. These fields can be configured to allow only certain file extensions to be uploaded by end users (e.g. only PDF / Excel / ...). The input validation of uploaded files is insufficient in versions prior to 1.0.9 and 1.1.1. Users could alter or strip file extensions to bypass this validation. This results in files being uploaded to the server that are of a different file type than indicated by the file name extension. These files may be downloaded (manually or automatically) by staff and/or other applications for further processing. Malicious files can therefore find their way into internal/trusted networks. Versions 1.0.9 and 1.1.1 contain patches for this issue. As a workaround, an API gateway or intrusion detection solution in front of open-forms may be able to scan for and block malicious content before it reaches the Open Forms application.", "cwe_list": ["CWE-434"], "cwe_name_lst": ["Unrestricted Upload of File with Dangerous Type"], "url": "https://api.github.com/repos/open-formulieren/open-forms/commits/0978a29e821a7228c5d46c0527c3e925eb91b071", "html_url": "https://github.com/open-formulieren/open-forms/commit/0978a29e821a7228c5d46c0527c3e925eb91b071", "filename_list": ["./data/python/python_filter/217_0@open-formulieren@open-forms@3e8c9cce386e548765783354694fbb9d7a6ea7d3@src_openforms_submissions_attachments.py.txt"], "patch_list": [{"patch_file": "src/openforms/submissions/attachments.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "attach_uploads_to_submission_step(submission_step: SubmissionStep) -> list:", "Modified_Line": "    components = list(submission_step.form_step.iter_components(recursive=True))\n    uploads = resolve_uploads_from_data(components, submission_step.data)\n    result = list()\n    for key, (component, uploads) in uploads.items():\n        resize_apply = glom(component, \"of.image.resize.apply\", default=False)\n        resize_size = (\n            glom(component, \"of.image.resize.width\", default=DEFAULT_IMAGE_MAX_SIZE[0]),\n            glom(\n                component, \"of.image.resize.height\", default=DEFAULT_IMAGE_MAX_SIZE[1]\n            ),\n        )\n        for i, upload in enumerate(uploads, start=1):\n            if upload.file_size > file_max_size:\n                raise RequestEntityTooLarge(\n                    _(\n                        \"Upload {uuid} exceeds the maximum upload size of {max_size}b\"\n                    ).format(\n                        uuid=upload.uuid,\n                        max_size=file_max_size,\n                    ),\n                )\n"}]}]}
{"num": 221, "cve": "CVE-2022-31027", "des": "OAuthenticator is an OAuth token library for the JupyerHub login handler. CILogonOAuthenticator is provided by the OAuthenticator package, and lets users log in to a JupyterHub via CILogon. This is primarily used to restrict a JupyterHub only to users of a given institute. The allowed_idps configuration trait of CILogonOAuthenticator is documented to be a list of domains that indicate the institutions whose users are authorized to access this JupyterHub. This authorization is validated by ensuring that the *email* field provided to us by CILogon has a *domain* that matches one of the domains listed in `allowed_idps`.If `allowed_idps` contains `berkeley.edu`, you might expect only users with valid current credentials provided by University of California, Berkeley to be able to access the JupyterHub. However, CILogonOAuthenticator does *not* verify which provider is used by the user to login, only the email address provided. So a user can login with a GitHub account that has email set to `<something>@berkeley.edu`, and that will be treated exactly the same as someone logging in using the UC Berkeley official Identity Provider. The patch fixing this issue makes a *breaking change* in how `allowed_idps` is interpreted. It's no longer a list of domains, but configuration representing the `EntityID` of the IdPs that are allowed, picked from the [list maintained by CILogon](https://cilogon.org/idplist/). Users are advised to upgrade.", "cwe_list": ["CWE-639"], "cwe_name_lst": ["Authorization Bypass Through User-Controlled Key"], "url": "https://api.github.com/repos/jupyterhub/oauthenticator/commits/5cd2d1816f90dc5c946e6e38fd2d0ba535624c5c", "html_url": "https://github.com/jupyterhub/oauthenticator/commit/5cd2d1816f90dc5c946e6e38fd2d0ba535624c5c", "filename_list": ["./data/python/python_filter/221_0@jupyterhub@oauthenticator@c58b9e122071cbe6fdc614651e61f7814703d771@oauthenticator_cilogon.py.txt"], "patch_list": [{"patch_file": "oauthenticator/cilogon.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "authenticate(self, handler, data=None):", "Modified_Line": "        for claim in claimlist:\n            username = resp_json.get(claim)\n            if username:\n                break\n        if not username:\n            if len(claimlist) < 2:\n                self.log.error(\n                    \"Username claim %s not found in response: %s\",\n                    self.username_claim,\n                    sorted(resp_json.keys()),\n                )\n            else:\n                self.log.error(\n                    \"No username claim from %r in response: %s\",\n                    claimlist,\n                    sorted(resp_json.keys()),\n                )\n            raise web.HTTPError(500, \"Failed to get username from CILogon\")\n        if self.allowed_idps:\n            gotten_name, gotten_idp = username.split('@')\n            if gotten_idp not in self.allowed_idps:\n                self.log.error(\"Trying to login from not allowed domain %s\", gotten_idp)\n                raise web.HTTPError(500, \"Trying to login from a domain not allowed\")\n            if len(self.allowed_idps) == 1 and self.strip_idp_domain:\n                username = gotten_name\n"}]}]}
{"num": 222, "cve": "CVE-2022-29255", "des": "Vyper is a Pythonic Smart Contract Language for the ethereum virtual machine. In versions prior to 0.3.4 when a calling an external contract with no return value, the contract address (including side effects) could be evaluated twice. This may result in incorrect outcomes for contracts. This issue has been addressed in v0.3.4.", "cwe_list": ["CWE-670"], "cwe_name_lst": ["Always-Incorrect Control Flow Implementation"], "url": "https://api.github.com/repos/vyperlang/vyper/commits/6b4d8ff185de071252feaa1c319712b2d6577f8d", "html_url": "https://github.com/vyperlang/vyper/commit/6b4d8ff185de071252feaa1c319712b2d6577f8d", "filename_list": ["./data/python/python_filter/222_0@vyperlang@vyper@90e3d20c9c9099101492514135b8677dcbf2be10@vyper_codegen_external_call.py.txt"], "patch_list": [{"patch_file": "vyper/codegen/external_call.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "ir_for_external_call(call_expr, context):", "Modified_Line": "-    contract_address = Expr.parse_value_expr(call_expr.func.value, context)\n-    call_kwargs = _parse_kwargs(call_expr, context)\n-    args_ir = [Expr(x, context).ir_node for x in call_expr.args]\n-    assert isinstance(contract_address.typ, InterfaceType)\n"}]}]}
{"num": 223, "cve": "CVE-2022-24840", "des": "django-s3file is a lightweight file upload input for Django and Amazon S3 . In versions prior to 5.5.1 it was possible to traverse the entire AWS S3 bucket and in most cases to access or delete files. If the `AWS_LOCATION` setting was set, traversal was limited to that location only. The issue was discovered by the maintainer. There were no reports of the vulnerability being known to or exploited by a third party, prior to the release of the patch. The vulnerability has been fixed in version 5.5.1 and above. There is no feasible workaround. We must urge all users to immediately updated to a patched version.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/codingjoe/django-s3file/commits/68ccd2c621a40eb66fdd6af2be9d5fcc9c373318", "html_url": "https://github.com/codingjoe/django-s3file/commit/68ccd2c621a40eb66fdd6af2be9d5fcc9c373318", "filename_list": ["./data/python/python_filter/223_1@codingjoe@django-s3file@03f6ff81278a616619726ba3c51a71fec8a9f9e2@s3file_middleware.py.txt"], "patch_list": [{"patch_file": "s3file/middleware.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_get_files_from_storage(paths):", "Modified_Line": "        for path in paths:\n            path = pathlib.PurePosixPath(path)\n            try:\n-                location = storage.aws_location\n-            except AttributeError:\n-                location = storage.location\n            try:\n-                f = storage.open(str(path.relative_to(location)))\n"}]}]}
{"num": 227, "cve": "CVE-2022-31168", "des": "Zulip is an open source team chat tool. Due to an incorrect authorization check in Zulip Server 5.4 and earlier, a member of an organization could craft an API call that grants organization administrator privileges to one of their bots. The vulnerability is fixed in Zulip Server 5.5. Members who dont own any bots, and lack permission to create them, cant exploit the vulnerability. As a workaround for the vulnerability, an organization administrator can restrict the `Who can create bots` permission to administrators only, and change the ownership of existing bots.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/zulip/zulip/commits/751b2a03e565e9eb02ffe923b7c24ac73d604034", "html_url": "https://github.com/zulip/zulip/commit/751b2a03e565e9eb02ffe923b7c24ac73d604034", "filename_list": ["./data/python/python_filter/227_0@zulip@zulip@ad2ca0e6685f9aa46a1df1495fc08e73b98e1091@zerver_views_users.py.txt"], "patch_list": [{"patch_file": "zerver/views/users.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "update_user_backend(", "Modified_Line": "    if role is not None and target.role != role:\n        if UserProfile.ROLE_REALM_OWNER in [role, target.role] and not user_profile.is_realm_owner:\n            raise OrganizationOwnerRequired()\n"}, {"Modified_Block_Num": "2", "Modified_Function": "patch_bot_backend(", "Modified_Line": "    if role is not None and bot.role != role:\n        if UserProfile.ROLE_REALM_OWNER in [role, bot.role] and not user_profile.is_realm_owner:\n            raise OrganizationOwnerRequired()\n"}]}]}
{"num": 232, "cve": "CVE-2022-31564", "des": "The woduq1414/munhak-moa repository before 2022-05-03 on GitHub allows absolute path traversal because the Flask send_file function is used unsafely.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/woduq1414/munhak-moa/commits/e8f800373b20cb22de70c7a994325b8903877da0", "html_url": "https://github.com/woduq1414/munhak-moa/commit/e8f800373b20cb22de70c7a994325b8903877da0", "filename_list": ["./data/python/python_filter/232_0@woduq1414@munhak-moa@cdcc98959879c2e88a89eea164e806b3b0e09972@app.py.txt"], "patch_list": [{"patch_file": "app.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_image(path):", "Modified_Line": "    def get_absolute_path(path):\n        script_dir = os.path.dirname(__file__)\n        rel_path = path\n-        abs_file_path = os.path.join(script_dir, rel_path)\n        return abs_file_path\n    return send_file(\n        get_absolute_path(f\"./images/{path}\"),\n        mimetype='image/png',\n        attachment_filename='snapshot.png',\n        cache_timeout=0\n    )\n"}]}]}
{"num": 233, "cve": "CVE-2022-31549", "des": "The olmax99/helm-flask-celery repository before 2022-05-25 on GitHub allows absolute path traversal because the Flask send_file function is used unsafely.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/olmax99/helm-flask-celery/commits/28c985d712d7ac26893433e8035e2e3678fcae9f", "html_url": "https://github.com/olmax99/helm-flask-celery/commit/28c985d712d7ac26893433e8035e2e3678fcae9f", "filename_list": ["./data/python/python_filter/233_0@olmax99@helm-flask-celery@0e8a6bdc4fa5b35fbdda18b27c8e768df8a9bb3c@webapiservice_flaskapi_core_app_setup.py.txt"], "patch_list": [{"patch_file": "webapiservice/flaskapi/core/app_setup.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "route_frontend(path):", "Modified_Line": "-    file_path = os.path.join(current_app.template_folder, path)\n    if os.path.isfile(file_path):\n        return send_file(file_path)\n"}]}]}
{"num": 234, "cve": "CVE-2022-31507", "des": "The ganga-devs/ganga repository before 8.5.10 on GitHub allows absolute path traversal because the Flask send_file function is used unsafely.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/ganga-devs/ganga/commits/730e7aba192407d35eb37dd7938d49071124be8c", "html_url": "https://github.com/ganga-devs/ganga/commit/730e7aba192407d35eb37dd7938d49071124be8c", "filename_list": ["./data/python/python_filter/234_0@ganga-devs@ganga@0c0f9e33b36ee7ead0855f1464f8d4efad26bdbc@ganga_GangaGUI_gui_routes.py.txt"], "patch_list": [{"patch_file": "ganga/GangaGUI/gui/routes.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "job_browse(job_id: int, path):", "Modified_Line": "-    abs_path = os.path.join(job_base_dir, path)\n    if os.path.isfile(abs_path):\n        return send_file(abs_path)\n"}]}]}
{"num": 235, "cve": "CVE-2022-31506", "des": "The cmusatyalab/opendiamond repository through 10.1.1 on GitHub allows absolute path traversal because the Flask send_file function is used unsafely.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/cmusatyalab/opendiamond/commits/398049c187ee644beabab44d6fece82251c1ea56", "html_url": "https://github.com/cmusatyalab/opendiamond/commit/398049c187ee644beabab44d6fece82251c1ea56", "filename_list": ["./data/python/python_filter/235_1@cmusatyalab@opendiamond@d2f20ffff793f88335f2c0244679d7193295abe2@opendiamond_dataretriever_diamond_store.py.txt"], "patch_list": [{"patch_file": "opendiamond/dataretriever/diamond_store.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_object_src_http(obj_path):", "Modified_Line": "    path = _get_obj_absolute_path(obj_path)\n    headers = Headers()\n    response = send_file(path,\n                         cache_timeout=datetime.timedelta(\n                             days=365).total_seconds(),\n                         add_etags=True,\n                         conditional=True)\n    return response\n"}]}]}
{"num": 236, "cve": "CVE-2022-35411", "des": "rpc.py through 0.6.0 allows Remote Code Execution because an unpickle occurs when the \"serializer: pickle\" HTTP header is sent. In other words, although JSON (not Pickle) is the default data format, an unauthenticated client can cause the data to be processed with unpickle.", "cwe_list": ["CWE-522"], "cwe_name_lst": ["Insufficiently Protected Credentials"], "url": "https://api.github.com/repos/abersheeran/rpc.py/commits/491e7a841ed9a754796d6ab047a9fb16e23bf8bd", "html_url": "https://github.com/abersheeran/rpc.py/commit/491e7a841ed9a754796d6ab047a9fb16e23bf8bd", "filename_list": ["./data/python/python_filter/236_0@abersheeran@rpc.py@3d5c31916a597f8bdd3260c50d6ec398da1c421c@rpcpy_serializers.py.txt"], "patch_list": [{"patch_file": "rpcpy/serializers.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "SERIALIZER_NAMES = {\n    JSONSerializer.name: JSONSerializer(),\n-    PickleSerializer.name: PickleSerializer(),\n    MsgpackSerializer.name: MsgpackSerializer(),\n    CBORSerializer.name: CBORSerializer(),\n"}, {"Modified_Block_Num": "2", "Modified_Function": "", "Modified_Line": "SERIALIZER_TYPES = {\n    JSONSerializer.content_type: JSONSerializer(),\n-    PickleSerializer.content_type: PickleSerializer(),\n    MsgpackSerializer.content_type: MsgpackSerializer(),\n    CBORSerializer.content_type: CBORSerializer(),\n"} ]}]}
{"num": 239, "cve": "CVE-2022-31124", "des": "openssh_key_parser is an open source Python package providing utilities to parse and pack OpenSSH private and public key files. In versions prior to 0.0.6 if a field of a key is shorter than it is declared to be, the parser raises an error with a message containing the raw field value. An attacker able to modify the declared length of a key's sensitive field can thus expose the raw value of that field. Users are advised to upgrade to version 0.0.6, which no longer includes the raw field value in the error message. There are no known workarounds for this issue.", "cwe_list": ["CWE-209"], "cwe_name_lst": ["Generation of Error Message Containing Sensitive Information"], "url": "https://api.github.com/repos/scottcwang/openssh_key_parser/commits/d5b53b4b7e76c5b666fc657019dbf864fb04076c", "html_url": "https://github.com/scottcwang/openssh_key_parser/commit/d5b53b4b7e76c5b666fc657019dbf864fb04076c", "filename_list": ["./data/python/python_filter/239_0@scottcwang@openssh_key_parser@26e0a471e9fdb23e635bc3014cf4cbd2323a08d3@openssh_key_private_key_list.py.txt"], "patch_list": [{"patch_file": "openssh_key/private_key_list.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "from_bytes(", "Modified_Line": "-        byte_stream = PascalStyleByteStream(byte_string)\n-        header = byte_stream.read_from_format_instructions_dict(\n-            cls.HEADER_FORMAT_INSTRUCTIONS_DICT\n-        )\n-        if header['auth_magic'] != b'openssh-key-v1\\x00':\n-            raise ValueError('Not an openssh-key-v1 key')\n-        num_keys = header['num_keys']\n-        if num_keys < 0:\n-            raise ValueError('Cannot parse negative number of keys')\n-        public_key_list = []\n-        for i in range(num_keys):\n-            public_key_bytes = byte_stream.read_from_format_instruction(\n                PascalStyleFormatInstruction.BYTES\n            )\n-            public_key_list.append(\n-                PublicKey.from_bytes(public_key_bytes)\n-            )\n-        cipher_bytes = byte_stream.read_from_format_instruction(\n-            PascalStyleFormatInstruction.BYTES\n-        )\n-\n-        kdf_class = get_kdf_options_class(header['kdf'])\n-        kdf_options = kdf_class(\n-            PascalStyleByteStream(\n-                header['kdf_options']\n-            ).read_from_format_instructions_dict(\n-                kdf_class.FORMAT_INSTRUCTIONS_DICT\n            )\n-        )\n-        cipher_class = get_cipher_class(header['cipher'])\n-        if kdf_class == NoneKDFOptions:\n-            passphrase = ''\n-        elif passphrase is None:\n-            passphrase = getpass.getpass('Key passphrase: ')\n-        if issubclass(cipher_class, ConfidentialityIntegrityCipher):\n-            cipher_bytes += byte_stream.read_fixed_bytes(\n-                cipher_class.TAG_LENGTH\n-            )\n-\n-        decipher_bytes = cipher_class.decrypt(\n-            kdf_class(kdf_options),\n-            passphrase,\n-            cipher_bytes\n-        )\n-\n-        decipher_byte_stream = PascalStyleByteStream(decipher_bytes)\n-        decipher_bytes_header = \\\n-            decipher_byte_stream.read_from_format_instructions_dict(\n-                cls.DECIPHER_BYTES_HEADER_FORMAT_INSTRUCTIONS_DICT\n            )\n-        if decipher_bytes_header['check_int_1'] \\\n-                != decipher_bytes_header['check_int_2']:\n-            warnings.warn('Cipher header check numbers do not match')\n-        initlist = []\n-        for i in range(num_keys):\n-            initlist.append(\n-                PublicPrivateKeyPair(\n-                    public_key_list[i],\n-                    PrivateKey.from_byte_stream(decipher_byte_stream)\n-                )\n-            )\n-            if initlist[i].public.header['key_type'] \\\n-                    != initlist[i].private.header['key_type']:\n-                warnings.warn(\n-                    f'Inconsistency between private and public '\n-                    f'key types for key {i}'\n                )\n-            if not all(\n-                (\n-                    initlist[i].public.params[k] ==\n-                    initlist[i].private.params[k]\n-                ) for k in (\n-                    initlist[i].public.params.keys() &\n-                    initlist[i].private.params.keys()\n                )\n            ):\n-                warnings.warn(\n-                    f'Inconsistency between private and public '\n-                    f'values for key {i}'\n-                )\n-\n-        decipher_padding = decipher_byte_stream.read()\n-\n-        if (\n-            len(decipher_byte_stream.getvalue()) %\n-                cipher_class.BLOCK_SIZE != 0\n-        ) or not (\n-            bytes(\n-                range(1, 1 + cipher_class.BLOCK_SIZE)\n-            ).startswith(decipher_padding)\n-        ):\n-            warnings.warn('Incorrect padding at end of ciphertext')\n"}]}]}
{"num": 243, "cve": "CVE-2022-34265", "des": "An issue was discovered in Django 3.2 before 3.2.14 and 4.0 before 4.0.6. The Trunc() and Extract() database functions are subject to SQL injection if untrusted data is used as a kind/lookup_name value. Applications that constrain the lookup name and kind choice to a known safe list are unaffected.", "cwe_list": ["CWE-89"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "url": "https://api.github.com/repos/django/django/commits/0dc9c016fadb71a067e5a42be30164e3f96c0492", "html_url": "https://github.com/django/django/commit/0dc9c016fadb71a067e5a42be30164e3f96c0492", "filename_list": ["./data/python/python_filter/243_1@django@django@a2b88d7be6fc9b443794518d2f75fd2f3d9e677a@django_db_models_functions_datetime.py.txt"], "patch_list": [{"patch_file": "django/db/models/functions/datetime.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "as_sql(self, compiler, connection):", "Modified_Line": "        sql, params = compiler.compile(self.lhs)\n        lhs_ou    tput_field = self.lhs.output_field\n        if isinstance(lhs_output_field, DateTimeField):\n            tzname = self.get_tzname()\n            sql = connection.ops.datetime_extract_sql(self.lookup_name, sql, tzname)\n        elif self.tzinfo is not None:\n            raise ValueError(\"tzinfo can only be used with DateTimeField.\")\n        elif isinstance(lhs_output_field, DateField):\n            sql = connection.ops.date_extract_sql(self.lookup_name, sql)\n        elif isinstance(lhs_output_field, TimeField):\n            sql = connection.ops.time_extract_sql(self.lookup_name, sql)\n        elif isinstance(lhs_output_field, DurationField):\n            if not connection.features.has_native_duration_field:\n                raise ValueError(\n                    \"Extract requires native DurationField database support.\"\n                )\n            sql = connection.ops.time_extract_sql(self.lookup_name, sql)\n        else:\n            assert False, \"Tried to Extract from an invalid type.\"\n        return sql, params\n"}, {"Modified_Block_Num": "2", "Modified_Function": "as_sql(self, compiler, connection):c", "Modified_Line": "        inner_sql, inner_params = compiler.compile(self.lhs)\n        tzname = None\n        if isinstance(self.lhs.output_field, DateTimeField):\n            tzname = self.get_tzname()\n        elif self.tzinfo is not None:\n            raise ValueError(\"tzinfo can only be used with DateTimeField.\")\n        if isinstance(self.output_field, DateTimeField):\n            sql = connection.ops.datetime_trunc_sql(self.kind, inner_sql, tzname)\n        elif isinstance(self.output_field, DateField):\n            sql = connection.ops.date_trunc_sql(self.kind, inner_sql, tzname)\n        elif isinstance(self.output_field, TimeField):\n            sql = connection.ops.time_trunc_sql(self.kind, inner_sql, tzname)\n        else:\n            raise ValueError(\n                \"Trunc only valid on DateField, TimeField, or DateTimeField.\"\n            )\n        return sql, inner_params\n"}]}]}
{"num": 244, "cve": "CVE-2022-31605", "des": "NVFLARE, versions prior to 2.1.2, contains a vulnerability in its utils module, where YAML files are loaded via yaml.load() instead of yaml.safe_load(). The deserialization of Untrusted Data, may allow an unprivileged network attacker to cause Remote Code Execution, Denial Of Service, and Impact to both Confidentiality and Integrity.", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/NVIDIA/NVFlare/commits/71c061f9fdd323d3eb4cf76f5e44bc971d3493a8", "html_url": "https://github.com/NVIDIA/NVFlare/commit/71c061f9fdd323d3eb4cf76f5e44bc971d3493a8", "filename_list": ["./data/python/python_filter/244_0@NVIDIA@NVFlare@4de9782697ecb12f39bcae83221bd8d3498959be@nvflare_ha_overseer_utils.py.txt", "./data/python/python_filter/244_1@NVIDIA@NVFlare@4de9782697ecb12f39bcae83221bd8d3498959be@nvflare_lighter_study.py.txt"], "patch_list": [{"patch_file": "nvflare/ha/overseer/utils.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "load_privilege():", "Modified_Line": "    privilege_file = os.environ.get(\"AUTHZ_FILE\", \"privilege.yml\")\n    try:\n        privilege = yaml.load(open(privilege_file, \"tr\"), Loader=yaml.Loader)\n    except:\n        privilege = dict()\n    return privilege\n"}]}, {"patch_file": "nvflare/lighter/study.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "main():", "Modified_Line": "    parser = argparse.ArgumentParser()\n    parser.add_argument(\"-p\", \"--project_file\", type=str, default=\"project.yml\", help=\"file to describe FL project\")\n    args = parser.parse_args()\n    current_path = os.getcwd()\n    project_file = args.project_file\n    project_full_path = os.path.join(current_path, project_file)\n    if not os.path.exists(project_full_path):\n        print(f\"{project_full_path} not found.  Running study requires that file.\")\n        exit(0)\n    project = yaml.load(open(project_full_path, \"r\"), Loader=yaml.Loader)\n"}]}]}
{"num": 246, "cve": "CVE-2021-3020", "des": "An issue was discovered in ClusterLabs Hawk (aka HA Web Konsole) through 2.3.0-15. It ships the binary hawk_invoke (built from tools/hawk_invoke.c), intended to be used as a setuid program. This allows the hacluster user to invoke certain commands as root (with an attempt to limit this to safe combinations). This user is able to execute an interactive \"shell\" that isn't limited to the commands specified in hawk_invoke, allowing escalation to root.", "cwe_list": ["CWE-269"], "cwe_name_lst": ["Improper Privilege Management"], "url": "https://api.github.com/repos/ClusterLabs/crmsh/commits/c538024b8ebd138dc373b005189471d9b77e9c82", "html_url": "https://github.com/ClusterLabs/crmsh/commit/c538024b8ebd138dc373b005189471d9b77e9c82", "filename_list": ["./data/python/python_filter/246_0@ClusterLabs@crmsh@8dea33fffd95cd1ca83108aacc1f5663345ec5fd@crmsh_bootstrap.py.txt"], "patch_list": [{"patch_file": "crmsh/bootstrap.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "-RSA_PRIVATE_KEY = \"/root/.ssh/id_rsa\"\n-RSA_PUBLIC_KEY = \"/root/.ssh/id_rsa.pub\"\n-AUTHORIZED_KEYS_FILE = \"/root/.ssh/authorized_keys\"\n"}, {"Modified_Block_Num": "2", "Modified_Function": "configure_local_ssh_key():", "Modified_Line": "-    if not os.path.exists(RSA_PRIVATE_KEY):\n-        status(\"Generating SSH key\")\n-        invoke(\"ssh-keygen -q -f {} -C 'Cluster Internal on {}' -N ''\".format(RSA_PRIVATE_KEY, utils.this_node()))\n-    if not os.path.exists(AUTHORIZED_KEYS_FILE):\n-        open(AUTHORIZED_KEYS_FILE, 'w').close()\n-    append_unique(RSA_PUBLIC_KEY, AUTHORIZED_KEYS_FILE)\n"}]}]}
{"num": 247, "cve": "CVE-2021-4041", "des": "A flaw was found in ansible-runner. An improper escaping of the shell command, while calling the ansible_runner.interface.run_command, can lead to parameters getting executed as host's shell command. A developer could unintentionally write code that gets executed in the host rather than the virtual environment.", "cwe_list": ["CWE-116"], "cwe_name_lst": ["Improper Encoding or Escaping of Output"], "url": "https://api.github.com/repos/ansible/ansible-runner/commits/3533f265f4349a3f2a0283158cd01b59a6bbc7bd", "html_url": "https://github.com/ansible/ansible-runner/commit/3533f265f4349a3f2a0283158cd01b59a6bbc7bd", "filename_list": ["./data/python/python_filter/247_1@ansible@ansible-runner@f8b50dc7e31e57b3e9091db3b99aad73ffecb232@ansible_runner_runner.py.txt"], "patch_list": [{"patch_file": "ansible_runner/runner.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "run(self):", "Modified_Line": "-            cmd = 'cgcreate -a {user}:{group} -t {user}:{group} -g cpuacct,memory,pids:{}'.format(cgroup_path, user=user, group=group)\n-            proc = Popen(cmd, stdout=PIPE, stderr=PIPE, shell=True)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "_delete(retries=15):", "Modified_Line": "        if self.resource_profiling:\n-            cmd = 'cgdelete -g cpuacct,memory,pids:{}'.format(cgroup_path)\n-            proc = Popen(cmd, stdout=PIPE, stderr=PIPE, shell=True)\n"}, {"Modified_Block_Num": "3", "Modified_Function": "kill_container(self):", "Modified_Line": "        if container_name:\n            container_cli = self.config.process_isolation_executable\n-            cmd = '{} kill {}'.format(container_cli, container_name)\n-            proc = Popen(cmd, stdout=PIPE, stderr=PIPE, shell=True)\n"}]}]}
{"num": 248, "cve": "CVE-2021-3702", "des": "A race condition flaw was found in ansible-runner, where an attacker could watch for rapid creation and deletion of a temporary directory, substitute their directory at that name, and then have access to ansible-runner's private_data_dir the next time ansible-runner made use of the private_data_dir. The highest Threat out of this flaw is to integrity and confidentiality.", "cwe_list": ["CWE-362"], "cwe_name_lst": ["Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')"], "url": "https://api.github.com/repos/ansible/ansible-runner/commits/dcdb62daf668a31754fc6fbf73374e7d14d5f52c", "html_url": "https://github.com/ansible/ansible-runner/commit/dcdb62daf668a31754fc6fbf73374e7d14d5f52c", "filename_list": ["./data/python/python_filter/248_0@ansible@ansible-runner@9652fa0753a31364dbb62cd787cfe07aab8e730b@ansible_runner_config__base.py.txt"], "patch_list": [{"patch_file": "ansible_runner/config/_base.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "__init__(self,", "Modified_Line": "        if private_data_dir:\n            self.private_data_dir = os.path.abspath(private_data_dir)\n        else:\n-            self.private_data_dir = os.path.join(gettempdir(), \".ansible-runner\")-        os.makedirs(self.private_data_dir, exist_ok=True, mode=0o700)\n"}]}]}
{"num": 253, "cve": "CVE-2022-35918", "des": "Streamlit is a data oriented application development framework for python. Users hosting Streamlit app(s) that use custom components are vulnerable to a directory traversal attack that could leak data from their web server file-system such as: server logs, world readable files, and potentially other sensitive information. An attacker can craft a malicious URL with file paths and the streamlit server would process that URL and return the contents of that file. This issue has been resolved in version 1.11.1. Users are advised to upgrade. There are no known workarounds for this issue.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/streamlit/streamlit/commits/80d9979d5f4a00217743d607078a1d867fad8acf", "html_url": "https://github.com/streamlit/streamlit/commit/80d9979d5f4a00217743d607078a1d867fad8acf", "filename_list": ["./data/python/python_filter/253_0@streamlit@streamlit@4a04eefe248b9af28ba5b563e54d665f68e49116@lib_streamlit_components_v1_components.py.txt"], "patch_list": [{"patch_file": "lib/streamlit/components/v1/components.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get(self, path: str) -> None:", "Modified_Line": "        parts = path.split(\"/\")\n        component_name = parts[0]\n        component_root = self._registry.get_component_path(component_name)\n        filename = \"/\".join(parts[1:])\n"}]}]}
{"num": 256, "cve": "CVE-2022-3371", "des": "Allocation of Resources Without Limits or Throttling in GitHub repository ikus060/rdiffweb prior to 2.5.0a3.", "cwe_list": ["CWE-770"], "cwe_name_lst": ["Allocation of Resources Without Limits or Throttling"], "url": "https://api.github.com/repos/ikus060/rdiffweb/commits/b62c479ff6979563c7c23e7182942bc4f460a2c7", "html_url": "https://github.com/ikus060/rdiffweb/commit/b62c479ff6979563c7c23e7182942bc4f460a2c7", "filename_list": ["./data/python/python_filter/256_0@ikus060@rdiffweb@d1fb5abcd42b57c8274f6bba33573d524359fe42@rdiffweb_controller_page_admin_users.py.txt", "./data/python/python_filter/256_1@ikus060@rdiffweb@d1fb5abcd42b57c8274f6bba33573d524359fe42@rdiffweb_controller_page_pref_general.py.txt"], "patch_list": [{"patch_file": "rdiffweb/controller/page_admin_users.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "-    fullname = StringField(_('Fullname'), validators=[validators.optional()])\n"}]}, {"patch_file": "rdiffweb/controller/page_pref_general.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "-    fullname = StringField(_('Fullname'))\n"}]}]}
{"num": 258, "cve": "CVE-2022-39254", "des": "matrix-nio is a Python Matrix client library, designed according to sans I/O principles. Prior to version 0.20, when a users requests a room key from their devices, the software correctly remember the request. Once they receive a forwarded room key, they accept it without checking who the room key came from. This allows homeservers to try to insert room keys of questionable validity, potentially mounting an impersonation attack. Version 0.20 fixes the issue.", "cwe_list": ["NVD-CWE-Other"], "cwe_name_lst": ["none"], "url": "https://api.github.com/repos/poljar/matrix-nio/commits/b1cbf234a831daa160673defd596e6450e9c29f0", "html_url": "https://github.com/poljar/matrix-nio/commit/b1cbf234a831daa160673defd596e6450e9c29f0", "filename_list": ["./data/python/python_filter/258_0@poljar@matrix-nio@dea4b37b899203f4245fb7cdf34523355f4daf5c@nio_crypto_olm_machine.py.txt"], "patch_list": [{"patch_file": "nio/crypto/olm_machine.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_handle_forwarded_room_key_event(", "Modified_Line": "-        event = ForwardedRoomKeyEvent.from_dict(payload, sender, sender_key)\n-        if isinstance(event, (BadEvent, UnknownBadEvent)):\n-            return event\n        if event.algorithm != \"m.megolm.v1.aes-sha2\":\n            logger.error(\n                f\"Error: unsupported forwarded room key of type {event.algorithm}\"\n            )\n-            return None\n-        if event.session_id not in self.outgoing_key_requests:\n            logger.info(\n                \"Ignoring session key we have not requested from device {}.\", sender_key\n            )\n-            return None\n        key_request = self.outgoing_key_requests[event.session_id]\n        if (\n            event.algorithm != key_request.algorithm\n            or event.room_id != key_request.room_id\n            or event.session_id != key_request.session_id\n        ):\n            logger.info(\n                \"Ignoring session key with mismatched algorithm, room_id, or \"\n                \"session id.\"\n            )\n            return None\n"}]}]}
{"num": 260, "cve": "CVE-2022-3326", "des": "Weak Password Requirements in GitHub repository ikus060/rdiffweb prior to 2.4.9.", "cwe_list": ["CWE-521"], "cwe_name_lst": ["Weak Password Requirements"], "url": "https://api.github.com/repos/ikus060/rdiffweb/commits/ee98e5af78ec60db8a17fef6ea0ca250e3f31eec", "html_url": "https://github.com/ikus060/rdiffweb/commit/ee98e5af78ec60db8a17fef6ea0ca250e3f31eec", "filename_list": ["./data/python/python_filter/260_3@ikus060@rdiffweb@2406780831618405a13113377a784f3102465f40@rdiffweb_core_store.py.txt"], "patch_list": [{"patch_file": "rdiffweb/core/store.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "set_password(self, password, old_password=None):", "Modified_Line": "-        cfg = self._store.app.cfg\n-        if cfg.password_min_length > len(password) > cfg.password_max_length:\n-            raise ValueError(\"invalid password length\")\n"}]}]}
{"num": 265, "cve": "CVE-2022-3301", "des": "Improper Cleanup on Thrown Exception in GitHub repository ikus060/rdiffweb prior to 2.4.8.", "cwe_list": ["CWE-460"], "cwe_name_lst": ["Improper Cleanup on Thrown Exception"], "url": "https://api.github.com/repos/ikus060/rdiffweb/commits/5ac38b2a75becbab9f948bd5e37ecbcd9f0b362e", "html_url": "https://github.com/ikus060/rdiffweb/commit/5ac38b2a75becbab9f948bd5e37ecbcd9f0b362e", "filename_list": ["./data/python/python_filter/265_0@ikus060@rdiffweb@e974df75bdbcff3996ad70bd1b4424ec1485ea3f@rdiffweb_rdw_app.py.txt"], "patch_list": [{"patch_file": "rdiffweb/rdw_app.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "error_page(self, **kwargs):", "Modified_Line": "        logger.error(\n            'error page: %s %s\n%s' % (kwargs.get('status', ''), kwargs.get('message', ''), kwargs.get('traceback', ''))\n        )\n        mtype = cherrypy.tools.accept.callable(['text/html', 'text/plain'])  # @UndefinedVariable\n"}]}]}
{"num": 266, "cve": "CVE-2022-3269", "des": "Session Fixation in GitHub repository ikus060/rdiffweb prior to 2.4.7.", "cwe_list": ["CWE-384"], "cwe_name_lst": ["Session Fixation"], "url": "https://api.github.com/repos/ikus060/rdiffweb/commits/39e7dcd4a1f44d2a7bd92b79d78a800910b1b22b", "html_url": "https://github.com/ikus060/rdiffweb/commit/39e7dcd4a1f44d2a7bd92b79d78a800910b1b22b", "filename_list": ["./data/python/python_filter/266_0@ikus060@rdiffweb@ac334dd27ceadac0661b1e2e059a8423433c3fee@rdiffweb_controller_page_login.py.txt"], "patch_list": [{"patch_file": "rdiffweb/controller/page_login.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "index(self, **kwargs):", "Modified_Line": "        form = LoginForm()\n        if form.validate_on_submit():\n            try:\n                userobj = self.app.store.login(form.login.data, form.password.data)\n            except Exception:\n                logger.exception('fail to validate credential')\n                flash(_(\"Fail to validate user credential.\"))\n            else:\n                if userobj:\n                    cherrypy.session[SESSION_KEY] = userobj.username\n                    raise cherrypy.HTTPRedirect(form.redirect.data)\n                flash(_(\"Invalid username or password.\"))\n"}, {"Modified_Block_Num": "2", "Modified_Function": "default(self):", "Modified_Line": "        cherrypy.session[SESSION_KEY] = None\n        raise cherrypy.HTTPRedirect('/')\n"}]}]}
{"num": 268, "cve": "CVE-2022-3274", "des": "Cross-Site Request Forgery (CSRF) in GitHub repository ikus060/rdiffweb prior to 2.4.7.", "cwe_list": ["CWE-352"], "cwe_name_lst": ["Cross-Site Request Forgery (CSRF)"], "url": "https://api.github.com/repos/ikus060/rdiffweb/commits/e974df75bdbcff3996ad70bd1b4424ec1485ea3f", "html_url": "https://github.com/ikus060/rdiffweb/commit/e974df75bdbcff3996ad70bd1b4424ec1485ea3f", "filename_list": ["./data/python/python_filter/268_0@ikus060@rdiffweb@39e7dcd4a1f44d2a7bd92b79d78a800910b1b22b@rdiffweb_controller_pref_general.py.txt"], "patch_list": [{"patch_file": "rdiffweb/controller/pref_general.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "render_prefs_panel(self, panelid, action=None, **kwargs):  # @UnusedVariable", "Modified_Line": "-        if action == \"set_profile_info\":\n-            self._handle_set_profile_info(action, profile_form)\n-        elif action == \"set_password\":\n-            self._handle_set_password(action, password_form)\n-        elif action == \"update_repos\":\n-            self.app.currentuser.refresh_repos(delete=True)\n-            flash(_(\"Repositories successfully updated\"), level='success')\n-        elif action is None:\n-            pass\n-        else:\n-            _logger.warning(\"unknown action: %s\", action)\n-            raise cherrypy.NotFound(\"Unknown action\")\n"}]}]}
{"num": 269, "cve": "CVE-2022-3267", "des": "Cross-Site Request Forgery (CSRF) in GitHub repository ikus060/rdiffweb prior to 2.4.6.", "cwe_list": ["CWE-352"], "cwe_name_lst": ["Cross-Site Request Forgery (CSRF)"], "url": "https://api.github.com/repos/ikus060/rdiffweb/commits/20fc0d304412cc569b21f31e52cb8b94094d6314", "html_url": "https://github.com/ikus060/rdiffweb/commit/20fc0d304412cc569b21f31e52cb8b94094d6314", "filename_list": ["./data/python/python_filter/269_0@ikus060@rdiffweb@18a5aabd48fa6d2d2771a25f95610c28a1a097ca@rdiffweb_controller_page_settings.py.txt"], "patch_list": [{"patch_file": "rdiffweb/controller/page_settings.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "        repo_obj = self.app.store.get_repo(path)\n-        if kwargs.get('keepdays'):\n-            return self._remove_older(repo_obj, **kwargs)\n-        elif kwargs.get('new_encoding'):\n-            return self._set_encoding(repo_obj, **kwargs)\n-        elif kwargs.get('maxage'):\n-            return self._set_maxage(repo_obj, **kwargs)\n"}]}]}
{"num": 270, "cve": "CVE-2022-3233", "des": "Cross-Site Request Forgery (CSRF) in GitHub repository ikus060/rdiffweb prior to 2.4.6.", "cwe_list": ["CWE-352"], "cwe_name_lst": ["Cross-Site Request Forgery (CSRF)"], "url": "https://api.github.com/repos/ikus060/rdiffweb/commits/18a5aabd48fa6d2d2771a25f95610c28a1a097ca", "html_url": "https://github.com/ikus060/rdiffweb/commit/18a5aabd48fa6d2d2771a25f95610c28a1a097ca", "filename_list": ["./data/python/python_filter/270_0@ikus060@rdiffweb@85dd2990a0975bdd3280435bcada545535eb709f@rdiffweb_controller_pref_notification.py.txt"], "patch_list": [{"patch_file": "rdiffweb/controller/pref_notification.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_handle_set_notification_info(self, **kwargs):", "Modified_Line": "-        if action == \"set_notification_info\":\r\n            self._handle_set_notification_info(**kwargs)\r\n"}]}]}
{"num": 272, "cve": "CVE-2022-23951", "des": "In Keylime before 6.3.0, quote responses from the agent can contain possibly untrusted ZIP data which can lead to zip bombs.", "cwe_list": ["NVD-CWE-noinfo"], "cwe_name_lst": ["none"], "url": "https://api.github.com/repos/keylime/keylime/commits/6e44758b64b0ee13564fc46e807f4ba98091c355", "html_url": "https://github.com/keylime/keylime/commit/6e44758b64b0ee13564fc46e807f4ba98091c355", "filename_list": ["./data/python/python_filter/272_3@keylime@keylime@796ed49df2f48d9c78a6b4e3e95fbb79d556cfc8@keylime_tpm_tpm_main.py.txt"], "patch_list": [{"patch_file": "keylime/tpm/tpm_main.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "create_quote(self, nonce, data=None, pcrmask=tpm_abstract.AbstractTPM.EMPTYM", "Modified_Line": "                quoteraw = retDict['fileouts'][quotepath.name]\n-                quote_b64encode = base64.b64encode(zlib.compress(quoteraw))\n                sigraw = retDict['fileouts'][sigpath.name]\n-                sigraw_b64encode = base64.b64encode(zlib.compress(sigraw))\n                pcrraw = retDict['fileouts'][pcrpath.name]\n-                pcrraw_b64encode = base64.b64encode(zlib.compress(pcrraw))\n"}, {"Modified_Block_Num": "2", "Modified_Function": "_tpm2_checkquote(self, aikTpmFromRegistrar, quote, nonce, hash_alg):", "Modified_Line": "-        quoteblob = zlib.decompress(base64.b64decode(quote_tokens[0]))\n-        sigblob = zlib.decompress(base64.b64decode(quote_tokens[1]))\n-        pcrblob = zlib.decompress(base64.b64decode(quote_tokens[2]))\n"}]}]}
{"num": 273, "cve": "CVE-2022-23950", "des": "In Keylime before 6.3.0, Revocation Notifier uses a fixed /tmp path for UNIX domain socket which can allow unprivileged users a method to prohibit keylime operations.", "cwe_list": ["CWE-668"], "cwe_name_lst": ["Exposure of Resource to Wrong Sphere"], "url": "https://api.github.com/repos/keylime/keylime/commits/ea5d0373fa2c050d5d95404eb779be7e8327b911", "html_url": "https://github.com/keylime/keylime/commit/ea5d0373fa2c050d5d95404eb779be7e8327b911", "filename_list": ["./data/python/python_filter/273_0@keylime@keylime@e019609c9b9b450e91eacfbd598eb75029f15031@keylime_revocation_notifier.py.txt"], "patch_list": [{"patch_file": "keylime/revocation_notifier.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "worker():", "Modified_Line": "        frontend = context.socket(zmq.SUB)\n-        frontend.bind(\"ipc:///tmp/keylime.verifier.ipc\")\n"}, {"Modified_Block_Num": "2", "Modified_Function": "stop_broker():", "Modified_Line": "    global broker_proc\n    if broker_proc is not None:\n-        if os.path.exists(\"/tmp/keylime.verifier.ipc\"):\n-            os.remove(\"/tmp/keylime.verifier.ipc\")\n"}]}]}
{"num": 276, "cve": "CVE-2022-23948", "des": "A flaw was found in Keylime before 6.3.0. The logic in the Keylime agent for checking for a secure mount can be fooled by previously created unprivileged mounts allowing secrets to be leaked to other processes on the host.", "cwe_list": ["NVD-CWE-noinfo"], "cwe_name_lst": ["none"], "url": "https://api.github.com/repos/keylime/keylime/commits/1a4f31a6368d651222683c9debe7d6832db6f607", "html_url": "https://github.com/keylime/keylime/commit/1a4f31a6368d651222683c9debe7d6832db6f607", "filename_list": ["./data/python/python_filter/276_0@keylime@keylime@387e320dc22c89f4f47c68cb37eb9eec2137f34b@keylime_secure_mount.py.txt"], "patch_list": [{"patch_file": "keylime/secure_mount.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "check_mounted(secdir):", "Modified_Line": "-    whatsmounted = cmd_exec.run(\"mount\")['retout']\n-    whatsmounted_converted = config.convert(whatsmounted)\n-    for line in whatsmounted_converted:\n-        tokens = line.split()\n-        tmpfs = False\n-        if len(tokens) < 3:\n-            continue\n-        if tokens[0] == 'tmpfs':\n-            tmpfs = True\n-        if tokens[2] == secdir:\n-            if not tmpfs:\n-                logger.error(\"secure storage location %s already mounted \"\n-                             \"on wrong file system type: %s.  Unmount to\"\n-                             \"continue.\", secdir, tokens[0])\n-                raise Exception(\n-                    f\"secure storage location {secdir} already mounted on \"\n-                    f\"wrong file system type: {tokens[0]}.  Unmount to \"\n-                    f\"continue.\")\n            logger.debug(\n-                \"secure storage location %s already mounted on tmpfs\" % secdir)\n            return True\n-    logger.debug(\"secure storage location %s not mounted \" % secdir)\n"}]}]}
{"num": 278, "cve": "CVE-2021-43310", "des": "A vulnerability in Keylime before 6.3.0 allows an attacker to craft a request to the agent that resets the U and V keys as if the agent were being re-added to a verifier. This could lead to a remote code execution.", "cwe_list": ["CWE-290"], "cwe_name_lst": ["Authentication Bypass by Spoofing"], "url": "https://api.github.com/repos/keylime/keylime/commits/70a2f8eabbba15a888dd24ed61d59b6bc5aabbcb", "html_url": "https://github.com/keylime/keylime/commit/70a2f8eabbba15a888dd24ed61d59b6bc5aabbcb", "filename_list": ["./data/python/python_filter/278_0@keylime@keylime@edda2bb2682a38bc51ccb622508b1d0984c87134@keylime_keylime_agent.py.txt"], "patch_list": [{"patch_file": "keylime/keylime_agent.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "main():", "Modified_Line": "-    serveraddr = (config.get('cloud_agent', 'cloudagent_ip'),\n-                  config.getint('cloud_agent', 'cloudagent_port'))\n-    server = CloudAgentHTTPServer(serveraddr, Handler, agent_uuid)\n-    serverthread = threading.Thread(target=server.serve_forever, daemon=True)\n"}]}]}
{"num": 279, "cve": "CVE-2022-3250", "des": "Sensitive Cookie in HTTPS Session Without 'Secure' Attribute in GitHub repository ikus060/rdiffweb prior to 2.4.6.", "cwe_list": ["CWE-311"], "cwe_name_lst": ["Missing Encryption of Sensitive Data"], "url": "https://api.github.com/repos/ikus060/rdiffweb/commits/ac334dd27ceadac0661b1e2e059a8423433c3fee", "html_url": "https://github.com/ikus060/rdiffweb/commit/ac334dd27ceadac0661b1e2e059a8423433c3fee", "filename_list": ["./data/python/python_filter/279_0@ikus060@rdiffweb@20fc0d304412cc569b21f31e52cb8b94094d6314@rdiffweb_tools_secure_headers.py.txt"], "patch_list": [{"patch_file": "rdiffweb/tools/secure_headers.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_set_headers(self):", "Modified_Line": "-        response = cherrypy.serving.response\n-        response.headers['X-Frame-Options'] = 'DENY'\n-        cookie = response.cookie.get('session_id', None)\n-        if cookie:\n-            cookie['samesite'] = 'Lax'\n-            https = cherrypy.request.base.startswith('https')\n-            if https:\n-                cookie['secure'] = 1\n"}]}]}
{"num": 281, "cve": "CVE-2022-2888", "des": "If an attacker comes into the possession of a victim's OctoPrint session cookie through whatever means, the attacker can use this cookie to authenticate as long as the victim's account exists.", "cwe_list": ["CWE-613"], "cwe_name_lst": ["Insufficient Session Expiration"], "url": "https://api.github.com/repos/OctoPrint/OctoPrint/commits/40e6217ac1a85cc5ed592873ae49db01d3005da4", "html_url": "https://github.com/OctoPrint/OctoPrint/commit/40e6217ac1a85cc5ed592873ae49db01d3005da4", "filename_list": ["./data/python/python_filter/281_0@OctoPrint@OctoPrint@b83b57406eebca60432fbdcb54f8e7791b377e5b@src_octoprint_access_users.py.txt", "./data/python/python_filter/281_1@OctoPrint@OctoPrint@b83b57406eebca60432fbdcb54f8e7791b377e5b@src_octoprint_server___init__.py.txt", "./data/python/python_filter/281_3@OctoPrint@OctoPrint@b83b57406eebca60432fbdcb54f8e7791b377e5b@src_octoprint_server_util_flask.py.txt"], "patch_list": [{"patch_file": "src/octoprint/access/users.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_cleanup_sessions(self):", "Modified_Line": "-            if user.created + (24 * 60 * 60) < time.monotonic():\n                self._logger.info(\n-                    \"Cleaning up user session {} for user {}\".format(\n-                        session, user.get_id()\n-                    )\n"}]}, {"patch_file": "src/octoprint/server/__init__.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "load_user(id):", "Modified_Line": "    if sessionid:\n-        user = userManager.find_user(userid=id, session=sessionid)\n    else:\n        user = userManager.find_user(userid=id)\n-    if user and user.is_active:\n        return user\n"}]}, {"patch_file": "src/octoprint/server/util/flask.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "cookies(self):", "Modified_Line": "-            if key.endswith(self.cookie_suffix):\n-                desuffixed[key[: -len(self.cookie_suffix)]] = value\n-            else:\n-                result[key] = value\n"}]}]}
{"num": 282, "cve": "CVE-2022-2872", "des": "Unrestricted Upload of File with Dangerous Type in GitHub repository octoprint/octoprint prior to 1.8.3.", "cwe_list": ["CWE-434"], "cwe_name_lst": ["Unrestricted Upload of File with Dangerous Type"], "url": "https://api.github.com/repos/OctoPrint/OctoPrint/commits/3e3c11811e216fb371a33e28412df83f9701e5b0", "html_url": "https://github.com/OctoPrint/OctoPrint/commit/3e3c11811e216fb371a33e28412df83f9701e5b0", "filename_list": ["./data/python/python_filter/282_0@OctoPrint@OctoPrint@a33622e0b79644494e51caea377750aff3659faf@src_octoprint_filemanager_storage.py.txt","./data/python/python_filter/282_2@OctoPrint@OctoPrint@a33622e0b79644494e51caea377750aff3659faf@src_octoprint_server_api_files.py.txt"], "patch_list": [{"patch_file": "src/octoprint/filemanager/storage.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "copy_file(self, source, destination):", "Modified_Line": "        source_data, destination_data = self._get_source_destination_data(\n            source, destination, must_not_equal=True\n        )\n        try:\n            shutil.copy2(source_data[\"fullpath\"], destination_data[\"fullpath\"])\n"},{"Modified_Block_Num": "2", "Modified_Function": "move_file(self, source, destination, allow_overwrite=False):", "Modified_Line": "        source_data, destination_data = self._get_source_destination_data(\n            source, destination\n        )\n        if source_data[\"fullpath\"] == destination_data[\"fullpath\"]:\n            self._set_display_metadata(destination_data)\n            return self.path_in_storage(destination_data[\"fullpath\"])\n        try:\n            shutil.move(source_data[\"fullpath\"], destination_data[\"fullpath\"])\n"}]}, {"patch_file": "src/octoprint/server/api/files.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "slicing_done(target, path, select_after_slicing, print_after_slicing):", "Modified_Line": "-            if command == \"copy\":\n-                if _verifyFileExists(target, destination) or _verifyFolderExists(\n-                    target, destination\n-                ):\n-                    abort(409, description=\"File or folder does already exist\")\n-                if is_file:\n-                    fileManager.copy_file(target, filename, destination)\n-                else:\n-                    fileManager.copy_folder(target, filename, destination)\n-\n-            elif command == \"move\":\n-                with Permissions.FILES_DELETE.require(403):\n-                    if _isBusy(target, filename):\n-                        abort(\n-                            409,\n-                            description=\"Trying to move a file or folder that is currently in use\",\n-                        )\n-                    if (\n-                        _verifyFileExists(target, destination)\n-                        or _verifyFolderExists(target, destination)\n-                    ) and sanitized_destination != filename:\n                        abort(409, description=\"File or folder does already exist\")\n-                    currentOrigin, currentFilename = _getCurrentFile()\n-                    if currentFilename is not None and filename == currentFilename:\n-                        printer.unselect_file()\n                    if is_file:\n-                        fileManager.move_file(target, filename, destination)\n                    else:\n-                        fileManager.move_folder(target, filename, destination)\n"}]}]}
{"num": 283, "cve": "CVE-2022-3232", "des": "Cross-Site Request Forgery (CSRF) in GitHub repository ikus060/rdiffweb prior to 2.4.5.", "cwe_list": ["CWE-352"], "cwe_name_lst": ["Cross-Site Request Forgery (CSRF)"], "url": "https://api.github.com/repos/ikus060/rdiffweb/commits/422791ea45713aaaa865bdca74addb9fffd93a71", "html_url": "https://github.com/ikus060/rdiffweb/commit/422791ea45713aaaa865bdca74addb9fffd93a71", "filename_list": ["./data/python/python_filter/283_0@ikus060@rdiffweb@28258e5dd85e7c417918ed3bf481e19ed5eff91f@rdiffweb_controller_page_admin.py.txt", "./data/python/python_filter/283_1@ikus060@rdiffweb@28258e5dd85e7c417918ed3bf481e19ed5eff91f@rdiffweb_controller_page_delete.py.txt"], "patch_list": [{"patch_file": "rdiffweb/controller/page_admin.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "users(self, username=None, criteria=u\"\", search=u\"\", action=u\"\", **kwargs):", "Modified_Line": "-            self._delete_user(action, DeleteUserForm())\n"}]}, {"patch_file": "rdiffweb/controller/page_delete.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "default(self, path=b\"\", **kwargs):", "Modified_Line": "        form = DeleteRepoForm()\r\n-        if not form.validate():\r\n-            raise cherrypy.HTTPError(400, form.error_message)\r\n-\r\n-        # Validate the name\r\n-        if form.confirm.data != path_obj.display_name:\r\n-            _logger.info(\"do not delete repo, bad confirmation %r != %r\", form.confirm.data, path_obj.display_name)\r\n-            raise cherrypy.HTTPError(400, 'bad confirmation')\r\n-\r\n-        # Delete repository in background using a schedule task.\r\n-        scheduled = cherrypy.engine.publish('schedule_task', repo.delete, path)\r\n-        assert scheduled\r\n-        raise cherrypy.HTTPRedirect(form.redirect.data)\r\n"}]}]}
{"num": 342, "cve": "CVE-2022-3221", "des": "Cross-Site Request Forgery (CSRF) in GitHub repository ikus060/rdiffweb prior to 2.4.3.", "cwe_list": ["CWE-352"], "cwe_name_lst": ["Cross-Site Request Forgery (CSRF)"], "url": "https://api.github.com/repos/ikus060/rdiffweb/commits/9125f5a2d918fed0f3fc1c86fa94cd1779ed9f73", "html_url": "https://github.com/ikus060/rdiffweb/commit/9125f5a2d918fed0f3fc1c86fa94cd1779ed9f73", "filename_list": ["./data/python/python_filter/342_0@ikus060@rdiffweb@73a369a3f7ec7958106d395eb65dd511fca0d9c7@rdiffweb_controller_pref_sshkeys.py.txt"], "patch_list": [{"patch_file": "rdiffweb/controller/pref_sshkeys.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "render_prefs_panel(self, panelid, action=None, **kwargs):  # @UnusedVariable", "Modified_Line": "        form = SshForm()\n-        if action == \"add\":\n            self._add_key(action, form)\n-        elif action == 'delete':\n            self._delete_key(action, DeleteSshForm())\n"}]}]}
{"num": 343, "cve": "CVE-2022-3179", "des": "Weak Password Requirements in GitHub repository ikus060/rdiffweb prior to 2.4.2.", "cwe_list": ["CWE-521"], "cwe_name_lst": ["Weak Password Requirements"], "url": "https://api.github.com/repos/ikus060/rdiffweb/commits/233befc33bdc45d4838c773d5aed4408720504c5", "html_url": "https://github.com/ikus060/rdiffweb/commit/233befc33bdc45d4838c773d5aed4408720504c5", "filename_list": ["./data/python/python_filter/343_0@ikus060@rdiffweb@e7828ca959a03582691679456a90b16903f98afe@rdiffweb_controller_page_admin.py.txt", "./data/python/python_filter/343_3@ikus060@rdiffweb@e7828ca959a03582691679456a90b16903f98afe@rdiffweb_core_store.py.txt"], "patch_list": [{"patch_file": "rdiffweb/controller/page_admin.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "-    password = PasswordField(_('Password'))\n"}]}, {"patch_file": "rdiffweb/core/store.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "set_password(self, password, old_password=None):", "Modified_Line": "        assert isinstance(password, str)\n        assert old_password is None or isinstance(old_password, str)\n        if not password:\n            raise ValueError(\"password can't be empty\")\n"}]}]}
{"num": 348, "cve": "CVE-2022-36082", "des": "mangadex-downloader is a command-line tool to download manga from MangaDex. When using `file:<location>` command and `<location>` is a web URL location (http, https), mangadex-downloader between versions 1.3.0 and 1.7.2 will try to open and read a file in local disk for each line of website contents. Version 1.7.2 contains a patch for this issue.", "cwe_list": ["CWE-20"], "cwe_name_lst": ["Improper Input Validation"], "url": "https://api.github.com/repos/mansuf/mangadex-downloader/commits/439cc2825198ebc12b3310c95c39a8c7710c9b42", "html_url": "https://github.com/mansuf/mangadex-downloader/commit/439cc2825198ebc12b3310c95c39a8c7710c9b42", "filename_list": ["./data/python/python_filter/348_0@mansuf@mangadex-downloader@972b1d4ec1439bab11cee3c21068d57a2c0535e3@mangadex_downloader_cli_validator.py.txt"], "patch_list": [{"patch_file": "mangadex_downloader/cli/validator.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "validate_url(url):", "Modified_Line": "-    if os.path.exists(url):\n-        with open(url, 'r') as opener:\n-            content = opener.read()\n-    else:\n-        content = url\n    urls = []\n-    for _url in content.splitlines():\n        if not _url:\n            continue\n"}]}]}
{"num": 349, "cve": "CVE-2022-36081", "des": "Wikmd is a file based wiki that uses markdown. Prior to version 1.7.1, Wikmd is vulnerable to path traversal when accessing `/list/<path:folderpath>` and discloses lists of files located on the server including sensitive data. Version 1.7.1 fixes this issue.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/Linbreux/wikmd/commits/8d1f94ec86b5b6c3df8ef10051facfb511a78450", "html_url": "https://github.com/Linbreux/wikmd/commit/8d1f94ec86b5b6c3df8ef10051facfb511a78450", "filename_list": ["./data/python/python_filter/349_0@Linbreux@wikmd@259412c47d64d5b85980f95345179fbf05927798@wiki.py.txt"], "patch_list": [{"patch_file": "wiki.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "list_wiki(folderpath):", "Modified_Line": "    folder_list = []\n    app.logger.info(\"Showing >>> 'all files'\")\n-    for root, subfolder, files in os.walk(os.path.join(cfg.wiki_directory, folderpath)):\n"}]}]}
{"num": 351, "cve": "CVE-2022-39286", "des": "Jupyter Core is a package for the core common functionality of Jupyter projects. Jupyter Core prior to version 4.11.2 contains an arbitrary code execution vulnerability in `jupyter_core` that stems from `jupyter_core` executing untrusted files in CWD. This vulnerability allows one user to run code as another. Version 4.11.2 contains a patch for this issue. There are no known workarounds.", "cwe_list": ["CWE-427"], "cwe_name_lst": ["Uncontrolled Search Path Element"], "url": "https://api.github.com/repos/jupyter/jupyter_core/commits/1118c8ce01800cb689d51f655f5ccef19516e283", "html_url": "https://github.com/jupyter/jupyter_core/commit/1118c8ce01800cb689d51f655f5ccef19516e283", "filename_list": ["./data/python/python_filter/351_0@jupyter@jupyter_core@d3f61f336bfe5c6c63e1af0d8c9fb0dea59f8793@jupyter_core_application.py.txt"], "patch_list": [{"patch_file": "jupyter_core/application.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "config_file_paths(self):", "Modified_Line": "        path = jupyter_config_path()\n-        path.insert(0, os.getcwd())\n"}]}]}
{"num": 355, "cve": "CVE-2022-3607", "des": "Failure to Sanitize Special Elements into a Different Plane (Special Element Injection) in GitHub repository octoprint/octoprint prior to 1.8.3.", "cwe_list": ["CWE-74"], "cwe_name_lst": ["Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')"], "url": "https://api.github.com/repos/OctoPrint/OctoPrint/commits/3cca3a43f3d085e9bbe5a5840c8255bb1b5d052e", "html_url": "https://github.com/OctoPrint/OctoPrint/commit/3cca3a43f3d085e9bbe5a5840c8255bb1b5d052e", "filename_list": ["./data/python/python_filter/355_0@OctoPrint@OctoPrint@ef95ef1c101b79394f134e8fce000e6bae046571@src_octoprint_server_api_languages.py.txt"], "patch_list": [{"patch_file": "src/octoprint/server/api/languages.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_unpack_uploaded_zipfile(path, target):", "Modified_Line": "-        map(_validate_archive_name, zip.namelist())\n"}, {"Modified_Block_Num": "2", "Modified_Function": "_unpack_uploaded_tarball(path, target):", "Modified_Line": "-        map(_validate_archive_name, tar.getmembers())\n"}, {"Modified_Block_Num": "3", "Modified_Function": "_validate_archive_name(name):", "Modified_Line": "-    if name.startswith(\"/\") or \"..\" in name:\n"}]}]}
{"num": 356, "cve": "CVE-2022-41547", "des": "Mobile Security Framework (MobSF) v0.9.2 and below was discovered to contain a local file inclusion (LFI) vulnerability in the StaticAnalyzer/views.py script. This vulnerability allows attackers to read arbitrary files via a crafted HTTP request.", "cwe_list": ["NVD-CWE-noinfo"], "cwe_name_lst": ["none"], "url": "https://api.github.com/repos/MobSF/Mobile-Security-Framework-MobSF/commits/b9cdd1f52bdf127cf33bb1be369e374a2855f8e6", "html_url": "https://github.com/MobSF/Mobile-Security-Framework-MobSF/commit/b9cdd1f52bdf127cf33bb1be369e374a2855f8e6", "filename_list": ["./data/python/python_filter/356_0@MobSF@Mobile-Security-Framework-MobSF@0458e21b2a9d6e4bc154a58b10c8713d914e177b@DynamicAnalyzer_views.py.txt", "./data/python/python_filter/356_1@MobSF@Mobile-Security-Framework-MobSF@0458e21b2a9d6e4bc154a58b10c8713d914e177b@StaticAnalyzer_views.py.txt"], "patch_list": [{"patch_file": "DynamicAnalyzer/views.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "def APIFuzzer(request):", "Modified_Line": "            MD5=request.POST['md5']\n-            m=re.match('[0-9a-f]{32}',MD5)\n"}]}, {"patch_file": "StaticAnalyzer/views.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "Java(request):", "Modified_Line": "-        m=re.match('[0-9a-f]{32}',request.GET['md5'])\n"}]}]}
{"num": 358, "cve": "CVE-2022-3457", "des": "Origin Validation Error in GitHub repository ikus060/rdiffweb prior to 2.5.0a5.", "cwe_list": ["CWE-346"], "cwe_name_lst": ["Origin Validation Error"], "url": "https://api.github.com/repos/ikus060/rdiffweb/commits/afc1bdfab5161c74012ff2590a6ec49cc0d8fde0", "html_url": "https://github.com/ikus060/rdiffweb/commit/afc1bdfab5161c74012ff2590a6ec49cc0d8fde0", "filename_list": ["./data/python/python_filter/358_0@ikus060@rdiffweb@8becdaf734b11dc277f7b41151c00f12851085f5@rdiffweb_tools_secure_headers.py.txt"], "patch_list": [{"patch_file": "rdiffweb/tools/secure_headers.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "set_headers(", "Modified_Line": "-        if origin and not origin.startswith(request.base):\n"}]}]}
{"num": 361, "cve": "CVE-2022-42725", "des": "Warpinator through 1.2.14 allows access outside of an intended directory, as demonstrated by symbolic directory links.", "cwe_list": ["CWE-59"], "cwe_name_lst": ["Improper Link Resolution Before File Access ('Link Following')"], "url": "https://api.github.com/repos/linuxmint/warpinator/commits/95124fd4468683dd69ddd7b3da0e9906ce6beae2", "html_url": "https://github.com/linuxmint/warpinator/commit/95124fd4468683dd69ddd7b3da0e9906ce6beae2", "filename_list": ["./data/python/python_filter/361_0@linuxmint@warpinator@8bfd2f8b3f1b0c0f0a5a6d275702d107b9e08a94@src_transfers.py.txt"], "patch_list": [{"patch_file": "src/transfers.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "__init__(self, op):", "Modified_Line": "-        self.save_path_file = Gio.File.new_for_path(self.save_path)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "receive_data(self, s):", "Modified_Line": "-            if self.save_path_file.get_relative_path(self.current_gfile) is None:\n-                raise Exception(_(\"Resolved path is not valid: %s -> %s\") % (path, self.current_gfile.get_path()))\n"}]}]}
{"num": 364, "cve": "CVE-2022-3389", "des": "Path Traversal in GitHub repository ikus060/rdiffweb prior to 2.4.10.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/ikus060/rdiffweb/commits/323383d1db656f1b1291be529947bd943a6b0e99", "html_url": "https://github.com/ikus060/rdiffweb/commit/323383d1db656f1b1291be529947bd943a6b0e99", "filename_list": ["./data/python/python_filter/364_0@ikus060@rdiffweb@ee98e5af78ec60db8a17fef6ea0ca250e3f31eec@rdiffweb_controller_dispatch.py.txt"], "patch_list": [{"patch_file": "rdiffweb/controller/dispatch.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "static(path):", "Modified_Line": "-    assert os.path.exists(path), \"%r doesn't exists\" % path\n-    content_type = None\n-    if os.path.isfile(path):\n-        # Set content-type based on filename extension\n-        ext = \"\"\n-        i = path.rfind('.')\n-        if i != -1:\n-            ext = path[i:].lower()\n-        content_type = mimetypes.types_map.get(ext, None)  # @UndefinedVariable\n    def handler(*args, **kwargs):\n-        if cherrypy.request.method not in ('GET', 'HEAD'):\n-            return None\n-        filename = os.path.join(path, *args)\n-        assert filename.startswith(path)\n-        if not os.path.isfile(filename):\n-            return None\n-        return serve_file(filename, content_type)\n"}]}]}
{"num": 365, "cve": "CVE-2022-39280", "des": "dparse is a parser for Python dependency files. dparse in versions before 0.5.2 contain a regular expression that is vulnerable to a Regular Expression Denial of Service. All the users parsing index server URLs with dparse are impacted by this vulnerability. A patch has been applied in version `0.5.2`, all the users are advised to upgrade to `0.5.2` as soon as possible. Users unable to upgrade should avoid passing index server URLs in the source file to be parsed.", "cwe_list": ["CWE-1333"], "cwe_name_lst": ["Inefficient Regular Expression Complexity"], "url": "https://api.github.com/repos/pyupio/dparse/commits/d87364f9db9ab916451b1b036cfeb039e726e614", "html_url": "https://github.com/pyupio/dparse/commit/d87364f9db9ab916451b1b036cfeb039e726e614", "filename_list": ["./data/python/python_filter/365_0@pyupio@dparse@699069ef65fa10b4f252ab2989f89dd043945db8@dparse_parser.py.txt"], "patch_list": [{"patch_file": "dparse/parser.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "parse_index_server(cls, line):", "Modified_Line": "-        matches = URL_REGEX.findall(line)\n-        if matches:\n-            url = matches[0]\n-            return url if url.endswith(\"/\") else url + \"/\"\n"}]}]}
{"num": 367, "cve": "CVE-2022-39275", "des": "Saleor is a headless, GraphQL commerce platform. In affected versions some GraphQL mutations were not properly checking the ID type input which allowed to access database objects that the authenticated user may not be allowed to access. This vulnerability can be used to expose the following information: Estimating database row counts from tables with a sequential primary key or Exposing staff user and customer email addresses and full name through the `assignNavigation()` mutation. This issue has been patched in main and backported to multiple releases (3.7.17, 3.6.18, 3.5.23, 3.4.24, 3.3.26, 3.2.14, 3.1.24). Users are advised to upgrade. There are no known workarounds for this issue.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/saleor/saleor/commits/96e04c092ddcac17b14f2e31554aa02d9006d0ce", "html_url": "https://github.com/saleor/saleor/commit/96e04c092ddcac17b14f2e31554aa02d9006d0ce", "filename_list": ["./data/python/python_filter/367_0@saleor@saleor@5e23b5730889d7745edb6f456349e48b0f106aa1@saleor_graphql_account_mutations_account.py.txt", "./data/python/python_filter/367_1@saleor@saleor@5e23b5730889d7745edb6f456349e48b0f106aa1@saleor_graphql_account_mutations_base.py.txt", "./data/python/python_filter/367_2@saleor@saleor@5e23b5730889d7745edb6f456349e48b0f106aa1@saleor_graphql_menu_mutations.py.txt", "./data/python/python_filter/367_3@saleor@saleor@5e23b5730889d7745edb6f456349e48b0f106aa1@saleor_graphql_product_bulk_mutations_products.py.txt"], "patch_list": [{"patch_file": "saleor/graphql/account/mutations/account.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "perform_mutation(cls, _root, info, **data):", "Modified_Line": "-        address = cls.get_node_or_error(info, data.get(\"id\"), Address)\n"}]}, {"patch_file": "saleor/graphql/account/mutations/base.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "perform_mutation(cls, _root, info, **data):", "Modified_Line": "-        instance = cls.get_node_or_error(info, node_id, Address)\n"}]}, {"patch_file": "saleor/graphql/menu/mutations.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "perform_mutation(cls, _root, info, navigation_type, menu=None):", "Modified_Line": "-            menu = cls.get_node_or_error(info, menu, field=\"menu\")\n"}]}, {"patch_file": "saleor/graphql/product/bulk_mutations/products.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "perform_mutation(cls, _root, info, **data):", "Modified_Line": "-        product = cls.get_node_or_error(info, data[\"product_id\"], models.Product)\n"}]}]}
{"num": 368, "cve": "CVE-2022-3376", "des": "Weak Password Requirements in GitHub repository ikus060/rdiffweb prior to 2.5.0a4.", "cwe_list": ["CWE-521"], "cwe_name_lst": ["Weak Password Requirements"], "url": "https://api.github.com/repos/ikus060/rdiffweb/commits/2ffc2af65c8f8113b06e0b89929c604bcdf844b9", "html_url": "https://github.com/ikus060/rdiffweb/commit/2ffc2af65c8f8113b06e0b89929c604bcdf844b9", "filename_list": ["./data/python/python_filter/368_0@ikus060@rdiffweb@a5d0bca218bd83c2e131767c061b0872969e9d23@rdiffweb_controller_page_pref_general.py.txt"], "patch_list": [{"patch_file": "rdiffweb/controller/page_pref_general.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "populate_obj(self, user):", "Modified_Line": "        if not user.validate_password(self.current.data):\n            cherrypy.session[CHANGE_PASSWORD_ATTEMPTS] = cherrypy.session.get(CHANGE_PASSWORD_ATTEMPTS, 0) + 1\n            attempts = cherrypy.session[CHANGE_PASSWORD_ATTEMPTS]\n-            flash(_(\"Wrong current password.\"), level='warning')\n-        else:\n-            # Clear number of attempts\n-            if CHANGE_PASSWORD_ATTEMPTS in cherrypy.session:\n-                del cherrypy.session[CHANGE_PASSWORD_ATTEMPTS]\n-            # If Valid, update password\n-            try:\n-                user.set_password(self.new.data)\n-                flash(_(\"Password updated successfully.\"), level='success')\n-            except ValueError as e:\n-                flash(str(e), level='warning')\n"}]}]}
{"num": 378, "cve": "CVE-2022-45907", "des": "In PyTorch before trunk/89695, torch.jit.annotations.parse_type_line can cause arbitrary code execution because eval is used unsafely.", "cwe_list": ["CWE-94"], "cwe_name_lst": ["Improper Control of Generation of Code ('Code Injection')"], "url": "https://api.github.com/repos/pytorch/pytorch/commits/767f6aa49fe20a2766b9843d01e3b7f7793df6a3", "html_url": "https://github.com/pytorch/pytorch/commit/767f6aa49fe20a2766b9843d01e3b7f7793df6a3", "filename_list": ["./data/python/python_filter/378_0@pytorch@pytorch@fbbf3687453aed1b732eee6f6e9050258ce29561@torch_jit_annotations.py.txt"], "patch_list": [{"patch_file": "torch/jit/annotations.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "parse_type_line(type_line, rcb, loc):", "Modified_Line": "-        arg_ann = eval(arg_ann_str, {}, EvalEnv(rcb))  # type: ignore[arg-type] # noqa: P204\n-        ret_ann = eval(ret_ann_str, {}, EvalEnv(rcb))  # type: ignore[arg-type] # noqa: P204\n"}]}]}
{"num": 379, "cve": "CVE-2022-45908", "des": "In PaddlePaddle before 2.4, paddle.audio.functional.get_window is vulnerable to code injection because it calls eval on a user-supplied winstr. This may lead to arbitrary code execution.", "cwe_list": ["CWE-94"], "cwe_name_lst": ["Improper Control of Generation of Code ('Code Injection')"], "url": "https://api.github.com/repos/PaddlePaddle/Paddle/commits/26c419ca386aeae3c461faf2b828d00b48e908eb", "html_url": "https://github.com/PaddlePaddle/Paddle/commit/26c419ca386aeae3c461faf2b828d00b48e908eb", "filename_list": ["./data/python/python_filter/379_0@PaddlePaddle@Paddle@0f649b32397dcd043e51b414904ccfa730b52603@python_paddle_audio_functional_window.py.txt"], "patch_list": [{"patch_file": "python/paddle/audio/functional/window.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_window(", "Modified_Line": "-        winfunc = eval('_' + winstr)\n-    except NameError as e:\n"}]}]}
{"num": 383, "cve": "CVE-2022-4105", "des": "A stored XSS in a kiwi Test Plan can run malicious javascript which could be chained with an HTML injection to perform a UI redressing attack (clickjacking) and an HTML injection which disables the use of the history page.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/kiwitcms/Kiwi/commits/a2b169ffdef1d7c1755bade8138578423b35011b", "html_url": "https://github.com/kiwitcms/Kiwi/commit/a2b169ffdef1d7c1755bade8138578423b35011b", "filename_list": ["./data/python/python_filter/383_0@kiwitcms@Kiwi@a54cbbf73d6978c01f947b2c64f2db1986ecfb2c@tcms_core_history.py.txt"], "patch_list": [{"patch_file": "tcms/core/history.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "diff_objects(old_instance, new_instance, fields):", "Modified_Line": "    for field in fields:\n        field_diff = []\n        old_value = getattr(old_instance, field.attname)\n        new_value = getattr(new_instance, field.attname)\n"}]}]}
{"num": 408, "cve": "CVE-2022-41914", "des": "Zulip is an open-source team collaboration tool. For organizations with System for Cross-domain Identity Management(SCIM) account management enabled, Zulip Server 5.0 through 5.6 checked the SCIM bearer token using a comparator that did not run in constant time. Therefore, it might theoretically be possible for an attacker to infer the value of the token by performing a sophisticated timing analysis on a large number of failing requests. If successful, this would allow the attacker to impersonate the SCIM client for its abilities to read and update user accounts in the Zulip organization. Organizations where SCIM account management has not been enabled are not affected.", "cwe_list": ["CWE-203"], "cwe_name_lst": ["Observable Discrepancy"], "url": "https://api.github.com/repos/zulip/zulip/commits/59edbfa4113d140d3e20126bc65f4d67b2a8ffe5", "html_url": "https://github.com/zulip/zulip/commit/59edbfa4113d140d3e20126bc65f4d67b2a8ffe5", "filename_list": ["./data/python/python_filter/408_0@zulip@zulip@1dc094dded7bc407e0d5ac1bc25f31f93cb5ea80@zerver_middleware.py.txt"], "patch_list": [{"patch_file": "zerver/middleware.py", "patch_content": [ {"Modified_Block_Num": "1", "Modified_Function": "validate_scim_bearer_token(request: HttpRequest) -> Optional[SCIMClient]:", "Modified_Line": "    subdomain = get_subdomain(request)\n    valid_bearer_token = scim_config_dict.get(\"bearer_token\")\n-    if request.headers.get(\"Authorization\") != f\"Bearer {valid_bearer_token}\":\n        return None\n"}]}]}
{"num": 410, "cve": "CVE-2022-37109", "des": "patrickfuller camp up to and including commit bbd53a256ed70e79bd8758080936afbf6d738767 is vulnerable to Incorrect Access Control. Access to the password.txt file is not properly restricted as it is in the root directory served by StaticFileHandler and the Tornado rule to throw a 403 error when password.txt is accessed can be bypassed. Furthermore, it is not necessary to crack the password hash to authenticate with the application because the password hash is also used as the cookie secret, so an attacker can generate his own authentication cookie.", "cwe_list": ["CWE-522"], "cwe_name_lst": ["Insufficiently Protected Credentials"], "url": "https://api.github.com/repos/patrickfuller/camp/commits/bf6af5c2e5cf713e4050c11c52dd4c55e89880b1", "html_url": "https://github.com/patrickfuller/camp/commit/bf6af5c2e5cf713e4050c11c52dd4c55e89880b1", "filename_list": ["./data/python/python_filter/410_0@patrickfuller@camp@bbd53a256ed70e79bd8758080936afbf6d738767@server.py.txt"], "patch_list": [{"patch_file": "server.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "handlers = [(r\"/\", IndexHandler), (r\"/login\", LoginHandler),\n            (r\"/websocket\", WebSocket),\n-            (r\"/static/password.txt\", ErrorHandler),\n-            (r'/static/(.*)', tornado.web.StaticFileHandler, {'path': ROOT})]\n-application = tornado.web.Application(handlers, cookie_secret=PASSWORD)\n"}]}]}
{"num": 415, "cve": "CVE-2022-4860", "des": "A vulnerability was found in KBase Metrics. It has been classified as critical. This affects the function upload_user_data of the file source/daily_cron_jobs/methods_upload_user_stats.py. The manipulation leads to sql injection. The patch is named 959dfb6b05991e30b0fa972a1ecdcaae8e1dae6d. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-217059.", "cwe_list": ["CWE-89"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "url": "https://api.github.com/repos/kbase/metrics/commits/959dfb6b05991e30b0fa972a1ecdcaae8e1dae6d", "html_url": "https://github.com/kbase/metrics/commit/959dfb6b05991e30b0fa972a1ecdcaae8e1dae6d", "filename_list": ["./data/python/python_filter/415_0@kbase@metrics@c9ec0701170e052a34ece852ba7eda53adde5a37@source_daily_cron_jobs_methods_upload_user_stats.py.txt"], "patch_list": [{"patch_file": "source/daily_cron_jobs/methods_upload_user_stats.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "upload_user_data(user_stats_dict):", "Modified_Line": "    dev_tokens_users = get_dev_token_users_from_mongo()\n    dev_tokens_string = \"', '\".join(dev_tokens_users)\n    update_new_dev_tokens_statement = (\n        \"update user_info set dev_token_first_seen = now() \"\n        \"where dev_token_first_seen is null and \"\n        \"username in ('\" + dev_tokens_string + \"')\"\n"}]}]}
{"num": 418, "cve": "CVE-2022-46179", "des": "LiuOS is a small Python project meant to imitate the functions of a regular operating system. Version 0.1.0 and prior of LiuOS allow an attacker to set the GITHUB_ACTIONS environment variable to anything other than null or true and skip authentication checks. This issue is patched in the latest commit (c658b4f3e57258acf5f6207a90c2f2169698ae22) by requiring the var to be set to true, causing a test script to run instead of being able to login. A potential workaround is to check for the GITHUB_ACTIONS environment variable and set it to \"\" (no quotes) to null the variable and force credential checks.", "cwe_list": ["CWE-639"], "cwe_name_lst": ["Authorization Bypass Through User-Controlled Key"], "url": "https://api.github.com/repos/LiuWoodsCode/LiuOS/commits/c658b4f3e57258acf5f6207a90c2f2169698ae22", "html_url": "https://github.com/LiuWoodsCode/LiuOS/commit/c658b4f3e57258acf5f6207a90c2f2169698ae22", "filename_list": ["./data/python/python_filter/418_0@LiuWoodsCode@LiuOS@a37744679569399f7d383bf4706c28fae9246fac@core.py.txt"], "patch_list": [{"patch_file": "core.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "actualsys() :", "Modified_Line": "-        if os.environ.get('GITHUB_ACTIONS') != \"\":\n"}]}]}
{"num": 420, "cve": "CVE-2022-4768", "des": "A vulnerability was found in Dropbox merou. It has been classified as critical. Affected is the function add_public_key of the file grouper/public_key.py of the component SSH Public Key Handler. The manipulation of the argument public_key_str leads to injection. It is possible to launch the attack remotely. The name of the patch is d93087973afa26bc0a2d0a5eb5c0fde748bdd107. It is recommended to apply a patch to fix this issue. VDB-216906 is the identifier assigned to this vulnerability.", "cwe_list": ["CWE-74"], "cwe_name_lst": ["Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')"], "url": "https://api.github.com/repos/dropbox/merou/commits/d93087973afa26bc0a2d0a5eb5c0fde748bdd107", "html_url": "https://github.com/dropbox/merou/commit/d93087973afa26bc0a2d0a5eb5c0fde748bdd107", "filename_list": ["./data/python/python_filter/420_0@dropbox@merou@30755ea28858f9d3bcd3e7eda2a122f76435ee6f@grouper_public_key.py.txt"], "patch_list": [{"patch_file": "grouper/public_key.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "add_public_key(session, user, public_key_str):", "Modified_Line": "    pubkey = sshpubkeys.SSHKey(public_key_str, strict=True)\n    try:\n        pubkey.parse()\n    except sshpubkeys.InvalidKeyException as e:\n        raise PublicKeyParseError(str(e))\n    try:\n        get_plugin_proxy().will_add_public_key(pubkey)\n    except PluginRejectedPublicKey as e:\n        raise BadPublicKey(str(e))\n"}]}]}
{"num": 422, "cve": "CVE-2022-4724", "des": "Improper Access Control in GitHub repository ikus060/rdiffweb prior to 2.5.5.", "cwe_list": ["CWE-284"], "cwe_name_lst": ["Improper Access Control"], "url": "https://api.github.com/repos/ikus060/rdiffweb/commits/c4a19cf67d575c4886171b8efcbf4675d51f3929", "html_url": "https://github.com/ikus060/rdiffweb/commit/c4a19cf67d575c4886171b8efcbf4675d51f3929", "filename_list": ["./data/python/python_filter/422_2@ikus060@rdiffweb@d1aaa96b665a39fba9e98d6054a9de511ba0a837@rdiffweb_core_model__user.py.txt"], "patch_list": [{"patch_file": "rdiffweb/core/model/_user.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "add_authorizedkey(self, key, comment=None):", "Modified_Line": "        filename = os.path.join(self.user_root, '.ssh', 'authorized_keys')\n        if os.path.isfile(filename):\n        else:\n            logger.info(\"add key [%s] to [%s] database\", key, self.username)\n            try:\n                SshKey(userid=self.userid, fingerprint=key.fingerprint, key=key.getvalue()).add().flush()\n"}]}]}
{"num": 424, "cve": "CVE-2022-4722", "des": "Authentication Bypass by Primary Weakness in GitHub repository ikus060/rdiffweb prior to 2.5.5.", "cwe_list": ["CWE-287"], "cwe_name_lst": ["Improper Authentication"], "url": "https://api.github.com/repos/ikus060/rdiffweb/commits/d1aaa96b665a39fba9e98d6054a9de511ba0a837", "html_url": "https://github.com/ikus060/rdiffweb/commit/d1aaa96b665a39fba9e98d6054a9de511ba0a837", "filename_list": ["./data/python/python_filter/424_0@ikus060@rdiffweb@6e9ee210548f6d3210704cac302cfc7cdb239765@rdiffweb_core_login.py.txt", "./data/python/python_filter/424_2@ikus060@rdiffweb@6e9ee210548f6d3210704cac302cfc7cdb239765@rdiffweb_core_model__user.py.txt"], "patch_list": [{"patch_file": "rdiffweb/core/login.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "authenticate(self, username, password):", "Modified_Line": "-        user = UserObject.query.filter_by(username=username).first()\n"}, {"Modified_Block_Num": "2", "Modified_Function": "login(self, username, password):", "Modified_Line": "-        userobj = UserObject.query.filter_by(username=username).first()\n"}]}, {"patch_file": "rdiffweb/core/model/_user.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "-    username = Column('Username', String, nullable=False, unique=True)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "get_user(cls, user):", "Modified_Line": "-        return UserObject.query.filter(UserObject.username == user).first()\n"}]}]}
{"num": 427, "cve": "CVE-2021-4287", "des": "A vulnerability, which was classified as problematic, was found in ReFirm Labs binwalk up to 2.3.2. Affected is an unknown function of the file src/binwalk/modules/extractor.py of the component Archive Extraction Handler. The manipulation leads to symlink following. It is possible to launch the attack remotely. Upgrading to version 2.3.3 is able to address this issue. The name of the patch is fa0c0bd59b8588814756942fe4cb5452e76c1dcd. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-216876.", "cwe_list": ["CWE-59"], "cwe_name_lst": ["Improper Link Resolution Before File Access ('Link Following')"], "url": "https://api.github.com/repos/ReFirmLabs/binwalk/commits/fa0c0bd59b8588814756942fe4cb5452e76c1dcd", "html_url": "https://github.com/ReFirmLabs/binwalk/commit/fa0c0bd59b8588814756942fe4cb5452e76c1dcd", "filename_list": ["./data/python/python_filter/427_1@ReFirmLabs@binwalk@0499019337796d69d37939a2e0e8b8d5a055ed21@src_binwalk_modules_extractor.py.txt"], "patch_list": [{"patch_file": "src/binwalk/modules/extractor.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "callback(self, r):", "Modified_Line": "-                    if (self.matryoshka and\n-                        file_path != dd_file_path and\n-                        scan_extracted_files and\n-                            self.directory in real_file_path):\n-                        if len(real_file_path.split(self.directory)[1].split(os.path.sep)) <= self.matryoshka:\n-                            if os.path.isdir(file_path):\n-                                for root, dirs, files in os.walk(file_path):\n-                                    for f in files:\n-                                        full_path = os.path.join(root, f)\n-                                        self.add_pending(full_path)\n-                                self.add_pending(file_path)\n"}]}]}
{"num": 428, "cve": "CVE-2020-36631", "des": "A vulnerability was found in barronwaffles dwc_network_server_emulator. It has been declared as critical. This vulnerability affects the function update_profile of the file gamespy/gs_database.py. The manipulation of the argument firstname/lastname leads to sql injection. The attack can be initiated remotely. The name of the patch is f70eb21394f75019886fbc2fb536de36161ba422. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-216772.", "cwe_list": ["CWE-89"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "url": "https://api.github.com/repos/barronwaffles/dwc_network_server_emulator/commits/f70eb21394f75019886fbc2fb536de36161ba422", "html_url": "https://github.com/barronwaffles/dwc_network_server_emulator/commit/f70eb21394f75019886fbc2fb536de36161ba422", "filename_list": ["./data/python/python_filter/428_0@barronwaffles@dwc_network_server_emulator@78ea73840db5006fcaa086f3320a1974dcf1bead@gamespy_gs_database.py.txt"], "patch_list": [{"patch_file": "gamespy/gs_database.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "update_profile(self, profileid, field):", "Modified_Line": "-        with Transaction(self.conn) as tx:\n-            q = \"UPDATE users SET \\\"%s\\\" = ? WHERE profileid = ?\"\n-            tx.nonquery(q % field[0], (field[1], profileid))\n"}]}]}
{"num": 432, "cve": "CVE-2022-4638", "des": "A vulnerability classified as problematic was found in collective.contact.widget up to 1.12. This vulnerability affects the function title of the file src/collective/contact/widget/widgets.py. The manipulation leads to cross site scripting. The attack can be initiated remotely. The name of the patch is 5da36305ca7ed433782be8901c47387406fcda12. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-216496.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/collective/collective.contact.widget/commits/5da36305ca7ed433782be8901c47387406fcda12", "html_url": "https://github.com/collective/collective.contact.widget/commit/5da36305ca7ed433782be8901c47387406fcda12", "filename_list": ["./data/python/python_filter/432_0@collective@collective.contact.widget@25f81b89bd0c7834d22ebbb3c758e43d7cd05b09@src_collective_contact_widget_widgets.py.txt"], "patch_list": [{"patch_file": "src/collective/contact/widget/widgets.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "title(self):", "Modified_Line": "-        return title\n"}]}]}
{"num": 434, "cve": "CVE-2022-23530", "des": "GuardDog is a CLI tool to identify malicious PyPI packages. Versions prior to v0.1.8 are vulnerable to arbitrary file write when scanning a specially-crafted remote PyPI package. Extracting files using shutil.unpack_archive() from a potentially malicious tarball without validating that the destination file path is within the intended destination directory can cause files outside the destination directory to be overwritten.  This issue is patched in version 0.1.8. Potential workarounds include using a safer module, like zipfile, and validating the location of the extracted files and discarding those with malicious paths.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/DataDog/guarddog/commits/37c7d0767ba28f4df46117d478f97652594c491c", "html_url": "https://github.com/DataDog/guarddog/commit/37c7d0767ba28f4df46117d478f97652594c491c", "filename_list": ["./data/python/python_filter/434_0@DataDog@guarddog@8e814deb3ae6457ea1a4f7b0d3a0e64db0734f13@guarddog_scanners_package_scanner.py.txt"], "patch_list": [{"patch_file": "guarddog/scanners/package_scanner.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "download_compressed(self, url, zippath, unzippedpath):", "Modified_Line": "-        shutil.unpack_archive(zippath, unzippedpath)\n-        os.remove(zippath)\n"}]}]}
{"num": 438, "cve": "CVE-2022-4314", "des": "Improper Privilege Management in GitHub repository ikus060/rdiffweb prior to 2.5.2.", "cwe_list": ["CWE-269"], "cwe_name_lst": ["Improper Privilege Management"], "url": "https://api.github.com/repos/ikus060/rdiffweb/commits/b2df3679564d0daa2856213bb307d3e34bd89a25", "html_url": "https://github.com/ikus060/rdiffweb/commit/b2df3679564d0daa2856213bb307d3e34bd89a25", "filename_list": ["./data/python/python_filter/438_0@ikus060@rdiffweb@979ab34bdb37b644a7d742323e3249f5db463354@rdiffweb_core_librdiff.py.txt", "./data/python/python_filter/438_1@ikus060@rdiffweb@979ab34bdb37b644a7d742323e3249f5db463354@rdiffweb_core_model__repo.py.txt"], "patch_list": [{"patch_file": "rdiffweb/core/librdiff.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "__init__(self, user_root, path, encoding):", "Modified_Line": "-        if isinstance(user_root, str):\n-            user_root = os.fsencode(user_root)\n-        if isinstance(path, str):\n-            path = os.fsencode(path)\n-        assert isinstance(user_root, bytes)\n-        assert isinstance(path, bytes)\n-        assert encoding\n        self._encoding = encodings.search_function(encoding)\n-        assert self._encoding\n-        self.path = path.strip(b\"/\")\n-        if self.path:\n-            self.full_path = os.path.normpath(os.path.join(user_root, self.path))\n-        else:\n-            self.full_path = os.path.normpath(user_root)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "get_display_name(self, path):", "Modified_Line": "-            if not self.path:\n-                return self._decode(unquote(os.path.basename(self.full_path)))\n-            return self._decode(unquote(self.path))\n"}]}, {"patch_file": "rdiffweb/core/model/_repo.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "__init_on_load__(self):", "Modified_Line": "-        RdiffRepo.__init__(\n-            self, self.user.user_root, self.repopath, encoding=self.encoding or RepoObject.DEFAULT_REPO_ENCODING\n-        )\n"}]}]}
{"num": 443, "cve": "CVE-2022-44900", "des": "A directory traversal vulnerability in the SevenZipFile.extractall() function of the python library py7zr v0.20.0 and earlier allows attackers to write arbitrary files via extracting a crafted 7z file.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/miurahr/py7zr/commits/1bb43f17515c7f69673a1c88ab9cc72a7bbef406", "html_url": "https://github.com/miurahr/py7zr/commit/1bb43f17515c7f69673a1c88ab9cc72a7bbef406", "filename_list": ["./data/python/python_filter/443_1@miurahr@py7zr@04e3af5ae5092137ee7b015b85efac1c7fd8974e@py7zr_py7zr.py.txt"], "patch_list": [{"patch_file": "py7zr/py7zr.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_extract(", "Modified_Line": "-            if path is None:\n-                try:\n-                    pathlib.Path(os.getcwd()).joinpath(remove_relative_path_marker(outname)).relative_to(os.getcwd())\n-                except ValueError:\n-                    raise Bad7zFile\n-                outfilename = pathlib.Path(remove_relative_path_marker(outname))\n            else:\n-                outfilename = path.joinpath(remove_relative_path_marker(outname))\n-                try:\n-                    outfilename.relative_to(path)\n-                except ValueError:\n-                    raise Bad7zFile\n-            if is_windows_native_python() and outfilename.is_absolute() and not is_windows_unc_path(outfilename):\n-                outfilename = pathlib.WindowsPath(\"\\\\\\\\?\\\\\" + str(outfilename))\n"}]}]}
{"num": 444, "cve": "CVE-2022-23472", "des": "Passeo is an open source python password generator. Versions prior to 1.0.5 rely on the python `random` library for random value selection. The python `random` library warns that it should not be used for security purposes due to its reliance on a non-cryptographically secure random number generator. As a result a motivated attacker may be able to guess generated passwords. This issue has been addressed in version 1.0.5. Users are advised to upgrade. There are no known workarounds for this vulnerability.", "cwe_list": ["CWE-338"], "cwe_name_lst": ["Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "url": "https://api.github.com/repos/ArjunSharda/Passeo/commits/8caa798b6bc4647dca59b2376204b6dc6176361a", "html_url": "https://github.com/ArjunSharda/Passeo/commit/8caa798b6bc4647dca59b2376204b6dc6176361a", "filename_list": ["./data/python/python_filter/444_0@ArjunSharda@Passeo@d51dd9fa6deb99bda9802b62707ccbc14bbf3e97@src_passeo___init__.py.txt"], "patch_list": [{"patch_file": "src/passeo/__init__.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "generate(length, numbers=False, symbols=False, uppercase=False, lowercase=False, space=False, save=False):", "Modified_Line": "-            if numbers:\n-                password += string.digits\n-            if symbols:\n-                password += string.punctuation\n-            if uppercase:\n-                password += string.ascii_uppercase\n-            if lowercase:\n-                if uppercase:\n-                    raise ValueError('Uppercase and lowercase are both true, please make one of them false.')\n-                password += string.ascii_lowercase\n-            if space:\n                password += ' '\n-            PasseoPassword = ''.join(random.sample(password, length))\n-            if save:\n                with open('passeo_passwords.txt', 'a') as file:\n                    file.write(PasseoPassword + '\n')\n            return PasseoPassword\n"}]}]}
{"num": 445, "cve": "CVE-2022-23470", "des": "Galaxy is an open-source platform for data analysis. An arbitrary file read exists in Galaxy 22.01 and Galaxy 22.05 due to the switch to Gunicorn, which can be used to read any file accessible to the operating system user under which Galaxy is running. This vulnerability affects Galaxy 22.01 and higher, after the switch to gunicorn, which serve static contents directly.  Additionally, the vulnerability is mitigated when using Nginx or Apache to serve /static/* contents, instead of Galaxy's internal middleware. This issue has been patched in commit `e5e6bda4f` and will be included in future releases. Users are advised to manually patch their installations. There are no known workarounds for this vulnerability.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/galaxyproject/galaxy/commits/e5e6bda4f014f807ca77ee0cf6af777a55918346", "html_url": "https://github.com/galaxyproject/galaxy/commit/e5e6bda4f014f807ca77ee0cf6af777a55918346", "filename_list": ["./data/python/python_filter/445_0@galaxyproject@galaxy@7136d72b06b30fee0aefb1d617bbe1fe19a5cb49@lib_galaxy_web_framework_middleware_static.py.txt"], "patch_list": [{"patch_file": "lib/galaxy/web/framework/middleware/static.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "__call__(self, environ, start_response):", "Modified_Line": "-        full = os.path.join(directory, filename)\n"}]}]}
{"num": 449, "cve": "CVE-2020-25659", "des": "python-cryptography 3.2 is vulnerable to Bleichenbacher timing attacks in the RSA decryption API, via timed processing of valid PKCS#1 v1.5 ciphertext.", "cwe_list": ["NVD-CWE-Other"], "cwe_name_lst": ["none"], "url": "https://api.github.com/repos/pyca/cryptography/commits/58494b41d6ecb0f56b7c5f05d5f5e3ca0320d494", "html_url": "https://github.com/pyca/cryptography/commit/58494b41d6ecb0f56b7c5f05d5f5e3ca0320d494", "filename_list": ["./data/python/python_filter/449_0@pyca@cryptography@cf9bd6a36bc7b05abca114b76e216598d9ad9b16@src_cryptography_hazmat_backends_openssl_rsa.py.txt"], "patch_list": [{"patch_file": "src/cryptography/hazmat/backends/openssl/rsa.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_enc_dec_rsa_pkey_ctx(backend, key, data, padding_enum, padding):", "Modified_Line": "    res = crypt(pkey_ctx, buf, outlen, data, len(data))\n    if res <= 0:\n-        _handle_rsa_enc_dec_error(backend, key)\n-\n-    return backend._ffi.buffer(buf)[: outlen[0]]\n"},{"Modified_Block_Num": "2", "Modified_Function": "_handle_rsa_enc_dec_error(backend, key):", "Modified_Line": "-    errors = backend._consume_errors_with_text()\n-    if isinstance(key, _RSAPublicKey):\n-        raise ValueError(\n-            \"Data too long for key size. Encrypt less data or use a \"\n-            \"larger key size.\",\n-            errors,\n-        )\n-    else:\n-        raise ValueError(\"Decryption failed.\", errors)\n"}]}]}
{"num": 450, "cve": "CVE-2021-21236", "des": "CairoSVG is a Python (pypi) package. CairoSVG is an SVG converter based on Cairo. In CairoSVG before version 2.5.1, there is a regular expression denial of service (REDoS) vulnerability. When processing SVG files, the python package CairoSVG uses two regular expressions which are vulnerable to Regular Expression Denial of Service (REDoS). If an attacker provides a malicious SVG, it can make cairosvg get stuck processing the file for a very long time. This is fixed in version 2.5.1. See Referenced GitHub advisory for more information.", "cwe_list": ["CWE-400"], "cwe_name_lst": ["Uncontrolled Resource Consumption"], "url": "https://api.github.com/repos/Kozea/CairoSVG/commits/cfc9175e590531d90384aa88845052de53d94bf3", "html_url": "https://github.com/Kozea/CairoSVG/commit/cfc9175e590531d90384aa88845052de53d94bf3", "filename_list": ["./data/python/python_filter/450_0@Kozea@CairoSVG@9c4a982b9a021280ad90e89707eacc1d114e4ac4@cairosvg_colors.py.txt"], "patch_list": [{"patch_file": "cairosvg/colors.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "-RGBA = re.compile(r'rgba\\([ \\n\\r\\t]*(.+?)[ \\n\\r\\t]*\\)')\n-RGB = re.compile(r'rgb\\([ \\n\\r\\t]*(.+?)[ \\n\\r\\t]*\\)')\n"}]}]}
{"num": 451, "cve": "CVE-2021-21330", "des": "aiohttp is an asynchronous HTTP client/server framework for asyncio and Python. In aiohttp before version 3.7.4 there is an open redirect vulnerability. A maliciously crafted link to an aiohttp-based web-server could redirect the browser to a different website. It is caused by a bug in the `aiohttp.web_middlewares.normalize_path_middleware` middleware. This security problem has been fixed in 3.7.4. Upgrade your dependency using pip as follows \"pip install aiohttp >= 3.7.4\". If upgrading is not an option for you, a workaround can be to avoid using `aiohttp.web_middlewares.normalize_path_middleware` in your applications.", "cwe_list": ["CWE-601"], "cwe_name_lst": ["URL Redirection to Untrusted Site ('Open Redirect')"], "url": "https://api.github.com/repos/aio-libs/aiohttp/commits/2545222a3853e31ace15d87ae0e2effb7da0c96b", "html_url": "https://github.com/aio-libs/aiohttp/commit/2545222a3853e31ace15d87ae0e2effb7da0c96b", "filename_list": ["./data/python/python_filter/451_0@aio-libs@aiohttp@f2afa2f054ba9e6c5d142e00233f0073925e7893@aiohttp_web_middlewares.py.txt"], "patch_list": [{"patch_file": "aiohttp/web_middlewares.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "impl(request: Request, handler: _Handler) -> StreamResponse:", "Modified_Line": "            paths_to_check = []\n            if \"?\" in request.raw_path:\n                path, query = request.raw_path.split(\"?\", 1)\n                query = \"?\" + query\n            else:\n                query = \"\"\n                path = request.raw_path\n            for path in paths_to_check:\n                resolves, request = await _check_request_resolves(request, path)\n                if resolves:\n                    raise redirect_class(request.raw_path + query)\n        return await handler(request)\n"}]}]}
{"num": 452, "cve": "CVE-2020-35681", "des": "Django Channels 3.x before 3.0.3 allows remote attackers to obtain sensitive information from a different request scope. The legacy channels.http.AsgiHandler class, used for handling HTTP type requests in an ASGI environment prior to Django 3.0, did not correctly separate request scopes in Channels 3.0. In many cases this would result in a crash but, with correct timing, responses could be sent to the wrong client, resulting in potential leakage of session identifiers and other sensitive data. Note that this affects only the legacy Channels provided class, and not Django's similar ASGIHandler, available from Django 3.0.", "cwe_list": ["CWE-200"], "cwe_name_lst": ["Exposure of Sensitive Information to an Unauthorized Actor"], "url": "https://api.github.com/repos/django/channels/commits/e85874d9630474986a6937430eac52db79a2a022", "html_url": "https://github.com/django/channels/commit/e85874d9630474986a6937430eac52db79a2a022", "filename_list": ["./data/python/python_filter/452_0@django@channels@945b8ad0196136dc4265eba8ff70f12d5f02520f@channels_http.py.txt"], "patch_list": [{"patch_file": "channels/http.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "__call__(self, scope, receive, send):", "Modified_Line": "-        self.scope = scope\n-        self.send = async_to_sync(send)\n-        await self.handle(body_stream)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "handle(self, body):", "Modified_Line": "-        script_prefix = self.scope.get(\"root_path\", \"\") or \"\"\n-        signals.request_started.send(sender=self.__class__, scope=self.scope)\n        try:\n-            request = self.request_class(self.scope, body)\n"}]}]}
{"num": 453, "cve": "CVE-2021-27213", "des": "config.py in pystemon before 2021-02-13 allows code execution via YAML deserialization because SafeLoader and safe_load are not used.", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/cvandeplas/pystemon/commits/dbeb87afefdb63de2f4cff69b6f10c5965d14b54", "html_url": "https://github.com/cvandeplas/pystemon/commit/dbeb87afefdb63de2f4cff69b6f10c5965d14b54", "filename_list": ["./data/python/python_filter/453_0@cvandeplas@pystemon@8ea148589d3b8c860436b816b85b99b25fae9995@pystemon_config.py.txt"], "patch_list": [{"patch_file": "pystemon/config.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_load_yamlconfig(self, configfile):", "Modified_Line": "        yamlconfig = None\n        try:\n            if self._recent_pyyaml():\n-                yamlconfig = yaml.load(open(configfile), Loader=yaml.FullLoader)\n            else:\n-                yamlconfig = yaml.load(open(configfile))\n        for includes in yamlconfig.get(\"includes\", []):\n            try:\n-                yamlconfig.update(yaml.load(open(includes)))\n        return yamlconfig\n"}]}]}
{"num": 456, "cve": "CVE-2021-21386", "des": "APKLeaks is an open-source project for scanning APK file for URIs, endpoints & secrets. APKLeaks prior to v2.0.3 allows remote attackers to execute arbitrary OS commands via package name inside application manifest. An attacker could include arguments that allow unintended commands or code to be executed, allow sensitive data to be read or modified or could cause other unintended behavior through malicious package name. The problem is fixed in version v2.0.6-dev and above.", "cwe_list": ["CWE-78"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "url": "https://api.github.com/repos/dwisiswant0/apkleaks/commits/a966e781499ff6fd4eea66876d7532301b13a382", "html_url": "https://github.com/dwisiswant0/apkleaks/commit/a966e781499ff6fd4eea66876d7532301b13a382", "filename_list": ["./data/python/python_filter/456_0@dwisiswant0@apkleaks@8577b7af6224bf0a5455b552963c46721308d2ff@apkleaks_apkleaks.py.txt"], "patch_list": [{"patch_file": "apkleaks/apkleaks.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "decompile(self):", "Modified_Line": "-\t\tdec = \"%s %s -d %s --deobf\" % (self.jadx, dex, self.tempdir)\n-\t\tos.system(dec)\n"}]}]}
{"num": 458, "cve": "CVE-2021-20270", "des": "An infinite loop in SMLLexer in Pygments versions 1.5 to 2.7.3 may lead to denial of service when performing syntax highlighting of a Standard ML (SML) source file, as demonstrated by input that only contains the \"exception\" keyword.", "cwe_list": ["CWE-835"], "cwe_name_lst": ["Loop with Unreachable Exit Condition ('Infinite Loop')"], "url": "https://api.github.com/repos/pygments/pygments/commits/f91804ff4772e3ab41f46e28d370f57898700333", "html_url": "https://github.com/pygments/pygments/commit/f91804ff4772e3ab41f46e28d370f57898700333", "filename_list": ["./data/python/python_filter/458_0@pygments@pygments@ccd14b98092c7189452cfbe825158c434b90b9cc@pygments_lexers_ml.py.txt"], "patch_list": [{"patch_file": "pygments/lexers/ml.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "id_callback(self, match):", "Modified_Line": "-            (r'(exception|and)\\b(\\s+)(%s)' % alphanumid_re,\n             bygroups(Keyword.Reserved, Text, Name.Class)),\n-            (r'(exception|and)\\b(\\s*)(%s)' % symbolicid_re,\n             bygroups(Keyword.Reserved, Text, Name.Class)),\n            (r'\b(of)\b(?!')', Keyword.Reserved),\n-            include('breakout'),\n-            include('core'),\n-            (r'\\S+', Error),\n"}]}]}
{"num": 464, "cve": "CVE-2021-28363", "des": "The urllib3 library 1.26.x before 1.26.4 for Python omits SSL certificate validation in some cases involving HTTPS to HTTPS proxies. The initial connection to the HTTPS proxy (if an SSLContext isn't given via proxy_config) doesn't verify the hostname of the certificate. This means certificates for different servers that still validate properly with the default urllib3 SSLContext will be silently accepted.", "cwe_list": ["CWE-295"], "cwe_name_lst": ["Improper Certificate Validation"], "url": "https://api.github.com/repos/urllib3/urllib3/commits/8d65ea1ecf6e2cdc27d42124e587c1b83a3118b0", "html_url": "https://github.com/urllib3/urllib3/commit/8d65ea1ecf6e2cdc27d42124e587c1b83a3118b0", "filename_list": ["./data/python/python_filter/464_0@urllib3@urllib3@5e3432646ad63749ff0d655c157fe293cdc6c2aa@src_urllib3_connection.py.txt"], "patch_list": [{"patch_file": "src/urllib3/connection.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_connect_tls_proxy(self, hostname, conn):", "Modified_Line": "        proxy_config = self.proxy_config\n        ssl_context = proxy_config.ssl_context\n        ssl_context = create_proxy_ssl_context(\n            self.ssl_version,\n            self.cert_reqs,\n            self.ca_certs,\n            self.ca_cert_dir,\n            self.ca_cert_data,\n        )\n"}]}]}
{"num": 465, "cve": "CVE-2021-21371", "des": "Tenable for Jira Cloud is an open source project designed to pull Tenable.io vulnerability data, then generate Jira Tasks and sub-tasks based on the vulnerabilities' current state. It published in pypi as \"tenable-jira-cloud\". In tenable-jira-cloud before version 1.1.21, it is possible to run arbitrary commands through the yaml.load() method. This could allow an attacker with local access to the host to run arbitrary code by running the application with a specially crafted YAML configuration file. This is fixed in version 1.1.21 by using yaml.safe_load() instead of yaml.load().", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/tenable/integration-jira-cloud/commits/f8c2095fd529e664e7fa25403a0a4a85bb3907d0", "html_url": "https://github.com/tenable/integration-jira-cloud/commit/f8c2095fd529e664e7fa25403a0a4a85bb3907d0", "filename_list": ["./data/python/python_filter/465_0@tenable@integration-jira-cloud@fa838db45f1ae5581a47e1965f74919c12488cf5@tenable_jira_cli.py.txt"], "patch_list": [{"patch_file": "tenable_jira/cli.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "cli(configfile, observed_since, setup_only=False, troubleshoot=False):", "Modified_Line": "-    config_from_file = yaml.load(configfile, Loader=yaml.Loader)\n"}]}]}
{"num": 466, "cve": "CVE-2021-21360", "des": "Products.GenericSetup is a mini-framework for expressing the configured state of a Zope Site as a set of filesystem artifacts. In Products.GenericSetup before version 2.1.1 there is an information disclosure vulnerability - anonymous visitors may view log and snapshot files generated by the Generic Setup Tool. The problem has been fixed in version 2.1.1. Depending on how you have installed Products.GenericSetup, you should change the buildout version pin to 2.1.1 and re-run the buildout, or if you used pip simply do pip install `\"Products.GenericSetup>=2.1.1\"`.", "cwe_list": ["CWE-200"], "cwe_name_lst": ["Exposure of Sensitive Information to an Unauthorized Actor"], "url": "https://api.github.com/repos/zopefoundation/Products.GenericSetup/commits/700319512b3615b3871a1f24e096cf66dc488c57", "html_url": "https://github.com/zopefoundation/Products.GenericSetup/commit/700319512b3615b3871a1f24e096cf66dc488c57", "filename_list": ["./data/python/python_filter/466_0@zopefoundation@Products.GenericSetup@835c1ac23e18b7b6f8b7facd5caebe0e997d3500@src_Products_GenericSetup_context.py.txt"], "patch_list": [{"patch_file": "src/Products/GenericSetup/context.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "writeDataFile(self, filename, text, content_type, subdir=None):", "Modified_Line": "        folder = self._ensureSnapshotsFolder(subdir)\n        ob = self._createObjectByType(filename, text, content_type)\n        folder._setObject(str(filename), ob)  # No Unicode IDs!\n"}, {"Modified_Block_Num": "2", "Modified_Function": "_ensureSnapshotsFolder(self, subdir=None):", "Modified_Line": "        path = ['snapshots', self._snapshot_id]\n        current = self._tool\n        for element in path:\n-            current = current._getOb(element)\n"}]}]}
{"num": 468, "cve": "CVE-2021-21337", "des": "Products.PluggableAuthService is a pluggable Zope authentication and authorization framework. In Products.PluggableAuthService before version 2.6.0 there is an open redirect vulnerability. A maliciously crafted link to the login form and login functionality could redirect the browser to a different website. The problem has been fixed in version 2.6.1. Depending on how you have installed Products.PluggableAuthService, you should change the buildout version pin to `2.6.1` and re-run the buildout, or if you used `pip` simply do `pip install \"Products.PluggableAuthService>=2.6.1\".", "cwe_list": ["CWE-601"], "cwe_name_lst": ["URL Redirection to Untrusted Site ('Open Redirect')"], "url": "https://api.github.com/repos/zopefoundation/Products.PluggableAuthService/commits/7eead067898852ebd3e0f143bc51295928528dfa", "html_url": "https://github.com/zopefoundation/Products.PluggableAuthService/commit/7eead067898852ebd3e0f143bc51295928528dfa", "filename_list": ["./data/python/python_filter/468_0@zopefoundation@Products.PluggableAuthService@c49ddb0f2770cab57f76475f4571e8e842181b87@src_Products_PluggableAuthService_plugins_CookieAuthHelper.py.txt"], "patch_list": [{"patch_file": "src/Products/PluggableAuthService/plugins/CookieAuthHelper.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "unauthorized(self):", "Modified_Line": "        url = self.getLoginURL()\n        if url is not None:\n            came_from = req.get('came_from', None)\n            url = '%s%scame_from=%s' % (url, sep, quote(came_from))\n            resp.redirect(url, lock=1)\n"}]}]}
{"num": 469, "cve": "CVE-2021-21336", "des": "Products.PluggableAuthService is a pluggable Zope authentication and authorization framework. In Products.PluggableAuthService before version 2.6.0 there is an information disclosure vulnerability - everyone can list the names of roles defined in the ZODB Role Manager plugin if the site uses this plugin. The problem has been fixed in version 2.6.0. Depending on how you have installed Products.PluggableAuthService, you should change the buildout version pin to 2.6.0 and re-run the buildout, or if you used pip simply do `pip install \"Products.PluggableAuthService>=2.6.0\"`.", "cwe_list": ["CWE-200"], "cwe_name_lst": ["Exposure of Sensitive Information to an Unauthorized Actor"], "url": "https://api.github.com/repos/zopefoundation/Products.PluggableAuthService/commits/2dad81128250cb2e5d950cddc9d3c0314a80b4bb", "html_url": "https://github.com/zopefoundation/Products.PluggableAuthService/commit/2dad81128250cb2e5d950cddc9d3c0314a80b4bb", "filename_list": ["./data/python/python_filter/469_0@zopefoundation@Products.PluggableAuthService@7eead067898852ebd3e0f143bc51295928528dfa@src_Products_PluggableAuthService_plugins_ZODBRoleManager.py.txt"], "patch_list": [{"patch_file": "src/Products/PluggableAuthService/plugins/ZODBRoleManager.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "enumerateRoles(self, id=None, exact_match=False, sort_by=None,", "Modified_Line": "        role_info = []\n        role_ids = []\n        plugin_id = self.getId()\n        if isinstance(id, str):\n            id = [id]\n        if exact_match and (id):\n            role_ids.extend(id)\n        if role_ids:\n            role_filter = None\n        else:   # Searching\n            role_ids = self.listRoleIds()\n            role_filter = _ZODBRoleFilter(id, **kw)\n        for role_id in role_ids:\n            if self._roles.get(role_id):\n                e_url = '%s/manage_roles' % self.getId()\n                p_qs = 'role_id=%s' % role_id\n                m_qs = 'role_id=%s&assign=1' % role_id\n                info = {}\n                info.update(self._roles[role_id])\n                info['pluginid'] = plugin_id\n                info['properties_url'] = '%s?%s' % (e_url, p_qs)\n                info['members_url'] = '%s?%s' % (e_url, m_qs)\n                if not role_filter or role_filter(info):\n                    role_info.append(info)\n        return tuple(role_info)\n"}]}]}
{"num": 472, "cve": "CVE-2021-20228", "des": "A flaw was found in the Ansible Engine 2.9.18, where sensitive info is not masked by default and is not protected by the no_log feature when using the sub-option feature of the basic.py module. This flaw allows an attacker to obtain sensitive information. The highest threat from this vulnerability is to confidentiality.", "cwe_list": ["CWE-200"], "cwe_name_lst": ["Exposure of Sensitive Information to an Unauthorized Actor"], "url": "https://api.github.com/repos/ansible/ansible/commits/0cdc410dce6658e93c06fa27e0100ddbb11e7015", "html_url": "https://github.com/ansible/ansible/commit/0cdc410dce6658e93c06fa27e0100ddbb11e7015", "filename_list": ["./data/python/python_filter/472_0@ansible@ansible@4315e1880742eedc5b65fdc51fdc6a94afa61bd1@lib_ansible_module_utils_basic.py.txt"], "patch_list": [{"patch_file": "lib/ansible/module_utils/basic.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_set_defaults(self, pre=True, spec=None, param=None):", "Modified_Line": "        for (k, v) in spec.items():\n            default = v.get('default', None)\n-            if pre is True:\n-                if default is not None and k not in param:\n-                    param[k] = default\n-            else:\n-                if k not in param:\n-                    param[k] = default\n"}]}]}
{"num": 473, "cve": "CVE-2020-36324", "des": "Wikimedia Quarry analytics-quarry-web before 2020-12-15 allows Reflected XSS because app.py does not explicitly set the application/json content type.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/wikimedia/analytics-quarry-web/commits/4b7e1d6a3a52ec6cf826a971135a38b0f74785d2", "html_url": "https://github.com/wikimedia/analytics-quarry-web/commit/4b7e1d6a3a52ec6cf826a971135a38b0f74785d2", "filename_list": ["./data/python/python_filter/473_0@wikimedia@analytics-quarry-web@085a51b2dee8b58882276d9fe090174252edb85e@quarry_web_app.py.txt"], "patch_list": [{"patch_file": "quarry/web/app.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "pref_get(key):", "Modified_Line": "    if key in get_preferences():\n-        return Response(json.dumps({'key': key, 'value': get_preferences()[key]}))\n    else:\n-        return Response(json.dumps({'key': key, 'error': 'novalue'}))\n"}, {"Modified_Block_Num": "2", "Modified_Function": "pref_set(key, value):", "Modified_Line": "    get_preferences()[key] = (None if value == 'null' else value)\n-    return Response(json.dumps({'key': key, 'success': ''})), 201\n"}]}]}
{"num": 474, "cve": "CVE-2021-29430", "des": "Sydent is a reference Matrix identity server. Sydent does not limit the size of requests it receives from HTTP clients. A malicious user could send an HTTP request with a very large body, leading to memory exhaustion and denial of service. Sydent also does not limit response size for requests it makes to remote Matrix homeservers. A malicious homeserver could return a very large response, again leading to memory exhaustion and denial of service. This affects any server which accepts registration requests from untrusted clients. This issue has been patched by releases 89071a1, 0523511, f56eee3. As a workaround request sizes can be limited in an HTTP reverse-proxy. There are no known workarounds for the problem with overlarge responses.", "cwe_list": ["CWE-770"], "cwe_name_lst": ["Allocation of Resources Without Limits or Throttling"], "url": "https://api.github.com/repos/matrix-org/sydent/commits/0523511d2fb40f2738f8a8549868f44b96e5dab7", "html_url": "https://github.com/matrix-org/sydent/commit/0523511d2fb40f2738f8a8549868f44b96e5dab7", "filename_list": ["./data/python/python_filter/474_1@matrix-org@sydent@4d96e71bfe036e946d0335b729e1c4cff3093645@sydent_http_matrixfederationagent.py.txt"], "patch_list": [{"patch_file": "sydent/http/matrixfederationagent.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_do_get_well_known(self, server_name):", "Modified_Line": "        uri = b\"https://%s/.well-known/matrix/server\" % (server_name, )\n        try:\n            response = yield self._well_known_agent.request(b\"GET\", uri)\n-            body = yield readBody(response)\n"}]}]}
{"num": 475, "cve": "CVE-2021-29431", "des": "Sydent is a reference Matrix identity server. Sydent can be induced to send HTTP GET requests to internal systems, due to lack of parameter validation or IP address blacklisting. It is not possible to exfiltrate data or control request headers, but it might be possible to use the attack to perform an internal port enumeration. This issue has been addressed in in 9e57334, 8936925, 3d531ed, 0f00412. A potential workaround would be to use a firewall to ensure that Sydent cannot reach internal HTTP resources.", "cwe_list": ["CWE-20"], "cwe_name_lst": ["Improper Input Validation"], "url": "https://api.github.com/repos/matrix-org/sydent/commits/0f00412017f25619bc36c264b29ea96808bf310a", "html_url": "https://github.com/matrix-org/sydent/commit/0f00412017f25619bc36c264b29ea96808bf310a", "filename_list": ["./data/python/python_filter/475_3@matrix-org@sydent@29e7f4fed0c59716ebc8cf745f80069ebee9ef74@sydent_util_stringutils.py.txt"], "patch_list": [{"patch_file": "sydent/util/stringutils.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "is_valid_client_secret(client_secret):", "Modified_Line": "-    host_parts = string.split(\":\", 1)\n-    if len(host_parts) == 1:\n-        return hostname_regex.match(string) is not None\n-    else:\n-        host, port = host_parts\n-        valid_hostname = hostname_regex.match(host) is not None\n-        try:\n            port_num = int(port)\n-            valid_port = (\n-                port == str(port_num)  # exclude things like '08090' or ' 8090'\n-                and 1 <= port_num < 65536)\n-        except ValueError:\n-            valid_port = False\n-        return valid_hostname and valid_port\n"}]}]}
{"num": 476, "cve": "CVE-2021-29433", "des": "Sydent is a reference Matrix identity server. In Sydent versions 2.2.0 and prior, sissing input validation of some parameters on the endpoints used to confirm third-party identifiers could cause excessive use of disk space and memory leading to resource exhaustion. A patch for the vulnerability is in version 2.3.0. No workarounds are known to exist.", "cwe_list": ["CWE-20"], "cwe_name_lst": ["Improper Input Validation"], "url": "https://api.github.com/repos/matrix-org/sydent/commits/3175fd358ebc2c310eab7a3dbf296ce2bd54c1da", "html_url": "https://github.com/matrix-org/sydent/commit/3175fd358ebc2c310eab7a3dbf296ce2bd54c1da", "filename_list": ["./data/python/python_filter/476_0@matrix-org@sydent@23ced7cf01fee201569d24bc33285e297afd6ca3@sydent_http_servlets_emailservlet.py.txt", "./data/python/python_filter/476_1@matrix-org@sydent@23ced7cf01fee201569d24bc33285e297afd6ca3@sydent_http_servlets_store_invite_servlet.py.txt", "./data/python/python_filter/476_2@matrix-org@sydent@23ced7cf01fee201569d24bc33285e297afd6ca3@sydent_util_stringutils.py.txt"], "patch_list": [{"patch_file": "sydent/http/servlets/emailservlet.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "render_POST(self, request):", "Modified_Line": "        args = get_args(request, ('email', 'client_secret', 'send_attempt'))\n        email = args['email']\n        sendAttempt = args['send_attempt']\n        clientSecret = args['client_secret']\n        ipaddress = self.sydent.ip_from_request(request)\n        brand = self.sydent.brand_from_request(request)\n        nextLink = None\n        if 'next_link' in args and not args['next_link'].startswith(\"file:///\"):\n            nextLink = args['next_link']\n        try:\n            sid = self.sydent.validators.email.requestToken(\n                email, clientSecret, sendAttempt, nextLink, ipaddress=ipaddress, brand=brand,\n            )\n            resp = {'sid': str(sid)}\n        return resp\n"}]}, {"patch_file": "sydent/http/servlets/store_invite_servlet.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "render_POST(self, request):", "Modified_Line": "        args = get_args(request, (\"medium\", \"address\", \"room_id\", \"sender\",))\n        medium = args[\"medium\"]\n        address = args[\"address\"]\n        roomId = args[\"room_id\"]\n        sender = args[\"sender\"]\n        verified_sender = None\n        mxid = globalAssocStore.getMxid(medium, address)\n        token = self._randomString(128)\n        tokenStore.storeToken(medium, address, roomId, sender, token)\n"}]}, {"patch_file": "sydent/util/stringutils.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "-client_secret_regex = re.compile(r\"^[0-9a-zA-Z\\.\\=\\_\\-]+$\")\n"}, {"Modified_Block_Num": "2", "Modified_Function": "is_valid_client_secret(client_secret):", "Modified_Line": "-    return client_secret_regex.match(client_secret) is not None\n"}]}]}
{"num": 479, "cve": "CVE-2021-21433", "des": "Discord Recon Server is a bot that allows you to do your reconnaissance process from your Discord. Remote code execution in version 0.0.1 would allow remote users to execute commands on the server resulting in serious issues. This flaw is patched in 0.0.2.", "cwe_list": ["CWE-78"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "url": "https://api.github.com/repos/DEMON1A/Discord-Recon/commits/26e2a084679679cccdeeabbb6889ce120eff7e50", "html_url": "https://github.com/DEMON1A/Discord-Recon/commit/26e2a084679679cccdeeabbb6889ce120eff7e50", "filename_list": ["./data/python/python_filter/479_0@DEMON1A@Discord-Recon@a6996fb801df313173453084525cdb3973a89c0b@app.py.txt"], "patch_list": [{"patch_file": "app.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "dirsearch(ctx , *, argument):", "Modified_Line": "    Path = TOOLS['dirsearch']; MainPath = getcwd(); chdir(Path)\n    await ctx.send(f\"**Running Your Dirsearch Scan, We Will Send The Results When It's Done**\")\n    Process = subprocess.Popen(f'python3 dirsearch.py -u {argument} -e * -b' , shell=True,stdout=subprocess.PIPE,stderr=subprocess.STDOUT)\n    Output = Process.communicate()[0].decode('UTF-8')\n    Output = removeColors.Remove(Output); chdir(MainPath)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "arjun(ctx , *, argument):", "Modified_Line": "    Path = TOOLS['arjun']; MainPath = getcwd(); chdir(Path)\n    await ctx.send(f\"**Running Your Arjun Scan, We Will Send The Results When It's Done**\")\n    await ctx.send(f\"**Note: The Bot Won't Respond Until The Scan is Done. All Of Your Commands Now Will Be Executed After This Process is Done.\")\n    Process = subprocess.Popen(f'python3 arjun.py -u {argument}' , shell=True,stdout=subprocess.PIPE,stderr=subprocess.STDOUT)\n    Output = Process.communicate()[0].decode('UTF-8')\n    Output = removeColors.Remove(Output); chdir(MainPath)\n    Output = removeString.removeString('Processing' , Output=Output)\n"}]}]}
{"num": 480, "cve": "CVE-2021-32646", "des": "Roomer is a discord bot cog (extension) which provides automatic voice channel generation as well as private voice and text channels. A vulnerability has been discovered allowing discord users to get the ``manage channel`` permissions in a private VC they have joined. This allowed them to make changes to or delete the voice channel they have taken over. The exploit does not allow access or control to any other channels in the server. Upgrade to version 1.0.1 for a patched version of the cog. As a workaround you may disable private VCs in your guild(server) or unload the roomer cog to render the exploit unusable.", "cwe_list": ["CWE-287"], "cwe_name_lst": ["Improper Authentication"], "url": "https://api.github.com/repos/Dav-Git/Dav-Cogs/commits/fbe2ae8ec851a2e9e3e2370db3b812f268e8c8cb", "html_url": "https://github.com/Dav-Git/Dav-Cogs/commit/fbe2ae8ec851a2e9e3e2370db3b812f268e8c8cb", "filename_list": ["./data/python/python_filter/480_0@Dav-Git@Dav-Cogs@3168cd380bd307234780376d254647962a84cab5@roomer_roomer.py.txt"], "patch_list": [{"patch_file": "roomer/roomer.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "hidden(self, ctx: commands.Context, true_or_false: Optional[bool] = Tr", "Modified_Line": "-                    ov = {\n-                        ctx.guild.default_role: discord.PermissionOverwrite(\n-                            view_channel=False, connect=False\n-                        ),\n-                        ctx.author: discord.PermissionOverwrite(\n-                            view_channel=True, connect=True, speak=True, manage_channels=True\n-                        ),\n-                    }\n"}]}]}
{"num": 482, "cve": "CVE-2020-10729", "des": "A flaw was found in the use of insufficiently random values in Ansible. Two random password lookups of the same length generate the equal value as the template caching action for the same file since no re-evaluation happens. The highest threat from this vulnerability would be that all passwords are exposed at once for the file. This flaw affects Ansible Engine versions before 2.9.6.", "cwe_list": ["CWE-330"], "cwe_name_lst": ["Use of Insufficiently Random Values"], "url": "https://api.github.com/repos/ansible/ansible/commits/b38603c45ed3a53574ec2080fb3a24db38ab5bc6", "html_url": "https://github.com/ansible/ansible/commit/b38603c45ed3a53574ec2080fb3a24db38ab5bc6", "filename_list": ["./data/python/python_filter/482_0@ansible@ansible@48bfa3e906da4ce85b55e15ac6ed8a470193d723@lib_ansible_template___init__.py.txt"], "patch_list": [{"patch_file": "lib/ansible/template/__init__.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "template(self, variable, convert_bare=False, preserve_trailing_newlines=True", "Modified_Line": "-                        if cache:\n                            self._cached_result[sha1_hash] = result\n"}]}]}
{"num": 572, "cve": "CVE-2021-23393", "des": "This affects the package Flask-Unchained before 0.9.0. When using the the _validate_redirect_url function, it is possible to bypass URL validation and redirect a user to an arbitrary URL by providing multiple back slashes such as \\\\\\evil.com/path. This vulnerability is only exploitable if an alternative WSGI server other than Werkzeug is used, or the default behaviour of Werkzeug is modified using 'autocorrect_location_header=False.", "cwe_list": ["CWE-601"], "cwe_name_lst": ["URL Redirection to Untrusted Site ('Open Redirect')"], "url": "https://api.github.com/repos/briancappello/flask-unchained/commits/71e36b28166f9ffbe0a991f51127f0984f7e6a40", "html_url": "https://github.com/briancappello/flask-unchained/commit/71e36b28166f9ffbe0a991f51127f0984f7e6a40", "filename_list": ["./data/python/python_filter/572_0@briancappello@flask-unchained@2bfeedf1bc31df851cab8c66df0c432b10406aad@flask_unchained_bundles_controller_utils.py.txt"], "patch_list": [{"patch_file": "flask_unchained/bundles/controller/utils.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "redirect(where: Optional[str] = None,", "Modified_Line": "    urls = [url_for(request.args.get('next'), **flask_url_for_kwargs),\n            url_for(request.form.get('next'), **flask_url_for_kwargs)]\n    for url in urls:\n        if _validate_redirect_url(url, _external_host):\n            return flask_redirect(encode_non_url_reserved_characters(url))\n    return flask_redirect('/')\n"}]}]}
{"num": 573, "cve": "CVE-2021-32677", "des": "FastAPI is a web framework for building APIs with Python 3.6+ based on standard Python type hints. FastAPI versions lower than 0.65.2 that used cookies for authentication in path operations that received JSON payloads sent by browsers were vulnerable to a Cross-Site Request Forgery (CSRF) attack. In versions lower than 0.65.2, FastAPI would try to read the request payload as JSON even if the content-type header sent was not set to application/json or a compatible JSON media type (e.g. application/geo+json). A request with a content type of text/plain containing JSON data would be accepted and the JSON data would be extracted. Requests with content type text/plain are exempt from CORS preflights, for being considered Simple requests. The browser will execute them right away including cookies, and the text content could be a JSON string that would be parsed and accepted by the FastAPI application. This is fixed in FastAPI 0.65.2. The request data is now parsed as JSON only if the content-type header is application/json or another JSON compatible media type like application/geo+json. It's best to upgrade to the latest FastAPI, but if updating is not possible then a middleware or a dependency that checks the content-type header and aborts the request if it is not application/json or another JSON compatible content type can act as a mitigating workaround.", "cwe_list": ["CWE-352"], "cwe_name_lst": ["Cross-Site Request Forgery (CSRF)"], "url": "https://api.github.com/repos/tiangolo/fastapi/commits/fa7e3c996edf2d5482fff8f9d890ac2390dede4d", "html_url": "https://github.com/tiangolo/fastapi/commit/fa7e3c996edf2d5482fff8f9d890ac2390dede4d", "filename_list": ["./data/python/python_filter/573_0@tiangolo@fastapi@90120dd6e83d997fa2f7f54119a2e0cf906b1ded@fastapi_routing.py.txt"], "patch_list": [{"patch_file": "fastapi/routing.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "app(request: Request) -> Response:", "Modified_Line": "-            body = None\n            if body_field:\n                if is_body_form:\n                    body = await request.form()\n                else:\n                    body_bytes = await request.body()\n                    if body_bytes:\n-                        body = await request.json()\n"}]}]}
{"num": 574, "cve": "CVE-2021-29621", "des": "Flask-AppBuilder is a development framework, built on top of Flask. User enumeration in database authentication in Flask-AppBuilder <= 3.2.3. Allows for a non authenticated user to enumerate existing accounts by timing the response time from the server when you are logging in. Upgrade to version 3.3.0 or higher to resolve.", "cwe_list": ["CWE-203"], "cwe_name_lst": ["Observable Discrepancy"], "url": "https://api.github.com/repos/dpgaspar/Flask-AppBuilder/commits/780bd0e8fbf2d36ada52edb769477e0a4edae580", "html_url": "https://github.com/dpgaspar/Flask-AppBuilder/commit/780bd0e8fbf2d36ada52edb769477e0a4edae580", "filename_list": ["./data/python/python_filter/574_0@dpgaspar@Flask-AppBuilder@b60dea9cedf98b56c926ba41020c73f287d5826e@flask_appbuilder_security_manager.py.txt"], "patch_list": [{"patch_file": "flask_appbuilder/security/manager.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "auth_user_db(self, username, password):", "Modified_Line": "        user = self.find_user(username=username)\n        if user is None or (not user.is_active):\n            log.info(LOGMSG_WAR_SEC_LOGIN_FAILED.format(username))\n            return None\n"}]}]}
{"num": 575, "cve": "CVE-2021-32807", "des": "The module `AccessControl` defines security policies for Python code used in restricted code within Zope applications. Restricted code is any code that resides in Zope's object database, such as the contents of `Script (Python)` objects. The policies defined in `AccessControl` severely restrict access to Python modules and only exempt a few that are deemed safe, such as Python's `string` module. However, full access to the `string` module also allows access to the class `Formatter`, which can be overridden and extended within `Script (Python)` in a way that provides access to other unsafe Python libraries. Those unsafe Python libraries can be used for remote code execution. By default, you need to have the admin-level Zope \"Manager\" role to add or edit `Script (Python)` objects through the web. Only sites that allow untrusted users to add/edit these scripts through the web - which would be a very unusual configuration to begin with - are at risk. The problem has been fixed in AccessControl 4.3 and 5.2. Only AccessControl versions 4 and 5 are vulnerable, and only on Python 3, not Python 2.7. As a workaround, a site administrator can restrict adding/editing `Script (Python)` objects through the web using the standard Zope user/role permission mechanisms. Untrusted users should not be assigned the Zope Manager role and adding/editing these scripts through the web should be restricted to trusted users only. This is the default configuration in Zope.", "cwe_list": ["CWE-1321"], "cwe_name_lst": ["Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution')"], "url": "https://api.github.com/repos/zopefoundation/AccessControl/commits/b42dd4badf803bb9fb71ac34cd9cb0c249262f2c", "html_url": "https://github.com/zopefoundation/AccessControl/commit/b42dd4badf803bb9fb71ac34cd9cb0c249262f2c", "filename_list": ["./data/python/python_filter/575_0@zopefoundation@AccessControl@5af868c32ff1104b1bdc9734e46092515d75bd64@src_AccessControl_ZopeGuards.py.txt"], "patch_list": [{"patch_file": "src/AccessControl/ZopeGuards.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "string.__allow_access_to_unprotected_subobjects__ = 1\nmath.__allow_access_to_unprotected_subobjects__ = 1\nrandom.__allow_access_to_unprotected_subobjects__ = 1\n"}]}]}
{"num": 579, "cve": "CVE-2021-39163", "des": "Matrix is an ecosystem for open federated Instant Messaging and Voice over IP. In versions 1.41.0 and prior, unauthorised users can access the name, avatar, topic and number of members of a room if they know the ID of the room. This vulnerability is limited to homeservers where the vulnerable homeserver is in the room and untrusted users are permitted to create groups (communities). By default, only homeserver administrators can create groups. However, homeserver administrators can already access this information in the database or using the admin API. As a result, only homeservers where the configuration setting `enable_group_creation` has been set to `true` are impacted. Server administrators should upgrade to 1.41.1 or higher to patch the vulnerability. There are two potential workarounds. Server administrators can set `enable_group_creation` to `false` in their homeserver configuration (this is the default value) to prevent creation of groups by non-administrators. Administrators that are using a reverse proxy could, with partial loss of group functionality, block the endpoints `/_matrix/client/r0/groups/{group_id}/rooms` and `/_matrix/client/unstable/groups/{group_id}/rooms`.", "cwe_list": ["CWE-200"], "cwe_name_lst": ["Exposure of Sensitive Information to an Unauthorized Actor"], "url": "https://api.github.com/repos/matrix-org/synapse/commits/cb35df940a828bc40b96daed997b5ad4c7842fd3", "html_url": "https://github.com/matrix-org/synapse/commit/cb35df940a828bc40b96daed997b5ad4c7842fd3", "filename_list": ["./data/python/python_filter/579_0@matrix-org@synapse@52c7a51cfc568ed61d800df99dcca25dc3b5fe3e@synapse_groups_groups_server.py.txt"], "patch_list": [{"patch_file": "synapse/groups/groups_server.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_rooms_in_group(", "Modified_Line": "            entry = await self.room_list_handler.generate_room_entry(\n-                room_id, len(joined_users), with_alias=False, allow_private=True\n"}]}]}
{"num": 580, "cve": "CVE-2021-39160", "des": "nbgitpuller is a Jupyter server extension to sync a git repository one-way to a local path. Due to unsanitized input, visiting maliciously crafted links could result in arbitrary code execution in the user environment. This has been resolved in version 0.10.2 and all users are advised to upgrade. No work around exist for users who can not upgrade.", "cwe_list": ["CWE-78"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "url": "https://api.github.com/repos/jupyterhub/nbgitpuller/commits/07690644f29a566011dd0d7ba14cae3eb0490481", "html_url": "https://github.com/jupyterhub/nbgitpuller/commit/07690644f29a566011dd0d7ba14cae3eb0490481", "filename_list": ["./data/python/python_filter/580_0@jupyterhub@nbgitpuller@2cad6147f1769a962f8d0733045967663add53cb@nbgitpuller_pull.py.txt"], "patch_list": [{"patch_file": "nbgitpuller/pull.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "branch_exists(self, branch):", "Modified_Line": "        try:\n            heads = subprocess.run(\n-                [\"git\", \"ls-remote\", \"--heads\", self.git_url],\n                capture_output=True,\n                text=True,\n                check=True\n            )\n            tags = subprocess.run(\n-                [\"git\", \"ls-remote\", \"--tags\", self.git_url],\n                capture_output=True,\n                text=True,\n                check=True\n            )\n"}, {"Modified_Block_Num": "2", "Modified_Function": "resolve_default_branch(self):", "Modified_Line": "        try:\n            head_branch = subprocess.run(\n-                [\"git\", \"ls-remote\", \"--symref\", self.git_url, \"HEAD\"],\n                capture_output=True,\n                text=True,\n                check=True\n            )\n"}, {"Modified_Block_Num": "3", "Modified_Function": "initialize_repo(self):", "Modified_Line": "        logging.info('Repo {} doesn't exist. Cloning...'.format(self.repo_dir))\n        clone_args = ['git', 'clone']\n        if self.depth and self.depth > 0:\n            clone_args.extend(['--depth', str(self.depth)])\n        clone_args.extend(['--branch', self.branch_name])\n-        clone_args.extend([self.git_url, self.repo_dir])\n"}]}]}
{"num": 581, "cve": "CVE-2021-38598", "des": "OpenStack Neutron before 16.4.1, 17.x before 17.1.3, and 18.0.0 allows hardware address impersonation when the linuxbridge driver with ebtables-nft is used on a Netfilter-based platform. By sending carefully crafted packets, anyone in control of a server instance connected to the virtual switch can impersonate the hardware addresses of other systems on the network, resulting in denial of service or in some cases possibly interception of traffic intended for other destinations.", "cwe_list": ["CWE-290"], "cwe_name_lst": ["Authentication Bypass by Spoofing"], "url": "https://api.github.com/repos/openstack/neutron/commits/fafa5dacd5057120562184a734e7345e7c0e9639", "html_url": "https://github.com/openstack/neutron/commit/fafa5dacd5057120562184a734e7345e7c0e9639", "filename_list": ["./data/python/python_filter/581_0@openstack@neutron@7e28f395220ac7f8f060b7771b1c7f0299f16969@neutron_plugins_ml2_drivers_linuxbridge_agent_arp_protect.py.txt"], "patch_list": [{"patch_file": "neutron/plugins/ml2/drivers/linuxbridge/agent/arp_protect.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_delete_unreferenced_arp_protection(current_vifs, table, chain):", "Modified_Line": "-    current_rules = ebtables(['-L'], table=table).splitlines()\n    to_delete = []\n    for line in current_rules:\n        if line.startswith('Bridge chain: %s' % SPOOF_CHAIN_PREFIX):\n            devname = line.split(SPOOF_CHAIN_PREFIX, 1)[1].split(',')[0]\n            if devname not in current_vifs:\n                to_delete.append(devname)\n    LOG.info(\"Clearing orphaned ARP spoofing entries for devices %s\",\n             to_delete)\n-    _delete_arp_spoofing_protection(to_delete, current_rules, table=table,\n-                                    chain=chain)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "delete_unreferenced_arp_protection(current_vifs):", "Modified_Line": "-    _delete_unreferenced_arp_protection(current_vifs,\n-                                        table='nat', chain='PREROUTING')\n-    _delete_unreferenced_arp_protection(current_vifs,\n-                                        table='filter', chain='FORWARD')\n"}, {"Modified_Block_Num": "3", "Modified_Function": "_install_arp_spoofing_protection(vif, addresses, current_rules):", "Modified_Line": "    vif_chain = chain_name(vif)\n    if not chain_exists(vif_chain, current_rules):\n        ebtables(['-N', vif_chain, '-P', 'DROP'])\n-    ebtables(['-F', vif_chain])\n    for addr in sorted(addresses):\n-        ebtables(['-A', vif_chain, '-p', 'ARP', '--arp-ip-src', addr,\n"}, {"Modified_Block_Num": "4", "Modified_Function": "_install_mac_spoofing_protection(vif, port_details, current_rules):", "Modified_Line": "if not _mac_vif_jump_present(vif, current_rules):\n-        ebtables(['-A', 'PREROUTING', '-i', vif, '-j', vif_chain])\n    for chunk in (mac_addresses[i:i + 500]\n                  for i in range(0, len(mac_addresses), 500)):\n-        new_rule = ['-A', vif_chain, '-i', vif,\n                    '--among-src', ','.join(sorted(chunk)), '-j', 'RETURN']\n        ebtables(new_rule)\n-    _delete_vif_mac_rules(vif, current_rules)\n"}]}]}
{"num": 583, "cve": "CVE-2021-37705", "des": "OneFuzz is an open source self-hosted Fuzzing-As-A-Service platform. Starting with OneFuzz 2.12.0 or greater, an incomplete authorization check allows an authenticated user from any Azure Active Directory tenant to make authorized API calls to a vulnerable OneFuzz instance. To be vulnerable, a OneFuzz deployment must be both version 2.12.0 or greater and deployed with the non-default --multi_tenant_domain option. This can result in read/write access to private data such as software vulnerability and crash information, security testing tools and proprietary code and symbols. Via authorized API calls, this also enables tampering with existing data and unauthorized code execution on Azure compute resources. This issue is resolved starting in release 2.31.0, via the addition of application-level check of the bearer token's `issuer` against an administrator-configured allowlist. As a workaround users can restrict access to the tenant of a deployed OneFuzz instance < 2.31.0 by redeploying in the default configuration, which omits the `--multi_tenant_domain` option.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/microsoft/onefuzz/commits/2fcb4998887959b4fa11894a068d689189742cb1", "html_url": "https://github.com/microsoft/onefuzz/commit/2fcb4998887959b4fa11894a068d689189742cb1", "filename_list": ["./data/python/python_filter/583_3@microsoft@onefuzz@ba3a6eab04ea049c712502ad593df25eb98e987e@src_api-service___app___onefuzzlib_user_credentials.py.txt"], "patch_list": [{"patch_file": "src/api-service/__app__/onefuzzlib/user_credentials.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "parse_jwt_token(request: func.HttpRequest) -> Result[UserInfo]:", "Modified_Line": "    token_str = get_auth_token(request)\n    token = jwt.decode(token_str, options={\"verify_signature\": False})\n    application_id = UUID(token[\"appid\"]) if \"appid\" in token else None\n    object_id = UUID(token[\"oid\"]) if \"oid\" in token else None\n    upn = token.get(\"upn\")\n    return UserInfo(application_id=application_id, object_id=object_id, upn=upn)\n"}]}]}
{"num": 595, "cve": "CVE-2021-37678", "des": "TensorFlow is an end-to-end open source platform for machine learning. In affected versions TensorFlow and Keras can be tricked to perform arbitrary code execution when deserializing a Keras model from YAML format. The [implementation](https://github.com/tensorflow/tensorflow/blob/460e000de3a83278fb00b61a16d161b1964f15f4/tensorflow/python/keras/saving/model_config.py#L66-L104) uses `yaml.unsafe_load` which can perform arbitrary code execution on the input. Given that YAML format support requires a significant amount of work, we have removed it for now. We have patched the issue in GitHub commit 23d6383eb6c14084a8fc3bdf164043b974818012. The fix will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow 2.5.1, TensorFlow 2.4.3, and TensorFlow 2.3.4, as these are also affected and still in supported range.", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/tensorflow/tensorflow/commits/23d6383eb6c14084a8fc3bdf164043b974818012", "html_url": "https://github.com/tensorflow/tensorflow/commit/23d6383eb6c14084a8fc3bdf164043b974818012", "filename_list": ["./data/python/python_filter/595_2@tensorflow@tensorflow@e1ec21ffbd969144d7cae7c71561faa970673d76@tensorflow_python_keras_saving_model_config.py.txt"], "patch_list": [{"patch_file": "tensorflow/python/keras/saving/model_config.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "model_from_yaml(yaml_string, custom_objects=None):", "Modified_Line": "-try:\n-  import yaml\n-except ImportError:\n-  yaml = None\n-  if yaml is None:\n-    raise ImportError('Requires yaml module installed (`pip install pyyaml`).')\n-  try:\n-    config = yaml.unsafe_load(yaml_string)\n-  except AttributeError:\n-    config = yaml.load(yaml_string)\n-  from tensorflow.python.keras.layers import deserialize  # pylint: disable=g-import-not-at-top\n-  return deserialize(config, custom_objects=custom_objects)\n"}]}]}
{"num": 652, "cve": "CVE-2021-32806", "des": "Products.isurlinportal is a replacement for isURLInPortal method in Plone. Versions of Products.isurlinportal prior to 1.2.0 have an Open Redirect vulnerability. Various parts of Plone use the 'is url in portal' check for security, mostly to see if it is safe to redirect to a url. A url like `https://example.org` is not in the portal. The url `https:example.org` without slashes is considered to be in the portal. When redirecting, some browsers go to `https://example.org`, others give an error. Attackers may use this to redirect victims to their site, especially as part of a phishing attack. The problem has been patched in Products.isurlinportal 1.2.0.", "cwe_list": ["CWE-601"], "cwe_name_lst": ["URL Redirection to Untrusted Site ('Open Redirect')"], "url": "https://api.github.com/repos/plone/Products.isurlinportal/commits/d4fd34990d18adf05a10dc5e2bb4b066798280ba", "html_url": "https://github.com/plone/Products.isurlinportal/commit/d4fd34990d18adf05a10dc5e2bb4b066798280ba", "filename_list": ["./data/python/python_filter/652_0@plone@Products.isurlinportal@a52a08c32296ea0d2a37075260481fa6f132a050@Products_isurlinportal___init__.py.txt"], "patch_list": [{"patch_file": "Products/isurlinportal/__init__.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "isURLInPortal(self, url, context=None):", "Modified_Line": "url = re.sub(\"^[\u0000- ]+\", \"\", url).strip()\n    cmp_url = url.lower()\n    p_url = self()\n    schema, u_host, u_path, _, _, _ = urlparse(url)\n    unescaped_url = unescape(url)\n    if not u_host and not u_path.startswith(\"/\"):\n        if context is None:\n            return True  # old behavior\n        if not context.isPrincipiaFolderish:\n            useurl = context.aq_parent.absolute_url()\n        else:\n            useurl = context.absolute_url()\n    else:\n        useurl = p_url  # when u_path.startswith('/')\n    if not useurl.endswith(\"/\"):\n        useurl += \"/\"\n    _, u_host, u_path, _, _, _ = urlparse(urljoin(useurl, url))\n    if not u_path:\n        u_path = \"/\"\n    else:\n        u_path = normpath(u_path)\n        if not u_path.endswith(\"/\"):\n            u_path += \"/\"\n    _, host, path, _, _, _ = urlparse(p_url)\n    if not path.endswith(\"/\"):\n        path += \"/\"\n    if host == u_host and u_path.startswith(path):\n        return True\n    for external_site in get_external_sites(self):\n        _, host, path, _, _, _ = urlparse(external_site)\n        if not path.endswith(\"/\"):\n            path += \"/\"\n        if host == u_host and u_path.startswith(path):\n            return True\n    return False\n"}]}]}
{"num": 654, "cve": "CVE-2021-25962", "des": "Shuup application in versions 0.4.2 to 2.10.8 is affected by the Formula Injection vulnerability. A customer can inject payloads in the name input field in the billing address while buying a product. When a store administrator accesses the reports page to export the data as an Excel file and opens it, the payload gets executed.", "cwe_list": ["CWE-1236"], "cwe_name_lst": ["Improper Neutralization of Formula Elements in a CSV File"], "url": "https://api.github.com/repos/shuup/shuup/commits/0a2db392e8518410c282412561461cd8797eea51", "html_url": "https://github.com/shuup/shuup/commit/0a2db392e8518410c282412561461cd8797eea51", "filename_list": ["./data/python/python_filter/654_0@shuup@shuup@32b78119bfb8bb5ac989bd63842261b77b986feb@shuup_reports_writer.py.txt"], "patch_list": [{"patch_file": "shuup/reports/writer.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "write_data_table(self, report, report_data, has_totals=True):", "Modified_Line": "        self.data.append([c[\"title\"] for c in report.schema])\n        for datum in report_data:\n            datum = report.read_datum(datum)\n-            self.data.append([format_data(data, format_iso_dates=True) for data in datum])\n        if has_totals:\n            for datum in report.get_totals(report_data):\n                datum = report.read_datum(datum)\n-                self.data.append([format_data(data) for data in datum])\n"}]}]}
{"num": 655, "cve": "CVE-2021-3828", "des": "nltk is vulnerable to Inefficient Regular Expression Complexity", "cwe_list": ["CWE-697"], "cwe_name_lst": ["Incorrect Comparison"], "url": "https://api.github.com/repos/nltk/nltk/commits/277711ab1dec729e626b27aab6fa35ea5efbd7e6", "html_url": "https://github.com/nltk/nltk/commit/277711ab1dec729e626b27aab6fa35ea5efbd7e6", "filename_list": ["./data/python/python_filter/655_0@nltk@nltk@23f4b1c4b4006b0cb3ec278e801029557cec4e82@nltk_corpus_reader_comparative_sents.py.txt"], "patch_list": [{"patch_file": "nltk/corpus/reader/comparative_sents.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "-KEYWORD = re.compile(r\"\\((?!.*\\()(.*)\\)$\")\n"}]}]}
{"num": 657, "cve": "CVE-2021-32839", "des": "sqlparse is a non-validating SQL parser module for Python. In sqlparse versions 0.4.0 and 0.4.1 there is a regular Expression Denial of Service in sqlparse vulnerability. The regular expression may cause exponential backtracking on strings containing many repetitions of '\\r\\n' in SQL comments. Only the formatting feature that removes comments from SQL statements is affected by this regular expression. As a workaround don't use the sqlformat.format function with keyword strip_comments=True or the --strip-comments command line flag when using the sqlformat command line tool. The issues has been fixed in sqlparse 0.4.2.", "cwe_list": ["CWE-400"], "cwe_name_lst": ["Uncontrolled Resource Consumption"], "url": "https://api.github.com/repos/andialbrecht/sqlparse/commits/8238a9e450ed1524e40cb3a8b0b3c00606903aeb", "html_url": "https://github.com/andialbrecht/sqlparse/commit/8238a9e450ed1524e40cb3a8b0b3c00606903aeb", "filename_list": ["./data/python/python_filter/657_0@andialbrecht@sqlparse@e66046785b816e5c2d22f101f36faefd19c4a771@sqlparse_filters_others.py.txt"], "patch_list": [{"patch_file": "sqlparse/filters/others.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_get_insert_token(token):", "Modified_Line": "-            m = re.search(r'((\\r\\n|\\r|\\n)+) *$', token.value)\n"}]}]}
{"num": 658, "cve": "CVE-2021-39207", "des": "parlai is a framework for training and evaluating AI models on a variety of openly available dialogue datasets. In affected versions the package is vulnerable to YAML deserialization attack caused by unsafe loading which leads to Arbitary code execution. This security bug is patched by avoiding unsafe loader users should update to version above v1.1.0. If upgrading is not possible then users can change the Loader used to SafeLoader as a workaround. See commit 507d066ef432ea27d3e201da08009872a2f37725 for details.", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/facebookresearch/ParlAI/commits/4374fa2aba383db6526ab36e939eb1cf8ef99879", "html_url": "https://github.com/facebookresearch/ParlAI/commit/4374fa2aba383db6526ab36e939eb1cf8ef99879", "filename_list": ["./data/python/python_filter/658_0@facebookresearch@ParlAI@15fbf55f32e64722c452c907425e10fdb977f62e@parlai_crowdsourcing_tasks_model_chat_model_chat_blueprint.py.txt"], "patch_list": [{"patch_file": "parlai/crowdsourcing/tasks/model_chat/model_chat_blueprint.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_get_shared_models(self, args: \"DictConfig\") -> Dict[str, dict]:", "Modified_Line": "        with open(args.blueprint.model_opt_path) as f:\n-            all_model_opts = yaml.load(f.read())\n"}]}]}
{"num": 660, "cve": "CVE-2021-32805", "des": "Flask-AppBuilder is an application development framework, built on top of Flask. In affected versions if using Flask-AppBuilder OAuth, an attacker can share a carefully crafted URL with a trusted domain for an application built with Flask-AppBuilder, this URL can redirect a user to a malicious site. This is an open redirect vulnerability. To resolve this issue upgrade to Flask-AppBuilder 3.2.2 or above. If upgrading is infeasible users may filter HTTP traffic containing `?next={next-site}` where the `next-site` domain is different from the application you are protecting as a workaround.", "cwe_list": ["CWE-601"], "cwe_name_lst": ["URL Redirection to Untrusted Site ('Open Redirect')"], "url": "https://api.github.com/repos/dpgaspar/Flask-AppBuilder/commits/6af28521589599b1dbafd6313256229ee9a4fa74", "html_url": "https://github.com/dpgaspar/Flask-AppBuilder/commit/6af28521589599b1dbafd6313256229ee9a4fa74", "filename_list": ["./data/python/python_filter/660_0@dpgaspar@Flask-AppBuilder@0bc5f1ef9b90a395b435127239b56557d676eb8b@flask_appbuilder_security_views.py.txt"], "patch_list": [{"patch_file": "flask_appbuilder/security/views.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "oauth_authorized(self, provider):", "Modified_Line": "-            try:\n-                next_url = state[\"next\"][0] or self.appbuilder.get_url_for_index\n-            except (KeyError, IndexError):\n-                next_url = self.appbuilder.get_url_for_index\n            return redirect(next_url)\n"}]}]}
{"num": 661, "cve": "CVE-2021-32568", "des": "mrdoc is vulnerable to Deserialization of Untrusted Data", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/zmister2016/MrDoc/commits/bb49e1287700b4e7681eab544c61093821ce72f6", "html_url": "https://github.com/zmister2016/MrDoc/commit/bb49e1287700b4e7681eab544c61093821ce72f6", "filename_list": ["./data/python/python_filter/661_1@zmister2016@MrDoc@ce0c9f1c63b107827f70c1bb47752aad5d22fd42@app_doc_import_utils.py.txt"], "patch_list": [{"patch_file": "app_doc/import_utils.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "read_zip(self,zip_file_path,create_user):", "Modified_Line": "            with open(os.path.join(self.temp_dir ,'mrdoc.yaml'),'r',encoding='utf-8') as yaml_file:\n-                yaml_str = yaml.load(yaml_file.read())\n"}]}]}
{"num": 662, "cve": "CVE-2021-23437", "des": "The package pillow 5.2.0 and before 8.3.2 are vulnerable to Regular Expression Denial of Service (ReDoS) via the getrgb function.", "cwe_list": ["CWE-125"], "cwe_name_lst": ["Out-of-bounds Read"], "url": "https://api.github.com/repos/python-pillow/Pillow/commits/9e08eb8f78fdfd2f476e1b20b7cf38683754866b", "html_url": "https://github.com/python-pillow/Pillow/commit/9e08eb8f78fdfd2f476e1b20b7cf38683754866b", "filename_list": ["./data/python/python_filter/662_0@python-pillow@Pillow@bd5cf7db87c6abf7c3510a50170851af5538249f@src_PIL_ImageColor.py.txt"], "patch_list": [{"patch_file": "src/PIL/ImageColor.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "getrgb(color):", "Modified_Line": "    color = color.lower()\n    rgb = colormap.get(color, None)\n    if rgb:\n        if isinstance(rgb, tuple):\n            return rgb\n        colormap[color] = rgb = getrgb(rgb)\n        return rgb\n"}]}]}
{"num": 664, "cve": "CVE-2021-41185", "des": "Mycodo is an environmental monitoring and regulation system. An exploit in versions prior to 8.12.7 allows anyone with access to endpoints to download files outside the intended directory. A patch has been applied and a release made. Users should upgrade to version 8.12.7. As a workaround, users may manually apply the changes from the fix commit.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/kizniche/Mycodo/commits/23ac5dd422029c2b6ae1701a3599b6d41b66a6a9", "html_url": "https://github.com/kizniche/Mycodo/commit/23ac5dd422029c2b6ae1701a3599b6d41b66a6a9", "filename_list": ["./data/python/python_filter/664_0@kizniche@Mycodo@69acf2646f5e50435e086bd544a9d264adc00edf@mycodo_mycodo_flask_routes_general.py.txt"], "patch_list": [{"patch_file": "mycodo/mycodo_flask/routes_general.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "send_note_attachment(filename):", "Modified_Line": "    file_path = os.path.join(PATH_NOTE_ATTACHMENTS, filename)\n    if file_path is not None:\n        try:\n-            return send_file(file_path, as_attachment=True)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "camera_img_return_path(camera_unique_id, img_type, filename):", "Modified_Line": "    if filename in files:\n        path_file = os.path.join(path, filename)\n-        return send_file(path_file, mimetype='image/jpeg')\n"}]}]}
{"num": 669, "cve": "CVE-2021-41125", "des": "Scrapy is a high-level web crawling and scraping framework for Python. If you use `HttpAuthMiddleware` (i.e. the `http_user` and `http_pass` spider attributes) for HTTP authentication, all requests will expose your credentials to the request target. This includes requests generated by Scrapy components, such as `robots.txt` requests sent by Scrapy when the `ROBOTSTXT_OBEY` setting is set to `True`, or as requests reached through redirects. Upgrade to Scrapy 2.5.1 and use the new `http_auth_domain` spider attribute to control which domains are allowed to receive the configured HTTP authentication credentials. If you are using Scrapy 1.8 or a lower version, and upgrading to Scrapy 2.5.1 is not an option, you may upgrade to Scrapy 1.8.1 instead. If you cannot upgrade, set your HTTP authentication credentials on a per-request basis, using for example the `w3lib.http.basic_auth_header` function to convert your credentials into a value that you can assign to the `Authorization` header of your request, instead of defining your credentials globally using `HttpAuthMiddleware`.", "cwe_list": ["CWE-522"], "cwe_name_lst": ["Insufficiently Protected Credentials"], "url": "https://api.github.com/repos/scrapy/scrapy/commits/b01d69a1bf48060daec8f751368622352d8b85a6", "html_url": "https://github.com/scrapy/scrapy/commit/b01d69a1bf48060daec8f751368622352d8b85a6", "filename_list": ["./data/python/python_filter/669_0@scrapy@scrapy@4183925b4b7114f772883c04e7cef44d766f0f80@scrapy_downloadermiddlewares_httpauth.py.txt"], "patch_list": [{"patch_file": "scrapy/downloadermiddlewares/httpauth.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "spider_opened(self, spider):", "Modified_Line": "        usr = getattr(spider, 'http_user', '')\n        pwd = getattr(spider, 'http_pass', '')\n        if usr or pwd:\n            self.auth = basic_auth_header(usr, pwd)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "process_request(self, request, spider):", "Modified_Line": "        auth = getattr(self, 'auth', None)\n        if auth and b'Authorization' not in request.headers:\n-            request.headers[b'Authorization'] = auth\n"}]}]}
{"num": 672, "cve": "CVE-2021-40325", "des": "Cobbler before 3.3.0 allows authorization bypass for modification of settings.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/cobbler/cobbler/commits/d8f60bbf14a838c8c8a1dba98086b223e35fe70a", "html_url": "https://github.com/cobbler/cobbler/commit/d8f60bbf14a838c8c8a1dba98086b223e35fe70a", "filename_list": ["./data/python/python_filter/672_1@cobbler@cobbler@36c2ba149f8ba005ea30a94439562fd6fd4e9b67@cobbler_remote.py.txt"], "patch_list": [{"patch_file": "cobbler/remote.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "modify_setting(self, setting_name: str, value, token: str) -> int:", "Modified_Line": "        self.check_access(token, \"modify_setting\")\n        self._log(\"modify_setting(%s)\" % setting_name, token=token)\n        try:\n            if isinstance(getattr(self.api.settings(), setting_name), str):\n                value = str(value)\n            elif isinstance(getattr(self.api.settings(), setting_name), int):\n                value = int(value)\n            elif isinstance(getattr(self.api.settings(), setting_name), bool):\n                value = utils.input_boolean(value)\n            elif isinstance(getattr(self.api.settings(), setting_name), float):\n                value = float(value)\n            elif isinstance(getattr(self.api.settings(), setting_name), list):\n                value = utils.input_string_or_list(value)\n            elif isinstance(getattr(self.api.settings(), setting_name), dict):\n                value = utils.input_string_or_dict(value)[1]\n            else:\n                self.logger.error(\"modify_setting(%s) - Wrong type for value\", setting_name)\n                return 1\n        except TypeError:\n            return 1\n        except ValueError:\n            return 1\n        setattr(self.api.settings(), setting_name, value)\n        self.api.settings().save()\n        return 0\n"}]}]}
{"num": 673, "cve": "CVE-2021-40324", "des": "Cobbler before 3.3.0 allows arbitrary file write operations via upload_log_data.", "cwe_list": ["CWE-434"], "cwe_name_lst": ["Unrestricted Upload of File with Dangerous Type"], "url": "https://api.github.com/repos/cobbler/cobbler/commits/d8f60bbf14a838c8c8a1dba98086b223e35fe70a", "html_url": "https://github.com/cobbler/cobbler/commit/d8f60bbf14a838c8c8a1dba98086b223e35fe70a", "filename_list": ["./data/python/python_filter/672_1@cobbler@cobbler@36c2ba149f8ba005ea30a94439562fd6fd4e9b67@cobbler_remote.py.txt"], "patch_list": [{"patch_file": "cobbler/remote.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "upload_log_data(self, sys_name, file, size, offset, data, token=None, **rest):", "Modified_Line": "        self._log(\"upload_log_data (file: '%s', size: %s, offset: %s)\" % (file, size, offset), token=token,\n                  name=sys_name)\n-        systems = self.api.systems()\n-        obj = systems.find(name=sys_name)\n-        return self.__upload_file(sys_name, file, size, offset, data)\n"}]}]}
{"num": 674, "cve": "CVE-2021-40323", "des": "Cobbler before 3.3.0 allows log poisoning, and resultant Remote Code Execution, via an XMLRPC method that logs to the logfile for template injection.", "cwe_list": ["CWE-94"], "cwe_name_lst": ["Improper Control of Generation of Code ('Code Injection')"], "url": "https://api.github.com/repos/cobbler/cobbler/commits/d8f60bbf14a838c8c8a1dba98086b223e35fe70a", "html_url": "https://github.com/cobbler/cobbler/commit/d8f60bbf14a838c8c8a1dba98086b223e35fe70a", "filename_list": ["./data/python/python_filter/674_1@cobbler@cobbler@36c2ba149f8ba005ea30a94439562fd6fd4e9b67@cobbler_remote.py.txt"], "patch_list": [{"patch_file": "cobbler/remote.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_log(self, msg, user=None, token=None, name=None, object_id=None, attribute=None, debug: bool = False,", "Modified_Line": "        m_user = \"?\"\n-        if user is not None:\n-            m_user = user\n"}]}]}
{"num": 675, "cve": "CVE-2021-43780", "des": "Redash is a package for data visualization and sharing. In versions 10.0 and priorm the implementation of URL-loading data sources like JSON, CSV, or Excel is vulnerable to advanced methods of Server Side Request Forgery (SSRF). These vulnerabilities are only exploitable on installations where a URL-loading data source is enabled. As of time of publication, the `master` and `release/10.x.x` branches address this by applying the Advocate library for making http requests instead of the requests library directly. Users should upgrade to version 10.0.1 to receive this patch. There are a few workarounds for mitigating the vulnerability without upgrading. One can disable the vulnerable data sources entirely, by adding the following env variable to one's configuration, making them unavailable inside the webapp. One can switch any data source of certain types (viewable in the GitHub Security Advisory) to be `View Only` for all groups on the Settings > Groups > Data Sources screen. For users unable to update an admin may modify Redash's configuration through environment variables to mitigate this issue. Depending on the version of Redash, an admin may also need to run a CLI command to re-encrypt some fields in the database. The `master` and `release/10.x.x` branches as of time of publication have removed the default value for `REDASH_COOKIE_SECRET`. All future releases will also require this to be set explicitly. For existing installations, one will need to ensure that explicit values are set for the `REDASH_COOKIE_SECRET` and `REDASH_SECRET_KEY `variables.", "cwe_list": ["CWE-918"], "cwe_name_lst": ["Server-Side Request Forgery (SSRF)"], "url": "https://api.github.com/repos/getredash/redash/commits/61bbb5aa7a23a93f2f93710005f71bc972826099", "html_url": "https://github.com/getredash/redash/commit/61bbb5aa7a23a93f2f93710005f71bc972826099", "filename_list": ["./data/python/python_filter/675_0@getredash@redash@ce60d20c4e3d1537581f2f70f1308fe77ab6a214@redash_query_runner___init__.py.txt", "./data/python/python_filter/675_1@getredash@redash@ce60d20c4e3d1537581f2f70f1308fe77ab6a214@redash_query_runner_csv.py.txt", "./data/python/python_filter/675_2@getredash@redash@ce60d20c4e3d1537581f2f70f1308fe77ab6a214@redash_query_runner_excel.py.txt", "./data/python/python_filter/675_3@getredash@redash@ce60d20c4e3d1537581f2f70f1308fe77ab6a214@redash_query_runner_json_ds.py.txt"], "patch_list": [{"patch_file": "redash/query_runner/__init__.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_response(self, url, auth=None, http_method=\"get\", **kwargs):", "Modified_Line": "-        if is_private_address(url) and settings.ENFORCE_PRIVATE_ADDRESS_BLOCK:\n-            raise Exception(\"Can't query private addresses.\")\n"}]}, {"patch_file": "redash/query_runner/csv.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "run_query(self, query, user):", "Modified_Line": "        path = \"\"\n        ua = \"\"\n        args = {}\n        try:\n            args = yaml.safe_load(query)\n            path = args['url']\n            args.pop('url', None)\n            ua = args['user-agent']\n            args.pop('user-agent', None)\n-            if is_private_address(path) and settings.ENFORCE_PRIVATE_ADDRESS_BLOCK:\n-                raise Exception(\"Can't query private addresses.\")\n"}]}, {"patch_file": "redash/query_runner/excel.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "run_query(self, query, user):", "Modified_Line": "        path = \"\"\n        ua = \"\"\n        args = {}\n        try:\n            args = yaml.safe_load(query)\n            path = args['url']\n            args.pop('url', None)\n            ua = args['user-agent']\n            args.pop('user-agent', None)\n-            if is_private_address(path) and settings.ENFORCE_PRIVATE_ADDRESS_BLOCK:\n-                raise Exception(\"Can't query private addresses.\")\n"}]}, {"patch_file": "redash/query_runner/json_ds.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "run_query(self, query, user):", "Modified_Line": "query = parse_query(query)\n-        if is_private_address(query[\"url\"]) and settings.ENFORCE_PRIVATE_ADDRESS_BLOCK:\n-            raise Exception(\"Can't query private addresses.\")\n"}]}]}
{"num": 676, "cve": "CVE-2021-41192", "des": "Redash is a package for data visualization and sharing. If an admin sets up Redash versions 10.0.0 and prior without explicitly specifying the `REDASH_COOKIE_SECRET` or `REDASH_SECRET_KEY` environment variables, a default value is used for both that is the same across all installations. In such cases, the instance is vulnerable to attackers being able to forge sessions using the known default value. This issue only affects installations where the `REDASH_COOKIE_SECRET or REDASH_SECRET_KEY` environment variables have not been explicitly set. This issue does not affect users of the official Redash cloud images, Redash's Digital Ocean marketplace droplets, or the scripts in the `getredash/setup` repository. These instances automatically generate unique secret keys during installation. One can verify whether one's instance is affected by checking the value of the `REDASH_COOKIE_SECRET` environment variable. If it is `c292a0a3aa32397cdb050e233733900f`, should follow the steps to secure the instance, outlined in the GitHub Security Advisory.", "cwe_list": ["CWE-1188"], "cwe_name_lst": ["Initialization of a Resource with an Insecure Default"], "url": "https://api.github.com/repos/getredash/redash/commits/ce60d20c4e3d1537581f2f70f1308fe77ab6a214", "html_url": "https://github.com/getredash/redash/commit/ce60d20c4e3d1537581f2f70f1308fe77ab6a214", "filename_list": ["./data/python/python_filter/676_0@getredash@redash@da696ff7f84787cbf85967460fac52886cbe063e@redash_settings___init__.py.txt"], "patch_list": [{"patch_file": "redash/settings/__init__.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "-SECRET_KEY = os.environ.get(\"REDASH_COOKIE_SECRET\", \"c292a0a3aa32397cdb050e233733900f\")\n"}]}]}
{"num": 677, "cve": "CVE-2021-43777", "des": "Redash is a package for data visualization and sharing. In Redash version 10.0 and prior, the implementation of Google Login (via OAuth) incorrectly uses the `state` parameter to pass the next URL to redirect the user to after login. The `state` parameter should be used for a Cross-Site Request Forgery (CSRF) token, not a static and easily predicted value. This vulnerability does not affect users who do not use Google Login for their instance of Redash. A patch in the `master` and `release/10.x.x` branches addresses this by replacing `Flask-Oauthlib` with `Authlib` which automatically provides and validates a CSRF token for the state variable. The new implementation stores the next URL on the user session object. As a workaround, one may disable Google Login to mitigate the vulnerability.", "cwe_list": ["CWE-601"], "cwe_name_lst": ["URL Redirection to Untrusted Site ('Open Redirect')"], "url": "https://api.github.com/repos/getredash/redash/commits/da696ff7f84787cbf85967460fac52886cbe063e", "html_url": "https://github.com/getredash/redash/commit/da696ff7f84787cbf85967460fac52886cbe063e", "filename_list": ["./data/python/python_filter/677_1@getredash@redash@ed654a7b78dd791779ba61e884100af4d76e1c97@redash_authentication_google_oauth.py.txt"], "patch_list": [ {"patch_file": "redash/authentication/google_oauth.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "login():", "Modified_Line": "-    callback = url_for(\".callback\", _external=True)\n-    next_path = request.args.get(\n-        \"next\", url_for(\"redash.index\", org_slug=session.get(\"org_slug\"))\n    )\n-    logger.debug(\"Callback url: %s\", callback)\n-    logger.debug(\"Next is: %s\", next_path)\n-    return google_remote_app().authorize(callback=callback, state=next_path)\n"},{"Modified_Block_Num": "2", "Modified_Function": "authorized():", "Modified_Line": "-    resp = google_remote_app().authorized_response()\n-    access_token = resp[\"access_token\"]\n-\n-    if access_token is None:\n-        logger.warning(\"Access token missing in call back request.\")\n-        flash(\"Validation error. Please retry.\")\n-        return redirect(url_for(\"redash.login\"))\n-\n-    profile = get_user_profile(access_token)\n-    if profile is None:\n-        flash(\"Validation error. Please retry.\")\n-        return redirect(url_for(\"redash.login\"))\n-\n-    if \"org_slug\" in session:\n-        org = models.Organization.get_by_slug(session.pop(\"org_slug\"))\n-    else:\n-        org = current_org\n-\n-    if not verify_profile(org, profile):\n-        logger.warning(\n-            \"User tried to login with unauthorized domain name: %s (org: %s)\",\n-            profile[\"email\"],\n-            org,\n        )\n-        flash(\"Your Google Apps account ({}) isn't allowed.\".format(profile[\"email\"]))\n-        return redirect(url_for(\"redash.login\", org_slug=org.slug))\n-    picture_url = \"%s?sz=40\" % profile[\"picture\"]\n-    user = create_and_login_user(org, profile[\"name\"], profile[\"email\"], picture_url)\n-    if user is None:\n-        return logout_and_redirect_to_index()\n-    unsafe_next_path = request.args.get(\"state\") or url_for(\n-        \"redash.index\", org_slug=org.slug\n-    )\n-    next_path = get_next_path(unsafe_next_path)\n-    return redirect(next_path)\n"}]}]}
{"num": 679, "cve": "CVE-2021-41281", "des": "Synapse is a package for Matrix homeservers written in Python 3/Twisted. Prior to version 1.47.1, Synapse instances with the media repository enabled can be tricked into downloading a file from a remote server into an arbitrary directory. No authentication is required for the affected endpoint. The last 2 directories and file name of the path are chosen randomly by Synapse and cannot be controlled by an attacker, which limits the impact. Homeservers with the media repository disabled are unaffected. Homeservers with a federation whitelist are also unaffected, since Synapse will check the remote hostname, including the trailing `../`s, against the whitelist. Server administrators should upgrade to 1.47.1 or later. Server administrators using a reverse proxy could, at the expense of losing media functionality, may block the certain endpoints as a workaround. Alternatively, non-containerized deployments can be adapted to use the hardened systemd config.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/matrix-org/synapse/commits/91f2bd0907f1d05af67166846988e49644eb650c", "html_url": "https://github.com/matrix-org/synapse/commit/91f2bd0907f1d05af67166846988e49644eb650c", "filename_list": ["./data/python/python_filter/679_0@matrix-org@synapse@9f9d82aa846332189e818f51d49daf2335780014@synapse_rest_media_v1__base.py.txt", "./data/python/python_filter/679_1@matrix-org@synapse@9f9d82aa846332189e818f51d49daf2335780014@synapse_rest_media_v1_filepath.py.txt"], "patch_list": [{"patch_file": "synapse/rest/media/v1/_base.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "parse_media_id(request: Request) -> Tuple[str, str, Optional[str]]:", "Modified_Line": "        postpath: List[bytes] = request.postpath  # type: ignore\n        assert postpath\n        server_name_bytes, media_id_bytes =c postpath[:2]\n        server_name = server_name_bytes.decode(\"utf-8\")\n        media_id = media_id_bytes.decode(\"utf8\")\n"}]}, {"patch_file": "synapse/rest/media/v1/filepath.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "local_media_filepath_rel(self, media_id: str) -> str:", "Modified_Line": "-        return os.path.join(\"local_content\", media_id[0:2], media_id[2:4], media_id[4:])\n"}, {"Modified_Block_Num": "2", "Modified_Function": "local_media_thumbnail_rel(", "Modified_Line": "        top_level_type, sub_type = content_type.split(\"/\")\n        file_name = \"%i-%i-%s-%s-%s\" % (width, height, top_level_type, sub_type, method)\n        return os.path.join(\n-            \"local_thumbnails\", media_id[0:2], media_id[2:4], media_id[4:], file_name\n"}, {"Modified_Block_Num": "3", "Modified_Function": "local_media_thumbnail_dir(self, media_id: str) -> str:", "Modified_Line": "        return os.path.join(\n            self.base_path,\n            \"local_thumbnails\",\n            media_id[0:2],\n            media_id[2:4],\n            media_id[4:],\n"}, {"Modified_Block_Num": "4", "Modified_Function": "remote_media_filepath_rel(self, server_name: str, file_id: str) -> str:", "Modified_Line": "        return os.path.join(\n            \"remote_content\", server_name, file_id[0:2], file_id[2:4], file_id[4:]\n"}, {"Modified_Block_Num": "5", "Modified_Function": "remote_media_thumbnail_rel(", "Modified_Line": "        top_level_type, sub_type = content_type.split(\"/\")\n        file_name = \"%i-%i-%s-%s-%s\" % (width, height, top_level_type, sub_type, method)\n        return os.path.join(\n            \"remote_thumbnail\",\n-            server_name,\n-            file_id[0:2],\n-            file_id[2:4],\n-            file_id[4:],\n-            file_name,\n"}, {"Modified_Block_Num": "6", "Modified_Function": "remote_media_thumbnail_rel_legacy(", "Modified_Line": "        top_level_type, sub_type = content_type.split(\"/\")\n        file_name = \"%i-%i-%s-%s-%s\" % (width, height, top_level_type, sub_type, method)\n        return os.path.join(\n            \"remote_thumbnail\",\n-            server_name,\n-            file_id[0:2],\n-            file_id[2:4],\n-            file_id[4:],\n-            file_name,\n"}, {"Modified_Block_Num": "7", "Modified_Function": "remote_media_thumbnail_dir(self, server_name: str, file_id: str) -> str:", "Modified_Line": "        return os.path.join(\n            self.base_path,\n            \"remote_thumbnail\",\n-            server_name,\n-            file_id[0:2],\n-            file_id[2:4],\n-            file_id[4:],\n"}, {"Modified_Block_Num": "8", "Modified_Function": "url_cache_filepath_rel(self, media_id: str) -> str:", "Modified_Line": "        if NEW_FORMAT_ID_RE.match(media_id):\n-            return os.path.join(\"url_cache\", media_id[:10], media_id[11:])\n        else:\n-            return os.path.join(\"url_cache\", media_id[0:2], media_id[2:4], media_id[4:])\n"}, {"Modified_Block_Num": "9", "Modified_Function": "url_cache_filepath_dirs_to_delete(self, media_id: str) -> List[str]:", "Modified_Line": "        if NEW_FORMAT_ID_RE.match(media_id):\n-            return [os.path.join(self.base_path, \"url_cache\", media_id[:10])]\n        else:\n            return [\n-                os.path.join(self.base_path, \"url_cache\", media_id[0:2], media_id[2:4]),\n-                os.path.join(self.base_path, \"url_cache\", media_id[0:2]),\n"}, {"Modified_Block_Num": "10", "Modified_Function": "url_cache_thumbnail_rel(", "Modified_Line": "        top_level_type, sub_type = content_type.split(\"/\")\n        file_name = \"%i-%i-%s-%s-%s\" % (width, height, top_level_type, sub_type, method)\n        if NEW_FORMAT_ID_RE.match(media_id):\n            return os.path.join(\n-                \"url_cache_thumbnails\", media_id[:10], media_id[11:], file_name\n            )\n        else:\n            return os.path.join(\n                \"url_cache_thumbnails\",\n-                media_id[0:2],\n-                media_id[2:4],\n-                media_id[4:],\n-                file_name,\n"}, {"Modified_Block_Num": "11", "Modified_Function": "url_cache_thumbnail_directory_rel(self, media_id: str) -> str:", "Modified_Line": "        if NEW_FORMAT_ID_RE.match(media_id):\n-            return os.path.join(\"url_cache_thumbnails\", media_id[:10], media_id[11:])\n        else:\n            return os.path.join(\n                \"url_cache_thumbnails\",\n-                media_id[0:2],\n-                media_id[2:4],\n-                media_id[4:],\n"}, {"Modified_Block_Num": "12", "Modified_Function": "url_cache_thumbnail_dirs_to_delete(self, media_id: str) -> List[str]:", "Modified_Line": "        if NEW_FORMAT_ID_RE.match(media_id):\n            return [\n                os.path.join(\n-                    self.base_path, \"url_cache_thumbnails\", media_id[:10], media_id[11:]\n                ),\n-                os.path.join(self.base_path, \"url_cache_thumbnails\", media_id[:10]),\n            ]\n        else:\n            return [\n                os.path.join(\n                    self.base_path,\n                    \"url_cache_thumbnails\",\n-                    media_id[0:2],\n-                    media_id[2:4],\n-                    media_id[4:],\n                ),\n                os.path.join(\n-                    self.base_path, \"url_cache_thumbnails\", media_id[0:2], media_id[2:4]\n                ),\n-                os.path.join(self.base_path, \"url_cache_thumbnails\", media_id[0:2]),\n"}]}]}
{"num": 680, "cve": "CVE-2021-3950", "des": "django-helpdesk is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/django-helpdesk/django-helpdesk/commits/04483bdac3b5196737516398b5ce0383875a5c60", "html_url": "https://github.com/django-helpdesk/django-helpdesk/commit/04483bdac3b5196737516398b5ce0383875a5c60", "filename_list": ["./data/python/python_filter/680_0@django-helpdesk@django-helpdesk@2c7065e0c4296e0c692fb4a7ee19c7357583af30@helpdesk_lib.py.txt"], "patch_list": [{"patch_file": "helpdesk/lib.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "process_attachments(followup, attached_files):", "Modified_Line": "        if attached.size:\n            filename = smart_text(attached.name)\n            att = FollowUpAttachment(\n                followup=followup,\n                file=attached,\n                filename=filename,\n                mime_type=attached.content_type or\n                mimetypes.guess_type(filename, strict=False)[0] or\n                'application/octet-stream',\n                size=attached.size,\n            )\n            att.save()\n"}]}]}
{"num": 683, "cve": "CVE-2021-43572", "des": "The verify function in the Stark Bank Python ECDSA library (aka starkbank-escada or ecdsa-python) before 2.0.1 fails to check that the signature is non-zero, which allows attackers to forge signatures on arbitrary messages.", "cwe_list": ["CWE-347"], "cwe_name_lst": ["Improper Verification of Cryptographic Signature"], "url": "https://api.github.com/repos/starkbank/ecdsa-python/commits/d136170666e9510eb63c2572551805807bd4c17f", "html_url": "https://github.com/starkbank/ecdsa-python/commit/d136170666e9510eb63c2572551805807bd4c17f", "filename_list": ["./data/python/python_filter/683_1@starkbank@ecdsa-python@998c92b59db5d2372f62d49f67805d8875d8b299@ellipticcurve_ecdsa.py.txt"], "patch_list": [{"patch_file": "ellipticcurve/ecdsa.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "verify(cls, message, signature, publicKey, hashfunc=sha256):", "Modified_Line": "        byteMessage = hashfunc(toBytes(message)).digest()\n        numberMessage = numberFromByteString(byteMessage)\n        curve = publicKey.curve\n        r = signature.r\n        s = signature.s\n        inv = Math.inv(s, curve.N)\n        u1 = Math.multiply(curve.G, n=(numberMessage * inv) % curve.N, N=curve.N, A=curve.A, P=curve.P)\n        u2 = Math.multiply(publicKey.point, n=(r * inv) % curve.N, N=curve.N, A=curve.A, P=curve.P)\n        add = Math.add(u1, u2, A=curve.A, P=curve.P)\n        modX = add.x % curve.N\n        return r == modX\n"}]}]}
{"num": 684, "cve": "CVE-2021-39182", "des": "EnroCrypt is a Python module for encryption and hashing. Prior to version 1.1.4, EnroCrypt used the MD5 hashing algorithm in the hashing file. Beginners who are unfamiliar with hashes can face problems as MD5 is considered an insecure hashing algorithm. The vulnerability is patched in v1.1.4 of the product. As a workaround, users can remove the `MD5` hashing function from the file `hashing.py`.", "cwe_list": ["CWE-326"], "cwe_name_lst": ["Inadequate Encryption Strength"], "url": "https://api.github.com/repos/Morgan-Phoenix/EnroCrypt/commits/e652d56ac60eadfc26489ab83927af13a9b9d8ce", "html_url": "https://github.com/Morgan-Phoenix/EnroCrypt/commit/e652d56ac60eadfc26489ab83927af13a9b9d8ce", "filename_list": ["./data/python/python_filter/684_0@Morgan-Phoenix@EnroCrypt@d02050267cecbe4f2877a07ca8a930129528ac05@enrocrypt_hashing.py.txt"], "patch_list": [{"patch_file": "enrocrypt/hashing.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "MD5(self,data:str):", "Modified_Line": "-        sha = hashlib.md5(bytes(data.encode()))\n-        hash = str(sha.digest())\n-        return self.__Salt(hash,salt=self.salt)\n-\n"}]}]}
{"num": 685, "cve": "CVE-2021-41250", "des": "Python discord bot is the community bot for the Python Discord community. In affected versions when a non-blacklisted URL and an otherwise triggering filter token is included in the same message the token filter does not trigger. This means that by including any non-blacklisted URL moderation filters can be bypassed. This issue has been resolved in commit 67390298852513d13e0213870e50fb3cff1424e0", "cwe_list": ["NVD-CWE-Other"], "cwe_name_lst": ["none"], "url": "https://api.github.com/repos/python-discord/bot/commits/67390298852513d13e0213870e50fb3cff1424e0", "html_url": "https://github.com/python-discord/bot/commit/67390298852513d13e0213870e50fb3cff1424e0", "filename_list": ["./data/python/python_filter/685_0@python-discord@bot@69fdd3649e2f9a646b97e445bc4d5440440e5890@bot_exts_filters_filtering.py.txt"], "patch_list": [{"patch_file": "bot/exts/filters/filtering.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_has_watch_regex_match(self, text: str) -> Tuple[Union[bool, re.Match]", "Modified_Line": "        text = self.clean_input(text)\n-        if URL_RE.search(text):\n-            return False, None\n-\n"}]}]}
{"num": 693, "cve": "CVE-2021-41213", "des": "TensorFlow is an open source platform for machine learning. In affected versions the code behind `tf.function` API can be made to deadlock when two `tf.function` decorated Python functions are mutually recursive. This occurs due to using a non-reentrant `Lock` Python object. Loading any model which contains mutually recursive functions is vulnerable. An attacker can cause denial of service by causing users to load such models and calling a recursive `tf.function`, although this is not a frequent scenario. The fix will be included in TensorFlow 2.7.0. We will also cherrypick this commit on TensorFlow 2.6.1, TensorFlow 2.5.2, and TensorFlow 2.4.4, as these are also affected and still in supported range.", "cwe_list": ["CWE-662"], "cwe_name_lst": ["Improper Synchronization"], "url": "https://api.github.com/repos/tensorflow/tensorflow/commits/afac8158d43691661ad083f6dd9e56f327c1dcb7", "html_url": "https://github.com/tensorflow/tensorflow/commit/afac8158d43691661ad083f6dd9e56f327c1dcb7", "filename_list": ["./data/python/python_filter/693_0@tensorflow@tensorflow@0fec20b7091bfc10987e35118d1b2fc0b0d6cd58@tensorflow_python_eager_def_function.py.txt", "./data/python/python_filter/693_1@tensorflow@tensorflow@0fec20b7091bfc10987e35118d1b2fc0b0d6cd58@tensorflow_python_eager_function.py.txt"], "patch_list": [{"patch_file": "tensorflow/python/eager/def_function.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "__init__(self,", "Modified_Line": "-    self._lock = threading.Lock()\n"}, {"Modified_Block_Num": "2", "Modified_Function": "__getstate__(self):", "Modified_Line": "-    self._lock = threading.Lock()\n"}]}, {"patch_file": "tensorflow/python/eager/function.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "__init__(self,", "Modified_Line": "-    self._lock = threading.Lock()\n"}]}]}
{"num": 720, "cve": "CVE-2021-43857", "des": "Gerapy is a distributed crawler management framework. Gerapy prior to version 0.9.8 is vulnerable to remote code execution, and this issue is patched in version 0.9.8.", "cwe_list": ["CWE-78"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "url": "https://api.github.com/repos/Gerapy/Gerapy/commits/49bcb19be5e0320e7e1535f34fe00f16a3cf3b28", "html_url": "https://github.com/Gerapy/Gerapy/commit/49bcb19be5e0320e7e1535f34fe00f16a3cf3b28", "filename_list": ["./data/python/python_filter/720_0@Gerapy@Gerapy@f1cd46d80328497c016fbac12c9239b9dcaef047@gerapy_server_core_views.py.txt"], "patch_list": [{"patch_file": "gerapy/server/core/views.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "project_configure(request, project_name):", "Modified_Line": "-        project_name = re.sub('[\\!\\@\\#\\$\\;\\&\\*\\~\\\"\\'\\{\\}\\]\\[\\-\\+\\%\\^]+', '', project_name)\n-        cmd = ' '.join(['gerapy', 'generate', project_name])\n-        p = Popen(cmd, shell=True, stdin=PIPE, stdout=PIPE, stderr=PIPE)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "project_clone(request):", "Modified_Line": "        data = json.loads(request.body)\n        address = data.get('address')\n        address = address + '.git' if not address.endswith('.git') else address\n-        cmd = 'git clone {address} {target}'.format(address=address, target=join(PROJECTS_FOLDER, Path(address).stem))\n        logger.debug('clone cmd %s', cmd)\n-        p = Popen(cmd, shell=True, stdin=PIPE, stdout=PIPE, stderr=PIPE)\n"}, {"Modified_Block_Num": "3", "Modified_Function": "project_parse(request, project_name):", "Modified_Line": "-        args_cmd = ' '.join(\n-            ['--{arg} {value}'.format(arg=arg, value=value) for arg, value in args.items()])\n-        logger.debug('args cmd %s', args_cmd)\n-        cmd = 'gerapy parse {args_cmd} {project_path} {spider_name}'.format(\n-            args_cmd=args_cmd,\n-            project_path=project_path,\n-            spider_name=spider_name\n-        )\n"}]}]}
{"num": 722, "cve": "CVE-2021-43854", "des": "NLTK (Natural Language Toolkit) is a suite of open source Python modules, data sets, and tutorials supporting research and development in Natural Language Processing. Versions prior to 3.6.5 are vulnerable to regular expression denial of service (ReDoS) attacks. The vulnerability is present in PunktSentenceTokenizer, sent_tokenize and word_tokenize. Any users of this class, or these two functions, are vulnerable to the ReDoS attack. In short, a specifically crafted long input to any of these vulnerable functions will cause them to take a significant amount of execution time. If your program relies on any of the vulnerable functions for tokenizing unpredictable user input, then we would strongly recommend upgrading to a version of NLTK without the vulnerability. For users unable to upgrade the execution time can be bounded by limiting the maximum length of an input to any of the vulnerable functions. Our recommendation is to implement such a limit.", "cwe_list": ["CWE-400"], "cwe_name_lst": ["Uncontrolled Resource Consumption"], "url": "https://api.github.com/repos/nltk/nltk/commits/1405aad979c6b8080dbbc8e0858f89b2e3690341", "html_url": "https://github.com/nltk/nltk/commit/1405aad979c6b8080dbbc8e0858f89b2e3690341", "filename_list": ["./data/python/python_filter/722_0@nltk@nltk@0b7b076247ec41f9b6b8a94400d48ea299e4b507@nltk_tokenize_punkt.py.txt"], "patch_list": [{"patch_file": "nltk/tokenize/punkt.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "debug_decisions(self, text):", "Modified_Line": "-        for match in self._lang_vars.period_context_re().finditer(text):\n-            decision_text = match.group() + match.group(\"after_tok\")\n"}, {"Modified_Block_Num": "2", "Modified_Function": "_slices_from_text(self, text):", "Modified_Line": "-        for match in self._lang_vars.period_context_re().finditer(text):\n-            context = match.group() + match.group(\"after_tok\")\n"}]}]}
{"num": 724, "cve": "CVE-2021-43831", "des": "Gradio is an open source framework for building interactive machine learning models and demos. In versions prior to 2.5.0 there is a vulnerability that affects anyone who creates and publicly shares Gradio interfaces. File paths are not restricted and users who receive a Gradio link can access any files on the host computer if they know the file names or file paths. This is limited only by the host operating system. Paths are opened in read only mode. The problem has been patched in gradio 2.5.0.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/gradio-app/gradio/commits/41bd3645bdb616e1248b2167ca83636a2653f781", "html_url": "https://github.com/gradio-app/gradio/commit/41bd3645bdb616e1248b2167ca83636a2653f781", "filename_list": ["./data/python/python_filter/724_0@gradio-app@gradio@0b2c4901a63b2e5a7d7b3964d27b8f82d6d330e1@gradio_networking.py.txt"], "patch_list": [{"patch_file": "gradio/networking.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "file(path):", "Modified_Line": "-    path = secure_filename(path)\n    if app.interface.encrypt and isinstance(app.interface.examples, str) and path.startswith(app.interface.examples):\n-        with open(os.path.join(app.cwd, path), \"rb\") as encrypted_file:\n            encrypted_data = encrypted_file.read()\n        file_data = encryptor.decrypt(\n            app.interface.encryption_key, encrypted_data)\n        return send_file(io.BytesIO(file_data), attachment_filename=os.path.basename(path))\n    else:\n-        return send_file(os.path.join(app.cwd, path))\n"}]}]}
{"num": 726, "cve": "CVE-2021-43818", "des": "lxml is a library for processing XML and HTML in the Python language. Prior to version 4.6.5, the HTML Cleaner in lxml.html lets certain crafted script content pass through, as well as script content in SVG files embedded using data URIs. Users that employ the HTML cleaner in a security relevant context should upgrade to lxml 4.6.5 to receive a patch. There are no known workarounds available.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/lxml/lxml/commits/f2330237440df7e8f39c3ad1b1aa8852be3b27c0", "html_url": "https://github.com/lxml/lxml/commit/f2330237440df7e8f39c3ad1b1aa8852be3b27c0", "filename_list": ["./data/python/python_filter/726_0@lxml@lxml@12fa9669007180a7bb87d990c375cf91ca5b664a@src_lxml_html_clean.py.txt"], "patch_list": [{"patch_file": "src/lxml/html/clean.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_is_javascript_scheme(s):", "Modified_Line": "-_is_image_dataurl = re.compile(\n-    r'^data:image/.+;base64', re.I).search\n_is_possibly_malicious_scheme = re.compile(\n-    r'(?:javascript|jscript|livescript|vbscript|data|about|mocha):',\n-    re.I).search\n-    if _is_image_dataurl(s):\n-        return None\n-    return _is_possibly_malicious_scheme(s)\n"}]}]}
{"num": 729, "cve": "CVE-2021-43781", "des": "Invenio-Drafts-Resources is a submission/deposit module for Invenio, a software framework for research data management. Invenio-Drafts-Resources prior to versions 0.13.7 and 0.14.6 does not properly check permissions when a record is published. The vulnerability is exploitable in a default installation of InvenioRDM. An authenticated a user is able via REST API calls to publish draft records of other users if they know the record identifier and the draft validates (e.g. all require fields filled out). An attacker is not able to modify the data in the record, and thus e.g. *cannot* change a record from restricted to public. The problem is patched in Invenio-Drafts-Resources v0.13.7 and 0.14.6, which is part of InvenioRDM v6.0.1 and InvenioRDM v7.0 respectively.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/inveniosoftware/invenio-drafts-resources/commits/039b0cff1ad4b952000f4d8c3a93f347108b6626", "html_url": "https://github.com/inveniosoftware/invenio-drafts-resources/commit/039b0cff1ad4b952000f4d8c3a93f347108b6626", "filename_list": ["./data/python/python_filter/729_0@inveniosoftware@invenio-drafts-resources@998ede99c377c84f11fe22c07c20f90c88c463dc@invenio_drafts_resources_services_records_service.py.txt"], "patch_list": [{"patch_file": "invenio_drafts_resources/services/records/service.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "publish(self, id_, identity, uow=None):", "Modified_Line": "-        self.require_permission(identity, \"publish\")\n"}]}]}
{"num": 730, "cve": "CVE-2021-43791", "des": "Zulip is an open source group chat application that combines real-time chat with threaded conversations. In affected versions expiration dates on the confirmation objects associated with email invitations were not enforced properly in the new account registration flow. A confirmation link takes a user to the check_prereg_key_and_redirect endpoint, before getting redirected to POST to /accounts/register/. The problem was that validation was happening in the check_prereg_key_and_redirect part and not in /accounts/register/ - meaning that one could submit an expired confirmation key and be able to register. The issue is fixed in Zulip 4.8. There are no known workarounds and users are advised to upgrade as soon as possible.", "cwe_list": ["CWE-613"], "cwe_name_lst": ["Insufficient Session Expiration"], "url": "https://api.github.com/repos/zulip/zulip/commits/a014ef75a3a0ed7f24ebb157632ba58751e732c6", "html_url": "https://github.com/zulip/zulip/commit/a014ef75a3a0ed7f24ebb157632ba58751e732c6", "filename_list": ["./data/python/python_filter/730_1@zulip@zulip@a1cd660147a5d89c9aec7c2bb4c0feeea2790229@zerver_views_registration.py.txt"], "patch_list": [{"patch_file": "zerver/views/registration.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "accounts_register(", "Modified_Line": "-    try:\n-        confirmation = Confirmation.objects.get(confirmation_key=key)\n-    except Confirmation.DoesNotExist:\n-        return render(request, \"zerver/confirmation_link_expired_error.html\", status=404)\n-    prereg_user = confirmation.content_object\n    assert prereg_user is not None\n-    if prereg_user.status == confirmation_settings.STATUS_REVOKED:\n-        return render(request, \"zerver/confirmation_link_expired_error.html\", status=404)\n"}]}]}
{"num": 732, "cve": "CVE-2021-3994", "des": "django-helpdesk is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/django-helpdesk/django-helpdesk/commits/a22eb0673fe0b7784f99c6b5fd343b64a6700f06", "html_url": "https://github.com/django-helpdesk/django-helpdesk/commit/a22eb0673fe0b7784f99c6b5fd343b64a6700f06", "filename_list": ["./data/python/python_filter/732_0@django-helpdesk@django-helpdesk@7097c9c4c0b255ec1f10f3ea14fa2b9c47f6c706@helpdesk_models.py.txt"], "patch_list": [{"patch_file": "helpdesk/models.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_markdown(text):", "Modified_Line": "-    pattern = fr'([\\[\\s\\S\\]]*?)\\(([\\s\\S]*?):([\\[\\s\\S\\]]*?)\\)'\n"}]}]}
{"num": 742, "cve": "CVE-2020-5236", "des": "Waitress version 1.4.2 allows a DOS attack When waitress receives a header that contains invalid characters. When a header like \"Bad-header: xxxxxxxxxxxxxxx\\x10\" is received, it will cause the regular expression engine to catastrophically backtrack causing the process to use 100% CPU time and blocking any other interactions. This allows an attacker to send a single request with an invalid header and take the service offline. This issue was introduced in version 1.4.2 when the regular expression was updated to attempt to match the behaviour required by errata associated with RFC7230. The regular expression that is used to validate incoming headers has been updated in version 1.4.3, it is recommended that people upgrade to the new version of Waitress as soon as possible.", "cwe_list": ["CWE-400"], "cwe_name_lst": ["Uncontrolled Resource Consumption"], "url": "https://api.github.com/repos/Pylons/waitress/commits/6e46f9e3f014d64dd7d1e258eaf626e39870ee1f", "html_url": "https://github.com/Pylons/waitress/commit/6e46f9e3f014d64dd7d1e258eaf626e39870ee1f", "filename_list": ["./data/python/python_filter/742_0@Pylons@waitress@8af9adb8e9078bfdbc3adf9153b04e2d4471222d@waitress_rfc7230.py.txt"], "patch_list": [{"patch_file": "waitress/rfc7230.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "-FIELD_CONTENT = FIELD_VCHAR + \"([ \\t\" + VCHAR + OBS_TEXT + \"]+\" + FIELD_VCHAR + \"){,1}\"\n-FIELD_VALUE = \"(\" + FIELD_CONTENT + \"){0,}\"\n-OWS_STRIP = re.compile(OWS + \"(?P<value>.*?)\" + OWS)\n"}]}]}
{"num": 743, "cve": "CVE-2020-8545", "des": "Global.py in AIL framework 2.8 allows path traversal.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/CIRCL/AIL-framework/commits/e808840f957c810b8e3944cba808716dc722581b", "html_url": "https://github.com/CIRCL/AIL-framework/commit/e808840f957c810b8e3944cba808716dc722581b", "filename_list": ["./data/python/python_filter/743_0@CIRCL@AIL-framework@e19a3b3e630ed8cacd492e5c36ffa59c3cdfac78@bin_Global.py.txt"], "patch_list": [{"patch_file": "bin/Global.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "rreplace(s, old, new, occurrence):", "Modified_Line": "        filename = os.path.join(PASTES_FOLDER, paste)-        dirname = os.path.dirname(filename)\n-        if not os.path.exists(dirname):\n-            os.makedirs(dirname)\n-\n-        decoded = base64.standard_b64decode(gzip64encoded)\n-        with open(filename, 'wb') as f:\n-            f.write(decoded)\n-        if PASTES_FOLDERS in paste:\n-            paste = paste.replace(PASTES_FOLDERS, '', 1)\n-        p.populate_set_out(paste)\n-        processed_paste+=1\n"}]}]}
{"num": 748, "cve": "CVE-2020-11010", "des": "In Tortoise ORM before versions 0.15.23 and 0.16.6, various forms of SQL injection have been found for MySQL and when filtering or doing mass-updates on char/text fields. SQLite & PostgreSQL are only affected when filtering with contains, starts_with, or ends_with filters (and their case-insensitive counterparts).", "cwe_list": ["CWE-89"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "url": "https://api.github.com/repos/tortoise/tortoise-orm/commits/91c364053e0ddf77edc5442914c6f049512678b3", "html_url": "https://github.com/tortoise/tortoise-orm/commit/91c364053e0ddf77edc5442914c6f049512678b3", "filename_list": ["./data/python/python_filter/748_0@tortoise@tortoise-orm@816ff00e988f79b4ff1601f247062bb5eb9db802@tortoise_backends_mysql_executor.py.txt", "./data/python/python_filter/748_1@tortoise@tortoise-orm@816ff00e988f79b4ff1601f247062bb5eb9db802@tortoise_filters.py.txt"], "patch_list": [{"patch_file": "tortoise/backends/mysql/executor.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "mysql_contains(field: Field, value: str) -> Criterion:", "Modified_Line": "-    return functions.Cast(field, SqlTypes.CHAR).like(f\"%{value}%\")\n"}, {"Modified_Block_Num": "2", "Modified_Function": "mysql_starts_with(field: Field, value: str) -> Criterion:", "Modified_Line": "-    return functions.Cast(field, SqlTypes.CHAR).like(f\"%{value}%\")\n"}, {"Modified_Block_Num": "3", "Modified_Function": "mysql_ends_with(field: Field, value: str) -> Criterion:", "Modified_Line": "-    return functions.Cast(field, SqlTypes.CHAR).like(f\"%{value}%\")\n"}, {"Modified_Block_Num": "4", "Modified_Function": "mysql_insensitive_exact(field: Field, value: str) -> Criterion:", "Modified_Line": "-    return functions.Upper(functions.Cast(field, SqlTypes.CHAR)).eq(functions.Upper(f\"{value}\"))\n"}, {"Modified_Block_Num": "5", "Modified_Function": "mysql_insensitive_contains(field: Field, value: str) -> Criterion:", "Modified_Line": "-    return functions.Upper(functions.Cast(field, SqlTypes.CHAR)).like(functions.Upper(f\"{value}\"))\n"}, {"Modified_Block_Num": "6", "Modified_Function": "mysql_insensitive_starts_with(field: Field, value: str) -> Criterion:", "Modified_Line": "-    return functions.Upper(functions.Cast(field, SqlTypes.CHAR)).like(functions.Upper(f\"{value}\"))\n"}, {"Modified_Block_Num": "7", "Modified_Function": "mysql_insensitive_ends_with(field: Field, value: str) -> Criterion:", "Modified_Line": "-    return functions.Upper(functions.Cast(field, SqlTypes.CHAR)).like(functions.Upper(f\"{value}\"))\n"}]}, {"patch_file": "tortoise/filters.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "def contains(field: Term, value: str) -> Criterion:", "Modified_Line": "-    return field.like(f\"%{value}%\")\n"},{"Modified_Block_Num": "2", "Modified_Function": "def starts_with(field: Term, value: str) -> Criterion:", "Modified_Line": "-    return field.like(f\"{value}%\")\n"},{"Modified_Block_Num": "3", "Modified_Function": "def ends_with(field: Term, value: str) -> Criterion:", "Modified_Line": "-    return field.like(f\"%{value}\")\n"},{"Modified_Block_Num": "4", "Modified_Function": "def insensitive_exact(field: Term, value: str) -> Criterion:", "Modified_Line": "-    return Upper(field).eq(Upper(f\"{value}\"))\n"},{"Modified_Block_Num": "5", "Modified_Function": "def insensitive_contains(field: Term, value: str) -> Criterion:", "Modified_Line": "-    return Upper(field).like(Upper(f\"%{value}%\"))\n"},{"Modified_Block_Num": "6", "Modified_Function": "def insensitive_starts_with(field: Term, value: str) -> Criterion:", "Modified_Line": "-    return Upper(field).like(Upper(f\"{value}%\"))\n"},{"Modified_Block_Num": "7", "Modified_Function": "def insensitive_ends_with(field: Term, value: str) -> Criterion:", "Modified_Line": "-    return Upper(field).like(Upper(f\"%{value}\"))\n"}]}]}
{"num": 749, "cve": "CVE-2020-11001", "des": "In Wagtail before versions 2.8.1 and 2.7.2, a cross-site scripting (XSS) vulnerability exists on the page revision\ncomparison view within the Wagtail admin interface. A user with a limited-permission editor account for the Wagtail\nadmin could potentially craft a page revision history that, when viewed by a user with higher privileges, could perform\nactions with that user's credentials. The vulnerability is not exploitable by an ordinary site visitor without access to\nthe Wagtail admin.\n\nPatched versions have been released as Wagtail 2.7.2 (for the LTS 2.7 branch) and Wagtail 2.8.1 (for the current 2.8 branch).", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/wagtail/wagtail/commits/61045ceefea114c40ac4b680af58990dbe732389", "html_url": "https://github.com/wagtail/wagtail/commit/61045ceefea114c40ac4b680af58990dbe732389", "filename_list": ["./data/python/python_filter/749_0@wagtail@wagtail@081705fc7a2d9aec75da25a3593b490f3c145d2b@wagtail_admin_compare.py.txt"], "patch_list": [{"patch_file": "wagtail/admin/compare.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "htmldiff(self):", "Modified_Line": "        return diff_text(\n-            BeautifulSoup(force_str(self.val_a), 'html5lib').getText(),\n-            BeautifulSoup(force_str(self.val_b), 'html5lib').getText()\n        ).to_html()\n"},{"Modified_Block_Num": "2", "Modified_Function": "htmlvalue(self, val):", "Modified_Line": "-        return self.block.render_basic(val)\n"}]}]}
{"num": 750, "cve": "CVE-2020-7655", "des": "netius prior to 1.17.58 is vulnerable to HTTP Request Smuggling. HTTP pipelining issues and request smuggling attacks might be possible due to incorrect Transfer encoding header parsing which could allow for CL:TE or TE:TE attacks.", "cwe_list": ["CWE-444"], "cwe_name_lst": ["Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')"], "url": "https://api.github.com/repos/hivesolutions/netius/commits/9830881ef68328f8ea9c7901db1d11690677e7d1", "html_url": "https://github.com/hivesolutions/netius/commit/9830881ef68328f8ea9c7901db1d11690677e7d1", "filename_list": ["./data/python/python_filter/750_0@hivesolutions@netius@f96d1b67d02394f03309b67a27066b9ee0a63f96@src_netius_common_http.py.txt"], "patch_list": [{"patch_file": "src/netius/common/http.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_parse_headers(self, data):", "Modified_Line": "-            if not key.strip() == key:\r\n-                raise netius.ParserError(\"Invalid header key\")\r\n-            if not value.strip(b\" \") == value.strip():\r\n-                raise netius.ParserError(\"Invalid header value\")\r\n"}]}]}
{"num": 756, "cve": "CVE-2020-15120", "des": "In \"I hate money\" before version 4.1.5, an authenticated member of one project can modify and delete members of another project, without knowledge of this other project's private code. This can be further exploited to access all bills of another project without knowledge of this other project's private code. With the default configuration, anybody is allowed to create a new project. An attacker can create a new project and then use it to become authenticated and exploit this flaw. As such, the exposure is similar to an unauthenticated attack, because it is trivial to become authenticated. This is fixed in version 4.1.5.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/spiral-project/ihatemoney/commits/8d77cf5d5646e1d2d8ded13f0660638f57e98471", "html_url": "https://github.com/spiral-project/ihatemoney/commit/8d77cf5d5646e1d2d8ded13f0660638f57e98471", "filename_list": ["./data/python/python_filter/756_0@spiral-project@ihatemoney@040d76af83411fb58ab400dc4eac909191a3e5fa@ihatemoney_models.py.txt"], "patch_list": [{"patch_file": "ihatemoney/models.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get_by_name(self, name, project):", "Modified_Line": "            return (\n                Person.query.filter(Person.name == name)\n-                .filter(Project.id == project.id)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "get(self, id, project=None):", "Modified_Line": "            return (\n                Person.query.filter(Person.id == id)\n-                .filter(Project.id == project.id)\n"}]}]}
{"num": 757, "cve": "CVE-2020-7698", "des": "This affects the package Gerapy from 0 and before 0.9.3. The input being passed to Popen, via the project_configure endpoint, isnt being sanitized.", "cwe_list": ["CWE-78"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "url": "https://api.github.com/repos/Gerapy/Gerapy/commits/e8446605eb2424717418eae199ec7aad573da2d2", "html_url": "https://github.com/Gerapy/Gerapy/commit/e8446605eb2424717418eae199ec7aad573da2d2", "filename_list": ["./data/python/python_filter/757_1@Gerapy@Gerapy@4cfd5f3cfab504ac922deda8d95126c66961d6f6@gerapy_server_core_views.py.txt"], "patch_list": [{"patch_file": "gerapy/server/core/views.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "project_configure(request, project_name):", "Modified_Line": "        cmd = ' '.join(['gerapy', 'generate', project_name])\n        p = Popen(cmd, shell=True, stdin=PIPE, stdout=PIPE, stderr=PIPE)\n"}]}]}
{"num": 760, "cve": "CVE-2020-15110", "des": "In jupyterhub-kubespawner before 0.12, certain usernames will be able to craft particular server names which will grant them access to the default server of other users who have matching usernames. This has been fixed in 0.12.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/jupyterhub/kubespawner/commits/3dfe870a7f5e98e2e398b01996ca6b8eff4bb1d0", "html_url": "https://github.com/jupyterhub/kubespawner/commit/3dfe870a7f5e98e2e398b01996ca6b8eff4bb1d0", "filename_list": ["./data/python/python_filter/760_0@jupyterhub@kubespawner@b7f55eae3d5afb6ac9f2facf76f46239e2f2a38a@kubespawner_spawner.py.txt"], "patch_list": [{"patch_file": "kubespawner/spawner.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "_expand_user_properties(self, template):", "Modified_Line": "--        if self.name:\n-            servername = '--{}'.format(self.name)\n-            safe_servername = '--{}'.format(escapism.escape(self.name, safe=safe_chars, escape_char='-').lower())\n-        else:\n-            servername = ''\n-            safe_servername = ''\n"}]}]}
{"num": 764, "cve": "CVE-2020-15239", "des": "In xmpp-http-upload before version 0.4.0, when the GET method is attacked, attackers can read files which have a `.data` suffix and which are accompanied by a JSON file with the `.meta` suffix. This can lead to Information Disclosure and in some shared-hosting scenarios also to circumvention of authentication or other limitations on the outbound (GET) traffic. For example, in a scenario where a single server has multiple instances of the application running (with separate DATA_ROOT settings), an attacker who has knowledge about the directory structure is able to read files from any other instance to which the process has read access. If instances have individual authentication (for example, HTTP authentication via a reverse proxy, source IP based filtering) or other restrictions (such as quotas), attackers may circumvent those limits in such a scenario by using the Directory Traversal to retrieve data from the other instances. If the associated XMPP server (or anyone knowing the SECRET_KEY) is malicious, they can write files outside the DATA_ROOT. The files which are written are constrained to have the `.meta` and the `.data` suffixes; the `.meta` file will contain the JSON with the Content-Type of the original request and the `.data` file will contain the payload. The issue is patched in version 0.4.0.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/horazont/xmpp-http-upload/commits/82056540191e89f0cd697c81f57714c00962ed75", "html_url": "https://github.com/horazont/xmpp-http-upload/commit/82056540191e89f0cd697c81f57714c00962ed75", "filename_list": ["./data/python/python_filter/764_0@horazont@xmpp-http-upload@f0fc7443c06a0e8aecb5696fc2bd513a2cc8b611@xhu.py.txt"], "patch_list": [{"patch_file": "xhu.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "sanitized_join(path: str, root: pathlib.Path) -> pathlib.Path:", "Modified_Line": "-    result = (root / path).absolute()\n-    if not str(result).startswith(str(root) + \"/\"):\n-        raise ValueError(\"resulting path is outside root\")\n-    return result\n"}]}]}
{"num": 765, "cve": "CVE-2020-15235", "des": "In RACTF before commit f3dc89b, unauthenticated users are able to get the value of sensitive config keys that would normally be hidden to everyone except admins. All versions after commit f3dc89b9f6ab1544a289b3efc06699b13d63e0bd(3/10/20) are patched.", "cwe_list": ["CWE-200"], "cwe_name_lst": ["Exposure of Sensitive Information to an Unauthorized Actor"], "url": "https://api.github.com/repos/ractf/core/commits/f3dc89b9f6ab1544a289b3efc06699b13d63e0bd", "html_url": "https://github.com/ractf/core/commit/f3dc89b9f6ab1544a289b3efc06699b13d63e0bd", "filename_list": ["./data/python/python_filter/765_1@ractf@core@41edf92a96e96fda1c43ca8bf3fab631e58ef886@src_config_views.py.txt"], "patch_list": [{"patch_file": "src/config/views.py", "patch_content": [ {"Modified_Block_Num": "1", "Modified_Function": "get(self, request, name=None):", "Modified_Line": "        if name is None:\n-            if request.user.is_staff:\n                return FormattedResponse(config.get_all())\n            return FormattedResponse(config.get_all_non_sensitive())\n-        return FormattedResponse(config.get(name))\n"}]}]}
{"num": 766, "cve": "CVE-2020-15172", "des": "The Act module for Red Discord Bot before commit 6b9f3b86 is vulnerable to Remote Code Execution. With this exploit, Discord users can use specially crafted messages to perform destructive actions and/or access sensitive information. Unloading the Act module with `unload act` can render this exploit inaccessible.", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/Zephyrkul/FluffyCogs/commits/6b9f3b862e1f0a5429c62f3090f814e53a242347", "html_url": "https://github.com/Zephyrkul/FluffyCogs/commit/6b9f3b862e1f0a5429c62f3090f814e53a242347", "filename_list": ["./data/python/python_filter/766_0@Zephyrkul@FluffyCogs@cbc70ed672e55d89424d8a091143c1fc1a2a6912@act_act.py.txt"], "patch_list": [{"patch_file": "act/act.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "on_message(self, message):", "Modified_Line": "-        if message.author.bot:\r\n            return\r\n-        ctx = await self.bot.get_context(message)\r\n-        if ctx.prefix is None or not ctx.invoked_with.replace(\"_\", \"\").isalpha():\r\n            return\r\n-        if ctx.valid and ctx.command.enabled:\r\n-            try:\r\n-                if await ctx.command.can_run(ctx):\r\n-                    return\r\n-            except commands.errors.CheckFailure:\r\n-                return\r\n-        ctx.command = self.act\r\n-        await self.bot.invoke(ctx)\r\n"}]}]}
{"num": 767, "cve": "CVE-2020-26232", "des": "Jupyter Server before version 1.0.6 has an Open redirect vulnerability. A maliciously crafted link to a jupyter server could redirect the browser to a different website. All jupyter servers are technically affected, however, these maliciously crafted links can only be reasonably made for known jupyter server hosts. A link to your jupyter server may appear safe, but ultimately redirect to a spoofed server on the public internet.", "cwe_list": ["CWE-601"], "cwe_name_lst": ["URL Redirection to Untrusted Site ('Open Redirect')"], "url": "https://api.github.com/repos/jupyter-server/jupyter_server/commits/3d83e49090289c431da253e2bdb8dc479cbcb157", "html_url": "https://github.com/jupyter-server/jupyter_server/commit/3d83e49090289c431da253e2bdb8dc479cbcb157", "filename_list": ["./data/python/python_filter/767_0@jupyter-server@jupyter_server@505140f96f27c105c2cd4cb38d9afdf4ff4b34d6@jupyter_server_base_handlers.py.txt"], "patch_list": [{"patch_file": "jupyter_server/base/handlers.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get(self):", "Modified_Line": "-        uri = self.request.path.rstrip(\"/\")\n-        if uri:\n-            self.redirect('?'.join((uri, self.request.query)))\n"}]}]}
{"num": 768, "cve": "CVE-2020-26236", "des": "In ScratchVerifier before commit a603769, an attacker can hijack the verification process to log into someone else's account on any site that uses ScratchVerifier for logins. A possible exploitation would follow these steps: 1. User starts login process. 2. Attacker attempts login for user, and is given the same verification code. 3. User comments code as part of their normal login. 4. Before user can, attacker completes the login process now that the code is commented. 5. User gets a failed login and attacker now has control of the account. Since commit a603769 starting a login twice will generate different verification codes, causing both user and attacker login to fail. For clients that rely on a clone of ScratchVerifier not hosted by the developers, their users may attempt to finish the login process as soon as possible after commenting the code. There is no reliable way for the attacker to know before the user can finish the process that the user has commented the code, so this vulnerability only really affects those who comment the code and then take several seconds before finishing the login.", "cwe_list": ["CWE-287"], "cwe_name_lst": ["Improper Authentication"], "url": "https://api.github.com/repos/ScratchVerifier/ScratchVerifier/commits/a603769010abf8c1bede91af46e4945314e4aa4a", "html_url": "https://github.com/ScratchVerifier/ScratchVerifier/commit/a603769010abf8c1bede91af46e4945314e4aa4a", "filename_list": ["./data/python/python_filter/768_0@ScratchVerifier@ScratchVerifier@2170fc56a64aeb40a0936702a9c3281f716c6405@backend_db.py.txt"], "patch_list": [{"patch_file": "backend/db.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "start_verification(self, client_id, username):", "Modified_Line": "-        if row is not None:\n-            await self.db.execute('UPDATE scratchverifier_usage SET expiry=? \\\n-WHERE client_id=? AND username=? AND code=?', (int(time.time()) + VERIFY_EXPIRY,\n-                                               client_id, username, row[0]))\n-            return row[0]\n"}]}]}
{"num": 769, "cve": "CVE-2020-26215", "des": "Jupyter Notebook before version 6.1.5 has an Open redirect vulnerability. A maliciously crafted link to a notebook server could redirect the browser to a different website. All notebook servers are technically affected, however, these maliciously crafted links can only be reasonably made for known notebook server hosts. A link to your notebook server may appear safe, but ultimately redirect to a spoofed server on the public internet. The issue is patched in version 6.1.5.", "cwe_list": ["CWE-601"], "cwe_name_lst": ["URL Redirection to Untrusted Site ('Open Redirect')"], "url": "https://api.github.com/repos/jupyter/notebook/commits/3cec4bbe21756de9f0c4bccf18cf61d840314d74", "html_url": "https://github.com/jupyter/notebook/commit/3cec4bbe21756de9f0c4bccf18cf61d840314d74", "filename_list": ["./data/python/python_filter/769_0@jupyter@notebook@d8308e13803ba1c6e92f129381e615af6c6e00d3@notebook_base_handlers.py.txt"], "patch_list": [{"patch_file": "notebook/base/handlers.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "get(self):", "Modified_Line": "-        self.redirect(self.request.uri.rstrip('/'))\n"}]}]}
{"num": 770, "cve": "CVE-2020-15278", "des": "Red Discord Bot before version 3.4.1 has an unauthorized privilege escalation exploit in the Mod module. This exploit allows Discord users with a high privilege level within the guild to bypass hierarchy checks when the application is in a specific condition that is beyond that user's control. By abusing this exploit, it is possible to perform destructive actions within the guild the user has high privileges in. This exploit has been fixed in version 3.4.1. As a workaround, unloading the Mod module with unload mod or, disabling the massban command with command disable global massban can render this exploit not accessible. We still highly recommend updating to 3.4.1 to completely patch this issue.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/Cog-Creators/Red-DiscordBot/commits/726bfd38adfdfaef760412a68e01447b470f438b", "html_url": "https://github.com/Cog-Creators/Red-DiscordBot/commit/726bfd38adfdfaef760412a68e01447b470f438b", "filename_list": ["./data/python/python_filter/770_0@Cog-Creators@Red-DiscordBot@21f9a6f0b6614ce350d0643b36df9f38885e01e8@redbot_cogs_mod_kickban.py.txt"], "patch_list": [{"patch_file": "redbot/cogs/mod/kickban.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "remove_processed(ids):", "Modified_Line": "        for user_id in user_ids:\n-            user = guild.get_member(user_id)\n-            if user is not None:\n-                if user_id in tempbans:\n-                    continue\n                else:\n-                    try:\n-                        success, reason = await self.ban_user(\n-                            user=user, ctx=ctx, days=days, reason=reason, create_modlog_case=True\n-                        )\n-                        if success:\n-                            banned.append(user_id)\n-                        else:\n-                            errors[user_id] = _(\"Failed to ban user {user_id}: {reason}\").format(\n-                                user_id=user_id, reason=reason\n-                            )\n-                    except Exception as e:\n-                        errors[user_id] = _(\"Failed to ban user {user_id}: {reason}\").format(\n-                            user_id=user_id, reason=e\n-                        )\n"}]}]}
{"num": 772, "cve": "CVE-2020-26280", "des": "OpenSlides is a free, Web-based presentation and assembly system for managing and projecting agenda, motions, and elections of assemblies. OpenSlides version 3.2, due to unsufficient user input validation and escaping, it is vulnerable to persistant cross-site scripting (XSS). In the web applications users can enter rich text in various places, e.g. for personal notes or in motions. These fields can be used to store arbitrary JavaScript Code that will be executed when other users read the respective text. An attacker could utilize this vulnerability be used to manipulate votes of other users, hijack the moderators session or simply disturb the meeting. The vulnerability was introduced with 6eae497abeab234418dfbd9d299e831eff86ed45 on 16.04.2020, which is first included in the 3.2 release. It has been patched in version 3.3 ( in commit f3809fc8a97ee305d721662a75f788f9e9d21938, merged in master on 20.11.2020).", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/OpenSlides/OpenSlides/commits/f3809fc8a97ee305d721662a75f788f9e9d21938", "html_url": "https://github.com/OpenSlides/OpenSlides/commit/f3809fc8a97ee305d721662a75f788f9e9d21938", "filename_list": ["./data/python/python_filter/772_0@OpenSlides@OpenSlides@bed9b3a958d66b88b9bef775eca49f9ee53d2297@server_openslides_utils_validate.py.txt"], "patch_list": [{"patch_file": "server/openslides/utils/validate.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "allow_all(tag: str, name: str, value: str) -> bool:", "Modified_Line": "-    return True\n-\n-\n-allowed_attributes = allow_all\n"}]}]}
{"num": 775, "cve": "CVE-2020-26257", "des": "Matrix is an ecosystem for open federated Instant Messaging and VoIP. Synapse is a reference \"homeserver\" implementation of Matrix. A malicious or poorly-implemented homeserver can inject malformed events into a room by specifying a different room id in the path of a `/send_join`, `/send_leave`, `/invite` or `/exchange_third_party_invite` request. This can lead to a denial of service in which future events will not be correctly sent to other servers over federation. This affects any server which accepts federation requests from untrusted servers. The Matrix Synapse reference implementation before version 1.23.1 the implementation is vulnerable to this injection attack. Issue is fixed in version 1.23.1. As a workaround homeserver administrators could limit access to the federation API to trusted servers (for example via `federation_domain_whitelist`).", "cwe_list": ["CWE-400"], "cwe_name_lst": ["Uncontrolled Resource Consumption"], "url": "https://api.github.com/repos/matrix-org/synapse/commits/3ce2f303f15f6ac3dc352298972dc6e04d9b7a8b", "html_url": "https://github.com/matrix-org/synapse/commit/3ce2f303f15f6ac3dc352298972dc6e04d9b7a8b", "filename_list": ["./data/python/python_filter/775_0@matrix-org@synapse@244bff4edd620998abd033050922994e74294c16@synapse_federation_federation_server.py.txt"], "patch_list": [{"patch_file": "synapse/federation/federation_server.py", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "on_send_join_request(", "Modified_Line": "        -room_version = await self.store.get_room_version(room_id)\n"}, {"Modified_Block_Num": "2", "Modified_Function": "on_send_leave_request(", "Modified_Line": "-        room_version = await self.store.get_room_version(room_id)\n"}, {"Modified_Block_Num": "3", "Modified_Function": "on_exchange_third_party_invite_request(", "Modified_Line": "-        ret = await self.handler.on_exchange_third_party_invite_request(\n-            room_id, event_dict\n-        )\n"}]}]}
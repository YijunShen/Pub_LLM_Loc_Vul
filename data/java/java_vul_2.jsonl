{"num": 1, "cve": "CVE-2022-44645", "des": "In Apache Linkis <=1.3.0 when used with the MySQL Connector/J, a deserialization vulnerability with possible remote code execution impact exists when an attacker has write access to a database and configures new datasource with a MySQL data source and malicious parameters. Therefore, the parameters in the jdbc url should be blacklisted. Versions of Apache Linkis <= 1.3.0 will be affected.\n\nWe recommend users to upgrade the version of Linkis to version 1.3.1.\n", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/apache/linkis/commits/584ea70b2290bcf92afdc92f64ec9b2f6b0ab9d5", "html_url": "https://github.com/apache/linkis/commit/584ea70b2290bcf92afdc92f64ec9b2f6b0ab9d5", "filename_list": ["./data/java/java_filter/1_0@apache@linkis@a3d4003e6e2ad5e73f566ec08cbdf21f8605f2a0@linkis-engineconn-plugins_jdbc_src_main_java_org_apache_linkis_manager_engineplugin_jdbc_utils_JdbcParamUtils.java.txt","./data/java/java_filter/1_1@apache@linkis@a3d4003e6e2ad5e73f566ec08cbdf21f8605f2a0@linkis-public-enhancements_linkis-datasource_linkis-metadata-query_service_jdbc_src_main_java_org_apache_linkis_metadata_query_service_mysql_SqlConnection.java.txt"], "patch_list": [{"patch_file": "linkis-engineconn-plugins/jdbc/src/main/java/org/apache/linkis/manager/engineplugin/jdbc/utils/JdbcParamUtils.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static String filterJdbcUrl(String url) {", "Modified_Line": "-    if (!url.startsWith(JDBC_MYSQL_PROTOCOL) && !url.toLowerCase().contains(JDBC_MYSQL_PROTOCOL)) {\n      return url;\n    }\n-    if (url.contains(SENSITIVE_PARAM)) {\n-      int index = url.indexOf(SENSITIVE_PARAM);\n-      String tmp = SENSITIVE_PARAM;\n-      if (url.charAt(index - 1) == AND_SYMBOL) {\n-        tmp = AND_SYMBOL + tmp;\n-      } else if (url.charAt(index + 1) == AND_SYMBOL) {\n-        tmp = tmp + AND_SYMBOL;\n      }\n-      LOG.warn(\"Sensitive param: {} in jdbc url is filtered.\", tmp);\n-      url = url.replace(tmp, \"\");\n"}]}, {"patch_file": "linkis-public-enhancements/linkis-datasource/linkis-metadata-query/service/jdbc/src/main/java/org/apache/linkis/metadata/query/service/mysql/SqlConnection.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private void validateParams(Map<String, Object> extraParams) {", "Modified_Line": "      String key = entry.getKey();\n-      if (\"allowLoadLocalInfile\".equalsIgnoreCase(key)\n-          || \"autoDeserialize\".equalsIgnoreCase(key)\n-          || \"allowLocalInfile\".equalsIgnoreCase(key)\n-          || \"allowUrlInLocalInfile\".equalsIgnoreCase(key)) {\n-        extraParams.remove(key);\n"}]}]}
{"num": 2, "cve": "CVE-2022-44644", "des": "In Apache Linkis <=1.3.0 when used with the MySQL Connector/J in the data source module, an authenticated attacker could read arbitrary local files by connecting a rogue MySQL server, By adding allowLoadLocalInfile to true in the JDBC parameter. Therefore, the parameters in the JDBC URL should be blacklisted. Versions of Apache Linkis <= 1.3.0 will be affected. \n\nWe recommend users upgrade the version of Linkis to version 1.3.1\n", "cwe_list": ["CWE-200", "CWE-20", "CWE-312"], "cwe_name_lst": ["Exposure of Sensitive Information to an Unauthorized Actor", "Improper Input Validation", "Cleartext Storage of Sensitive Information"], "url": "https://api.github.com/repos/apache/linkis/commits/b9a13c52e1fc6f370727d6ab0e69f289dd603211", "html_url": "https://github.com/apache/linkis/commit/b9a13c52e1fc6f370727d6ab0e69f289dd603211", "filename_list": ["./data/java/java_filter/2_0@apache@linkis@b5a7ef1c4915246a57bea38b31740b7cdcc167f3@linkis-public-enhancements_linkis-datasource_linkis-metadata-query_service_jdbc_src_main_java_org_apache_linkis_metadata_query_service_mysql_SqlConnection.java.txt"], "patch_list": [{"patch_file": "linkis-public-enhancements/linkis-datasource/linkis-metadata-query/service/jdbc/src/main/java/org/apache/linkis/metadata/query/service/mysql/SqlConnection.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public SqlConnection(", "Modified_Line": "    connectMessage = new ConnectMessage(host, port, username, password, extraParams);\n    conn = getDBConnection(connectMessage, database);\n"}]}]}
{"num": 3, "cve": "CVE-2023-24426", "des": "Jenkins Azure AD Plugin 303.va_91ef20ee49f and earlier does not invalidate the previous session on login.", "cwe_list": ["CWE-613"], "cwe_name_lst": ["Insufficient Session Expiration"], "url": "https://api.github.com/repos/jenkinsci/bitbucket-oauth-plugin/commits/b73ac285f8cfcc9727f089c6b2c7f13412285e7c", "html_url": "https://github.com/jenkinsci/bitbucket-oauth-plugin/commit/b73ac285f8cfcc9727f089c6b2c7f13412285e7c", "filename_list": ["./data/java/java_filter/3_0@jenkinsci@bitbucket-oauth-plugin@a927a8ff2e069afebb97f33f6798033ef4451e4f@src_main_java_org_jenkinsci_plugins_BitbucketSecurityRealm.java.txt"], "patch_list": [{"patch_file": "src/main/java/org/jenkinsci/plugins/BitbucketSecurityRealm.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public HttpResponse doFinishLogin(StaplerRequest request) throws IOException {", "Modified_Line": "        String code = request.getParameter(\"code\");\n        String state = request.getParameter(\"state\");\n-        if (state == null || !StringUtils.equals(state, (String) request.getSession().getAttribute(STATE_ATTRIBUTE))) {\n            return HttpResponses.redirectToContextRoot();\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public HttpResponse doFinishLogin(StaplerRequest request) throws IOException {", "Modified_Line": "-        String referer = (String) request.getSession().getAttribute(REFERER_ATTRIBUTE);\n"}]}]}
{"num": 4, "cve": "CVE-2023-24428", "des": "A cross-site request forgery (CSRF) vulnerability in Jenkins Bitbucket OAuth Plugin 0.12 and earlier allows attackers to trick users into logging in to the attacker's account.", "cwe_list": ["CWE-352"], "cwe_name_lst": ["Cross-Site Request Forgery (CSRF)"], "url": "https://api.github.com/repos/jenkinsci/bitbucket-oauth-plugin/commits/a927a8ff2e069afebb97f33f6798033ef4451e4f", "html_url": "https://github.com/jenkinsci/bitbucket-oauth-plugin/commit/a927a8ff2e069afebb97f33f6798033ef4451e4f", "filename_list": ["./data/java/java_filter/4_0@jenkinsci@bitbucket-oauth-plugin@80a37147784079f2a7e4cd7ac9d28ede56bc4b8a@src_main_java_org_jenkinsci_plugins_BitbucketSecurityRealm.java.txt"], "patch_list": [{"patch_file": "src/main/java/org/jenkinsci/plugins/BitbucketSecurityRealm.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public HttpResponse doCommenceLogin(StaplerRequest request, @Header(\"Referer\") f", "Modified_Line": "        request.getSession().setAttribute(REFERER_ATTRIBUTE, referer);\n        Jenkins jenkins = Jenkins.getInstance();\n        String rootUrl = jenkins.getRootUrl();\n        String callback = rootUrl + \"/securityRealm/finishLogin\";\n        BitbucketApiService bitbucketApiService = new BitbucketApiService(clientID, getSecretClientSecret().getPlainText(), callback);\n-        return new HttpRedirect(bitbucketApiService.createAuthorizationCodeURL(null));\n"},{"Modified_Block_Num": "2", "Modified_Function": "public HttpResponse doFinishLogin(StaplerRequest request) throws IOException {", "Modified_Line": "        String code = request.getParameter(\"code\");\n        String rawClientSecret = getSecretClientSecret().getPlainText();\n        Token accessToken = new BitbucketApiService(clientID, rawClientSecret).getTokenByAuthorizationCode(code, null);\n        if (!accessToken.isEmpty()) {\n            BitbucketAuthenticationToken auth = new BitbucketAuthenticationToken(accessToken, clientID, rawClientSecret);\n            SecurityContextHolder.getContext().setAuthentication(auth);\n            User u = User.current();\n            BitbucketUser userDetails = auth.getBitbucketUser();\n        } else {\n            LOGGER.log(Level.SEVERE, \"doFinishLogin() accessToken = null\");\n        }\n        String referer = (String) request.getSession().getAttribute(REFERER_ATTRIBUTE);\n        if (referer != null) {\n            return HttpResponses.redirectTo(referer);\n        } else {\n            return HttpResponses.redirectToContextRoot();\n"}]}]}
{"num": 5, "cve": "CVE-2023-24427", "des": "Jenkins Bitbucket OAuth Plugin 0.12 and earlier does not invalidate the previous session on login.", "cwe_list": ["CWE-384"], "cwe_name_lst": ["Session Fixation"], "url": "https://api.github.com/repos/jenkinsci/bitbucket-oauth-plugin/commits/b73ac285f8cfcc9727f089c6b2c7f13412285e7c", "html_url": "https://github.com/jenkinsci/bitbucket-oauth-plugin/commit/b73ac285f8cfcc9727f089c6b2c7f13412285e7c", "filename_list": ["./data/java/java_filter/5_0@jenkinsci@bitbucket-oauth-plugin@a927a8ff2e069afebb97f33f6798033ef4451e4f@src_main_java_org_jenkinsci_plugins_BitbucketSecurityRealm.java.txt"], "patch_list": [{"patch_file": "src/main/java/org/jenkinsci/plugins/BitbucketSecurityRealm.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public HttpResponse doFinishLogin(StaplerRequest request) throws IOException {", "Modified_Line": "        String code = request.getParameter(\"code\");\n        String state = request.getParameter(\"state\");\n-        if (state == null || !StringUtils.equals(state, (String) request.getSession().getAttribute(STATE_ATTRIBUTE))) {\n            LOGGER.log(Level.SEVERE, \"doFinishLogin() invalid state parameter\");\n            return HttpResponses.redirectToContextRoot();\n-        String referer = (String) request.getSession().getAttribute(REFERER_ATTRIBUTE);\n"}]}]}
{"num": 6, "cve": "CVE-2023-24422", "des": "A sandbox bypass vulnerability involving map constructors in Jenkins Script Security Plugin 1228.vd93135a_2fb_25 and earlier allows attackers with permission to define and run sandboxed scripts, including Pipelines, to bypass the sandbox protection and execute arbitrary code in the context of the Jenkins controller JVM.", "cwe_list": ["CWE-78"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "url": "https://api.github.com/repos/jenkinsci/script-security-plugin/commits/4880bbe905a6783d80150c8b881d0127430d4a73", "html_url": "https://github.com/jenkinsci/script-security-plugin/commit/4880bbe905a6783d80150c8b881d0127430d4a73", "filename_list": ["./data/java/java_filter/6_0@jenkinsci@script-security-plugin@d93135a2fb250c04cc361b0bb1efd809bc63ad08@src_main_java_org_jenkinsci_plugins_scriptsecurity_sandbox_groovy_SandboxInterceptor.java.txt"], "patch_list": [{"patch_file": "src/main/java/org/jenkinsci/plugins/scriptsecurity/sandbox/groovy/SandboxInterceptor.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "@Override public Object onNewInstance(GroovyInterceptor.Invoker invoker, Class receiver, Object... args) throws Throwable {", "Modified_Line": "        Constructor<?> c = GroovyCallSiteSelector.constructor(receiver, args);\n        if (c == null) {\n            throw new RejectedAccessException(\"No such constructor found: new \" + EnumeratingWhitelist.getName(receiver) + printArgumentTypes(args));\n        } else if (StaticWhitelist.isPermanentlyBlacklistedConstructor(c)) {\n            throw StaticWhitelist.rejectNew(c);\n        } else if (whitelist.permitsConstructor(c, args)) {\n            return super.onNewInstance(invoker, receiver, args);\n        } else {\n            throw StaticWhitelist.rejectNew(c);\n"}]}]}
{"num": 8, "cve": "CVE-2023-24425", "des": "Jenkins Kubernetes Credentials Provider Plugin 1.208.v128ee9800c04 and earlier does not set the appropriate context for Kubernetes credentials lookup, allowing attackers with Item/Configure permission to access and potentially capture Kubernetes credentials they are not entitled to.", "cwe_list": ["NVD-CWE-noinfo"], "cwe_name_lst": ["none"], "url": "https://api.github.com/repos/jenkinsci/kubernetes-credentials-provider-plugin/commits/862c6e5fb1ef65968ebfa399239cbef4fff7afc6", "html_url": "https://github.com/jenkinsci/kubernetes-credentials-provider-plugin/commit/862c6e5fb1ef65968ebfa399239cbef4fff7afc6", "filename_list": ["./data/java/java_filter/8_0@jenkinsci@kubernetes-credentials-provider-plugin@128ee9800c048d89c334f901a9671608e1218e4e@src_main_java_com_cloudbees_jenkins_plugins_kubernetes_credentials_provider_KubernetesCredentialProvider.java.txt"], "patch_list": [{"patch_file": "src/main/java/com/cloudbees/jenkins/plugins/kubernetes_credentials_provider/KubernetesCredentialProvider.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public <C extends Credentials> List<C> getCredentials(Class<C> type, ItemGroup i", "Modified_Line": "                    LOG.log(Level.FINEST, \"getCredentials {0} matches, adding to list\", credential.getId());\n                    list.add(type.cast(credential));\n-                if (type.isAssignableFrom(credential.getClass())) {\n"}]}]}
{"num": 9, "cve": "CVE-2023-24430", "des": "Jenkins Semantic Versioning Plugin 1.14 and earlier does not configure its XML parser to prevent XML external entity (XXE) attacks.", "cwe_list": ["CWE-611"], "cwe_name_lst": ["Improper Restriction of XML External Entity Reference"], "url": "https://api.github.com/repos/jenkinsci/semantic-versioning-plugin/commits/8df2fabd7d7396ae29c374914d1357744d3e454f", "html_url": "https://github.com/jenkinsci/semantic-versioning-plugin/commit/8df2fabd7d7396ae29c374914d1357744d3e454f", "filename_list": ["./data/java/java_filter/9_0@jenkinsci@semantic-versioning-plugin@c67a89822f86a7d10498ea2783b833052b719086@src_main_java_org_jenkinsci_plugins_SemanticVersioning_parsing_PomParser.java.txt"], "patch_list": [{"patch_file": "src/main/java/org/jenkinsci/plugins/SemanticVersioning/parsing/PomParser.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public Document invoke(File pom, VirtualChannel channel)", "Modified_Line": "-\t\t\t\t\t\tDocumentBuilder documentBuilder;\n-\t\t\t\t\t\tdocumentBuilder = DocumentBuilderFactory.newInstance()\n-\t\t\t\t\t\t\t\t.newDocumentBuilder();\n\t\t\t\t\t\treturn documentBuilder.parse(pom);\n"}]}]}
{"num": 19, "cve": "CVE-2023-0301", "des": "Cross-site Scripting (XSS) - Stored in GitHub repository alfio-event/alf.io prior to Alf.io 2.0-M4-2301.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/alfio-event/alf.io/commits/21cb2866e5f58b4a2b4a2cb0066479bbb26f7b39", "html_url": "https://github.com/alfio-event/alf.io/commit/21cb2866e5f58b4a2b4a2cb0066479bbb26f7b39", "filename_list": ["./data/java/java_filter/19_0@alfio-event@alf.io@586cf796893849c829fc9ceece468d6a82750610@src_main_java_alfio_util_MustacheCustomTag.java.txt"], "patch_list": [{"patch_file": "src/main/java/alfio/util/MustacheCustomTag.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void setAttributes(Node node, String tagName, Map<String, String> attribu", "Modified_Line": "            if (node instanceof Link) {\n                Link l = (Link) node;\n                String destination = StringUtils.trimToEmpty(l.getDestination());\n                if (UrlUtils.isAbsoluteUrl(destination)) {\n                    attributes.put(\"target\", \"_blank\");\n                    attributes.put(\"rel\", \"nofollow noopener noreferrer\");\n                    var newTabLabel = A11Y_NEW_TAB_LABEL.get();\n                    if (newTabLabel != null) {\n                        attributes.put(\"aria-label\", ((Text)node.getFirstChild()).getLiteral() + \" \" + newTabLabel);\n"}]}]}
{"num": 21, "cve": "CVE-2022-3782", "des": "keycloak: path traversal via double URL encoding. A flaw was found in Keycloak, where it does not properly validate URLs included in a redirect. An attacker can use this flaw to construct a malicious request to bypass validation and access other URLs and potentially sensitive information within the domain or possibly conduct further attacks. This flaw affects any client that utilizes a wildcard in the Valid Redirect URIs field.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/keycloak/keycloak/commits/1987c942f527b9f3bbf2a86ba71ba8ae0154ac37", "html_url": "https://github.com/keycloak/keycloak/commit/1987c942f527b9f3bbf2a86ba71ba8ae0154ac37", "filename_list": ["./data/java/java_filter/21_0@keycloak@keycloak@1ed81fa3772220cb8018654e40645f981c934da6@services_src_main_java_org_keycloak_protocol_oidc_utils_RedirectUtils.java.txt"], "patch_list": [{"patch_file": "services/src/main/java/org/keycloak/protocol/oidc/utils/RedirectUtils.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static String verifyRedirectUri(KeycloakSession session, String rootUrl,", "Modified_Line": "        if (redirectUri != null) {\n            try {\n                URI uri = URI.create(redirectUri);\n                redirectUri = uri.normalize().toString();\n        if (redirectUri == null) {\n            if (!requireRedirectUri) {\n                redirectUri = getSingleValidRedirectUri(validRedirects);\n            }\n        } else if (validRedirects.isEmpty()) {\n            logger.debug(\"No Redirect URIs supplied\");\n            redirectUri = null;\n        } else {\n            redirectUri = lowerCaseHostname(redirectUri);\n            String r = redirectUri;\n            Set<String> resolveValidRedirects = resolveValidRedirects(session, rootUrl, validRedirects);\n            boolean valid = matchesRedirects(resolveValidRedirects, r);\n            if (!valid && (r.startsWith(Constants.INSTALLED_APP_URL) || r.startsWith(Constants.INSTALLED_APP_LOOPBACK)) && r.indexOf(':', Constants.INSTALLED_APP_URL.length()) >= 0) {\n                int i = r.indexOf(':', Constants.INSTALLED_APP_URL.length());\n                StringBuilder sb = new StringBuilder();\n                sb.append(r.substring(0, i));\n                i = r.indexOf('/', i);\n                if (i >= 0) {\n                    sb.append(r.substring(i));\n                }\n                r = sb.toString();\n                valid = matchesRedirects(resolveValidRedirects, r);\n            }\n            if (valid && redirectUri.startsWith(\"/\")) {\n                redirectUri = relativeToAbsoluteURI(session, rootUrl, redirectUri);\n            }\n            redirectUri = valid ? redirectUri : null;\n        }\n        if (Constants.INSTALLED_APP_URN.equals(redirectUri)) {\n            return Urls.realmInstalledAppUrnCallback(uriInfo.getBaseUri(), realm.getName()).toString();\n        } else {\n            return redirectUri;\n"}]}]}
{"num": 22, "cve": "CVE-2022-24913", "des": "Versions of the package com.fasterxml.util:java-merge-sort before 1.1.0 are vulnerable to Insecure Temporary File in the StdTempFileProvider() function in StdTempFileProvider.java, which uses the permissive File.createTempFile() function, exposing temporary file contents.", "cwe_list": ["CWE-668"], "cwe_name_lst": ["Exposure of Resource to Wrong Sphere"], "url": "https://api.github.com/repos/cowtowncoder/java-merge-sort/commits/450fdee70b5f1181c2afc5d817f293efa1a543902", "html_url": "https://github.com/cowtowncoder/java-merge-sort/commit/450fdee70b5f181c2afc5d817f293efa1a543902", "filename_list": ["./data/java/java_filter/22_0@cowtowncoder@java-merge-sort@83b29a8ab784ff4c6cd05517371aa9893409d29b@src_main_java_com_fasterxml_sort_std_StdTempFileProvider.java.txt"], "patch_list": [{"patch_file": "src/main/java/com/fasterxml/sort/std/StdTempFileProvider.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public File provide() throws IOException", "Modified_Line": "-        File f = File.createTempFile(_prefix, _suffix);\n"}]}]}
{"num": 28, "cve": "CVE-2022-4878", "des": "A vulnerability classified as critical has been found in JATOS. Affected is the function ZipUtil of the file modules/common/app/utils/common/ZipUtil.java of the component ZIP Handler. The manipulation leads to path traversal. Upgrading to version 3.7.5-alpha is able to address this issue. The name of the patch is 2b42519f309d8164e8811392770ce604cdabb5da. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-217548.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/JATOS/JATOS/commits/2b42519f309d8164e8811392770ce604cdabb5da", "html_url": "https://github.com/JATOS/JATOS/commit/2b42519f309d8164e8811392770ce604cdabb5da", "filename_list": ["./data/java/java_filter/28_0@JATOS@JATOS@09315b918326763dba5cc10f5ce2bd4b3dc7c3ff@modules_common_app_utils_common_ZipUtil.java.txt"], "patch_list": [{"patch_file": "modules/common/app/utils/common/ZipUtil.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static File unzip(File fileToUnzip, File destDir) throws IOException {", "Modified_Line": "        FileUtils.deleteQuietly(destDir);\n        IOUtils.createDir(destDir);\n        destDir.deleteOnExit();\n        File file;\n        ZipFile zipFile = new ZipFile(fileToUnzip);\n        Enumeration<?> zipEnumeration = zipFile.entries();\n        while (zipEnumeration.hasMoreElements()) {\n            ZipEntry zipEntry = (ZipEntry) zipEnumeration.nextElement();\n            String fileName = zipEntry.getName();\n            file = new File(destDir, fileName);\n            if (fileName.endsWith(ZIP_FILE_SEPARATOR)) {\n                file.mkdirs();\n                continue;\n            }\n            File parent = file.getParentFile();\n            if (parent != null) {\n                parent.mkdirs();\n            }\n            InputStream inputStream = zipFile.getInputStream(zipEntry);\n            FileOutputStream fileOutputStream = new FileOutputStream(file);\n            byte[] bytes = new byte[BUFFER_SIZE];\n            int length;\n            while ((length = inputStream.read(bytes)) >= 0) {\n                fileOutputStream.write(bytes, 0, length);\n            }\n            inputStream.close();\n            fileOutputStream.close();\n        }\n        zipFile.close();\n        return destDir;\n    }\n"}]}]}
{"num": 30, "cve": "CVE-2020-36641", "des": "A vulnerability classified as problematic was found in gturri aXMLRPC up to 1.12.0. This vulnerability affects the function ResponseParser of the file src/main/java/de/timroes/axmlrpc/ResponseParser.java. The manipulation leads to xml external entity reference. Upgrading to version 1.14.0 is able to address this issue. The patch is identified as 456752ebc1ef4c0db980cb5b01a0b3cd0a9e0bae. It is recommended to upgrade the affected component. VDB-217450 is the identifier assigned to this vulnerability.", "cwe_list": ["CWE-611"], "cwe_name_lst": ["Improper Restriction of XML External Entity Reference"], "url": "https://api.github.com/repos/gturri/aXMLRPC/commits/ad6615b3ec41353e614f6ea5fdd5b046442a832b", "html_url": "https://github.com/gturri/aXMLRPC/commit/ad6615b3ec41353e614f6ea5fdd5b046442a832b", "filename_list": ["./data/java/java_filter/30_0@gturri@aXMLRPC@2e59d03c961607d32bc9dc5e7aba931338907603@src_main_java_de_timroes_axmlrpc_ResponseParser.java.txt"], "patch_list": [{"patch_file": "src/main/java/de/timroes/axmlrpc/ResponseParser.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public Object parse(SerializerHandler serializerHandler, InputStream response, boolean debugMode) throws XMLRPCException {", "Modified_Line": "\t\t\tDocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\n\t\t\tfactory.setNamespaceAware(true);\n\t\t\tDocumentBuilder builder = factory.newDocumentBuilder();\n\t\t\tDocument dom = builder.parse(response);\n"}]}]}
{"num": 31, "cve": "CVE-2020-36640", "des": "A vulnerability, which was classified as problematic, was found in bonitasoft bonita-connector-webservice up to 1.3.0. This affects the function TransformerConfigurationException of the file src/main/java/org/bonitasoft/connectors/ws/SecureWSConnector.java. The manipulation leads to xml external entity reference. Upgrading to version 1.3.1 is able to address this issue. The patch is named a12ad691c05af19e9061d7949b6b828ce48815d5. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-217443.", "cwe_list": ["CWE-611"], "cwe_name_lst": ["Improper Restriction of XML External Entity Reference"], "url": "https://api.github.com/repos/bonitasoft/bonita-connector-webservice/commits/a12ad691c05af19e9061d7949b6b828ce48815d5", "html_url": "https://github.com/bonitasoft/bonita-connector-webservice/commit/a12ad691c05af19e9061d7949b6b828ce48815d5", "filename_list": ["./data/java/java_filter/31_0@bonitasoft@bonita-connector-webservice@17a214d5a3f8af55080855a67a476497e3235689@src_main_java_org_bonitasoft_connectors_ws_SecureWSConnector.java.txt"], "patch_list": [{"patch_file": "src/main/java/org/bonitasoft/connectors/ws/SecureWSConnector.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "Transformer getTransformer() throws TransformerConfigurationException {", "Modified_Line": "        if (transformer == null) {\n-            transformer = TransformerFactory.newInstance().newTransformer();\n            transformer.setOutputProperty(OutputKeys.INDENT, \"yes\");\n            transformer.setOutputProperty(\"{http://xml.apache.org/xslt}indent-amount\", \"2\");\n"}]}]}
{"num": 34, "cve": "CVE-2023-0481", "des": "In RestEasy Reactive implementation of Quarkus the insecure File.createTempFile() is used in the FileBodyHandler class which creates temp files with insecure permissions that could be read by a local user.", "cwe_list": ["CWE-668"], "cwe_name_lst": ["Exposure of Resource to Wrong Sphere"], "url": "https://api.github.com/repos/quarkusio/quarkus/commits/95d5904f7cf18c8165b97d8ca03b203d7f69c17e", "html_url": "https://github.com/quarkusio/quarkus/commit/95d5904f7cf18c8165b97d8ca03b203d7f69c17e", "filename_list": ["./data/java/java_filter/34_0@quarkusio@quarkus@d52544cf2591bc4b580538d7d3cc947803b00ff2@independent-projects_resteasy-reactive_common_runtime_src_main_java_org_jboss_resteasy_reactive_common_providers_serialisers_FileBodyHandler.java.txt"], "patch_list": [{"patch_file": "independent-projects/resteasy-reactive/common/runtime/src/main/java/org/jboss/resteasy/reactive/common/providers/serialisers/FileBodyHandler.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public File readFrom(Class<File> type, Type genericType,", "Modified_Line": "-        File downloadedFile = File.createTempFile(PREFIX, SUFFIX);\n"}]}]}
{"num": 36, "cve": "CVE-2023-25613", "des": "An LDAP Injection vulnerability exists in the LdapIdentityBackend of Apache Kerby before 2.0.3. ", "cwe_list": ["CWE-74"], "cwe_name_lst": ["Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')"], "url": "https://api.github.com/repos/apache/directory-kerby/commits/a8901ed813d7453beacbcf174bac46f35940feea", "html_url": "https://github.com/apache/directory-kerby/commit/a8901ed813d7453beacbcf174bac46f35940feea", "filename_list": ["./data/java/java_filter/36_0@apache@directory-kerby@a1e7144dfeac5a8b197e587c3125d2e8520507c6@kerby-backend_ldap-backend_src_main_java_org_apache_kerby_kerberos_kdc_identitybackend_LdapIdentityBackend.java.txt"], "patch_list": [{"patch_file": "kerby-backend/ldap-backend/src/main/java/org/apache/kerby/kerberos/kdc/identitybackend/LdapIdentityBackend.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected KrbIdentity doGetIdentity(String principalName) throws KrbException {", "Modified_Line": "-        String searchFilter =\n-            String.format(\"(&(objectclass=krb5principal)(krb5PrincipalName=%s))\", principalName);\n"}]}]}
{"num": 38, "cve": "CVE-2023-25558", "des": "DataHub is an open-source metadata platform. When the DataHub frontend is configured to authenticate via SSO, it will leverage the pac4j library. The processing of the `id_token` is done in an unsafe manner which is not properly accounted for by the DataHub frontend. Specifically, if any of the id_token claims value start with the {#sb64} prefix, pac4j considers the value to be a serialized Java object and will deserialize it. This issue may lead to Remote Code Execution (RCE) in the worst case. Although a `RestrictedObjectInputStream` is in place, that puts some restriction on what classes can be deserialized, it still allows a broad range of java packages and potentially exploitable with different gadget chains. Users are advised to upgrade. There are no known workarounds. This vulnerability was discovered and reported by the GitHub Security lab and is tracked as GHSL-2022-086.", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/datahub-project/datahub/commits/2a182f484677d056730d6b4e9f0143e67368359f", "html_url": "https://github.com/datahub-project/datahub/commit/2a182f484677d056730d6b4e9f0143e67368359f", "filename_list": ["./data/java/java_filter/38_0@datahub-project@datahub@517688d0500e49f25a3c969909102f74a7818d90@datahub-frontend_app_auth_sso_oidc_custom_CustomOidcAuthenticator.java.txt"], "patch_list": [{"patch_file": "datahub-frontend/app/auth/sso/oidc/custom/CustomOidcAuthenticator.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void validate(final OidcCredentials credentials, final WebContext context", "Modified_Line": "-        final TokenRequest request = createTokenRequest(new AuthorizationCodeGrant(code, new URI(computedCallbackUrl)));\n"}]}]}
{"num": 39, "cve": "CVE-2022-4903", "des": "A vulnerability was found in CodenameOne 7.0.70. It has been classified as problematic. Affected is an unknown function. The manipulation leads to use of implicit intent for sensitive communication. It is possible to launch the attack remotely. The complexity of an attack is rather high. The exploitability is told to be difficult. Upgrading to version 7.0.71 is able to address this issue. The patch is identified as dad49c9ef26a598619fc48d2697151a02987d478. It is recommended to upgrade the affected component. VDB-220470 is the identifier assigned to this vulnerability.", "cwe_list": ["CWE-668"], "cwe_name_lst": ["Exposure of Resource to Wrong Sphere"], "url": "https://api.github.com/repos/codenameone/CodenameOne/commits/dad49c9ef26a598619fc48d2697151a02987d478", "html_url": "https://github.com/codenameone/CodenameOne/commit/dad49c9ef26a598619fc48d2697151a02987d478", "filename_list": ["./data/java/java_filter/39_0@codenameone@CodenameOne@79a8e37adb7dd48093779bd3657142e607bdd2d9@Ports_Android_src_com_codename1_impl_android_AndroidImplementation.java.txt", "./data/java/java_filter/39_1@codenameone@CodenameOne@79a8e37adb7dd48093779bd3657142e607bdd2d9@Ports_Android_src_com_codename1_impl_android_CodenameOneActivity.java.txt", "./data/java/java_filter/39_2@codenameone@CodenameOne@79a8e37adb7dd48093779bd3657142e607bdd2d9@Ports_Android_src_com_codename1_impl_android_PushNotificationService.java.txt", "./data/java/java_filter/39_3@codenameone@CodenameOne@79a8e37adb7dd48093779bd3657142e607bdd2d9@Ports_Android_src_com_codename1_location_AndroidLocationPlayServiceManager.java.txt", "./data/java/java_filter/39_4@codenameone@CodenameOne@79a8e37adb7dd48093779bd3657142e607bdd2d9@Ports_Android_src_com_codename1_media_BackgroundAudioService.java.txt"], "patch_list": [{"patch_file": "Ports/Android/src/com/codename1/impl/android/AndroidImplementation.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static void addActionsToNotification(PushActionsProvider provider, String", "Modified_Line": "-            PendingIntent contentIntent = PendingIntent.getActivity(context, requestCode++, newIntent, PendingIntent.FLAG_CANCEL_CURRENT);\r\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public Object notifyStatusBar(String tickerText, String contentTitle,", "Modified_Line": "-        PendingIntent contentIntent = PendingIntent.getActivity(getContext(), 0, notificationIntent, 0);\r\n"}, {"Modified_Block_Num": "3", "Modified_Function": "public void scheduleLocalNotification(LocalNotification notif, long firstTime, i", "Modified_Line": "-            PendingIntent pendingIntent = PendingIntent.getService(context, 0,\r\n-                    intent,\r\n-                    PendingIntent.FLAG_UPDATE_CURRENT);\r\n            notificationIntent.putExtra(LocalNotificationPublisher.BACKGROUND_FETCH_INTENT, pendingIntent);\r\n        } else {\r\n            contentIntent.setData(Uri.parse(\"http://codenameone.com/a?LocalNotificationID=\"+Uri.encode(notif.getId())));\r\n        }\r\n-        PendingIntent pendingContentIntent = PendingIntent.getActivity(getContext(), 0, contentIntent, PendingIntent.FLAG_UPDATE_CURRENT);\r\n        notificationIntent.putExtra(LocalNotificationPublisher.NOTIFICATION_INTENT, pendingContentIntent);\r\n-        PendingIntent pendingIntent = PendingIntent.getBroadcast(getContext(), 0, notificationIntent, PendingIntent.FLAG_UPDATE_CURRENT);\r\n"}, {"Modified_Block_Num": "4", "Modified_Function": "public void cancelLocalNotification(String notificationId) {", "Modified_Line": "-        PendingIntent pendingIntent = PendingIntent.getBroadcast(getContext(), 0, notificationIntent, PendingIntent.FLAG_UPDATE_CURRENT);\r\n"}]}, {"patch_file": "Ports/Android/src/com/codename1/impl/android/CodenameOneActivity.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void registerForPush(String key) {", "Modified_Line": "-        registrationIntent.putExtra(\"app\", PendingIntent.getBroadcast(this, 0, new Intent(), 0)); // boilerplate\n"},{"Modified_Block_Num": "2", "Modified_Function": "public void stopReceivingPush() {", "Modified_Line": "-        unregIntent.putExtra(\"app\", PendingIntent.getBroadcast(this, 0, new Intent(), 0));\n"}]}, {"patch_file": "Ports/Android/src/com/codename1/impl/android/PushNotificationService.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void run() {", "Modified_Line": "-            PendingIntent contentIntent = PendingIntent.getActivity(this, 0, newIntent, PendingIntent.FLAG_CANCEL_CURRENT);\n"}]}, {"patch_file": "Ports/Android/src/com/codename1/location/AndroidLocationPlayServiceManager.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void run() {", "Modified_Line": "-                            PendingIntent pendingIntent = PendingIntent.getService(context, 0,\r\n-                                    intent,\r\n-                                    PendingIntent.FLAG_UPDATE_CURRENT);\r\n"}, {"Modified_Block_Num": "2", "Modified_Function": "private PendingIntent createBackgroundPendingIntent(boolean forceService) {", "Modified_Line": "-            PendingIntent pendingIntent = PendingIntent.getBroadcast(context, 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);\r\n            return pendingIntent;\r\n        } else {\r\n            Intent intent = new Intent(context, BackgroundLocationHandler.class);\r\n            intent.setData(Uri.parse(\"http://codenameone.com/a?\" + bgListenerClass.getName()));\r\n-            PendingIntent pendingIntent = PendingIntent.getService(context, 0,\r\n-                    intent,\r\n-                    PendingIntent.FLAG_UPDATE_CURRENT);\r\n"}, {"Modified_Block_Num": "3", "Modified_Function": "public void run() {", "Modified_Line": "-                            PendingIntent pendingIntent = PendingIntent.getService(context, 0,\r\n-                                    intent,\r\n-                                    PendingIntent.FLAG_UPDATE_CURRENT);\r\n"}, {"Modified_Block_Num": "4", "Modified_Function": "private PendingIntent createGeofencePendingIntent(Class geofenceListenerClass, c", "Modified_Line": "-            geofencePendingIntent = PendingIntent.getBroadcast(AndroidNativeUtil.getContext().getApplicationContext(), 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);\r\n            return geofencePendingIntent;\r\n        } else {\r\n            Intent intent = new Intent(context, GeofenceHandler.class);\r\n            intent.putExtra(\"geofenceClass\", geofenceListenerClass.getName());\r\n            intent.putExtra(\"geofenceID\", gf.getId());\r\n-            PendingIntent pendingIntent = PendingIntent.getService(context, 0,\r\n-                    intent,\r\n-                    PendingIntent.FLAG_UPDATE_CURRENT);\r\n"}]}, {"patch_file": "Ports/Android/src/com/codename1/media/BackgroundAudioService.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private void initMediaSession() {", "Modified_Line": "-        PendingIntent pendingIntent = PendingIntent.getBroadcast(this, 0, mediaButtonIntent, 0);\n"}]}]}
{"num": 41, "cve": "CVE-2022-43550", "des": "A command injection vulnerability exists in Jitsi before commit 8aa7be58522f4264078d54752aae5483bfd854b2 when launching browsers on Windows which could allow an attacker to insert an arbitrary URL which opens up the opportunity to remote execution.", "cwe_list": ["CWE-77"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in a Command ('Command Injection')"], "url": "https://api.github.com/repos/jitsi/jitsi/commits/8aa7be58522f4264078d54752aae5483bfd854b2", "html_url": "https://github.com/jitsi/jitsi/commit/8aa7be58522f4264078d54752aae5483bfd854b2", "filename_list": ["./data/java/java_filter/41_0@jitsi@jitsi@08fd0a8ee531c07cab3526405d69d79659a1b087@modules_service_browserlauncher_src_main_java_net_java_sip_communicator_impl_browserlauncher_BrowserLauncherImpl.java.txt"], "patch_list": [{"patch_file": "modules/service/browserlauncher/src/main/java/net/java/sip/communicator/impl/browserlauncher/BrowserLauncherImpl.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": " public void openURL(final String url)", "Modified_Line": "        Thread launchBrowserThread\n            = new Thread(getClass().getName())\n                    {\n                        @Override\n                        public void run()\n                        {\n                            try\n                            {\n                                launchBrowser(url);\n                            }\n                            catch (Exception e)\n                            {\n                                logger.error(\"Failed to launch browser\", e);\n                            }\n                        }\n                    };\n        launchBrowserThread.start();\n    }\n"}]}]}
{"num": 42, "cve": "CVE-2023-24815", "des": "Vert.x-Web is a set of building blocks for building web applications in the java programming language. When running vertx web applications that serve files using `StaticHandler` on Windows Operating Systems and Windows File Systems, if the mount point is a wildcard (`*`) then an attacker can exfiltrate any class path resource. When computing the relative path to locate the resource, in case of wildcards, the code: `return \"/\" + rest;` from `Utils.java` returns the user input (without validation) as the segment to lookup. Even though checks are performed to avoid escaping the sandbox, given that the input was not sanitized `\\` are not properly handled and an attacker can build a path that is valid within the classpath. This issue only affects users deploying in windows environments and upgrading is the advised remediation path. There are no known workarounds for this vulnerability.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/vert-x3/vertx-web/commits/9e3a783b1d1a731055e9049078b1b1494ece9c15", "html_url": "https://github.com/vert-x3/vertx-web/commit/9e3a783b1d1a731055e9049078b1b1494ece9c15", "filename_list": ["./data/java/java_filter/42_0@vert-x3@vertx-web@1c3a0b16ab6721a4cb87194a1dfabbf6c6cdbcc2@vertx-web_src_main_java_io_vertx_ext_web_impl_Utils.java.txt"], "patch_list": [{"patch_file": "vertx-web/src/main/java/io/vertx/ext/web/impl/Utils.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static String pathOffset(String path, RoutingContext context) {", "Modified_Line": "-      final String rest = context.pathParam(\"*\");\n      if (rest != null) {\n        if (rest.length() > 0) {\n          if (rest.charAt(0) == '/') {\n            return rest;\n          } else {\n            return \"/\" + rest;\n          }\n        } else {\n          return \"/\";\n        }\n      }\n"}]}]}
{"num": 45, "cve": "CVE-2023-24997", "des": "Deserialization of Untrusted Data vulnerability in Apache Software Foundation Apache InLong.This issue affects Apache InLong: from 1.1.0 through 1.5.0. Users are advised to upgrade to Apache InLong's latest version or cherry-pick  https://github.com/apache/inlong/pull/7223 https://github.com/apache/inlong/pull/7223  to solve it.\n\n", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/apache/inlong/commits/835f0d889fa14b14e900c95ac6846dc3b7a3c8d4", "html_url": "https://github.com/apache/inlong/commit/835f0d889fa14b14e900c95ac6846dc3b7a3c8d4", "filename_list": ["./data/java/java_filter/45_1@apache@inlong@ff68b8d0ef6f4927bbdeb5e9f5983389c7c59364@inlong-manager_manager-pojo_src_main_java_org_apache_inlong_manager_pojo_sink_mysql_MySQLSinkDTO.java.txt"], "patch_list": [{"patch_file": "inlong-manager/manager-pojo/src/main/java/org/apache/inlong/manager/pojo/sink/mysql/MySQLSinkDTO.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected static String filterSensitive(String url) {", "Modified_Line": "-            String resultUrl = URLDecoder.decode(url, \"UTF-8\");\n"}]}]}
{"num": 47, "cve": "CVE-2023-28326", "des": "Vendor: The Apache Software Foundation\n\nVersions Affected: Apache OpenMeetings from 2.0.0 before 7.0.0\n\nDescription: Attacker can elevate their privileges in any room\n\n\n", "cwe_list": ["CWE-306"], "cwe_name_lst": ["Missing Authentication for Critical Function"], "url": "https://api.github.com/repos/apache/openmeetings/commits/1fb71af36b660b12031628bf237c04940ebc5cd0", "html_url": "https://github.com/apache/openmeetings/commit/1fb71af36b660b12031628bf237c04940ebc5cd0", "filename_list": ["./data/java/java_filter/47_0@apache@openmeetings@2b088f4357b03fa09c4ed64651789183e7f3c343@openmeetings-web_src_main_java_org_apache_openmeetings_web_common_InvitationForm.java.txt"], "patch_list": [{"patch_file": "openmeetings-web/src/main/java/org/apache/openmeetings/web/common/InvitationForm.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected void updateButtons(AjaxRequestTarget target) {", "Modified_Line": "\t\tCollection<User> recpnts = recipients.getModelObject();\n\t\ttarget.add(\n\t\t\t\tdialog.getSend().setEnabled(!recpnts.isEmpty())\n-\t\t\t\t, dialog.getGenerate().setEnabled(recpnts.size() == 1)\n\t\t\t\t);\n"}]}]}
{"num": 48, "cve": "CVE-2023-25197", "des": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') vulnerability in Apache Software Foundation apache fineract.\nAuthorized users may be able to exploit this for limited impact on components.  \n\nThis issue affects apache fineract: from 1.4 through 1.8.2.\n\n", "cwe_list": ["CWE-89"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "url": "https://api.github.com/repos/apache/fineract/commits/71b73db55007d01589e0fc9e30241486957f10ac", "html_url": "https://github.com/apache/fineract/commit/71b73db55007d01589e0fc9e30241486957f10ac", "filename_list": ["./data/java/java_filter/48_0@apache@fineract@e4c8a7d835d766589ff972c8315753f19fa60481@fineract-provider_src_main_java_org_apache_fineract_infrastructure_security_utils_SQLInjectionValidator.java.txt"], "patch_list": [{"patch_file": "fineract-provider/src/main/java/org/apache/fineract/infrastructure/security/utils/SQLInjectionValidator.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static void validateSQLInput(final String sqlSearch) {", "Modified_Line": "-        String inputSqlString = lowerCaseSQL;\n-        while (inputSqlString.indexOf(\" =\") > 0) { // Don't remove space before\n-            inputSqlString = inputSqlString.replaceAll(\" =\", \"=\");\n-        }\n-        while (inputSqlString.indexOf(\"= \") > 0) { // Don't remove space after =\n-            inputSqlString = inputSqlString.replaceAll(\"= \", \"=\");\n-        }\n"},{"Modified_Block_Num": "2", "Modified_Function": "public static void validateAdhocQuery(final String sqlSearch) {", "Modified_Line": "-        String inputSqlString = lowerCaseSQL;\n-        while (inputSqlString.indexOf(\" =\") > 0) { // Don't remove space before\n-            inputSqlString = inputSqlString.replaceAll(\" =\", \"=\");\n-        }\n-        while (inputSqlString.indexOf(\"= \") > 0) { // Don't remove space after =\n-            inputSqlString = inputSqlString.replaceAll(\"= \", \"=\");\n-        }\n"}]}]}
{"num": 51, "cve": "CVE-2023-20860", "des": "Spring Framework running version 6.0.0 - 6.0.6 or 5.3.0 - 5.3.25 using \"**\" as a pattern in Spring Security configuration with the mvcRequestMatcher creates a mismatch in pattern matching between Spring Security and Spring MVC, and the potential for a security bypass.", "cwe_list": ["NVD-CWE-noinfo"], "cwe_name_lst": ["none"], "url": "https://api.github.com/repos/spring-projects/spring-framework/commits/202fa5cdb3a3d0cfe6967e85fa167d978244f28a", "html_url": "https://github.com/spring-projects/spring-framework/commit/202fa5cdb3a3d0cfe6967e85fa167d978244f28a", "filename_list": ["./data/java/java_filter/51_0@spring-projects@spring-framework@8010de8b63057af06984df5c7550ba99d006e909@spring-webmvc_src_main_java_org_springframework_web_servlet_handler_HandlerMappingIntrospector.java.txt"], "patch_list": [{"patch_file": "spring-webmvc/src/main/java/org/springframework/web/servlet/handler/HandlerMappingIntrospector.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public MatchableHandlerMapping getMatchableHandlerMapping(HttpServletRequest request) throws Exception {", "Modified_Line": "\t\tHttpServletRequest wrappedRequest = new AttributesPreservingRequest(request);\n-\t\treturn doWithMatchingMapping(wrappedRequest, false, (matchedMapping, executionChain) -> {\n-\t\t\tif (matchedMapping instanceof MatchableHandlerMapping matchableHandlerMapping) {\n-\t\t\t\tPathPatternMatchableHandlerMapping mapping = this.pathPatternHandlerMappings.get(matchedMapping);\n-\t\t\t\tif (mapping != null) {\n\t\t\t\t\tRequestPath requestPath = ServletRequestPathUtils.getParsedRequestPath(wrappedRequest);\n-\t\t\t\t\treturn new PathSettingHandlerMapping(mapping, requestPath);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tString lookupPath = (String) wrappedRequest.getAttribute(UrlPathHelper.PATH_ATTRIBUTE);\n-\t\t\t\t\treturn new PathSettingHandlerMapping(matchableHandlerMapping, lookupPath);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthrow new IllegalStateException(\"HandlerMapping is not a MatchableHandlerMapping\");\n\t\t});\n\t}\n"}]}]}
{"num": 53, "cve": "CVE-2023-28630", "des": "GoCD is an open source continuous delivery server. In GoCD versions from 20.5.0 and below 23.1.0, if the server environment is not correctly configured by administrators to provide access to the relevant PostgreSQL or MySQL backup tools, the credentials for database access may be unintentionally leaked to admin alerts on the GoCD user interface. The vulnerability is triggered only if the GoCD server host is misconfigured to have backups enabled, but does not have access to the `pg_dump` or `mysqldump` utility tools to backup the configured database type (PostgreSQL or MySQL respectively). In such cases, failure to launch the expected backup utility reports the shell environment used to attempt to launch in the server admin alert, which includes the plaintext database password supplied to the configured tool. This vulnerability does not affect backups of the default on-disk H2 database that GoCD is configured to use. This issue has been addressed and fixed in GoCD 23.1.0. Users are advised to upgrade. Users unable to upgrade may disable backups, or administrators should ensure that the required `pg_dump` (PostgreSQL) or `mysqldump` (MySQL) binaries are available on the GoCD server when backups are triggered.", "cwe_list": ["CWE-532"], "cwe_name_lst": ["Insertion of Sensitive Information into Log File"], "url": "https://api.github.com/repos/gocd/gocd/commits/6545481e7b36817dd6033bf614585a8db242070d", "html_url": "https://github.com/gocd/gocd/commit/6545481e7b36817dd6033bf614585a8db242070d", "filename_list": ["./data/java/java_filter/53_1@gocd@gocd@e3facea4f17aad4b65604c721d1ed07e5d6f6dda@db-support_db-support-mysql_src_main_java_com_thoughtworks_go_server_database_mysql_MySQLBackupProcessor.java.txt", "./data/java/java_filter/53_2@gocd@gocd@e3facea4f17aad4b65604c721d1ed07e5d6f6dda@db-support_db-support-postgresql_src_main_java_com_thoughtworks_go_server_database_pg_PostgresqlBackupProcessor.java.txt"], "patch_list": [{"patch_file": "db-support/db-support-mysql/src/main/java/com/thoughtworks/go/server/database/mysql/MySQLBackupProcessor.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void backup(File targetDir, DataSource dataSource, DbProperties dbProperties) throws InterruptedException, TimeoutException, IOException {", "Modified_Line": "-        ProcessResult processResult = createProcessExecutor(targetDir, dbProperties).execute();\n-        if (processResult.getExitValue() == 0) {\n-            log.info(\"MySQL backup finished successfully.\");\n-        } else {\n-            log.warn(\"There was an error backing up the database using `mysqldump`. The `mysqldump` process exited with status code {}.\", processResult.getExitValue());\n-            throw new RuntimeException(\"There was an error backing up the database using `mysqldump`. The `mysqldump` process exited with status code \" + processResult.getExitValue() +\n-                    \". Please see the server logs for more errors\");\n"}]}, {"patch_file": "db-support/db-support-postgresql/src/main/java/com/thoughtworks/go/server/database/pg/PostgresqlBackupProcessor.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void backup(File targetDir, DataSource dataSource, DbProperties dbProperties) throws Exception {", "Modified_Line": "-        ProcessResult processResult = createProcessExecutor(targetDir, dbProperties).execute();\n-\n-        if (processResult.getExitValue() == 0) {\n-            log.info(\"PostgreSQL backup finished successfully.\");\n-        } else {\n-            log.warn(\"There was an error backing up the database using `pg_dump`. The `pg_dump` process exited with status code {}.\", processResult.getExitValue());\n-            throw new RuntimeException(\"There was an error backing up the database using `pg_dump`. The `pg_dump` process exited with status code \" + processResult.getExitValue() +\n-                    \". Please see the server logs for more errors.\");\n"}]}]}
{"num": 54, "cve": "CVE-2023-27296", "des": "Deserialization of Untrusted Data vulnerability in Apache Software Foundation Apache InLong.\n\nIt could be triggered by authenticated users of InLong, you could refer to [1] to know more about this vulnerability.\n\nThis issue affects Apache InLong: from 1.1.0 through 1.5.0.  Users are advised to upgrade to Apache InLong's latest version or cherry-pick [2] to solve it.\n\n\n\n[1]  https://programmer.help/blogs/jdbc-deserialization-vulnerability-learning.html\n\n https://programmer.help/blogs/jdbc-deserialization-vulnerability-learning.html \n\n[2]  https://github.com/apache/inlong/pull/7422 https://github.com/apache/inlong/pull/7422 \n\n\n\n", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/apache/inlong/commits/1ec92895349b4af0c866dedbbddae0e974cf64e9", "html_url": "https://github.com/apache/inlong/commit/1ec92895349b4af0c866dedbbddae0e974cf64e9", "filename_list": ["./data/java/java_filter/54_0@apache@inlong@34a7e8f501e9edde01a48b4413fcac3770644536@inlong-manager_manager-pojo_src_main_java_org_apache_inlong_manager_pojo_node_mysql_MySQLDataNodeDTO.java.txt", "./data/java/java_filter/54_1@apache@inlong@34a7e8f501e9edde01a48b4413fcac3770644536@inlong-manager_manager-pojo_src_main_java_org_apache_inlong_manager_pojo_sink_mysql_MySQLSinkDTO.java.txt"], "patch_list": [{"patch_file": "inlong-manager/manager-pojo/src/main/java/org/apache/inlong/manager/pojo/node/mysql/MySQLDataNodeDTO.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static String convertToJdbcurl(String url) {", "Modified_Line": "        String jdbcUrl = url;\n        if (StringUtils.isNotBlank(jdbcUrl) && !jdbcUrl.startsWith(MYSQL_JDBC_PREFIX)) {\n            jdbcUrl = MYSQL_JDBC_PREFIX + jdbcUrl;\n        }\n-        return jdbcUrl;\n"}]}, {"patch_file": "inlong-manager/manager-pojo/src/main/java/org/apache/inlong/manager/pojo/sink/mysql/MySQLSinkDTO.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected static String filterSensitive(String url) {", "Modified_Line": "-    @VisibleForTesting\n-    protected static String filterSensitive(String url) {\n        if (StringUtils.isBlank(url)) {\n            return url;\n"}]}]}
{"num": 55, "cve": "CVE-2023-20861", "des": "In Spring Framework versions 6.0.0 - 6.0.6, 5.3.0 - 5.3.25, 5.2.0.RELEASE - 5.2.22.RELEASE, and older unsupported versions, it is possible for a user to provide a specially crafted SpEL expression that may cause a denial-of-service (DoS) condition.", "cwe_list": ["NVD-CWE-noinfo"], "cwe_name_lst": ["none"], "url": "https://api.github.com/repos/spring-projects/spring-framework/commits/8010de8b63057af06984df5c7550ba99d006e909", "html_url": "https://github.com/spring-projects/spring-framework/commit/8010de8b63057af06984df5c7550ba99d006e909", "filename_list": ["./data/java/java_filter/55_1@spring-projects@spring-framework@5529294ec975f8a309161797670d68c3f0eeab7f@spring-expression_src_main_java_org_springframework_expression_spel_ast_OperatorMatches.java.txt"], "patch_list": [{"patch_file": "spring-expression/src/main/java/org/springframework/expression/spel/ast/OperatorMatches.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public OperatorMatches(ConcurrentMap<String, Pattern> patternCache, int startPos", "Modified_Line": "\t\tSpelNodeImpl leftOp = getLeftOperand();\n\t\tSpelNodeImpl rightOp = getRightOperand();\n-\t\tString left = leftOp.getValue(state, String.class);\n-\t\tObject right = getRightOperand().getValue(state);\n-\t\tif (left == null) {\n\t\t\tthrow new SpelEvaluationException(leftOp.getStartPosition(),\n\t\t\t\t\tSpelMessage.INVALID_FIRST_OPERAND_FOR_MATCHES_OPERATOR, (Object) null);\n\t\t}\n-\t\tif (!(right instanceof String rightString)) {\n\t\t\tthrow new SpelEvaluationException(rightOp.getStartPosition(),\n\t\t\t\t\tSpelMessage.INVALID_SECOND_OPERAND_FOR_MATCHES_OPERATOR, right);\n\t\t}\n\t\ttry {\n-\t\t\tPattern pattern = this.patternCache.get(rightString);\n\t\t\tif (pattern == null) {\n-\t\t\t\tpattern = Pattern.compile(rightString);\n-\t\t\t\tthis.patternCache.putIfAbsent(rightString, pattern);\n\t\t\t}\n-\t\t\tMatcher matcher = pattern.matcher(new MatcherInput(left, new AccessCount()));\n"}]}]} 
{"num": 70, "cve": "CVE-2023-26479", "des": "XWiki Platform is a generic wiki platform. Starting in version 6.0, users with write rights can insert well-formed content that is not handled well by the parser. As a consequence, some pages becomes unusable, including the user index (if the page containing the faulty content is a user page) and the page index.\n\nNote that on the page, the normal UI is completely missing and it is not possible to open the editor directly to revert the change as the stack overflow is already triggered while getting the title of the document. This means that it is quite difficult to remove this content once inserted.\n\nThis has been patched in XWiki 13.10.10, 14.4.6, and 14.9-rc-1. A temporary workaround to avoid Stack Overflow errors is to increase the memory allocated to the stack by using the `-Xss` JVM parameter (e.g., `-Xss32m`). This should allow the parser to pass and to fix the faulty content. The consequences for other aspects of the system (e.g., performance) are unknown, and this workaround should be only be used as a temporary solution. The workaround does not prevent the issue occurring again with other content. Consequently, it is strongly advised to upgrade to a version where the issue has been patched.", "cwe_list": ["CWE-755"], "cwe_name_lst": ["Improper Handling of Exceptional Conditions"], "url": "https://api.github.com/repos/xwiki/xwiki-platform/commits/e5b82cd98072464196a468b8f7fe6396dce142a7", "html_url": "https://github.com/xwiki/xwiki-platform/commit/e5b82cd98072464196a468b8f7fe6396dce142a7", "filename_list": ["./data/java/java_filter/70_0@xwiki@xwiki-platform@d4984c936291ed38d40937d483bb2b7142435f7c@xwiki-platform-core_xwiki-platform-rendering_xwiki-platform-rendering-parser_src_main_java_org_xwiki_rendering_internal_parser_DefaultContentParser.java.txt"], "patch_list": [{"patch_file": "xwiki-platform-core/xwiki-platform-rendering/xwiki-platform-rendering-parser/src/main/java/org/xwiki/rendering/internal/parser/DefaultContentParser.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public class DefaultContentParser implements ContentParser", "Modified_Line": "-        return getParser(syntax).parse(new StringReader(content == null ? \"\" : content));\n"}]}]}
{"num": 73, "cve": "CVE-2023-2258", "des": "Improper Neutralization of Formula Elements in a CSV File in GitHub repository alfio-event/alf.io prior to 2.0-M4-2304.", "cwe_list": ["CWE-1236"], "cwe_name_lst": ["Improper Neutralization of Formula Elements in a CSV File"], "url": "https://api.github.com/repos/alfio-event/alf.io/commits/94e2923a317452e337393789c9f3192dfc1ddac2", "html_url": "https://github.com/alfio-event/alf.io/commit/94e2923a317452e337393789c9f3192dfc1ddac2", "filename_list": ["./data/java/java_filter/73_0@alfio-event@alf.io@a00c7248b49a0afda0ab009078ce7c2be2d12fbf@src_main_java_alfio_util_ExportUtils.java.txt"], "patch_list": [{"patch_file": "src/main/java/alfio/util/ExportUtils.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static void exportCsv(String fileName, String[] header, Stream<String[]>", "Modified_Line": "-            data.forEachOrdered(writer::writeNext);\n"}]}]}
{"num": 77, "cve": "CVE-2023-29528", "des": "XWiki Commons are technical libraries common to several other top level XWiki projects. The \"restricted\" mode of the HTML cleaner in XWiki, introduced in version 4.2-milestone-1 and massively improved in version 14.6-rc-1, allowed the injection of arbitrary HTML code and thus cross-site scripting via invalid HTML comments. As a consequence, any code relying on this \"restricted\" mode for security is vulnerable to JavaScript injection (\"cross-site scripting\"/XSS). When a privileged user with programming rights visits such a comment in XWiki, the malicious JavaScript code is executed in the context of the user session. This allows server-side code execution with programming rights, impacting the confidentiality, integrity and availability of the XWiki instance. This problem has been patched in XWiki 14.10, HTML comments are now removed in restricted mode and a check has been introduced that ensures that comments don't start with `>`. There are no known workarounds apart from upgrading to a version including the fix.\n", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/xwiki/xwiki-commons/commits/8ff1a9d7e5d7b45b690134a537d53dc05cae04ab", "html_url": "https://github.com/xwiki/xwiki-commons/commit/8ff1a9d7e5d7b45b690134a537d53dc05cae04ab", "filename_list": ["./data/java/java_filter/77_1@xwiki@xwiki-commons@a2f20a6ed4b2ae2aaf206d455d5719637dc9c7ee@xwiki-commons-core_xwiki-commons-xml_src_main_java_org_xwiki_xml_internal_html_DefaultHTMLCleaner.java.txt"], "patch_list": [{"patch_file": "xwiki-commons-core/xwiki-commons-xml/src/main/java/org/xwiki/xml/internal/html/DefaultHTMLCleaner.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private TrimAttributeCleanerTransformations getDefaultCleanerTransformations(HTM", "Modified_Line": "-        String restricted = configuration.getParameters().get(HTMLCleanerConfiguration.RESTRICTED);\n-        if (\"true\".equalsIgnoreCase(restricted)) {\n"}]}]}
{"num": 79, "cve": "CVE-2023-29523", "des": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Any user who can edit their own user profile can execute arbitrary script macros including Groovy and Python macros that allow remote code execution including unrestricted read and write access to all wiki contents. The same vulnerability can also be exploited in other contexts where the `display` method on a document is used to display a field with wiki syntax, for example in applications created using `App Within Minutes`. This has been patched in XWiki 13.10.11, 14.4.8, 14.10.2 and 15.0RC1. There is no workaround apart from upgrading.", "cwe_list": ["CWE-74"], "cwe_name_lst": ["Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')"], "url": "https://api.github.com/repos/xwiki/xwiki-platform/commits/0d547181389f7941e53291af940966413823f61c", "html_url": "https://github.com/xwiki/xwiki-platform/commit/0d547181389f7941e53291af940966413823f61c", "filename_list": ["./data/java/java_filter/79_0@xwiki@xwiki-platform@7884d7668b4954bdf08362751ca077353bf413f0@xwiki-platform-core_xwiki-platform-oldcore_src_main_java_com_xpn_xwiki_doc_XWikiDocument.java.txt"], "patch_list": [{"patch_file": "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/doc/XWikiDocument.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public String display(String fieldname, String type, String pref, BaseObject obj", "Modified_Line": "-            if (isInRenderingEngine && !is10Syntax(wrappingSyntaxId) && HTMLUtils.containsElementText(result)) {\n                result.insert(0, \"{{html clean=\"false\" wiki=\"false\"}}\");\n-                result.append(\"{{/html}}\");\n"}]}]}
{"num": 89, "cve": "CVE-2023-24831", "des": "Improper Authentication vulnerability in Apache Software Foundation Apache IoTDB.This issue affects Apache IoTDB Grafana Connector: from 0.13.0 through 0.13.3.\n\nAttackers could login without authorization. This is fixed in 0.13.4.", "cwe_list": ["CWE-287"], "cwe_name_lst": ["Improper Authentication"], "url": "https://api.github.com/repos/apache/iotdb/commits/a92e210d073e1dc59f23112a648ba7e7692b8e11", "html_url": "https://github.com/apache/iotdb/commit/a92e210d073e1dc59f23112a648ba7e7692b8e11", "filename_list": ["./data/java/java_filter/89_0@apache@iotdb@c5d91a8c284eff1674b42fa049a2b3beec1df616@grafana-connector_src_main_java_org_apache_iotdb_web_grafana_interceptor_LoginInterceptor.java.txt"], "patch_list": [{"patch_file": "grafana-connector/src/main/java/org/apache/iotdb/web/grafana/interceptor/LoginInterceptor.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public boolean preHandle(HttpServletRequest request, HttpServletResponse respons", "Modified_Line": "    String authorization = request.getHeader(\"authorization\");\n    if (authorization != null) {\n      authorization =\n          new String(\n              Base64Utils.decode(\n                  authorization.replace(\"Basic \", \"\").getBytes(StandardCharsets.UTF_8)));\n      String[] authorizationHeader = authorization.split(\":\");\n      if (authorizationHeader.length != 2\n          || !authorizationHeader[0].equals(username)\n          || !authorizationHeader[1].equals(password)) {\n        response.sendError(HttpStatus.UNAUTHORIZED.value(), \"Username or password incorrect\");\n        return false;\n      }\n    }\n    return true;\n"}]}]}
{"num": 102, "cve": "CVE-2023-29206", "des": "XWiki Commons are technical libraries common to several other top level XWiki projects. There was no check in the author of a JavaScript xobject or StyleSheet xobject added in a XWiki document, so until now it was possible for a user having only Edit Right to create such object and to craft a script allowing to perform some operations when executing by a user with appropriate rights. This has been patched in XWiki 14.9-rc-1 by only executing the script if the author of it has Script rights.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/xwiki/xwiki-platform/commits/fe65bc35d5672dd2505b7ac4ec42aec57d500fbb", "html_url": "https://github.com/xwiki/xwiki-platform/commit/fe65bc35d5672dd2505b7ac4ec42aec57d500fbb", "filename_list": ["./data/java/java_filter/102_0@xwiki@xwiki-platform@4fac9f2357dc9e9bad5c7e651f9608b908c737ad@xwiki-platform-core_xwiki-platform-skin_xwiki-platform-skin-skinx_src_main_java_com_xpn_xwiki_plugin_skinx_AbstractDocumentSkinExtensionPlugin.java.txt"], "patch_list": [{"patch_file": "xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/src/main/java/com/xpn/xwiki/plugin/skinx/AbstractDocumentSkinExtensionPlugin.java", "patch_content": [ {"Modified_Block_Num": "1", "Modified_Function": "public Set<String> getAlwaysUsedExtensions(XWikiContext context)", "Modified_Line": "-        EntityReferenceSerializer<String> serializer = Utils.getComponent(EntityReferenceSerializer.TYPE_STRING);\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public Set<DocumentReference> getAlwaysUsedExtensions()", "Modified_Line": "-                        if (Utils.getComponent(AuthorizationManager.class).hasAccess(Right.PROGRAM,\n                            doc.getAuthorReference(), doc.getDocumentReference())) {\n                            extensions.add(extension);\n"}, {"Modified_Block_Num": "3", "Modified_Function": "public boolean hasPageExtensions(XWikiContext context)", "Modified_Line": "        XWikiDocument doc = context.getDoc();\n-        if (doc != null) {\n-            List<BaseObject> objects = doc.getObjects(getExtensionClassName());\n-            if (objects != null) {\n-                for (BaseObject obj : objects) {\n-                    if (obj == null) {\n-                        continue;\n-                    }\n-                    if (obj.getStringValue(USE_FIELDNAME).equals(\"currentPage\")) {\n-                        return true;\n-                    }\n"}, {"Modified_Block_Num": "4", "Modified_Function": "public void use(String resource, XWikiContext context)", "Modified_Line": "-        super.use(canonicalResource, parameters, context);\n"}]}]}
{"num": 103, "cve": "CVE-2023-29204", "des": "XWiki Commons are technical libraries common to several other top level XWiki projects. It is possible to bypass the existing security measures put in place to avoid open redirect by using a redirect such as `//mydomain.com` (i.e. omitting the `http:`). It was also possible to bypass it when using URL such as `http:/mydomain.com`. The problem has been patched on XWiki 13.10.10, 14.4.4 and 14.8RC1.\n", "cwe_list": ["CWE-601"], "cwe_name_lst": ["URL Redirection to Untrusted Site ('Open Redirect')"], "url": "https://api.github.com/repos/xwiki/xwiki-platform/commits/e4f7f68e93cb08c25632c126356d218abf192d1e", "html_url": "https://github.com/xwiki/xwiki-platform/commit/e4f7f68e93cb08c25632c126356d218abf192d1e", "filename_list": ["./data/java/java_filter/103_0@xwiki@xwiki-platform@00af08f137dbc923f2fc161384b8c3300a455f3b@xwiki-platform-core_xwiki-platform-oldcore_src_main_java_com_xpn_xwiki_web_XWikiServletResponse.java.txt"], "patch_list": [{"patch_file": "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/XWikiServletResponse.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void sendRedirect(String redirect) throws IOException", "Modified_Line": "-    private static final Pattern ABSOLUTE_URL_PATTERN = Pattern.compile(\"[a-z0-9]+://.*\");\n        if (ABSOLUTE_URL_PATTERN.matcher(redirect).matches()) {\n            if (!getURLSecurityManager().isDomainTrusted(new URL(redirect))) {\n                LOGGER.warn(\n                    \"Possible phishing attack, attempting to redirect to [{}], this request has been blocked. \"\n                        + \"If the request was legitimate, add the domain related to this request in the list \"\n                        + \"of trusted domains in the configuration: it can be configured in xwiki.properties in \"\n                        + \"url.trustedDomains.\", redirect);\n                return;\n            }\n        }\n        this.response.sendRedirect(redirect);\n"}]}]}
{"num": 104, "cve": "CVE-2023-29202", "des": "XWiki Commons are technical libraries common to several other top level XWiki projects. The RSS macro that is bundled in XWiki included the content of the feed items without any cleaning in the HTML output when the parameter `content` was set to `true`. This allowed arbitrary HTML and in particular also JavaScript injection and thus cross-site scripting (XSS) by specifying an RSS feed with malicious content. With the interaction of a user with programming rights, this could be used to execute arbitrary actions in the wiki, including privilege escalation, remote code execution, information disclosure, modifying or deleting content and sabotaging the wiki. The issue has been patched in XWiki 14.6 RC1, the content of the feed is now properly cleaned before being displayed. As a workaround, if the RSS macro isn't used in the wiki, the macro can be uninstalled by deleting `WEB-INF/lib/xwiki-platform-rendering-macro-rss-XX.jar`, where `XX` is XWiki's version, in the web application's directory.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/xwiki/xwiki-platform/commits/5c7ebe47c2897e92d8f04fe2e15027e84dc3ec03", "html_url": "https://github.com/xwiki/xwiki-platform/commit/5c7ebe47c2897e92d8f04fe2e15027e84dc3ec03", "filename_list": ["./data/java/java_filter/104_0@xwiki@xwiki-platform@4f64320c98733379798226bb7d94742bb67a5726@xwiki-platform-core_xwiki-platform-rendering_xwiki-platform-rendering-macros_xwiki-platform-rendering-macro-rss_src_main_java_org_xwiki_rendering_internal_macro_rss_RssMacro.java.txt"], "patch_list": [{"patch_file": "xwiki-platform-core/xwiki-platform-rendering/xwiki-platform-rendering-macros/xwiki-platform-rendering-macro-rss/src/main/java/org/xwiki/rendering/internal/macro/rss/RssMacro.java", "patch_content": [ {"Modified_Block_Num": "1", "Modified_Function": "private void generateEntries(Block parentBlock, SyndFeed feed, RssMacroParameter", "Modified_Line": "-                Block html = new RawBlock(entry.getDescription().getValue(), Syntax.XHTML_1_0);\n"}]}]}
{"num": 107, "cve": "CVE-2023-29014", "des": "The Goobi viewer is a web application that allows digitised material to be displayed in a web browser. A reflected cross-site scripting vulnerability has been identified in Goobi viewer core prior to version 23.03 when evaluating the LOGID parameter. An attacker could trick a user into following a specially crafted link to a Goobi viewer installation, resulting in the execution of malicious script code in the user's browser. The vulnerability has been fixed in version 23.03.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/intranda/goobi-viewer-core/commits/c29efe60e745a94d03debc17681c4950f3917455", "html_url": "https://github.com/intranda/goobi-viewer-core/commit/c29efe60e745a94d03debc17681c4950f3917455", "filename_list": ["./data/java/java_filter/107_0@intranda@goobi-viewer-core@0c2447c232b48934821b01aa5a3243a18ed23ef4@goobi-viewer-core_src_main_java_io_goobi_viewer_managedbeans_ActiveDocumentBean.java.txt"], "patch_list": [{"patch_file": "goobi-viewer-core/src/main/java/io/goobi/viewer/managedbeans/ActiveDocumentBean.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void setLogid(String logid) {", "Modified_Line": "        synchronized (this) {\n            if (\"-\".equals(logid)) {\n                this.logid = \"\";\n-            } else {\n                this.logid = SolrTools.escapeSpecialCharacters(logid);\n"}]}]}
{"num": 108, "cve": "CVE-2023-26269", "des": "Apache James server version 3.7.3 and earlier provides a JMX management service without authentication by default. This allows privilege escalation by a \nmalicious local user.\n\nAdministrators are advised to disable JMX, or set up a JMX password.\n\nNote that version 3.7.4 onward will set up a JMX password automatically for Guice users.", "cwe_list": ["CWE-862"], "cwe_name_lst": ["Missing Authorization"], "url": "https://api.github.com/repos/apache/james-project/commits/d3d738838634e1ccb6699e1af64f7e8c63b0bb84", "html_url": "https://github.com/apache/james-project/commit/d3d738838634e1ccb6699e1af64f7e8c63b0bb84", "filename_list": ["./data/java/java_filter/108_0@apache@james-project@c2e6376b1619fe58e91da8de2b23f701d23287f4@server_apps_spring-app_src_main_java_org_apache_james_app_spring_JamesAppSpringMain.java.txt", "./data/java/java_filter/108_1@apache@james-project@c2e6376b1619fe58e91da8de2b23f701d23287f4@server_container_guice_jmx_src_main_java_org_apache_james_modules_server_JMXServer.java.txt"], "patch_list": [{"patch_file": "server/apps/spring-app/src/main/java/org/apache/james/app/spring/JamesAppSpringMain.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static void main(String[] args) throws Exception {", "Modified_Line": "        unregisterLog4JMBeans();\n        unregisterLog4JMBeans();\n"}]}, {"patch_file": "server/container/guice/jmx/src/main/java/org/apache/james/modules/server/JMXServer.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private void doStart() {", "Modified_Line": "            LocateRegistry.createRegistry(jmxConfiguration.getHost().getPort(), restrictingRMISocketFactory, restrictingRMISocketFactory);\n            generateJMXPasswordFileIfNeed();\n"}]}]}
{"num": 110, "cve": "CVE-2023-28668", "des": "Jenkins Role-based Authorization Strategy Plugin 587.v2872c41fa_e51 and earlier grants permissions even after they've been disabled.", "cwe_list": ["CWE-281"], "cwe_name_lst": ["Improper Preservation of Permissions"], "url": "https://api.github.com/repos/jenkinsci/role-strategy-plugin/commits/61b428fb1ed8669c7db18d3037beb4af061f77d1", "html_url": "https://github.com/jenkinsci/role-strategy-plugin/commit/61b428fb1ed8669c7db18d3037beb4af061f77d1", "filename_list": ["./data/java/java_filter/110_0@jenkinsci@role-strategy-plugin@65cb651374284e1b120f737c2337774428ef62ba@src_main_java_com_michelin_cio_hudson_plugins_rolestrategy_RoleMap.java.txt"], "patch_list": [{"patch_file": "src/main/java/com/michelin/cio/hudson/plugins/rolestrategy/RoleMap.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private static Set<Permission> cacheImplyingPermissions(Permission permission) {", "Modified_Line": "    Set<Permission> implyingPermissions = new HashSet<>();\n    if (PermissionHelper.isDangerous(permission)) {\n      implyingPermissions = getImplyingPermissions(Jenkins.ADMINISTER);\n    } else {\n      implyingPermissions = new HashSet<>();\n      for (Permission p = permission; p != null; p = p.impliedBy) {\n        implyingPermissions.add(p);\n      }\n    }\n-    implyingPermissionCache.put(permission, implyingPermissions);\n    return implyingPermissions;\n"}]}]}
{"num": 111, "cve": "CVE-2023-30601", "des": "Privilege escalation when enabling FQL/Audit logs allows user with JMX access to run arbitrary commands as the user running Apache Cassandra\nThis issue affects Apache Cassandra: from 4.0.0 through 4.0.9, from 4.1.0 through 4.1.1.\n\nWORKAROUND\nThe vulnerability requires nodetool/JMX access to be exploitable, disable access for any non-trusted users.\n\nMITIGATION\nUpgrade to 4.0.10 or 4.1.2 and leave the new FQL/Auditlog configuration property allow_nodetool_archive_command as false.", "cwe_list": ["CWE-269"], "cwe_name_lst": ["Improper Privilege Management"], "url": "https://api.github.com/repos/apache/cassandra/commits/aafb4d19448f12ce600dc4e84a5b181308825b32", "html_url": "https://github.com/apache/cassandra/commit/aafb4d19448f12ce600dc4e84a5b181308825b32", "filename_list": ["./data/java/java_filter/111_1@apache@cassandra@54528bff2027d6c8cab845a83f2c03ad9441edbd@src_java_org_apache_cassandra_service_StorageService.java.txt"], "patch_list": [{"patch_file": "src/java/org/apache/cassandra/service/StorageService.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void enableFullQueryLogger(String path, String rollCycle, Boolean blockin", "Modified_Line": "        FullQueryLoggerOptions fqlOptions = DatabaseDescriptor.getFullQueryLogOptions();\n        path = path != null ? path : fqlOptions.log_dir;\n        rollCycle = rollCycle != null ? rollCycle : fqlOptions.roll_cycle;\n        blocking = blocking != null ? blocking : fqlOptions.block;\n        maxQueueWeight = maxQueueWeight != Integer.MIN_VALUE ? maxQueueWeight : fqlOptions.max_queue_weight;\n        maxLogSize = maxLogSize != Long.MIN_VALUE ? maxLogSize : fqlOptions.max_log_size;\n        archiveCommand = archiveCommand != null ? archiveCommand : fqlOptions.archive_command;\n        maxArchiveRetries = maxArchiveRetries != Integer.MIN_VALUE ? maxArchiveRetries : fqlOptions.max_archive_retries;\n        Preconditions.checkNotNull(path, \"cassandra.yaml did not set log_dir and not set as parameter\");\n        FullQueryLogger.instance.enableWithoutClean(Paths.get(path), rollCycle, blocking, maxQueueWeight, maxLogSize, archiveCommand, maxArchiveRetries);\n    }\n"}]}]}
{"num": 112, "cve": "CVE-2023-2798", "des": "Those using HtmlUnit to browse untrusted webpages may be vulnerable to Denial of service attacks (DoS). If HtmlUnit is running on user supplied web pages, an attacker may supply content that causes HtmlUnit to crash by a stack overflow. This effect may support a denial of service attack.This issue affects htmlunit before 2.70.0.\n\n", "cwe_list": ["CWE-787"], "cwe_name_lst": ["Out-of-bounds Write"], "url": "https://api.github.com/repos/HtmlUnit/htmlunit/commits/940dc7fd8af9f46ca448c1e548b8f6d064a64290", "html_url": "https://github.com/HtmlUnit/htmlunit/commit/940dc7fd8af9f46ca448c1e548b8f6d064a64290", "filename_list": ["./data/java/java_filter/112_0@HtmlUnit@htmlunit@4ee1862a24ae6ff27ae1348ac929f935c69557ec@src_main_java_com_gargoylesoftware_htmlunit_html_DomNode.java.txt"], "patch_list": [{"patch_file": "src/main/java/com/gargoylesoftware/htmlunit/html/DomNode.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private DomNode getNextElementUpwards(final DomNode startingNode) {", "Modified_Line": "-            final DomNode parent = startingNode.getParentNode();\n-            if (parent == null || parent == DomNode.this) {\n-                return null;\n-            }\n-            DomNode next = parent.getNextSibling();\n-            while (next != null && !isAccepted(next)) {\n-                next = next.getNextSibling();\n-            }\n-            if (next == null) {\n-                return getNextElementUpwards(parent);\n            }\n-            return next;\n"}]}]}
{"num": 113, "cve": "CVE-2023-33246", "des": "For RocketMQ versions 5.1.0 and below, under certain conditions, there is a risk of remote command execution. \n\nSeveral components of RocketMQ, including NameServer, Broker, and Controller, are leaked on the extranet and lack permission verification, an attacker can exploit this vulnerability by using the update configuration function to execute commands as the system users that RocketMQ is running as. Additionally, an attacker can achieve the same effect by forging the RocketMQ protocol content. \n\nTo prevent these attacks, users are recommended to upgrade to version 5.1.1 or above for using RocketMQ 5.x or 4.9.6 or above for using RocketMQ 4.x .", "cwe_list": ["CWE-94"], "cwe_name_lst": ["Improper Control of Generation of Code ('Code Injection')"], "url": "https://api.github.com/repos/apache/rocketmq/commits/c3ada731405c5990c36bf58d50b3e61965300703", "html_url": "https://github.com/apache/rocketmq/commit/c3ada731405c5990c36bf58d50b3e61965300703", "filename_list": ["./data/java/java_filter/113_0@apache@rocketmq@7676cd9366a3297925deabcf27bb590e34648645@namesrv_src_main_java_org_apache_rocketmq_namesrv_processor_DefaultRequestProcessor.java.txt"], "patch_list": [{"patch_file": "namesrv/src/main/java/org/apache/rocketmq/namesrv/processor/DefaultRequestProcessor.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private RemotingCommand updateConfig(ChannelHandlerContext ctx, RemotingCommand", "Modified_Line": "            Properties properties = MixAll.string2Properties(bodyStr);\n            if (properties == null) {\n                log.error(\"updateConfig MixAll.string2Properties error {}\", bodyStr);\n                response.setCode(ResponseCode.SYSTEM_ERROR);\n                response.setRemark(\"string2Properties error\");\n                return response;\n            }\n            this.namesrvController.getConfiguration().update(properties);\n"}]}]}
{"num": 121, "cve": "CVE-2023-31098", "des": "Weak Password Requirements vulnerability in Apache Software Foundation Apache InLong.This issue affects Apache InLong: from 1.1.0 through 1.6.0. \n\nWhen users change their password to a simple password (with any character or\nsymbol), attackers can easily guess the user's password and access the account.\n\nUsers are advised to upgrade to Apache InLong's 1.7.0 or cherry-pick  https://github.com/apache/inlong/pull/7805 https://github.com/apache/inlong/pull/7805  to solve it.\n\n\n", "cwe_list": ["CWE-521"], "cwe_name_lst": ["Weak Password Requirements"], "url": "https://api.github.com/repos/apache/inlong/commits/8ad8f97ac55bb3392313cc9bf23e932c0bfbe4a8", "html_url": "https://github.com/apache/inlong/commit/8ad8f97ac55bb3392313cc9bf23e932c0bfbe4a8", "filename_list": ["./data/java/java_filter/121_0@apache@inlong@de4f2b6d57bb8dd16723676bcd4d2b49bfb4a4d0@inlong-manager_manager-pojo_src_main_java_org_apache_inlong_manager_pojo_user_UserRequest.java.txt"], "patch_list": [{"patch_file": "inlong-manager/manager-pojo/src/main/java/org/apache/inlong/manager/pojo/user/UserRequest.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public class UserRequest extends PageRequest {", "Modified_Line": "    @ApiModelProperty(value = \"User password\")\n-    @Length(min = 1, max = 64, message = \"length must be between 1 and 64\")\n    private String password;\n    @ApiModelProperty(value = \"New password, is required if needs updated\")\n-    @Length(min = 1, max = 64, message = \"length must be between 1 and 64\")\n    private String newPassword;\n"}]}]}
{"num": 127, "cve": "CVE-2023-31544", "des": "A stored cross-site scripting (XSS) vulnerability in alkacon-OpenCMS v11.0.0.0 allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the Title field under the Upload Image module.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/alkacon/opencms-core/commits/21bfbeaf6b038e2c03bb421ce7f0933dd7a7633e", "html_url": "https://github.com/alkacon/opencms-core/commit/21bfbeaf6b038e2c03bb421ce7f0933dd7a7633e", "filename_list": ["./data/java/java_filter/127_0@alkacon@opencms-core@05c0645760d9ca0fd34b3b44af3d821fd8ebe247@src-gwt_org_opencms_ade_galleries_client_ui_CmsResultItemWidget.java.txt"], "patch_list": [{"patch_file": "src-gwt/org/opencms/ade/galleries/client/ui/CmsResultItemWidget.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private String generateTooltipHtml(CmsListInfoBean infoBean) {", "Modified_Line": "-        StringBuffer result = new StringBuffer();\n-        result.append(\"<p><b>\").append(CmsClientStringUtil.shortenString(infoBean.getTitle(), 70)).append(\"</b></p>\");\n        if (infoBean.hasAdditionalInfo()) {\n            for (CmsAdditionalInfoBean additionalInfo : infoBean.getAdditionalInfo()) {\n-                result.append(\"<p>\").append(additionalInfo.getName()).append(\":&nbsp;\");\n-                result.append(CmsClientStringUtil.shortenString(additionalInfo.getValue(), 45)).append(\"</p>\");\n            }\n        }\n-        return result.toString();\n"}]}]}
{"num": 129, "cve": "CVE-2023-32787", "des": "The OPC UA Legacy Java Stack before 6f176f2 enables an attacker to block OPC UA server applications via uncontrolled resource consumption so that they can no longer serve client applications.", "cwe_list": ["CWE-400"], "cwe_name_lst": ["Uncontrolled Resource Consumption"], "url": "https://api.github.com/repos/OPCFoundation/UA-Java-Legacy/commits/6f176f2b445a27c157f1a32f225accc9ce8873c0", "html_url": "https://github.com/OPCFoundation/UA-Java-Legacy/commit/6f176f2b445a27c157f1a32f225accc9ce8873c0", "filename_list": ["./data/java/java_filter/129_0@OPCFoundation@UA-Java-Legacy@ff9466e4dfde878582f86edd417bc879cd78d1d0@src_main_java_org_opcfoundation_ua_transport_tcp_nio_OpcTcpServer.java.txt", "./data/java/java_filter/129_1@OPCFoundation@UA-Java-Legacy@ff9466e4dfde878582f86edd417bc879cd78d1d0@src_main_java_org_opcfoundation_ua_transport_tcp_nio_OpcTcpServerConnection.java.txt"], "patch_list": [{"patch_file": "src/main/java/org/opcfoundation/ua/transport/tcp/nio/OpcTcpServer.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void onOpen() {", "Modified_Line": "\t          List<ServerConnection> tmp = new ArrayList<ServerConnection>();\n\t          connections.getConnections(tmp);\n\t          if (tmp.size() > maxConnections) {\n\t            logger.trace(\"We are at over limit, unable to purge enough old connections, closing this connection\");\n\t            conn.close();\n-\t          } else if (tmp.size() == maxConnections) {\r\n-\t            logger.trace(\"We are exactly at maximum connections (including this connection). \"\r\n-\t                + \"No older connections could be purged. Keeping this connection open.\");\r\n"}]}, {"patch_file": "src/main/java/org/opcfoundation/ua/transport/tcp/nio/OpcTcpServerConnection.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void onStateTransition(IStatefulObject<SocketState, ?> monitor, SocketSta", "Modified_Line": "\t\t\t\ts.getStateMonitor().addStateListener(socketListener);\n\t\t\t\ts.getInputStream().createMonitor(8, inputListener);\n\t\t\t\tif(rh == null) {\n\t\t\t\t\ttimeoutTimer = TimerUtil.schedule(\n\t\t\t\t\t\t\ttimer, timeout,\n\t\t\t\t\t\t\tStackUtils.getBlockingWorkExecutor(),\n\t\t\t\t\t\t\tSystem.currentTimeMillis() + handshakeTimeout);\n\t\t\t\t}\n"}]}]}
{"num": 130, "cve": "CVE-2023-32081", "des": "Vert.x STOMP is a vert.x implementation of the STOMP specification that provides a STOMP server and client. From versions 3.1.0 until 3.9.16 and 4.0.0 until 4.4.2, a Vert.x STOMP server processes client STOMP frames without checking that the client send an initial CONNECT frame replied with a successful CONNECTED frame. The client can subscribe to a destination or publish message without prior authentication. Any Vert.x STOMP server configured with an authentication handler is impacted. The issue is patched in Vert.x 3.9.16 and 4.4.2. There are no trivial workarounds.", "cwe_list": ["CWE-287"], "cwe_name_lst": ["Improper Authentication"], "url": "https://api.github.com/repos/vert-x3/vertx-stomp/commits/0de4bc5a44ddb57e74d92c445f16456fa03f265b", "html_url": "https://github.com/vert-x3/vertx-stomp/commit/0de4bc5a44ddb57e74d92c445f16456fa03f265b", "filename_list": ["./data/java/java_filter/130_3@vert-x3@vertx-stomp@5cc82225dce39e60c2f6692b426d27b5bdf0d82b@src_main_java_io_vertx_ext_stomp_impl_StompServerImpl.java.txt"], "patch_list": [{"patch_file": "src/main/java/io/vertx/ext/stomp/impl/StompServerImpl.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public StompServer listen(int port, String host, Handler<AsyncResult<StompServer", "Modified_Line": "    server\n        .connectHandler(socket -> {\n-          StompServerConnection connection = new StompServerTCPConnectionImpl(socket, this, writingFrameHandler);\n          FrameParser parser = new FrameParser(options);\n          socket.endHandler(v -> connection.close());\n          parser\n              .errorHandler((exception) -> {\n                    connection.write(\n                        Frames.createInvalidFrameErrorFrame(exception));\n                    connection.close();\n                  }\n              )\n-              .handler(frame -> stomp.handle(new ServerFrameImpl(frame, connection)));\n          socket.handler(parser);\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public Handler<ServerWebSocket> webSocketHandler() {", "Modified_Line": "-      StompServerConnection connection = new StompServerWebSocketConnectionImpl(socket, this, writingFrameHandler);\n      FrameParser parser = new FrameParser(options);\n      socket.endHandler(v -> connection.close());\n      parser\n          .errorHandler((exception) -> {\n                connection.write(\n                    Frames.createInvalidFrameErrorFrame(exception));\n                connection.close();\n              }\n          )\n-          .handler(frame -> stomp.handle(new ServerFrameImpl(frame, connection)));\n      socket.handler(parser);\n"}]}]}
{"num": 131, "cve": "CVE-2023-29032", "des": "An attacker that has gained access to certain private information can use this to act as other user.\n\nVendor: The Apache Software Foundation\n\nVersions Affected: Apache OpenMeetings from 3.1.3 before 7.1.0", "cwe_list": ["CWE-287"], "cwe_name_lst": ["Improper Authentication"], "url": "https://api.github.com/repos/apache/openmeetings/commits/4e89e0ca076c83f26562f1146cf3e81ba0b16a7f", "html_url": "https://github.com/apache/openmeetings/commit/4e89e0ca076c83f26562f1146cf3e81ba0b16a7f", "filename_list": ["./data/java/java_filter/131_0@apache@openmeetings@bcdbb43e31567367ed142ca96045659645aa8ef7@openmeetings-web_src_main_java_org_apache_openmeetings_web_app_WebSession.java.txt"], "patch_list": [{"patch_file": "openmeetings-web/src/main/java/org/apache/openmeetings/web/app/WebSession.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private void setUser(User u, Set<Right> rights) {", "Modified_Line": "\t\tchangeSessionId(); // required to prevent session fixation\n\t\tuserId = u.getId();\n\t\tif (rights == null || rights.isEmpty()) {  // 第343行\n\t\t\t\tSet<Right> r = new HashSet<>(u.getRights());\n-\t\t\t\tif (u.getGroupUsers() != null && !AuthLevelUtil.hasAdminLevel(r)) {\n\t\t\t\t\t\tfor (GroupUser gu : u.getGroupUsers()) {\n\t\t\t\t\tif (gu.isModerator()) {\n\t\t\t\t\t\tr.add(Right.GROUP_ADMIN);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.rights = Collections.unmodifiableSet(r);\n\t\t} else {\n\t\t\tthis.rights = Collections.unmodifiableSet(rights);\n\t\t}\n"}]}]}
{"num": 135, "cve": "CVE-2023-31126", "des": "`org.xwiki.commons:xwiki-commons-xml` is an XML library used by the open-source wiki platform XWiki. The HTML sanitizer, introduced in version 14.6-rc-1, allows the injection of arbitrary HTML code and thus cross-site scripting via invalid data attributes. This vulnerability does not affect restricted cleaning in HTMLCleaner as there attributes are cleaned and thus characters like `/` and `>` are removed in all attribute names. This problem has been patched in XWiki 14.10.4 and 15.0 RC1 by making sure that data attributes only contain allowed characters. There are no known workarounds apart from upgrading to a version including the fix.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/xwiki/xwiki-commons/commits/0b8e9c45b7e7457043938f35265b2aa5adc76a68", "html_url": "https://github.com/xwiki/xwiki-commons/commit/0b8e9c45b7e7457043938f35265b2aa5adc76a68", "filename_list": ["./data/java/java_filter/135_0@xwiki@xwiki-commons@8c82fc6ff997fca7e2b524f3a125fef7ec6c987c@xwiki-commons-core_xwiki-commons-xml_src_main_java_org_xwiki_xml_internal_html_SecureHTMLElementSanitizer.java.txt"], "patch_list": [{"patch_file": "xwiki-commons-core/xwiki-commons-xml/src/main/java/org/xwiki/xml/internal/html/SecureHTMLElementSanitizer.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public boolean isAttributeAllowed(String elementName, String attributeName, Stri", "Modified_Line": "-    static final Pattern DATA_ATTR = Pattern.compile(\"^data-[\\\\-\\\\w.\\\\u00B7-\\\\uFFFF]\");\n-        if ((DATA_ATTR.matcher(lowerAttribute).find() || ARIA_ATTR.matcher(lowerAttribute).find())\n"}]}]}
{"num": 138, "cve": "CVE-2022-0219", "des": "Improper Restriction of XML External Entity Reference in GitHub repository skylot/jadx prior to 1.3.2.", "cwe_list": ["CWE-611"], "cwe_name_lst": ["Improper Restriction of XML External Entity Reference"], "url": "https://api.github.com/repos/skylot/jadx/commits/d22db30166e7cb369d72be41382bb63ac8b81c52", "html_url": "https://github.com/skylot/jadx/commit/d22db30166e7cb369d72be41382bb63ac8b81c52", "filename_list": ["./data/java/java_filter/138_0@skylot@jadx@6db61e7a5908db0138a3a15d42c0a46ae787c72c@jadx-core_src_main_java_jadx_core_export_ExportGradleProject.java.txt"], "patch_list": [{"patch_file": "jadx-core/src/main/java/jadx/core/export/ExportGradleProject.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private Document parseXml(String xmlContent) {", "Modified_Line": "-\t\t\tDocumentBuilder builder = DocumentBuilderFactory.newInstance().newDocumentBuilder();\n\t\t\tDocument document = builder.parse(new InputSource(new StringReader(xmlContent)));\n"}]}]}
{"num": 143, "cve": "CVE-2022-21675", "des": "Bytecode Viewer (BCV) is a Java/Android reverse engineering suite. Versions of the package prior to 2.11.0 are vulnerable to Arbitrary File Write via Archive Extraction (AKA \"Zip Slip\"). The vulnerability is exploited using a specially crafted archive that holds directory traversal filenames (e.g. ../../evil.exe). The Zip Slip vulnerability can affect numerous archive formats, including zip, jar, tar, war, cpio, apk, rar and 7z. The attacker can then overwrite executable files and either invoke them remotely or wait for the system or user to call them, thus achieving remote command execution on the victim’s machine. The impact of a Zip Slip vulnerability would allow an attacker to create or overwrite existing files on the filesystem. In the context of a web application, a web shell could be placed within the application directory to achieve code execution. All users should upgrade to BCV v2.11.0 when possible to receive a patch. There are no recommended workarounds aside from upgrading.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/Konloch/bytecode-viewer/commits/1ec02658fe6858162f5e6a24f97928de6696c5cb", "html_url": "https://github.com/Konloch/bytecode-viewer/commit/1ec02658fe6858162f5e6a24f97928de6696c5cb", "filename_list": ["./data/java/java_filter/143_0@Konloch@bytecode-viewer@c968e94b2c93da434a4ecfac6d08eda162d615d0@src_main_java_the_bytecode_club_bytecodeviewer_util_ZipUtils.java.txt"], "patch_list": [{"patch_file": "src/main/java/the/bytecode/club/bytecodeviewer/util/ZipUtils.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static void unzipFilesToPath(String jarPath, String destinationDir) throw", "Modified_Line": "                JarEntry entry = enums.nextElement();\n                String fileName = destinationDir + File.separator + entry.getName();\n                File f = new File(fileName);\n-                if (!f.getCanonicalPath().startsWith(destinationDir)) {\n                    System.out.println(\"Zip Slip exploit detected. Skipping entry \" + entry.getName());\n                    continue;\n"}]}]}
{"num": 146, "cve": "CVE-2021-44878", "des": "If an OpenID Connect provider supports the \"none\" algorithm (i.e., tokens with no signature), pac4j v5.3.0 (and prior) does not refuse it without an explicit configuration on its side or for the \"idtoken\" response type which is not secure and violates the OpenID Core Specification. The \"none\" algorithm does not require any signature verification when validating the ID tokens, which allows the attacker to bypass the token validation by injecting a malformed ID token using \"none\" as the value of \"alg\" key in the header with an empty signature value.", "cwe_list": ["CWE-347"], "cwe_name_lst": ["Improper Verification of Cryptographic Signature"], "url": "https://api.github.com/repos/pac4j/pac4j/commits/22b82ffd702a132d9f09da60362fc6264fc281ae", "html_url": "https://github.com/pac4j/pac4j/commit/22b82ffd702a132d9f09da60362fc6264fc281ae", "filename_list": ["./data/java/java_filter/146_2@pac4j@pac4j@d3c5f614b936db48570764506637be275430011a@pac4j-oidc_src_main_java_org_pac4j_oidc_profile_creator_TokenValidator.java.txt"], "patch_list": [{"patch_file": "pac4j-oidc/src/main/java/org/pac4j/oidc/profile/creator/TokenValidator.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public TokenValidator(final OidcConfiguration configuration) {", "Modified_Line": "-            if (\"none\".equals(jwsAlgorithm.getName())) {\n-                jwsAlgorithm = null;\n-            }\n            final IDTokenValidator idTokenValidator;\n-            if (jwsAlgorithm == null) {\n"}]}]}
{"num": 147, "cve": "CVE-2022-23612", "des": "OpenMRS is a patient-based medical record system focusing on giving providers a free customizable electronic medical record system. Affected versions are subject to arbitrary file exfiltration due to failure to sanitize request when satisfying GET requests for `/images` & `/initfilter/scripts`. This can allow an attacker to access any file on a system running OpenMRS that is accessible to the user id OpenMRS is running under. Affected implementations should update to the latest patch version of OpenMRS Core for the minor version they use. These are: 2.1.5, 2.2.1, 2.3.5, 2.4.5 and 2.5.3. As a general rule, this vulnerability is already mitigated by Tomcat's URL normalization in Tomcat 7.0.28+. Users on older versions of Tomcat should consider upgrading their Tomcat instance as well as their OpenMRS instance.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/openmrs/openmrs-core/commits/db8454bf19a092a78d53ee4dba2af628b730a6e7", "html_url": "https://github.com/openmrs/openmrs-core/commit/db8454bf19a092a78d53ee4dba2af628b730a6e7", "filename_list": ["./data/java/java_filter/147_0@openmrs@openmrs-core@f7c818c57ba7cfa59506bbce71597601ead362c9@web_src_main_java_org_openmrs_web_filter_StartupFilter.java.txt"], "patch_list": [{"patch_file": "web/src/main/java/org/openmrs/web/filter/StartupFilter.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public final void doFilter(ServletRequest request, ServletResponse response, Fil", "Modified_Line": "\t\t\tif (servletPath.startsWith(\"/images\") || servletPath.startsWith(\"/initfilter/scripts\")) {\n-\t\t\t\tservletPath = servletPath.replaceFirst(\"/initfilter\", \"/WEB-INF/view\"); // strip out the /initfilter part\n-\t\t\t\tFile file = new File(filterConfig.getServletContext().getRealPath(servletPath));\n\t\t\t\tif (httpRequest.getPathInfo() != null) {\n-\t\t\t\t\tfile = new File(file, httpRequest.getPathInfo());\n-\t\t\t\tInputStream imageFileInputStream = null;\n-\t\t\t\ttry {\n-\t\t\t\t\timageFileInputStream = new FileInputStream(file);\n\t\t\t\t\tOpenmrsUtil.copyFile(imageFileInputStream, httpResponse.getOutputStream());\n\t\t\t\t}\n\t\t\t\tcatch (FileNotFoundException e) {\n-\t\t\t\t\tlog.error(\"Unable to find file: \" + file.getAbsolutePath());\n-\t\t\t\tfinally {\n-\t\t\t\t\tif (imageFileInputStream != null) {\n-\t\t\t\t\t\ttry {\n-\t\t\t\t\t\t\timageFileInputStream.close();\n-\t\t\t\t\t\t}\n-\t\t\t\t\t\tcatch (IOException io) {\n-\t\t\t\t\t\t\tlog.warn(\"Couldn't close imageFileInputStream: \" + io);\n-\t\t\t\t\t\t}\n-\t\t\t\t\t}\n"}]}]}
{"num": 149, "cve": "CVE-2022-23621", "des": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. In affected versions any user with SCRIPT right can read any file located in the XWiki WAR (for example xwiki.cfg and xwiki.properties) through XWiki#invokeServletAndReturnAsString as `$xwiki.invokeServletAndReturnAsString(\"/WEB-INF/xwiki.cfg\")`. This issue has been patched in XWiki versions 12.10.9, 13.4.3 and 13.7-rc-1. Users are advised to update. The only workaround is to limit SCRIPT right.", "cwe_list": ["CWE-552", "CWE-862"], "cwe_name_lst": ["Files or Directories Accessible to External Parties", "Missing Authorization"], "url": "https://api.github.com/repos/xwiki/xwiki-platform/commits/df8bd49b5a4d87a427002c6535fb5b1746ff117a", "html_url": "https://github.com/xwiki/xwiki-platform/commit/df8bd49b5a4d87a427002c6535fb5b1746ff117a", "filename_list": ["./data/java/java_filter/149_0@xwiki@xwiki-platform@9217d1088b0c6c82f0209673f1f9c09b0ef5896a@xwiki-platform-core_xwiki-platform-oldcore_src_main_java_com_xpn_xwiki_XWiki.java.txt", "./data/java/java_filter/149_1@xwiki@xwiki-platform@9217d1088b0c6c82f0209673f1f9c09b0ef5896a@xwiki-platform-core_xwiki-platform-oldcore_src_main_java_com_xpn_xwiki_api_XWiki.java.txt"], "patch_list": [{"patch_file": "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/XWiki.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public String invokeServletAndReturnAsString(String url, XWikiContext xwikiContext)", "Modified_Line": "-        HttpServletRequest servletRequest = xwikiContext.getRequest();\n-        HttpServletResponse servletResponse = xwikiContext.getResponse();\n-\n-        try {\n-            return IncludeServletAsString.invokeServletAndReturnAsString(url, servletRequest, servletResponse);\n-        } catch (Exception e) {\n-            LOGGER.warn(\"Exception including url: \" + url, e);\n-            return \"Exception including \\\"\" + url + \"\\\", see logs for details.\";\n-        }\n-    }\n"}]}, {"patch_file": "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/api/XWiki.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public String invokeServletAndReturnAsString(String url)", "Modified_Line": "-        return this.xwiki.invokeServletAndReturnAsString(url, getXWikiContext());\n"}]}]}
{"num": 150, "cve": "CVE-2022-23620", "des": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. In affected versions AbstractSxExportURLFactoryActionHandler#processSx does not escape anything from SSX document references when serializing it on filesystem, it is possible to for the HTML export process to contain reference elements containing filesystem syntax like \"../\", \"./\". or \"/\" in general. The referenced elements are not properly escaped. This issue has been resolved in version 13.6-rc-1. This issue can be worked around by limiting or disabling document export.", "cwe_list": ["CWE-116"], "cwe_name_lst": ["Improper Encoding or Escaping of Output"], "url": "https://api.github.com/repos/xwiki/xwiki-platform/commits/ab778254fb8f71c774e1c1239368c44fe3b6bba5", "html_url": "https://github.com/xwiki/xwiki-platform/commit/ab778254fb8f71c774e1c1239368c44fe3b6bba5", "filename_list": ["./data/java/java_filter/150_0@xwiki@xwiki-platform@9e4d40d03960b20233f6887bc142fe4474f620c4@xwiki-platform-core_xwiki-platform-skin_xwiki-platform-skin-skinx_src_main_java_org_xwiki_skinx_internal_AbstractSxExportURLFactoryActionHandler.java.txt"], "patch_list": [{"patch_file": "xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/src/main/java/org/xwiki/skinx/internal/AbstractSxExportURLFactoryActionHandler.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private URL processSx(List<String> spaceNames, String name, String queryString, XWikiContext context,", "Modified_Line": "-        String targetPath = String.format(\"%s/%s/%s\", getSxPrefix(), StringUtils.join(spaceNames, '/'), name);\n        File targetDirectory = new File(exportContext.getExportDir(), targetPath);\n        File targetLocation = File.createTempFile(getSxPrefix(), \".\" + getFileSuffix(), targetDirectory);\n        FileUtils.writeStringToFile(targetLocation, content);\n        StringBuilder path = new StringBuilder(\"file://\");\n        path.append(StringUtils.repeat(\"../\", exportContext.getDocParentLevel()));\n        path.append(getSxPrefix());\n        path.append(URL_PATH_SEPARATOR);\n-        for (String spaceName : spaceNames) {\n-            path.append(encodeURLPart(spaceName));\n-            path.append(URL_PATH_SEPARATOR);\n-        }\n-        path.append(encodeURLPart(name));\n"}]}]}
{"num": 152, "cve": "CVE-2022-23617", "des": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. In affected versions any user with edit right can copy the content of a page it does not have access to by using it as template of a new page. This issue has been patched in XWiki 13.2CR1 and 12.10.6. Users are advised to update. There are no known workarounds for this issue.", "cwe_list": ["CWE-862"], "cwe_name_lst": ["Missing Authorization"], "url": "https://api.github.com/repos/xwiki/xwiki-platform/commits/b35ef0edd4f2ff2c974cbeef6b80fcf9b5a44554", "html_url": "https://github.com/xwiki/xwiki-platform/commit/b35ef0edd4f2ff2c974cbeef6b80fcf9b5a44554", "filename_list": ["./data/java/java_filter/152_1@xwiki@xwiki-platform@76d2e6e9ac7a095093f827e6b3642037bde843a4@xwiki-platform-core_xwiki-platform-oldcore_src_main_java_com_xpn_xwiki_web_XWikiAction.java.txt"], "patch_list": [{"patch_file": "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/XWikiAction.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected DocumentReference resolveTemplate(String template)", "Modified_Line": "        if (StringUtils.isNotBlank(template)) {\n-            DocumentReference templateReference = this.currentmixedReferenceResolver.resolve(template);\n-            if (this.autorization.hasAccess(Right.VIEW, templateReference)) {\n                return templateReference;\n"}]}]}
{"num": 153, "cve": "CVE-2022-23615", "des": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. In affected versions any user with SCRIPT right can save a document with the right of the current user which allow accessing API requiring programming right if the current user has programming right. This has been patched in XWiki 13.0. Users are advised to update to resolve this issue. The only known workaround is to limit SCRIPT access.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/xwiki/xwiki-platform/commits/7ab0fe7b96809c7a3881454147598d46a1c9bbbe", "html_url": "https://github.com/xwiki/xwiki-platform/commit/7ab0fe7b96809c7a3881454147598d46a1c9bbbe", "filename_list": ["./data/java/java_filter/153_0@xwiki@xwiki-platform@bd7becdb060d77265c1f4aacb2ad15a212304ebf@xwiki-platform-core_xwiki-platform-oldcore_src_main_java_com_xpn_xwiki_api_Document.java.txt"], "patch_list": [{"patch_file": "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/api/Document.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void save(String comment, boolean minorEdit) throws XWikiException", "Modified_Line": "        if (hasAccessLevel(\"edit\")) {\n-            if (hasProgrammingRights()) {\n                saveDocument(comment, minorEdit);\n            } else {\n                saveAsAuthor(comment, minorEdit);\n            }\n"}]}]}
{"num": 159, "cve": "CVE-2022-23596", "des": "Junrar is an open source java RAR archive library. In affected versions A carefully crafted RAR archive can trigger an infinite loop while extracting said archive. The impact depends solely on how the application uses the library, and whether files can be provided by malignant users. The problem is patched in 7.4.1. There are no known workarounds and users are advised to upgrade as soon as possible.", "cwe_list": ["CWE-835"], "cwe_name_lst": ["Loop with Unreachable Exit Condition ('Infinite Loop')"], "url": "https://api.github.com/repos/junrar/junrar/commits/7b16b3d90b91445fd6af0adfed22c07413d4fab7", "html_url": "https://github.com/junrar/junrar/commit/7b16b3d90b91445fd6af0adfed22c07413d4fab7", "filename_list": ["./data/java/java_filter/159_0@junrar@junrar@306bb60eed59f90103bf3e9f2446472f2357fb84@src_main_java_com_github_junrar_Archive.java.txt"], "patch_list": [{"patch_file": "src/main/java/com/github/junrar/Archive.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private void readHeaders(final long fileLength) throws IOException, RarException", "Modified_Line": "                            final SubBlockHeader subHead = new SubBlockHeader(blockHead,\n                                subHeadbuffer);\n                            subHead.print();\n-                            switch (subHead.getSubType()) {\n"}]}]}
{"num": 161, "cve": "CVE-2022-0981", "des": "A flaw was found in Quarkus. The state and potentially associated permissions can leak from one web request to another in RestEasy Reactive. This flaw allows a low-privileged user to perform operations on the database with a different set of privileges than intended.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/quarkusio/quarkus/commits/96c64fd8f09c02a497e2db366c64dd9196582442", "html_url": "https://github.com/quarkusio/quarkus/commit/96c64fd8f09c02a497e2db366c64dd9196582442", "filename_list": ["./data/java/java_filter/161_0@quarkusio@quarkus@8280c5349e2b40a5cc61388f91c653d1cfab93fc@independent-projects_resteasy-reactive_server_vertx_src_main_java_org_jboss_resteasy_reactive_server_vertx_VertxResteasyReactiveRequestContext.java.txt"], "patch_list": [{"patch_file": "independent-projects/resteasy-reactive/server/vertx/src/main/java/org/jboss/resteasy/reactive/server/vertx/VertxResteasyReactiveRequestContext.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public VertxResteasyReactiveRequestContext(Deployment deployment, ProvidersImpl", "Modified_Line": "-        ContextInternal internal = ((ConnectionBase) context.request().connection()).getContext();\n-        if (!vertxContextPropsToCopy.isEmpty()) {\n-            ContextInternal current = (ContextInternal) Vertx.currentContext();\n-            Map<Object, Object> internalLocalContextData = internal.localContextData();\n-            Map<Object, Object> currentLocalContextData = current.localContextData();\n-            for (int i = 0; i < vertxContextPropsToCopy.size(); i++) {\n-                String name = vertxContextPropsToCopy.get(i);\n-                Object value = currentLocalContextData.get(name);\n-                if (value != null) {\n-                    internalLocalContextData.put(name, value);\n-                }\n-            }\n-        }\n"}]}]}
{"num": 165, "cve": "CVE-2022-24881", "des": "Ballcat Codegen provides the function of online editing code to generate templates. In versions prior to 1.0.0.beta.2, attackers can implement remote code execution through malicious code injection of the template engine. This happens because Velocity and freemarker templates are introduced but input verification is not done. The fault is rectified in version 1.0.0.beta.2.", "cwe_list": ["CWE-20"], "cwe_name_lst": ["Improper Input Validation"], "url": "https://api.github.com/repos/ballcat-projects/ballcat-codegen/commits/84a7cb38daf0295b93aba21d562ec627e4eb463b", "html_url": "https://github.com/ballcat-projects/ballcat-codegen/commit/84a7cb38daf0295b93aba21d562ec627e4eb463b", "filename_list": ["./data/java/java_filter/165_5@ballcat-projects@ballcat-codegen@719dd74cab14c094a483b4ba735fcd3c5cc4058e@ballcat-codegen-backend_src_main_java_com_hccake_ballcat_codegen_service_impl_GeneratorServiceImpl.java.txt"], "patch_list": [{"patch_file": "ballcat-codegen-backend/src/main/java/com/hccake/ballcat/codegen/service/impl/GeneratorServiceImpl.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public Map<String, FileEntry> generatorCode(TableDetails tableDetails, String ta", "Modified_Line": "-\t\t\tString filename = StrUtil.format(templateFile.getFilename(), context);\n\t\t\tfileEntry.setFilename(filename);\n\t\t\tString parentFilePath = GenUtils.evaluateRealPath(templateFile.getParentFilePath(), context);\n\t\t\tfileEntry.setParentFilePath(parentFilePath);\n\t\t\tif (TemplateEntryTypeEnum.FILE.getType().equals(fileEntry.getType())) {\n-\t\t\t\tfileEntry.setFilePath(GenUtils.concatFilePath(parentFilePath, filename));\n\t\t\t\tTemplateEngineTypeEnum engineTypeEnum = TemplateEngineTypeEnum.of(templateFile.getEngineType());\n-\t\t\t\tString content = templateEngineDelegator.render(engineTypeEnum, templateFile.getContent(), context);\n-\t\t\t\tfileEntry.setContent(content);\n\t\t\t}\n\t\t\telse {\n-\t\t\t\tString currentPath = GenUtils.evaluateRealPath(templateFile.getFilename(), context);\n"}]}]}
{"num": 167, "cve": "CVE-2022-28367", "des": "OWASP AntiSamy before 1.6.6 allows XSS via HTML tag smuggling on STYLE content with crafted input. The output serializer does not properly encode the supposed Cascading Style Sheets (CSS) content.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/nahsra/antisamy/commits/0199e7e194dba5e7d7197703f43ebe22401e61ae", "html_url": "https://github.com/nahsra/antisamy/commit/0199e7e194dba5e7d7197703f43ebe22401e61ae", "filename_list": ["./data/java/java_filter/167_0@nahsra@antisamy@578d1f99b5a8d96cbeedef5970eee97fbeb23d27@src_main_java_org_owasp_validator_html_scan_AntiSamyDOMScanner.java.txt"], "patch_list": [{"patch_file": "src/main/java/org/owasp/validator/html/scan/AntiSamyDOMScanner.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private boolean processStyleTag(Element ele, Node parentNode) {", "Modified_Line": "-            Node firstChild = ele.getFirstChild();\n-            if (firstChild != null) {\n-                String toScan = firstChild.getNodeValue();\n                CleanResults cr = styleScanner.scanStyleSheet(toScan, policy.getMaxInputSize());\n                errorMessages.addAll(cr.getErrorMessages());\n-                final String cleanHTML = cr.getCleanHTML();\n-                if (cleanHTML == null || cleanHTML.equals(\"\")) {\n-                    firstChild.setNodeValue(\"/* */\");\n-                } else {\n-                    firstChild.setNodeValue(cleanHTML);\n"}]}]}
{"num": 168, "cve": "CVE-2022-29577", "des": "OWASP AntiSamy before 1.6.7 allows XSS via HTML tag smuggling on STYLE content with crafted input. The output serializer does not properly encode the supposed Cascading Style Sheets (CSS) content. NOTE: this issue exists because of an incomplete fix for CVE-2022-28367.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/nahsra/antisamy/commits/32e273507da0e964b58c50fd8a4c94c9d9363af0", "html_url": "https://github.com/nahsra/antisamy/commit/32e273507da0e964b58c50fd8a4c94c9d9363af0", "filename_list": ["./data/java/java_filter/168_0@nahsra@antisamy@b6e76de85a07549f2c97941437dd73430d7287a8@src_main_java_org_owasp_validator_html_scan_AntiSamyDOMScanner.java.txt"], "patch_list": [{"patch_file": "src/main/java/org/owasp/validator/html/scan/AntiSamyDOMScanner.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private boolean processStyleTag(Element ele, Node parentNode) {", "Modified_Line": "-                for (int i = 1; i < ele.getChildNodes().getLength(); i++) {\n                    Node childNode = ele.getChildNodes().item(i);\n                    ele.removeChild(childNode);\n"}]}]}
{"num": 169, "cve": "CVE-2022-24861", "des": "Databasir is a team-oriented relational database model document management platform. Databasir 1.01 has remote code execution vulnerability. JDBC drivers are not validated prior to use and may be provided by users of the system. This can lead to code execution by any basic user who has access to the system. Users are advised to upgrade. There are no known workarounds to this issue.", "cwe_list": ["CWE-20"], "cwe_name_lst": ["Improper Input Validation"], "url": "https://api.github.com/repos/vran-dev/databasir/commits/ca22a8fef7a31c0235b0b2951260a7819b89993b", "html_url": "https://github.com/vran-dev/databasir/commit/ca22a8fef7a31c0235b0b2951260a7819b89993b", "filename_list": ["./data/java/java_filter/169_1@vran-dev@databasir@6b6a7f4e40b136866819ece585cb9d56cf3fcbe6@core_src_main_java_com_databasir_core_domain_database_service_DatabaseTypeService.java.txt"], "patch_list": [{"patch_file": "core/src/main/java/com/databasir/core/domain/database/service/DatabaseTypeService.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public Integer create(DatabaseTypeCreateRequest request) {", "Modified_Line": "        DatabaseTypePojo pojo = databaseTypePojoConverter.of(request);\n        try {\n            return databaseTypeDao.insertAndReturnId(pojo);\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public void update(DatabaseTypeUpdateRequest request) {", "Modified_Line": "        databaseTypeDao.selectOptionalById(request.getId()).ifPresent(data -> {\n            if (DatabaseTypes.has(data.getDatabaseType())) {\n                throw DomainErrors.MUST_NOT_MODIFY_SYSTEM_DEFAULT_DATABASE_TYPE.exception();\n            }\n            DatabaseTypePojo pojo = databaseTypePojoConverter.of(request);\n            try {\n                databaseTypeDao.updateById(pojo);\n"}]}]}
{"num": 171, "cve": "CVE-2022-1231", "des": "XSS via Embedded SVG in SVG Diagram Format in GitHub repository plantuml/plantuml prior to 1.2022.4. Stored XSS in the context of the diagram embedder. Depending on the actual context, this ranges from stealing secrets to account hijacking or even to code execution for example in desktop applications. Web based applications are the ones most affected. Since the SVG format allows clickable links in diagrams, it is commonly used in plugins for web based projects (like the Confluence plugin, etc. see https://plantuml.com/de/running).", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/plantuml/plantuml/commits/c9137be051ce98b3e3e27f65f54ec7d9f8886903", "html_url": "https://github.com/plantuml/plantuml/commit/c9137be051ce98b3e3e27f65f54ec7d9f8886903", "filename_list": ["./data/java/java_filter/171_0@plantuml@plantuml@d8c80f411083e317807c2d256e2d6c79e224f305@src_net_sourceforge_plantuml_ugraphic_UImageSvg.java.txt"], "patch_list": [{"patch_file": "src/net/sourceforge/plantuml/ugraphic/UImageSvg.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public UImageSvg(String svg, double scale) {", "Modified_Line": "-\tprivate String clean(String svg) {\n-\t\tsvg = svg.toLowerCase().replaceAll(\"\\\\s\", \"\");\n-\t\tif (svg.contains(\"<script>\"))\n\t\treturn EMPTY_SVG;\n-\t\tif (svg.contains(\"</script>\"))\n\t\treturn EMPTY_SVG;\n-\t\tif (svg.contains(\"<foreignobject\"))\n\t\treturn EMPTY_SVG;\n-\t\tif (svg.contains(\"</foreignobject>\"))\n\t\treturn EMPTY_SVG;\n"}]}]}
{"num": 172, "cve": "CVE-2021-43288", "des": "An issue was discovered in ThoughtWorks GoCD before 21.3.0. An attacker in control of a GoCD Agent can plant malicious JavaScript into a failed Job Report.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/gocd/gocd/commits/f5c1d2aa9ab302a97898a6e4b16218e64fe8e9e4", "html_url": "https://github.com/gocd/gocd/commit/f5c1d2aa9ab302a97898a6e4b16218e64fe8e9e4", "filename_list": ["./data/java/java_filter/172_1@gocd@gocd@60ff52417e8e15b1e886eac5c39a0f1fbbf8f8cb@common_src_main_java_com_thoughtworks_go_domain_FileDirectoryEntry.java.txt", "./data/java/java_filter/172_2@gocd@gocd@60ff52417e8e15b1e886eac5c39a0f1fbbf8f8cb@common_src_main_java_com_thoughtworks_go_domain_FolderDirectoryEntry.java.txt"], "patch_list": [ {"patch_file": "common/src/main/java/com/thoughtworks/go/domain/FileDirectoryEntry.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected HtmlRenderable htmlBody() {", "Modified_Line": "        return HtmlElement.li().content(\n            HtmlElement.span(HtmlAttribute.cssClass(\"artifact\")).content(\n                HtmlElement.a(HtmlAttribute.href(getUrl()))\n-                        .content(getFileName())\n"}]}, {"patch_file": "common/src/main/java/com/thoughtworks/go/domain/FolderDirectoryEntry.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected HtmlRenderable htmlBody() {", "Modified_Line": "        return sequence(\n                HtmlElement.div(cssClass(\"dir-container\")).content(\n                    HtmlElement.span(cssClass(\"directory\")).content(\n                        HtmlElement.a(onclick(\"BuildDetail.tree_navigator(this)\"))\n-                                .content(getFileName())\n"}]}]}
{"num": 173, "cve": "CVE-2021-43286", "des": "An issue was discovered in ThoughtWorks GoCD before 21.3.0. An attacker with privileges to create a new pipeline on a GoCD server can abuse a command-line injection in the Git URL \"Test Connection\" feature to execute arbitrary code.", "cwe_list": ["CWE-77"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in a Command ('Command Injection')"], "url": "https://api.github.com/repos/gocd/gocd/commits/6fa9fb7a7c91e760f1adc2593acdd50f2d78676b", "html_url": "https://github.com/gocd/gocd/commit/6fa9fb7a7c91e760f1adc2593acdd50f2d78676b", "filename_list": ["./data/java/java_filter/173_3@gocd@gocd@46c728487b1fe31bf3f3ed410707d5e46782ceb4@domain_src_main_java_com_thoughtworks_go_domain_materials_git_GitCommand.java.txt"], "patch_list": [{"patch_file": "domain/src/main/java/com/thoughtworks/go/domain/materials/git/GitCommand.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void checkConnection(UrlArgument repoUrl) {", "Modified_Line": "-        final CommandLine commandLine = git().withArgs(\"ls-remote\").withArg(repoUrl).withArg(ref);\n"}]}]}
{"num": 174, "cve": "CVE-2021-43290", "des": "An issue was discovered in ThoughtWorks GoCD before 21.3.0. An attacker who has compromised a GoCD agent can upload a malicious file into a directory of a GoCD server. They can control the filename but the directory is placed inside of a directory that they can't control.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/gocd/gocd/commits/c22e0428164af25d3e91baabd3f538a41cadc82f", "html_url": "https://github.com/gocd/gocd/commit/c22e0428164af25d3e91baabd3f538a41cadc82f", "filename_list": ["./data/java/java_filter/174_0@gocd@gocd@c47c61cc262e365e99583763ab08d4f6628d26fe@server_src_main_java_com_thoughtworks_go_server_controller_ArtifactsController.java.txt"], "patch_list": [{"patch_file": "server/src/main/java/com/thoughtworks/go/server/controller/ArtifactsController.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public ModelAndView postArtifact(", "Modified_Line": "        try {\n            jobIdentifier = restfulService.findJob(pipelineName, pipelineCounter, stageName, stageCounter,\n                    buildName, buildId);\n        } catch (Exception e) {\n            return buildNotFound(pipelineName, pipelineCounter, stageName, stageCounter,\n                    buildName);\n        }\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public ModelAndView putArtifact(", "Modified_Line": "        JobIdentifier jobIdentifier;\n        try {\n            jobIdentifier = restfulService.findJob(pipelineName, pipelineCounter, stageName, stageCounter, buildName, buildId);\n        } catch (Exception e) {\n            return buildNotFound(pipelineName, pipelineCounter, stageName, stageCounter, buildName);\n        }\n"}]}]}
{"num": 177, "cve": "CVE-2022-24818", "des": "GeoTools is an open source Java library that provides tools for geospatial data. The GeoTools library has a number of data sources that can perform unchecked JNDI lookups, which in turn can be used to perform class deserialization and result in arbitrary code execution. Similar to the Log4J case, the vulnerability can be triggered if the JNDI names are user-provided, but requires admin-level login to be triggered. The lookups are now restricted in GeoTools 26.4, GeoTools 25.6, and GeoTools 24.6. Users unable to upgrade should ensure that any downstream application should not allow usage of remotely provided JNDI strings.", "cwe_list": ["CWE-917"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection')"], "url": "https://api.github.com/repos/geotools/geotools/commits/4f70fa3234391dd0cda883a20ab0ec75688cba49", "html_url": "https://github.com/geotools/geotools/commit/4f70fa3234391dd0cda883a20ab0ec75688cba49", "filename_list": ["./data/java/java_filter/177_0@geotools@geotools@8483f1f4cdee174232f0c85393482112ea9f558d@modules_library_jdbc_src_main_java_org_geotools_data_jdbc_datasource_JNDIDataSourceFactory.java.txt", "./data/java/java_filter/177_1@geotools@geotools@8483f1f4cdee174232f0c85393482112ea9f558d@modules_library_jdbc_src_main_java_org_geotools_jdbc_JDBCJNDIDataStoreFactory.java.txt", "./data/java/java_filter/177_3@geotools@geotools@8483f1f4cdee174232f0c85393482112ea9f558d@modules_library_referencing_src_main_java_org_geotools_referencing_factory_AbstractEpsgMediator.java.txt", "./data/java/java_filter/177_5@geotools@geotools@8483f1f4cdee174232f0c85393482112ea9f558d@modules_library_referencing_src_main_java_org_geotools_referencing_factory_epsg_ThreadedEpsgFactory.java.txt", "./data/java/java_filter/177_6@geotools@geotools@8483f1f4cdee174232f0c85393482112ea9f558d@modules_unsupported_postgis-raster_src_main_java_org_geotools_gce_pgraster_PGRasterConfig.java.txt"], "patch_list": [{"patch_file": "modules/library/jdbc/src/main/java/org/geotools/data/jdbc/datasource/JNDIDataSourceFactory.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public DataSource createNewDataSource(Map<String, ?> params) throws IOException {", "Modified_Line": "        String refName = (String) JNDI_REFNAME.lookUp(params);\n        try {\n-            return (DataSource) GeoTools.getInitialContext().lookup(refName);\n"}]}, {"patch_file": "modules/library/jdbc/src/main/java/org/geotools/jdbc/JDBCJNDIDataStoreFactory.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected DataSource createDataSource(Map<String, ?> params, SQLDialect dialect)", "Modified_Line": "        String jndiName = (String) JNDI_REFNAME.lookUp(params);\n        if (jndiName == null) throw new IOException(\"Missing \" + JNDI_REFNAME.description);\n-        Context ctx = null;\n        DataSource ds = null;\n        try {\n-            ctx = GeoTools.getInitialContext();\n-        } catch (NamingException e) {\n-            throw new RuntimeException(e);\n-        }\n-\n-        try {\n-            ds = (DataSource) ctx.lookup(jndiName);\n        } catch (NamingException e1) {\n            try {\n                if (jndiName.startsWith(J2EERootContext) == false) {\n-                    ds = (DataSource) ctx.lookup(J2EERootContext + jndiName);\n"}]}, {"patch_file": "modules/library/referencing/src/main/java/org/geotools/referencing/factory/AbstractEpsgMediator.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "static DataSource lookupDataSource(Hints hints) throws FactoryException {", "Modified_Line": "            String name = (String) hint;\n-            InitialContext context;\n            try {\n-                context = GeoTools.getInitialContext();\n-                return (DataSource) context.lookup(name);\n"}]}, {"patch_file": "modules/library/referencing/src/main/java/org/geotools/referencing/factory/epsg/ThreadedEpsgFactory.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected DataSource createDataSource() throws SQLException {", "Modified_Line": "-        InitialContext context = null;\n        DataSource source = null;\n        try {\n-            context = GeoTools.getInitialContext();\n-            source = (DataSource) context.lookup(datasourceName);\n-        } catch (IllegalArgumentException | NoInitialContextException exception) {\n-        } catch (NamingException exception) {\n-            registerInto = context;\n        return source;\n"}]}, {"patch_file": "modules/unsupported/postgis-raster/src/main/java/org/geotools/gce/pgraster/PGRasterConfig.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "static Document parse(File cfgfile) {", "Modified_Line": "        String jndi = first(db, \"jndi\").map(this::nodeValue).orElse(null);\n        if (jndi != null) {\n            try {\n-                dataSource = (DataSource) GeoTools.getInitialContext().lookup(jndi);\n"}]}]}
{"num": 179, "cve": "CVE-2021-3461", "des": "A flaw was found in keycloak where keycloak may fail to logout user session if the logout request comes from external SAML identity provider and Principal Type is set to Attribute [Name].", "cwe_list": ["CWE-613"], "cwe_name_lst": ["Insufficient Session Expiration"], "url": "https://api.github.com/repos/keycloak/keycloak/commits/3bb5bff8e0bf9de91dde9323ef8bc2b637b90e1d", "html_url": "https://github.com/keycloak/keycloak/commit/3bb5bff8e0bf9de91dde9323ef8bc2b637b90e1d", "filename_list": ["./data/java/java_filter/179_0@keycloak@keycloak@3913526934d1537ee2fe32386ebc7b9439e59e92@services_src_main_java_org_keycloak_broker_saml_SAMLEndpoint.java.txt"], "patch_list": [{"patch_file": "services/src/main/java/org/keycloak/broker/saml/SAMLEndpoint.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected Response logoutRequest(LogoutRequestType request, String relayState) {", "Modified_Line": "            String brokerUserId = config.getAlias() + \".\" + request.getNameID().getValue();\n                for (String sessionIndex : request.getSessionIndex()) {\n-                    String brokerSessionId = brokerUserId + \".\" + sessionIndex;\n"}, {"Modified_Block_Num": "2", "Modified_Function": "protected Response handleLoginResponse(String samlResponse, SAMLDocumentHolder h", "Modified_Line": "                BrokeredIdentityContext identity = new BrokeredIdentityContext(principal);\n                AuthnStatementType authn = null;\n                for (Object statement : assertion.getStatements()) {\n                    if (statement instanceof AuthnStatementType) {\n                        authn = (AuthnStatementType)statement;\n                        identity.getContextData().put(SAML_AUTHN_STATEMENT, authn);\n                        break;\n                    }\n                }\n                String brokerUserId = config.getAlias() + \".\" + principal;\n                identity.setBrokerUserId(brokerUserId);\n                if (authn != null && authn.getSessiocnIndex() != null) {\n-                    identity.setBrokerSessionId(identity.getBrokerUserId() + \".\" + authn.getSessionIndex());\n"}]}]}
{"num": 180, "cve": "CVE-2022-22950", "des": "n Spring Framework versions 5.3.0 - 5.3.16 and older unsupported versions, it is possible for a user to provide a specially crafted SpEL expression that may cause a denial of service condition.", "cwe_list": ["CWE-770"], "cwe_name_lst": ["Allocation of Resources Without Limits or Throttling"], "url": "https://api.github.com/repos/spring-projects/spring-framework/commits/83ac65915871067c39a4fb255e0d484c785c0c11", "html_url": "https://github.com/spring-projects/spring-framework/commit/83ac65915871067c39a4fb255e0d484c785c0c11", "filename_list": ["./data/java/java_filter/180_1@spring-projects@spring-framework@a2f02dbfc04d5d7463612848067bdde26c84b743@spring-expression_src_main_java_org_springframework_expression_spel_ast_ConstructorReference.java.txt"], "patch_list": [{"patch_file": "spring-expression/src/main/java/org/springframework/expression/spel/ast/ConstructorReference.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private TypedValue createArray(ExpressionState state) throws EvaluationException", "Modified_Line": "\t\t\t\tTypeConverter typeConverter = state.getEvaluationContext().getTypeConverter();\n\t\t\t\t\tint[] dims = new int[this.dimensions.length];\n\t\t\t\t\tfor (int d = 0; d < this.dimensions.length; d++) {\n\t\t\t\t\t\tTypedValue o = this.dimensions[d].getTypedValue(state);\n-\t\t\t\t\t\tdims[d] = ExpressionUtils.toInt(typeConverter, o);\n"}]}]}
{"num": 182, "cve": "CVE-2022-23082", "des": "In CureKit versions v1.0.1 through v1.1.3 are vulnerable to path traversal as the function isFileOutsideDir fails to sanitize the user input which may lead to path traversal.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/whitesource/CureKit/commits/af35e870ed09411d2f1fae6db1b04598cd1a31b6", "html_url": "https://github.com/whitesource/CureKit/commit/af35e870ed09411d2f1fae6db1b04598cd1a31b6", "filename_list": ["./data/java/java_filter/182_0@whitesource@CureKit@d6ac3c382cb9d0b7a9f164eb3db1811d51f47c7c@src_main_java_io_whitesource_cure_FileSecurityUtils.java.txt"], "patch_list": [{"patch_file": "src/main/java/io/whitesource/cure/FileSecurityUtils.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static boolean isFileOutsideDir(", "Modified_Line": "    File file = new File(filePath);\n    File baseDir = new File(baseDirPath);\n-    return !file.getCanonicalPath().startsWith(baseDir.getCanonicalPath());\n"}]}]}
{"num": 183, "cve": "CVE-2022-29253", "des": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Starting with version 8.3-rc-1 and prior to versions 12.10.3 and 14.0, one can ask for any file located in the classloader using the template API and a path with \"..\" in it. The issue is patched in versions 14.0 and 13.10.3. There is no easy workaround for this issue.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/xwiki/xwiki-platform/commits/4917c8f355717bb636d763844528b1fe0f95e8e2", "html_url": "https://github.com/xwiki/xwiki-platform/commit/4917c8f355717bb636d763844528b1fe0f95e8e2", "filename_list": ["./data/java/java_filter/183_1@xwiki@xwiki-platform@6b54214a2671ee09affe31f8e4681d11af3e9bdf@xwiki-platform-core_xwiki-platform-oldcore_src_main_java_com_xpn_xwiki_internal_template_InternalTemplateManager.java.txt"], "patch_list": [{"patch_file": "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/internal/template/InternalTemplateManager.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private Template getClassloaderTemplate(String suffixPath, String templateName)", "Modified_Line": "-        return getClassloaderTemplate(Thread.currentThread().getContextClassLoader(), suffixPath, templateName);\n"}, {"Modified_Block_Num": "2", "Modified_Function": "private Template getClassloaderTemplate(ClassLoader classloader, String suffixPath, String templateName)", "Modified_Line": "-        String templatePath = suffixPath + templateName;\n"}]}]}
{"num": 186, "cve": "CVE-2022-29237", "des": "Opencast is a free and open source solution for automated video capture and distribution at scale. Prior to Opencast 10.14 and 11.7, users could pass along URLs for files belonging to organizations other than the user's own, which Opencast would then import into the current organization, bypassing organizational barriers. Attackers must have full access to Opencast's ingest REST interface, and also know internal links to resources in another organization of the same Opencast cluster. Users who do not run a multi-tenant cluster are not affected by this issue. This issue is fixed in Opencast 10.14 and 11.7.", "cwe_list": ["CWE-287"], "cwe_name_lst": ["Improper Authentication"], "url": "https://api.github.com/repos/opencast/opencast/commits/8d5ec1614eed109b812bc27b0c6d3214e456d4e7", "html_url": "https://github.com/opencast/opencast/commit/8d5ec1614eed109b812bc27b0c6d3214e456d4e7", "filename_list": ["./data/java/java_filter/186_0@opencast@opencast@eee0c26fe33afc0709373fcbd7c6870bee8e2bed@modules_ingest-service-impl_src_main_java_org_opencastproject_ingest_impl_IngestServiceImpl.java.txt"], "patch_list": [{"patch_file": "modules/ingest-service-impl/src/main/java/org/opencastproject/ingest/impl/IngestServiceImpl.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected URI addContentToRepo(MediaPackage mp, String elementId, URI uri) throw", "Modified_Line": "        HttpGet get = new HttpGet(uri);\n-        List<String> clusterUrls = new LinkedList<>();\n-        try {\n-          clusterUrls = organizationDirectoryService.getOrganization(uri.toURL()).getServers()\n-                          .keySet()\n-                          .stream()\n-                          .collect(Collectors.toUnmodifiableList());\n-        } catch (NotFoundException e) {\n-          logger.warn(\"Unable to determine cluster members, will not be able to authenticate any downloads from them\", e);\n-        }\n"}]}]}
{"num": 188, "cve": "CVE-2022-29184", "des": "GoCD is a continuous delivery server. In GoCD versions prior to 22.1.0, it is possible for existing authenticated users who have permissions to edit or create pipeline materials or pipeline configuration repositories to get remote code execution capability on the GoCD server via configuring a malicious branch name which abuses Mercurial hooks/aliases to exploit a command injection weakness. An attacker would require access to an account with existing GoCD administration permissions to either create/edit (`hg`-based) configuration repositories; create/edit pipelines and their (`hg`-based) materials; or, where \"pipelines-as-code\" configuration repositories are used, to commit malicious configuration to such an external repository which will be automatically parsed into a pipeline configuration and (`hg`) material definition by the GoCD server. This issue is fixed in GoCD 22.1.0. As a workaround, users who do not use/rely upon Mercurial materials can uninstall/remove the `hg`/Mercurial binary from the underlying GoCD Server operating system or Docker image.", "cwe_list": ["CWE-77"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in a Command ('Command Injection')"], "url": "https://api.github.com/repos/gocd/gocd/commits/37d35115db2ada2190173f9413cfe1bc6c295ecb", "html_url": "https://github.com/gocd/gocd/commit/37d35115db2ada2190173f9413cfe1bc6c295ecb", "filename_list": ["./data/java/java_filter/188_0@gocd@gocd@ce02934b9d94f7d34634f4221e035938643e44e7@domain_src_main_java_com_thoughtworks_go_domain_materials_mercurial_HgCommand.java.txt"], "patch_list": [{"patch_file": "domain/src/main/java/com/thoughtworks/go/domain/materials/mercurial/HgCommand.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private boolean pull(ConsoleOutputStreamConsumer outputStreamConsumer) {", "Modified_Line": "-        CommandLine hg = hg(\"pull\", \"-b\", branch, \"--config\", String.format(\"paths.default=%s\", url));\n-        return execute(hg, outputStreamConsumer) == 0;\n"},{"Modified_Block_Num": "2", "Modified_Function": "public int clone(ConsoleOutputStreamConsumer outputStreamConsumer, UrlArgument repositoryUrl) {", "Modified_Line": " -        CommandLine hg = createCommandLine(\"hg\").withArgs(\"clone\").withArg(\"-b\").withArg(branch).withArg(repositoryUrl)\n-                .withArg(workingDir.getAbsolutePath()).withNonArgSecrets(secrets).withEncoding(\"utf-8\");\n"}, {"Modified_Block_Num": "3", "Modified_Function": "public void checkConnection(UrlArgument repositoryURL) {", "Modified_Line": " -        execute(createCommandLine(\"hg\").withArgs(\"id\", \"--id\").withArg(repositoryURL).withNonArgSecrets(secrets).withEncoding(\"utf-8\"), new NamedProcessTag(repositoryURL.forDisplay()));\n"}, {"Modified_Block_Num": "4", "Modified_Function": "private String templatePath() {", "Modified_Line": "-        if (templatePath == null) {\n-            String file = HgCommand.class.getResource(\"/hg.template\").getFile();\n-            try {\n-                templatePath = URLDecoder.decode(new File(file).getAbsolutePath(), \"UTF-8\");\n-            } catch (UnsupportedEncodingException e) {\n-                templatePath = URLDecoder.decode(new File(file).getAbsolutePath());\n-            }\n-        }\n-        return templatePath;\n-    }\n-\n-    List<Modification> findRecentModifications(int count) {\n        InMemoryStreamConsumer consumer = inMemoryConsumer();\n        bombUnless(pull(consumer), \"Failed to run hg pull command: \" + consumer.getAllOutput());\n-        CommandLine hg = hg(\"log\", \"--limit\", String.valueOf(count), \"-b\", branch, \"--style\", templatePath());\n"}, {"Modified_Block_Num": "5", "Modified_Function": "public List<Modification> modificationsSince(Revision revision) {", "Modified_Line": "        InMemoryStreamConsumer consumer = inMemoryConsumer();\n        bombUnless(pull(consumer), \"Failed to run hg pull command: \" + consumer.getAllOutput());\n-        CommandLine hg = hg(\"log\",\n-                \"-r\", \"tip:\" + revision.getRevision(),\n-                \"-b\", branch,\n-                \"--style\", templatePath());\n"}]}]}
{"num": 189, "cve": "CVE-2022-1782", "des": "Cross-site Scripting (XSS) - Generic in GitHub repository erudika/para prior to v1.45.11.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/Erudika/para/commits/9d844f31333475a0394dd14b901ea50674b281f8", "html_url": "https://github.com/Erudika/para/commit/9d844f31333475a0394dd14b901ea50674b281f8", "filename_list": ["./data/java/java_filter/189_0@Erudika@para@62a6550546c50e1988f515f94129822f6564cfa8@para-core_src_main_java_com_erudika_para_core_utils_Utils.java.txt"], "patch_list": [{"patch_file": "para-core/src/main/java/com/erudika/para/core/utils/Utils.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static String compileMustache(Map<String, Object> context, String template) {", "Modified_Line": "\t\tWriter writer = new StringWriter();\n\t\ttry {\n-\t\t\tMustache.compiler().escapeHTML(false).emptyStringIsFalse(true).compile(template).execute(context, writer);\n"}]}]}
{"num": 194, "cve": "CVE-2022-24830", "des": "OpenClinica is an open source software for Electronic Data Capture (EDC) and Clinical Data Management (CDM). OpenClinica prior to version 3.16 is vulnerable to path traversal in multiple endpoints, leading to arbitrary file read/write, and potential remote code execution. There are no known workarounds. This issue has been patched and users are recommended to upgrade.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/OpenClinica/OpenClinica/commits/6f864e86543f903bd20d6f9fc7056115106441f3", "html_url": "https://github.com/OpenClinica/OpenClinica/commit/6f864e86543f903bd20d6f9fc7056115106441f3", "filename_list": ["./data/java/java_filter/194_0@OpenClinica@OpenClinica@bd363d40b0b002456b925b47a4cb84aacf7fa037@web_src_main_java_org_akaza_openclinica_control_admin_DownloadVersionSpreadSheetServlet.java.txt", "./data/java/java_filter/194_1@OpenClinica@OpenClinica@bd363d40b0b002456b925b47a4cb84aacf7fa037@web_src_main_java_org_akaza_openclinica_control_submit_DownloadAttachedFileServlet.java.txt", "./data/java/java_filter/194_2@OpenClinica@OpenClinica@bd363d40b0b002456b925b47a4cb84aacf7fa037@web_src_main_java_org_akaza_openclinica_controller_BatchCRFMigrationController.java.txt", "./data/java/java_filter/194_3@OpenClinica@OpenClinica@bd363d40b0b002456b925b47a4cb84aacf7fa037@web_src_main_java_org_akaza_openclinica_controller_openrosa_OpenRosaSubmissionController.java.txt"], "patch_list": [{"patch_file": "web/src/main/java/org/akaza/openclinica/control/admin/DownloadVersionSpreadSheetServlet.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void processRequest() throws Exception {", "Modified_Line": "-        \tif (oldExcelFile.exists() && oldExcelFile.length() > 0) {\n-                 if (!excelFile.exists() || excelFile.length() <= 0) {\n-                     excelFile = oldExcelFile;\n-                     excelFileName = oldExcelFileName;\n-                 }\n-             }\n"}]}, {"patch_file": "web/src/main/java/org/akaza/openclinica/control/submit/DownloadAttachedFileServlet.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void processRequest() throws Exception {", "Modified_Line": "        File f = new File(fileName);\r\n-        if(fileName != null && fileName.indexOf(\"..\") > -1) {\r\n-        \tthrow new RuntimeException(\"Traversal attempt - absolute path not allowed \" + fileName);\r\n-        }\r\n"}]}, {"patch_file": "web/src/main/java/org/akaza/openclinica/controller/BatchCRFMigrationController.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void getLogFile(@PathVariable(\"filename\") String fileName, HttpServletRes", "Modified_Line": "-            String logFileName = getFilePath() + File.separator + FilenameUtils.getName(fileName);\n-            File fileToDownload = new File(logFileName);\n-            inputStream = new FileInputStream(fileToDownload);\n-            response.setContentType(\"application/force-download\");\n-            response.setHeader(\"Content-Disposition\", \"attachment; filename=\" + fileName);\n-            IOUtils.copy(inputStream, response.getOutputStream());\n-            response.flushBuffer();\n"}]}, {"patch_file": "web/src/main/java/org/akaza/openclinica/controller/openrosa/OpenRosaSubmissionController.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static String getAttachedFilePath(String inputStudyOid) {", "Modified_Line": "-    \tString studyOid =  FilenameUtils.getName(inputStudyOid);\n    \tString attachedFilePath = CoreResources.getField(\"attached_file_location\");\n        if (attachedFilePath == null || attachedFilePath.length() <= 0) {\n-            attachedFilePath = CoreResources.getField(\"filePath\") + \"attached_files\" + File.separator + studyOid + File.separator;\n-        } else {\n-            attachedFilePath += studyOid + File.separator;\n        }\n-        return attachedFilePath;\n"}]}]}
{"num": 195, "cve": "CVE-2022-24823", "des": "Netty is an open-source, asynchronous event-driven network application framework. The package `io.netty:netty-codec-http` prior to version 4.1.77.Final contains an insufficient fix for CVE-2021-21290. When Netty's multipart decoders are used local information disclosure can occur via the local system temporary directory if temporary storing uploads on the disk is enabled. This only impacts applications running on Java version 6 and lower. Additionally, this vulnerability impacts code running on Unix-like systems, and very old versions of Mac OSX and Windows as they all share the system temporary directory between all users. Version 4.1.77.Final contains a patch for this vulnerability. As a workaround, specify one's own `java.io.tmpdir` when starting the JVM or use DefaultHttpDataFactory.setBaseDir(...) to set the directory to something that is only readable by the current user.", "cwe_list": ["CWE-668", "CWE-379", "CWE-378"], "cwe_name_lst": ["Exposure of Resource to Wrong Sphere", "Creation of Temporary File in Directory with Insecure Permissions", "Creation of Temporary File With Insecure Permissions"], "url": "https://api.github.com/repos/netty/netty/commits/185f8b2756a36aaa4f973f1a2a025e7d981823f1", "html_url": "https://github.com/netty/netty/commit/185f8b2756a36aaa4f973f1a2a025e7d981823f1", "filename_list": ["./data/java/java_filter/195_0@netty@netty@7dbca6aedc8cf5971e2a26d8fc2b7f265f2b4bf1@common_src_main_java_io_netty_util_internal_PlatformDependent.java.txt"], "patch_list": [{"patch_file": "common/src/main/java/io/netty/util/internal/PlatformDependent.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static File createTempFile(String prefix, String suffix, File directory)", "Modified_Line": "        if (directory == null) {\n-            return File.createTempFile(prefix, suffix);\n        }\n-        File file = File.createTempFile(prefix, suffix, directory);\n-        file.setReadable(false, false);\n-        file.setReadable(true, true);\n        return file;\n"}]}]}
{"num": 196, "cve": "CVE-2022-29161", "des": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. The XWiki Crypto API will generate X509 certificates signed by default using SHA1 with RSA, which is not considered safe anymore for use in certificate signatures, due to the risk of collisions with SHA1. The problem has been patched in XWiki version 13.10.6, 14.3.1 and 14.4-rc-1. Since then, the Crypto API will generate X509 certificates signed by default using SHA256 with RSA. Administrators are advised to upgrade their XWiki installation to one of the patched versions. If the upgrade is not possible, it is possible to patch the module xwiki-platform-crypto in a local installation by applying the change exposed in 26728f3 and re-compiling the module.", "cwe_list": ["CWE-326"], "cwe_name_lst": ["Inadequate Encryption Strength"], "url": "https://api.github.com/repos/xwiki/xwiki-platform/commits/26728f3f23658288683667a5182a916c7ecefc52", "html_url": "https://github.com/xwiki/xwiki-platform/commit/26728f3f23658288683667a5182a916c7ecefc52", "filename_list": ["./data/java/java_filter/196_0@xwiki@xwiki-platform@3b871d906e664fa1875fbeb088404cf31e9f0094@xwiki-platform-core_xwiki-platform-crypto_xwiki-platform-crypto-script_src_main_java_org_xwiki_crypto_script_RSACryptoScriptService.java.txt"], "patch_list": [{"patch_file": "xwiki-platform-core/xwiki-platform-crypto/xwiki-platform-crypto-script/src/main/java/org/xwiki/crypto/script/RSACryptoScriptService.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public class RSACryptoScriptService implements ScriptService", "Modified_Line": "-    @Named(\"SHA1withRSAEncryption\")\n"}]}]}
{"num": 197, "cve": "CVE-2022-24897", "des": "APIs to evaluate content with Velocity is a package for APIs to evaluate content with Velocity. Starting with version 2.3 and prior to 12.6.7, 12.10.3, and 13.0, the velocity scripts are not properly sandboxed against using the Java File API to perform read or write operations on the filesystem. Writing an attacking script in Velocity requires the Script rights in XWiki so not all users can use it, and it also requires finding an XWiki API which returns a File. The problem has been patched in versions 12.6.7, 12.10.3, and 13.0. There is no easy workaround for fixing this vulnerability other than upgrading and being careful when giving Script rights.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/xwiki/xwiki-commons/commits/215951cfb0f808d0bf5b1097c9e7d1e503449ab8", "html_url": "https://github.com/xwiki/xwiki-commons/commit/215951cfb0f808d0bf5b1097c9e7d1e503449ab8", "filename_list": ["./data/java/java_filter/197_0@xwiki@xwiki-commons@75aadf3257c57c6ab62f7441b66f3cf3abddfdde@xwiki-commons-core_xwiki-commons-velocity_src_main_java_org_xwiki_velocity_introspection_SecureIntrospector.java.txt"], "patch_list": [{"patch_file": "xwiki-commons-core/xwiki-commons-velocity/src/main/java/org/xwiki/velocity/introspection/SecureIntrospector.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public boolean checkObjectExecutePermission(Class clazz, String methodName)", "Modified_Line": "-        if (Class.class.isAssignableFrom(clazz) && methodName != null && this.secureClassMethods.contains(methodName)) {\n-            return true;\n-        } else {\n-            return super.checkObjectExecutePermission(clazz, methodName);\n"}]}]}
{"num": 201, "cve": "CVE-2022-29648", "des": "A cross-site scripting (XSS) vulnerability in Jfinal CMS v5.1.0 allows attackers to execute arbitrary web scripts or HTML via a crafted X-Forwarded-For request.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/jflyfox/jfinal_cms/commits/26f0945c047c5c24698f10115373f0ad8ea1331f", "html_url": "https://github.com/jflyfox/jfinal_cms/commit/26f0945c047c5c24698f10115373f0ad8ea1331f", "filename_list": ["./data/java/java_filter/201_0@jflyfox@jfinal_cms@075701a8c9dcd8c13f5560b551f33bb3ef79c3ed@src_main_java_com_jflyfox_modules_front_controller_PersonController.java.txt"], "patch_list": [{"patch_file": "src/main/java/com/jflyfox/modules/front/controller/PersonController.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void saveblog() {", "Modified_Line": "\t\tString content = model.getContent();\r\n\t\tString title = model.getTitle();\r\n\t\tcontent = JFlyFoxUtils.delScriptTag(content);\r\n\t\ttitle = HtmlUtils.delHTMLTag(title);\r\n"}]}]}
{"num": 202, "cve": "CVE-2022-24848", "des": "DHIS2 is an information system for data capture, management, validation, analytics and visualization. A SQL injection security vulnerability affects the `/api/programs/orgUnits?programs=` API endpoint in DHIS2 versions prior to 2.36.10.1 and 2.37.6.1. The system is vulnerable to attack only from users that are logged in to DHIS2, and there is no known way of exploiting the vulnerability without first being logged in as a DHIS2 user. The vulnerability is not exposed to a non-malicious user and requires a conscious attack to be exploited. A successful exploit of this vulnerability could allow the malicious user to read, edit and delete data in the DHIS2 instance's database. Security patches are now available for DHIS2 versions 2.36.10.1 and 2.37.6.1. One may apply mitigations at the web proxy level as a workaround. More information about these mitigations is available in the GitHub Security Advisory.", "cwe_list": ["CWE-89"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "url": "https://api.github.com/repos/dhis2/dhis2-core/commits/3b245d04a58b78f0dc9bae8559f36ee4ca36dfac", "html_url": "https://github.com/dhis2/dhis2-core/commit/3b245d04a58b78f0dc9bae8559f36ee4ca36dfac", "filename_list": ["./data/java/java_filter/202_2@dhis2@dhis2-core@0a0d8e393ed4f8bcd3cdc5a1bdd389051fe2a1b1@dhis-2_dhis-services_dhis-service-core_src_main_java_org_hisp_dhis_association_ProgramOrganisationUnitAssociationsQueryBuilder.java.txt"], "patch_list": [{"patch_file": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/association/ProgramOrganisationUnitAssociationsQueryBuilder.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private String getOwnerCondition( CurrentUserGroupInfo currentUserGroupInfo )", "Modified_Line": "        return String.join( \" or \",\n-            jsonbFunction( EXTRACT_PATH_TEXT, \"owner\" ) + \" = \" + withQuotes( currentUserGroupInfo.getUserUID() ),\n"}, {"Modified_Block_Num": "2", "Modified_Function": "private String getPublicSharingCondition( String access )", "Modified_Line": "        return String.join( \" or \",\n-            jsonbFunction( EXTRACT_PATH_TEXT, \"public\" ) + \" like \" + withQuotes( access ),\n"}, {"Modified_Block_Num": "3", "Modified_Function": "private String jsonbFunction( String functionName, String... params )", "Modified_Line": "        return String.join( \"\",\n            functionName,\n            \"(\",\n            String.join( \",\", \"prg.sharing\",\n                Arrays.stream( params )\n-                    .map( this::withQuotes )\n"}, {"Modified_Block_Num": "4", "Modified_Function": "private String getProgramUidsFilter( Set<String> programUids )", "Modified_Line": "        return \"pr.uid in (\" +\n            programUids.stream()\n-                .map( this::withQuotes )\n"}, {"Modified_Block_Num": "5", "Modified_Function": "private String withQuotes( String programUid )", "Modified_Line": "-        return String.join( \"\", \"'\", programUid, \"'\" );\n"}]}]}
{"num": 205, "cve": "CVE-2022-31139", "des": "UnsafeAccessor (UA) is a bridge to access jdk.internal.misc.Unsafe & sun.misc.Unsafe. Normally, if UA is loaded as a named module, the internal data of UA is protected by JVM and others can only access UA via UA's standard API. The main application can set up `SecurityCheck.AccessLimiter` for UA to limit access to UA. Starting with version 1.4.0 and prior to version 1.7.0, when `SecurityCheck.AccessLimiter` is set up, untrusted code can access UA without limitation, even when UA is loaded as a named module. This issue does not affect those for whom `SecurityCheck.AccessLimiter` is not set up. Version 1.7.0 contains a patch.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/Karlatemp/UnsafeAccessor/commits/4ef83000184e8f13239a1ea2847ee401d81585fd", "html_url": "https://github.com/Karlatemp/UnsafeAccessor/commit/4ef83000184e8f13239a1ea2847ee401d81585fd", "filename_list": ["./data/java/java_filter/205_1@Karlatemp@UnsafeAccessor@971c479496c38c89f6201ee73c108d2a342a9a5a@api_src_main_java_io_github_karlatemp_unsafeaccessor_UnsafeAccess.java.txt"], "patch_list": [{"patch_file": "api/src/main/java/io/github/karlatemp/unsafeaccessor/UnsafeAccess.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static UnsafeAccess getInstance() {", "Modified_Line": "-        SecurityCheck.getInstance();\n        return INSTANCE;\n"}]}]}
{"num": 206, "cve": "CVE-2022-1245", "des": "A privilege escalation flaw was found in the token exchange feature of keycloak. Missing authorization allows a client application holding a valid access token to exchange tokens for any target client by passing the client_id of the target. This could allow a client to gain unauthorized access to additional services.", "cwe_list": ["CWE-639"], "cwe_name_lst": ["Authorization Bypass Through User-Controlled Key"], "url": "https://api.github.com/repos/keycloak/keycloak/commits/76d83f46fad94ebcbedaa49e6daad458e2894e52", "html_url": "https://github.com/keycloak/keycloak/commit/76d83f46fad94ebcbedaa49e6daad458e2894e52", "filename_list": ["./data/java/java_filter/206_0@keycloak@keycloak@ac79fd0c23c6947a04073afc61e30d341498438e@services_src_main_java_org_keycloak_protocol_oidc_DefaultTokenExchangeProvider.java.txt"], "patch_list": [{"patch_file": "services/src/main/java/org/keycloak/protocol/oidc/DefaultTokenExchangeProvider.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected Response exchangeClientToClient(UserModel targetUser, UserSessionModel targetUserSession) {", "Modified_Line": "-        ClientModel targetClient = client;\n        String audience = formParams.getFirst(OAuth2Constants.AUDIENCE);\n        if (audience != null) {\n            targetClient = realm.getClientByClientId(audience);\n-        if (!targetClient.equals(client) && !AdminPermissions.management(session, realm).clients().canExchangeTo(client, targetClient)) {\n-            event.detail(Details.REASON, \"client not allowed to exchange to audience\");\n-            event.error(Errors.NOT_ALLOWED);\n-            throw new CorsErrorResponseException(cors, OAuthErrorException.ACCESS_DENIED, \"Client not allowed to exchange\", Response.Status.FORBIDDEN);\n"}]}]}
{"num": 207, "cve": "CVE-2022-1319", "des": "A flaw was found in Undertow. For an AJP 400 response, EAP 7 is improperly sending two response packets, and those packets have the reuse flag set even though JBoss EAP closes the connection. A failure occurs when the connection is reused after a 400 by CPING since it reads in the second SEND_HEADERS response packet instead of a CPONG.", "cwe_list": ["CWE-252"], "cwe_name_lst": ["Unchecked Return Value"], "url": "https://api.github.com/repos/undertow-io/undertow/commits/1443a1a2bbb8e32e56788109d8285db250d55c8b", "html_url": "https://github.com/undertow-io/undertow/commit/1443a1a2bbb8e32e56788109d8285db250d55c8b", "filename_list": ["./data/java/java_filter/207_0@undertow-io@undertow@5261e015fd7af133dd3ae2dc351e99240b1fa6a5@core_src_main_java_io_undertow_server_protocol_ajp_AjpReadListener.java.txt"], "patch_list": [{"patch_file": "core/src/main/java/io/undertow/server/protocol/ajp/AjpReadListener.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void handleEvent(AjpServerResponseConduit channel) {", "Modified_Line": "-    private static final byte[] END_RESPONSE = {'A', 'B', 0, 2, 5, 1};\n            if(oldState.badRequest) {\n                httpServerExchange.setStatusCode(StatusCodes.BAD_REQUEST);\n                httpServerExchange.endExchange();\n-                handleBadRequest();\n"},{"Modified_Block_Num": "2", "Modified_Function": "private void handleBadRequest() {", "Modified_Line": "        sendMessages(SEND_HEADERS_BAD_REQUEST_MSG, END_RESPONSE);\n"}]}]}
{"num": 208, "cve": "CVE-2022-2466", "des": "It was found that Quarkus 2.10.x does not terminate HTTP requests header context which may lead to unpredictable behavior.", "cwe_list": ["CWE-444"], "cwe_name_lst": ["Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')"], "url": "https://api.github.com/repos/quarkusio/quarkus/commits/aadc299b342d9c7dc99e3ddfcefbb1080e9e0a37", "html_url": "https://github.com/quarkusio/quarkus/commit/aadc299b342d9c7dc99e3ddfcefbb1080e9e0a37", "filename_list": ["./data/java/java_filter/208_0@quarkusio@quarkus@1c93492e00ce05103f2d9ac60d73830b0f29ae02@extensions_smallrye-graphql_runtime_src_main_java_io_quarkus_smallrye_graphql_runtime_SmallRyeGraphQLAbstractHandler.java.txt"], "patch_list": [{"patch_file": "extensions/smallrye-graphql/runtime/src/main/java/io/quarkus/smallrye/graphql/runtime/SmallRyeGraphQLAbstractHandler.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void handle(final RoutingContext ctx) {", "Modified_Line": "            currentManagedContext.activate();\n-            handleWithIdentity(ctx);\n-            ctx.response().bodyEndHandler((e) -> {\n                currentManagedContext.terminate();\n-            });\n"}]}]}
{"num": 209, "cve": "CVE-2022-25857", "des": "The package org.yaml:snakeyaml from 0 and before 1.31 are vulnerable to Denial of Service (DoS) due missing to nested depth limitation for collections.", "cwe_list": ["CWE-776"], "cwe_name_lst": ["Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')"], "url": "https://api.github.com/repos/snakeyaml/snakeyaml/commits/fc300780da21f4bb92c148bc90257201220cf174", "html_url": "https://github.com/snakeyaml/snakeyaml/commit/fc300780da21f4bb92c148bc90257201220cf174", "filename_list": ["./data/java/java_filter/209_1@snakeyaml@snakeyaml@4b8d1af4bd422a015fbb07d235f282412c863220@src_main_java_org_yaml_snakeyaml_composer_Composer.java.txt"], "patch_list": [{"patch_file": "src/main/java/org/yaml/snakeyaml/composer/Composer.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private Node composeNode(Node parent) {", "Modified_Line": "            NodeEvent event = (NodeEvent) parser.peekEvent();\n            String anchor = event.getAnchor();\n            if (parser.checkEvent(Event.ID.Scalar)) {\n                node = composeScalarNode(anchor, blockCommentsCollector.consume());\n            } else if (parser.checkEvent(Event.ID.SequenceStart)) {\n                node = composeSequenceNode(anchor);\n            } else {\n                node = composeMappingNode(anchor);\n            }\n"}]}]}
{"num": 210, "cve": "CVE-2021-3856", "des": "ClassLoaderTheme and ClasspathThemeResourceProviderFactory allows reading any file available as a resource to the classloader. By sending requests for theme resources with a relative path from an external HTTP client, the client will receive the content of random files if available.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/keycloak/keycloak/commits/73f0474008e1bebd0733e62a22aceda9e5de6743", "html_url": "https://github.com/keycloak/keycloak/commit/73f0474008e1bebd0733e62a22aceda9e5de6743", "filename_list": ["./data/java/java_filter/210_0@keycloak@keycloak@7d0af8519b0c4c90badd420bba75005ae4cdfa8a@services_src_main_java_org_keycloak_theme_ClassLoaderTheme.java.txt", "./data/java/java_filter/210_1@keycloak@keycloak@7d0af8519b0c4c90badd420bba75005ae4cdfa8a@services_src_main_java_org_keycloak_theme_ClasspathThemeResourceProviderFactory.java.txt"], "patch_list": [{"patch_file": "services/src/main/java/org/keycloak/theme/ClassLoaderTheme.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public InputStream getResourceAsStream(String path) {", "Modified_Line": "-        return classLoader.getResourceAsStream(resourceRoot + path);\n"}]}, {"patch_file": "services/src/main/java/org/keycloak/theme/ClasspathThemeResourceProviderFactory.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public InputStream getResourceAsStream(String path) throws IOException {", "Modified_Line": "-        return classLoader.getResourceAsStream(THEME_RESOURCES_RESOURCES + path);\n"}]}]}
{"num": 211, "cve": "CVE-2021-3859", "des": "A flaw was found in Undertow that tripped the client-side invocation timeout with certain calls made over HTTP2. This flaw allows an attacker to carry out denial of service attacks.", "cwe_list": ["CWE-668", "CWE-214"], "cwe_name_lst": ["Exposure of Resource to Wrong Sphere", "Invocation of Process Using Visible Sensitive Information"], "url": "https://api.github.com/repos/undertow-io/undertow/commits/db0f5be43f8e2a4b88fbedd2eb6d5a95a29ceaa8", "html_url": "https://github.com/undertow-io/undertow/commit/db0f5be43f8e2a4b88fbedd2eb6d5a95a29ceaa8", "filename_list": ["./data/java/java_filter/211_1@undertow-io@undertow@fca2af565496e99cdf169f624999c859674c5099@core_src_main_java_io_undertow_protocols_http2_Http2Channel.java.txt"], "patch_list": [{"patch_file": "core/src/main/java/io/undertow/protocols/http2/Http2Channel.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected AbstractHttp2StreamSourceChannel createChannelImpl(FrameHeaderData fra", "Modified_Line": "        if (frameParser.getContinuationParser() != null) {\n            this.continuationParser = frameParser.getContinuationParser();\n-            return null;\n-\n"}]}]}
{"num": 213, "cve": "CVE-2021-4213", "des": "A flaw was found in JSS, where it did not properly free up all memory. Over time, the wasted memory builds up in the server memory, saturating the server’s RAM. This flaw allows an attacker to force the invocation of an out-of-memory process, causing a denial of service.", "cwe_list": ["CWE-401"], "cwe_name_lst": ["Missing Release of Memory after Effective Lifetime"], "url": "https://api.github.com/repos/dogtagpki/jss/commits/5922560a78d0dee61af8a33cc9cfbf4cfa291448", "html_url": "https://github.com/dogtagpki/jss/commit/5922560a78d0dee61af8a33cc9cfbf4cfa291448", "filename_list": ["./data/java/java_filter/213_1@dogtagpki@jss@0eb6879c3acaaa06ff49f77e12d0a7ad490bc1f2@src_main_java_org_mozilla_jss_ssl_javax_JSSEngineReferenceImpl.java.txt"], "patch_list": [{"patch_file": "src/main/java/org/mozilla/jss/ssl/javax/JSSEngineReferenceImpl.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private void cleanupSSLFD() {", "Modified_Line": "        if (!closed_fd && ssl_fd != null) {\n            try {\n                SSL.RemoveCallbacks(ssl_fd);\n-                PR.Close(ssl_fd);\n                ssl_fd.close();\n            } catch (Exception e) {\n-                debug(\"Got exception trying to cleanup SSLFD: \" + e.getMessage());\n            } finally {\n                closed_fd = true;\n            }\n"}]}]}
{"num": 218, "cve": "CVE-2020-35509", "des": "A flaw was found in keycloak affecting versions 11.0.3 and 12.0.0. An expired certificate would be accepted by the direct-grant authenticator because of missing time stamp validations. The highest threat from this vulnerability is to data confidentiality and integrity.", "cwe_list": ["CWE-295"], "cwe_name_lst": ["Improper Certificate Validation"], "url": "https://api.github.com/repos/keycloak/keycloak/commits/478319348bdfdb9b6d39122f41edf2af79f679bb", "html_url": "https://github.com/keycloak/keycloak/commit/478319348bdfdb9b6d39122f41edf2af79f679bb", "filename_list": ["./data/java/java_filter/218_0@keycloak@keycloak@4b2c20c87107cad2825cb6d7b920835c0fafb922@services_src_main_java_org_keycloak_authentication_authenticators_x509_ValidateX509CertificateUsername.java.txt"], "patch_list": [{"patch_file": "services/src/main/java/org/keycloak/authentication/authenticators/x509/ValidateX509CertificateUsername.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void authenticate(AuthenticationFlowContext context) {", "Modified_Line": "            CertificateValidator.CertificateValidatorBuilder builder = certificateValidationParameters(context.getSession(), config);\n            CertificateValidator validator = builder.build(certs);\n            validator.checkRevocationStatus()\n                    .validateKeyUsage()\n-                    .validateExtendedKeyUsage();\n"}]}]}
{"num": 219, "cve": "CVE-2021-3690", "des": "A flaw was found in Undertow. A buffer leak on the incoming WebSocket PONG message may lead to memory exhaustion. This flaw allows an attacker to cause a denial of service. The highest threat from this vulnerability is availability.", "cwe_list": ["CWE-401"], "cwe_name_lst": ["Missing Release of Memory after Effective Lifetime"], "url": "https://api.github.com/repos/undertow-io/undertow/commits/c7e84a0b7efced38506d7d1dfea5902366973877", "html_url": "https://github.com/undertow-io/undertow/commit/c7e84a0b7efced38506d7d1dfea5902366973877", "filename_list": ["./data/java/java_filter/219_0@undertow-io@undertow@87f31ddaac835e3b41db339c1841760a1bac004f@websockets-jsr_src_main_java_io_undertow_websockets_jsr_FrameHandler.java.txt"], "patch_list": [{"patch_file": "websockets-jsr/src/main/java/io/undertow/websockets/jsr/FrameHandler.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void run() {", "Modified_Line": "        final HandlerWrapper handler = getHandler(FrameType.PONG);\n        if (handler != null) {\n            final Pooled<ByteBuffer[]> pooled = bufferedBinaryMessage.getData();\n            final PongMessage message = DefaultPongMessage.create(toBuffer(pooled.getResource()));\n            session.getContainer().invokeEndpointMethod(executor, new Runnable() {\n                @Override\n                public void run() {\n                    try {\n                        ((MessageHandler.Whole) handler.getHandler()).onMessage(message);\n                    } catch (Exception e) {\n                        invokeOnError(e);\n                    } finally {\n                        pooled.close();\n                    }\n                }\n            });\n"}]}]}
{"num": 221, "cve": "CVE-2022-36007", "des": "Venice is a Clojure inspired sandboxed Lisp dialect with excellent Java interoperability. A partial path traversal issue exists within the functions `load-file` and `load-resource`. These functions can be limited to load files from a list of load paths. Assuming Venice has been configured with the load paths: `[ \"/Users/foo/resources\" ]` When passing **relative** paths to these two vulnerable functions everything is fine: `(load-resource \"test.png\")` => loads the file \"/Users/foo/resources/test.png\" `(load-resource \"../resources-alt/test.png\")` => rejected, outside the load path When passing **absolute** paths to these two vulnerable functions Venice may return files outside the configured load paths: `(load-resource \"/Users/foo/resources/test.png\")` => loads the file \"/Users/foo/resources/test.png\" `(load-resource \"/Users/foo/resources-alt/test.png\")` => loads the file \"/Users/foo/resources-alt/test.png\" !!! The latter call suffers from the _Partial Path Traversal_ vulnerability. This issue’s scope is limited to absolute paths whose name prefix matches a load path. E.g. for a load-path `\"/Users/foo/resources\"`, the actor can cause loading a resource also from `\"/Users/foo/resources-alt\"`, but not from `\"/Users/foo/images\"`. Versions of Venice before and including v1.10.17 are affected by this issue. Upgrade to Venice >= 1.10.18, if you are on a version < 1.10.18. There are currently no known workarounds.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/jlangch/venice/commits/c942c73136333bc493050910f171a48e6f575b23", "html_url": "https://github.com/jlangch/venice/commit/c942c73136333bc493050910f171a48e6f575b23", "filename_list": ["./data/java/java_filter/221_0@jlangch@venice@c109778c75c56d553395eea74da81ef33e840e95@src_main_java_com_github_jlangch_venice_impl_util_io_LoadPaths.java.txt"], "patch_list": [{"patch_file": "src/main/java/com/github/jlangch/venice/impl/util/io/LoadPaths.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private boolean isFileWithinDirectory(", "Modified_Line": "            final File fl = new File(dir_, file.getPath());\n            if (fl.isFile()) {\n-                if (fl.getCanonicalPath().startsWith(dir_.getCanonicalPath())) {\n"}]}]}
{"num": 225, "cve": "CVE-2022-31195", "des": "DSpace open source software is a repository application which provides durable access to digital resources. In affected versions the ItemtImporServiceImpl is vulnerable to a path traversal vulnerability. This means a malicious SAF (simple archive format) package could cause a file/directory to be created anywhere the Tomcat/DSpace user can write to on the server. However, this path traversal vulnerability is only possible by a user with special privileges (either Administrators or someone with command-line access to the server). This vulnerability impacts the XMLUI, JSPUI and command-line. Users are advised to upgrade. As a basic workaround, users may block all access to the following URL paths: If you are using the XMLUI, block all access to /admin/batchimport path (this is the URL of the Admin Batch Import tool). Keep in mind, if your site uses the path \"/xmlui\", then you'd need to block access to /xmlui/admin/batchimport. If you are using the JSPUI, block all access to /dspace-admin/batchimport path (this is the URL of the Admin Batch Import tool). Keep in mind, if your site uses the path \"/jspui\", then you'd need to block access to /jspui/dspace-admin/batchimport. Keep in mind, only an Administrative user or a user with command-line access to the server is able to import/upload SAF packages. Therefore, assuming those users do not blindly upload untrusted SAF packages, then it is unlikely your site could be impacted by this vulnerability.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/DSpace/DSpace/commits/56e76049185bbd87c994128a9d77735ad7af0199", "html_url": "https://github.com/DSpace/DSpace/commit/56e76049185bbd87c994128a9d77735ad7af0199", "filename_list": ["./data/java/java_filter/225_0@DSpace@DSpace@73cdff26fdc40bb022e21dcfdeefebf28057cde7@dspace-api_src_main_java_org_dspace_app_itemimport_ItemImport.java.txt"], "patch_list": [{"patch_file": "dspace-api/src/main/java/org/dspace/app/itemimport/ItemImport.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static String unzip(File zipfile, String destDir) throws IOException {", "Modified_Line": "-        String sourcedir = destinationDir + System.getProperty(\"file.separator\") + zipfile.getName();\n-        String zipDir = destinationDir + System.getProperty(\"file.separator\") + zipfile.getName() + System.getProperty(\"file.separator\");\n        String sourceDirForZip = sourcedir;\n        while (entries.hasMoreElements())\n        {\n            entry = entries.nextElement();\n            if (entry.isDirectory())\n            {\n-                if (!new File(zipDir + entry.getName()).mkdir())\n-                {\n                    log.error(\"Unable to create contents directory: \" + zipDir + entry.getName());\n"}]}]}
{"num": 227, "cve": "CVE-2022-31194", "des": "DSpace open source software is a repository application which provides durable access to digital resources. dspace-jspui is a UI component for DSpace. The JSPUI resumable upload implementations in SubmissionController and FileUploadRequest are vulnerable to multiple path traversal attacks, allowing an attacker to create files/directories anywhere on the server writable by the Tomcat/DSpace user, by modifying some request parameters during submission. This path traversal can only be executed by a user with special privileges (submitter rights). This vulnerability only impacts the JSPUI. Users are advised to upgrade. There are no known workarounds. However, this vulnerability cannot be exploited by an anonymous user or a basic user. The user must first have submitter privileges to at least one Collection and be able to determine how to modify the request parameters to exploit the vulnerability.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/DSpace/DSpace/commits/7569c6374aefeafb996e202cf8d631020eda5f24", "html_url": "https://github.com/DSpace/DSpace/commit/7569c6374aefeafb996e202cf8d631020eda5f24", "filename_list": ["./data/java/java_filter/227_0@DSpace@DSpace@985b60ecb3d759c538cc48b7d09bd6349a275092@dspace-jspui_src_main_java_org_dspace_app_webui_servlet_SubmissionController.java.txt", "./data/java/java_filter/227_1@DSpace@DSpace@985b60ecb3d759c538cc48b7d09bd6349a275092@dspace-jspui_src_main_java_org_dspace_app_webui_util_FileUploadRequest.java.txt"], "patch_list": [{"patch_file": "dspace-jspui/src/main/java/org/dspace/app/webui/servlet/SubmissionController.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected void DoGetResumable(HttpServletRequest request, HttpServletResponse response)", "Modified_Line": "        if (ConfigurationManager.getProperty(\"upload.temp.dir\") != null)\n        {\n-            tempDir = ConfigurationManager.getProperty(\"upload.temp.dir\");\n        }\n        else\n        {\n-            tempDir = System.getProperty(\"java.io.tmpdir\");\n        }\n        String resumableIdentifier = request.getParameter(\"resumableIdentifier\");\n        String resumableChunkNumber = request.getParameter(\"resumableChunkNumber\");\n        long resumableCurrentChunkSize = \n                Long.valueOf(request.getParameter(\"resumableCurrentChunkSize\"));\n-        tempDir = tempDir + File.separator + resumableIdentifier;\n        File fileDir = new File(tempDir);\n        if (!fileDir.exists()) {\n            fileDir.mkdir();\n        }\n        String chunkPath = tempDir + File.separator + \"part\" + resumableChunkNumber;\n        File chunkFile = new File(chunkPath);\n"}]}, {"patch_file": "dspace-jspui/src/main/java/org/dspace/app/webui/util/FileUploadRequest.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public FileUploadRequest(HttpServletRequest req) throws IOException, FileSizeLim", "Modified_Line": "        tempDir = (ConfigurationManager.getProperty(\"upload.temp.dir\") != null)\n            ? ConfigurationManager.getProperty(\"upload.temp.dir\") : System.getProperty(\"java.io.tmpdir\"); \n        long maxSize = ConfigurationManager.getLongProperty(\"upload.max\");\n                    if (parameters.containsKey(\"resumableIdentifier\")) \n                    {\n                        String filename = getFilename(parameters.get(\"resumableFilename\"));\n                        if (!StringUtils.isEmpty(filename)) \n                        {\n                            String chunkDirPath = tempDir + File.separator + parameters.get(\"resumableIdentifier\");\n                            String chunkPath = chunkDirPath + File.separator + \"part\" + parameters.get(\"resumableChunkNumber\");\n                            File fileDir = new File(chunkDirPath);\n                            if(fileDir.exists())\n                            {\n                                item.write(new File(chunkPath));\n                            }\n                    else\n                    {\n                        parameters.put(item.getFieldName(), item.getName());\n                        fileitems.put(item.getFieldName(), item);\n                        filenames.add(item.getName());\n                        String filename = getFilename(item.getName());\n                        if (filename != null && !\"\".equals(filename))\n                        {\n-                            item.write(new File(tempDir + File.separator\n-                                            + filename));\n"}]}]}
{"num": 229, "cve": "CVE-2022-31193", "des": "DSpace open source software is a repository application which provides durable access to digital resources. dspace-jspui is a UI component for DSpace. The JSPUI controlled vocabulary servlet is vulnerable to an open redirect attack, where an attacker can craft a malicious URL that looks like a legitimate DSpace/repository URL. When that URL is clicked by the target, it redirects them to a site of the attacker's choice. This issue has been patched in versions 5.11 and 6.4. Users are advised to upgrade. There are no known workaround for this vulnerability.", "cwe_list": ["CWE-601"], "cwe_name_lst": ["URL Redirection to Untrusted Site ('Open Redirect')"], "url": "https://api.github.com/repos/DSpace/DSpace/commits/5f72424a478f59061dcc516b866dcc687bc3f9de", "html_url": "https://github.com/DSpace/DSpace/commit/5f72424a478f59061dcc516b866dcc687bc3f9de", "filename_list": ["./data/java/java_filter/229_0@DSpace@DSpace@3b0cdee734d0ee3f2c2cbdcc07c1135c1c048be8@dspace-jspui_src_main_java_org_dspace_app_webui_servlet_ControlledVocabularyServlet.java.txt"], "patch_list": [{"patch_file": "dspace-jspui/src/main/java/org/dspace/app/webui/servlet/ControlledVocabularyServlet.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected void doDSGet(Context context, HttpServletRequest request,", "Modified_Line": "        String ID = \"\";\n        String filter = \"\";\n        String callerUrl = request.getParameter(\"callerUrl\");\n"}]}]}
{"num": 231, "cve": "CVE-2022-31192", "des": "DSpace open source software is a repository application which provides durable access to digital resources. dspace-jspui is a UI component for DSpace. The JSPUI \"Request a Copy\" feature does not properly escape values submitted and stored from the \"Request a Copy\" form. This means that item requests could be vulnerable to XSS attacks. This vulnerability only impacts the JSPUI. Users are advised to upgrade. There are no known workarounds for this vulnerability.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/DSpace/DSpace/commits/28eb8158210d41168a62ed5f9e044f754513bc37", "html_url": "https://github.com/DSpace/DSpace/commit/28eb8158210d41168a62ed5f9e044f754513bc37", "filename_list": ["./data/java/java_filter/231_0@DSpace@DSpace@56e76049185bbd87c994128a9d77735ad7af0199@dspace-jspui_src_main_java_org_dspace_app_webui_servlet_RequestItemServlet.java.txt"], "patch_list": [{"patch_file": "dspace-jspui/src/main/java/org/dspace/app/webui/servlet/RequestItemServlet.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private void processForm (Context context,", "Modified_Line": "-        String requesterEmail = request.getParameter(\"email\");\n        if (request.getParameter(\"submit\") != null)\n        {\n-            String reqname = request.getParameter(\"reqname\");\n-            String coment = request.getParameter(\"coment\");\n"}]}]}
{"num": 236, "cve": "CVE-2022-39243", "des": "NuProcess is an external process execution implementation for Java. In all the versions of NuProcess where it forks processes by using the JVM's Java_java_lang_UNIXProcess_forkAndExec method (1.2.0+), attackers can use NUL characters in their strings to perform command line injection. Java's ProcessBuilder isn't vulnerable because of a check in ProcessBuilder.start. NuProcess is missing that check. This vulnerability can only be exploited to inject command line arguments on Linux. Version 2.0.5 contains a patch. As a workaround, users of the library can sanitize command strings to remove NUL characters prior to passing them to NuProcess for execution.", "cwe_list": ["NVD-CWE-Other"], "cwe_name_lst": ["none"], "url": "https://api.github.com/repos/brettwooldridge/NuProcess/commits/29bc09de561bf00ff9bf77123756363a9709f868", "html_url": "https://github.com/brettwooldridge/NuProcess/commit/29bc09de561bf00ff9bf77123756363a9709f868", "filename_list": ["./data/java/java_filter/236_0@brettwooldridge@NuProcess@4953d61e5fbf853583a52471d97e52e1ac33d6cd@src_main_java_com_zaxxer_nuprocess_NuProcessBuilder.java.txt"], "patch_list": [{"patch_file": "src/main/java/com/zaxxer/nuprocess/NuProcessBuilder.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public NuProcess start()", "Modified_Line": "      ensureListener();\n      String[] env = prepareEnvironment();\n      return factory.createProcess(command, env, processListener, cwd);\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public void run()", "Modified_Line": "      ensureListener();\n      String[] env = prepareEnvironment();\n      factory.runProcess(command, env, processListener, cwd);\n"}]}]}
{"num": 237, "cve": "CVE-2022-40955", "des": "In versions of Apache InLong prior to 1.3.0, an attacker with sufficient privileges to specify MySQL JDBC connection URL parameters and to write arbitrary data to the MySQL database, could cause this data to be deserialized by Apache InLong, potentially leading to Remote Code Execution on the Apache InLong server. Users are advised to upgrade to Apache InLong 1.3.0 or newer.", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/apache/inlong/commits/41981d937f49db17ae9ccb71b0021a4dfc33cffd", "html_url": "https://github.com/apache/inlong/commit/41981d937f49db17ae9ccb71b0021a4dfc33cffd", "filename_list": ["./data/java/java_filter/237_0@apache@inlong@cdc91418f29a4f00675c073de49f764af09c2f33@inlong-manager_manager-pojo_src_main_java_org_apache_inlong_manager_pojo_sink_mysql_MySQLSinkDTO.java.txt"], "patch_list": [{"patch_file": "inlong-manager/manager-pojo/src/main/java/org/apache/inlong/manager/pojo/sink/mysql/MySQLSinkDTO.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static MySQLSinkDTO getFromRequest(MySQLSinkRequest request) {", "Modified_Line": "        return MySQLSinkDTO.builder()\n-                .jdbcUrl(request.getJdbcUrl())\n"}]}]}
{"num": 239, "cve": "CVE-2022-38301", "des": "Onedev v7.4.14 contains a path traversal vulnerability which allows attackers to access restricted files and directories via uploading a crafted JAR file into the directory /opt/onedev/lib.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/theonedev/onedev/commits/5b6a19c1f7fe9c271acc4268bcd261a9a1cbb3ea", "html_url": "https://github.com/theonedev/onedev/commit/5b6a19c1f7fe9c271acc4268bcd261a9a1cbb3ea", "filename_list": ["./data/java/java_filter/239_0@theonedev@onedev@6ecf335728b4994a66e1a0274419f074eb762d31@server-core_src_main_java_io_onedev_server_web_page_project_builds_detail_artifacts_ArtifactUploadPanel.java.txt"], "patch_list": [{"patch_file": "server-core/src/main/java/io/onedev/server/web/page/project/builds/detail/artifacts/ArtifactUploadPanel.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void onClick(AjaxRequestTarget target) {", "Modified_Line": "-\t\t\t\tLockUtils.write(getBuild().getArtifactsLockKey(), new Callable<Void>() {\n-\t\t\t\t\t@Override\n-\t\t\t\t\tpublic Void call() throws Exception {\n-\t\t\t\t\t\tFile artifactsDir = getBuild().getArtifactsDir();\n-\t\t\t\t\t\tfor (FileUpload upload: uploads) {\n-\t\t\t\t\t\t\tString filePath = FilenameUtils.sanitizeFilename(upload.getFileName());\n-\t\t\t\t\t\t\tif (directory != null)\n-\t\t\t\t\t\t\t\tfilePath = directory + \"/\" + filePath;\n-\t\t\t\t\t\t\tFile file = new File(artifactsDir, filePath);\n-\t\t\t\t\t\t\tFileUtils.createDir(file.getParentFile());\n-\t\t\t\t\t\t\ttry (\tInputStream is = upload.getInputStream();\n-\t\t\t\t\t\t\t\t\tOutputStream os = new FileOutputStream(file)) {\n-\t\t\t\t\t\t\t\tIOUtils.copy(is, os);\n-\t\t\t\t\t\t\t} finally {\n-\t\t\t\t\t\t\t\tupload.release();\n\t\t\t\t\t\t}\n-\t\t\t\t\t\treturn null;\n-\t\t\t\t\t}\n-\t\t\t\t});\n-\t\t\t\t\n-\t\t\t\tonUploaded(target);\n"}]}]}
{"num": 240, "cve": "CVE-2022-39208", "des": "Onedev is an open source, self-hosted Git Server with CI/CD and Kanban. All files in the /opt/onedev/sites/ directory are exposed and can be read by unauthenticated users. This directory contains all projects, including their bare git repos and build artifacts. This file disclosure vulnerability can be used by unauthenticated attackers to leak all project files of any project. Since project IDs are incremental, an attacker could iterate through them and leak all project data. This issue has been resolved in version 7.3.0 and users are advised to upgrade. There are no known workarounds for this issue.", "cwe_list": ["CWE-552"], "cwe_name_lst": ["Files or Directories Accessible to External Parties"], "url": "https://api.github.com/repos/theonedev/onedev/commits/8aa94e0daf8447cdf76d4f27bfda0a85a7ea5822", "html_url": "https://github.com/theonedev/onedev/commit/8aa94e0daf8447cdf76d4f27bfda0a85a7ea5822", "filename_list": ["./data/java/java_filter/240_0@theonedev@onedev@f1e97688e4e19d6de1dfa1d00e04655209d39f8e@server-core_src_main_java_io_onedev_server_maintenance_Upgrade.java.txt", "./data/java/java_filter/240_1@theonedev@onedev@f1e97688e4e19d6de1dfa1d00e04655209d39f8e@server-core_src_main_java_io_onedev_server_web_component_brandlogo_BrandLogoPanel.java.txt", "./data/java/java_filter/240_2@theonedev@onedev@f1e97688e4e19d6de1dfa1d00e04655209d39f8e@server-core_src_main_java_io_onedev_server_web_page_admin_brandingsetting_BrandingSettingPage.java.txt"], "patch_list": [{"patch_file": "server-core/src/main/java/io/onedev/server/maintenance/Upgrade.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected void updateProgramFiles(File upgradeDir) {", "Modified_Line": "-\t\tfor (File file: new File(Bootstrap.getSiteDir(), \"avatars\").listFiles()) {\r\n\t\t\tif (file.isFile()) {\r\n\t\t\t\ttry {\r\n-\t\t\t\t\tFileUtils.copyFileToDirectory(file, new File(upgradeDir, \"site/avatars\"));\r\n\t\t\t\t} catch (IOException e) {\r\n\t\t\t\t\tthrow new RuntimeException(e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n-\t\tFile uploadedDir = new File(upgradeDir, \"site/avatars/uploaded\");\r\n"}]}, {"patch_file": "server-core/src/main/java/io/onedev/server/web/page/admin/brandingsetting/BrandingSettingPage.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public BrandingSettingPage(PageParameters params) {", "Modified_Line": "-\t\treturn new File(Bootstrap.getSiteDir(), \"logo.png\");\n"}]}]}
{"num": 241, "cve": "CVE-2022-39207", "des": "Onedev is an open source, self-hosted Git Server with CI/CD and Kanban. During CI/CD builds, it is possible to save build artifacts for later retrieval. They can be accessed through OneDev's web UI after the successful run of a build. These artifact files are served by the webserver in the same context as the UI without any further restrictions. This leads to Cross-Site Scripting (XSS) when a user creates a build artifact that contains HTML. When accessing the artifact, the content is rendered by the browser, including any JavaScript that it contains. Since all cookies (except for the rememberMe one) do not set the HttpOnly flag, an attacker could steal the session of a victim and use it to impersonate them. To exploit this issue, attackers need to be able to modify the content of artifacts, which usually means they need to be able to modify a project's build spec. The exploitation requires the victim to click on an attacker's link. It can be used to elevate privileges by targeting admins of a OneDev instance. In the worst case, this can lead to arbitrary code execution on the server, because admins can create Server Shell Executors and use them to run any command on the server. This issue has been patched in version 7.3.0. Users are advised to upgrade. There are no known workarounds for this issue.", "cwe_list": ["CWE-79", "CWE-732"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "Incorrect Permission Assignment for Critical Resource"], "url": "https://api.github.com/repos/theonedev/onedev/commits/adb6e31476621f824fc3227a695232df830d83ab", "html_url": "https://github.com/theonedev/onedev/commit/adb6e31476621f824fc3227a695232df830d83ab", "filename_list": ["./data/java/java_filter/241_0@theonedev@onedev@f2334ba7e41a543d128f6085f34514fd4f122a17@server-core_src_main_java_io_onedev_server_web_resource_ArtifactResource.java.txt"], "patch_list": [{"patch_file": "server-core/src/main/java/io/onedev/server/web/resource/ArtifactResource.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected ResourceResponse newResourceResponse(Attributes attributes) {", "Modified_Line": "-\t\ttry (InputStream is = new BufferedInputStream(new FileInputStream(artifactFile))) {\n-\t\t\tresponse.setContentType(ContentDetector.detectMediaType(is, artifactPath).toString());\n-\t\t} catch (Exception e) {\n-\t\t\tthrow new RuntimeException(e);\n-\t\t}\n"}]}]}
{"num": 242, "cve": "CVE-2022-39206", "des": "Onedev is an open source, self-hosted Git Server with CI/CD and Kanban. When using Docker-based job executors, the Docker socket (e.g. /var/run/docker.sock on Linux) is mounted into each Docker step. Users that can define and trigger CI/CD jobs on a project could use this to control the Docker daemon on the host machine. This is a known dangerous pattern, as it can be used to break out of Docker containers and, in most cases, gain root privileges on the host system. This issue allows regular (non-admin) users to potentially take over the build infrastructure of a OneDev instance. Attackers need to have an account (or be able to register one) and need permission to create a project. Since code.onedev.io has the right preconditions for this to be exploited by remote attackers, it could have been used to hijack builds of OneDev itself, e.g. by injecting malware into the docker images that are built and pushed to Docker Hub. The impact is increased by this as described before. Users are advised to upgrade to 7.3.0 or higher. There are no known workarounds for this issue.", "cwe_list": ["CWE-610"], "cwe_name_lst": ["Externally Controlled Reference to a Resource in Another Sphere"], "url": "https://api.github.com/repos/theonedev/onedev/commits/0052047a5b5095ac6a6b4a73a522d0272fec3a22", "html_url": "https://github.com/theonedev/onedev/commit/0052047a5b5095ac6a6b4a73a522d0272fec3a22", "filename_list": ["./data/java/java_filter/242_2@theonedev@onedev@8aa94e0daf8447cdf76d4f27bfda0a85a7ea5822@server-plugin_server-plugin-executor-remotedocker_src_main_java_io_onedev_server_plugin_executor_remotedocker_RemoteDockerExecutor.java.txt", "./data/java/java_filter/242_3@theonedev@onedev@8aa94e0daf8447cdf76d4f27bfda0a85a7ea5822@server-plugin_server-plugin-executor-serverdocker_src_main_java_io_onedev_server_plugin_executor_serverdocker_ServerDockerExecutor.java.txt"], "patch_list": [{"patch_file": "server-plugin/server-plugin-executor-remotedocker/src/main/java/io/onedev/server/plugin/executor/remotedocker/RemoteDockerExecutor.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void runOn(Long agentId, Session agentSession, AgentData agentData) {", "Modified_Line": "\t\t\t\t\tDockerJobData jobData = new DockerJobData(jobToken, getName(), jobContext.getProjectPath(), \n\t\t\t\t\t\tjobContext.getProjectId(), jobContext.getCommitId().name(), jobContext.getBuildNumber(), \n-\t\t\t\t\t\tjobContext.getActions(), jobContext.getRetried(), services, registryLogins, \n-\t\t\t\t\t\ttrustCertContent, getRunOptions());\n"}]}, {"patch_file": "server-plugin/server-plugin-executor-serverdocker/src/main/java/io/onedev/server/plugin/executor/serverdocker/ServerDockerExecutor.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private int runStepContainer(String image, @Nullable String entrypoint, ", "Modified_Line": "-\t\t\t\t\t\t\t\t\t\tif (SystemUtils.IS_OS_WINDOWS) \n-\t\t\t\t\t\t\t\t\t\t\tdocker.addArgs(\"-v\", \"//./pipe/docker_engine://./pipe/docker_engine\");\n-\t\t\t\t\t\t\t\t\t\telse\n-\t\t\t\t\t\t\t\t\t\t\tdocker.addArgs(\"-v\", \"/var/run/docker.sock:/var/run/docker.sock\");\n"}]}]}
{"num": 243, "cve": "CVE-2022-26049", "des": "This affects the package com.diffplug.gradle:goomph before 3.37.2. It allows a malicious zip file to potentially break out of the expected destination directory, writing contents into arbitrary locations on the file system. Overwriting certain files/directories could allow an attacker to achieve remote code execution on a target system by exploiting this vulnerability. **Note:** This could have allowed a malicious zip file to extract itself into an arbitrary directory. The only file that Goomph extracts is the p2 bootstrapper and eclipse metadata files hosted at eclipse.org, which are not malicious, so the only way this vulnerability could have affected you is if you had set a custom bootstrap zip, and that zip was malicious.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/diffplug/goomph/commits/25f04f67ba62d9a14104bee13a0a0f2517afb8c8", "html_url": "https://github.com/diffplug/goomph/commit/25f04f67ba62d9a14104bee13a0a0f2517afb8c8", "filename_list": ["./data/java/java_filter/243_0@diffplug@goomph@fe2083196f0d0a75885aea402baaa972254173d5@src_main_java_com_diffplug_gradle_ZipMisc.java.txt"], "patch_list": [{"patch_file": "src/main/java/com/diffplug/gradle/ZipMisc.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static void unzip(File input, File destinationDir) throws IOException {", "Modified_Line": "\t\t\tZipEntry entry;\n\t\t\twhile ((entry = zipInput.getNextEntry()) != null) {\n\t\t\t\tFile dest = new File(destinationDir, entry.getName());\n\t\t\t\tif (entry.isDirectory()) {\n\t\t\t\t\tFileMisc.mkdirs(dest);\n\t\t\t\t} else {\n\t\t\t\t\tFileMisc.mkdirs(dest.getParentFile());\n\t\t\t\t\ttry (OutputStream output = new BufferedOutputStream(new FileOutputStream(dest))) {\n\t\t\t\t\t\tcopy(zipInput, output);\n"}]}]}
{"num": 252, "cve": "CVE-2022-36092", "des": "XWiki Platform Old Core is a core package for XWiki Platform, a generic wiki platform. Prior to versions 14.2 and 13.10.4, all rights checks that would normally prevent a user from viewing a document on a wiki can be bypassed using the login action and directly specified templates. This exposes title, content and comments of any document and properties of objects, though class and property name must be known. This is also exploitable on private wikis. This has been patched in versions 14.2 and 13.10.4 by properly checking view rights before loading documents and disallowing non-default templates in the login, registration and skin action. As a workaround, it would be possible to protect all templates individually by adding code to check access rights first.", "cwe_list": ["CWE-287"], "cwe_name_lst": ["Improper Authentication"], "url": "https://api.github.com/repos/xwiki/xwiki-platform/commits/9b7057d57a941592d763992d4299456300918208", "html_url": "https://github.com/xwiki/xwiki-platform/commit/9b7057d57a941592d763992d4299456300918208", "filename_list": ["./data/java/java_filter/252_0@xwiki@xwiki-platform@71a6d0bb6f8ab718fcfaae0e9b8c16c2d69cd4bb@xwiki-platform-core_xwiki-platform-oldcore_src_main_java_com_xpn_xwiki_web_RegisterAction.java.txt"], "patch_list": [{"patch_file": "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/RegisterAction.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public boolean action(XWikiContext context) throws XWikiException", "Modified_Line": "-        if (!REGISTER.equals(Utils.getPage(context.getRequest(), REGISTER))) {\n            throw new XWikiException(XWikiException.MODULE_XWIKI, XWikiException.ERROR_XWIKI_ACCESS_DENIED,\n-                String.format(\"Template may not be overriden with 'xpage' in [%s] action.\", REGISTER));\n"}]}]}
{"num": 254, "cve": "CVE-2022-25914", "des": "The package com.google.cloud.tools:jib-core before 0.22.0 are vulnerable to Remote Code Execution (RCE) via the isDockerInstalled function, due to attempting to execute input.", "cwe_list": ["NVD-CWE-noinfo"], "cwe_name_lst": ["none"], "url": "https://api.github.com/repos/GoogleContainerTools/jib/commits/67fa40bc2c484da0546333914ea07a89fe44eaaf", "html_url": "https://github.com/GoogleContainerTools/jib/commit/67fa40bc2c484da0546333914ea07a89fe44eaaf", "filename_list": ["./data/java/java_filter/254_0@GoogleContainerTools@jib@df6c248682228f8179d4cb5d50362f8f1d2550eb@jib-core_src_main_java_com_google_cloud_tools_jib_docker_CliDockerClient.java.txt"], "patch_list": [{"patch_file": "jib-core/src/main/java/com/google/cloud/tools/jib/docker/CliDockerClient.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static boolean isDockerInstalled(Path dockerExecutable) {", "Modified_Line": "-    try {\n-      new ProcessBuilder(dockerExecutable.toString()).start();\n-      return true;\n-\n-    } catch (IOException ex) {\n-      return false;\n-    }\n"}]}]}
{"num": 259, "cve": "CVE-2021-27693", "des": "Server-side Request Forgery (SSRF) vulnerability in PublicCMS before 4.0.202011.b via /publiccms/admin/ueditor when the action is catchimage.", "cwe_list": ["CWE-918"], "cwe_name_lst": ["Server-Side Request Forgery (SSRF)"], "url": "https://api.github.com/repos/sanluan/PublicCMS/commits/0f4c4872914b6a71305e121a7d9a19c07cde0338", "html_url": "https://github.com/sanluan/PublicCMS/commit/0f4c4872914b6a71305e121a7d9a19c07cde0338", "filename_list": ["./data/java/java_filter/259_0@sanluan@PublicCMS@276f2fb6f8a703265ca2b9de18174b6a09ead38a@publiccms-parent_publiccms-core_src_main_java_com_publiccms_controller_admin_sys_UeditorAdminController.java.txt"], "patch_list": [{"patch_file": "publiccms-parent/publiccms-core/src/main/java/com/publiccms/controller/admin/sys/UeditorAdminController.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public Map<String, Object> catchimage(@RequestAttribute SysSite site, @SessionAt", "Modified_Line": "                        BufferedInputStream inputStream = new BufferedInputStream(entity.getContent());\r\n                        FileType fileType = FileTypeDetector.detectFileType(inputStream);\r\n                        String suffix = fileType.getCommonExtension();\r\n-                        if (CommonUtils.notEmpty(suffix)) {\r\n                            String fileName = CmsFileUtils.getUploadFileName(suffix);\r\n                             String filePath = siteComponent.getWebFilePath(site, fileName);\r\n                             CmsFileUtils.copyInputStreamToFile(inputStream, filePath);\r\n                             FileSize fileSize = CmsFileUtils.getFileSize(filePath, suffix);\r\n "}]}]}
{"num": 260, "cve": "CVE-2022-39367", "des": "QTIWorks is a software suite for standards-based assessment delivery. Prior to version 1.0-beta15, the QTIWorks Engine allows users to upload QTI content packages as ZIP files. The ZIP handling code does not sufficiently check the paths of files contained within ZIP files, so can insert files into other locations in the filesystem if they are writable by the process running the QTIWorks Engine. In extreme cases, this could allow anonymous users to change files in arbitrary locations in the filesystem. In normal QTIWorks Engine deployments, the impact is somewhat reduced because the default QTIWorks configuration does not enable the public demo functionality, so ZIP files can only be uploaded by users with \"instructor\" privileges. This vulnerability is fixed in version 1.0-beta15. There are no database configuration changes required when upgrading to this version. No known workarounds for this issue exist.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/davemckain/qtiworks/commits/1a46d6d842877ba2b824d5c269845827e2e0ccac", "html_url": "https://github.com/davemckain/qtiworks/commit/1a46d6d842877ba2b824d5c269845827e2e0ccac", "filename_list": ["./data/java/java_filter/260_0@davemckain@qtiworks@43e10fbb8c257b3f5b9c1cce6084a67b8e3761a5@qtiworks-engine_src_main_java_uk_ac_ed_ph_qtiworks_services_AssessmentPackageFileImporter.java.txt"], "patch_list": [{"patch_file": "qtiworks-engine/src/main/java/uk/ac/ed/ph/qtiworks/services/AssessmentPackageFileImporter.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private boolean tryUnpackZipFile(final File importSandboxDirectory, final Multip", "Modified_Line": "\t\ttry (ZipInputStream zipInput = new ZipInputStream(new BufferedInputStream(new FileInputStream(input)))) {\n\t\t\tZipEntry entry;\n\t\t\twhile ((entry = zipInput.getNextEntry()) != null) {\n\t\t\t\tFile dest = new File(destinationDir, entry.getName());\n\t\t\t\tif (entry.isDirectory()) {\n\t\t\t\t\tFileMisc.mkdirs(dest);\n\t\t\t\t} else {\n\t\t\t\t\tFileMisc.mkdirs(dest.getParentFile());\n\t\t\t\t\ttry (OutputStream output = new BufferedOutputStream(new FileOutputStream(dest))) {\n\t\t\t\t\t\tcopy(zipInput, output);\n"}]}]}
{"num": 261, "cve": "CVE-2022-39312", "des": "Dataease is an open source data visualization analysis tool. Dataease prior to 1.15.2 has a deserialization vulnerability. In Dataease, the Mysql data source in the data source function can customize the JDBC connection parameters and the Mysql server target to be connected. In `backend/src/main/java/io/dataease/provider/datasource/JdbcProvider.java`, the `MysqlConfiguration` class does not filter any parameters. If an attacker adds some parameters to a JDBC url and connects to a malicious mysql server, the attacker can trigger the mysql jdbc deserialization vulnerability. Through the deserialization vulnerability, the attacker can execute system commands and obtain server privileges. Version 1.15.2 contains a patch for this issue.", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/dataease/dataease/commits/956ee2d6c9e81349a60aef435efc046888e10a6d", "html_url": "https://github.com/dataease/dataease/commit/956ee2d6c9e81349a60aef435efc046888e10a6d", "filename_list": ["./data/java/java_filter/261_0@dataease@dataease@176f854bbe188ab55fd270c465e4c893c786a777@backend_src_main_java_io_dataease_dto_datasource_MysqlConfiguration.java.txt"], "patch_list": [{"patch_file": "backend/src/main/java/io/dataease/dto/datasource/MysqlConfiguration.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public String getJdbc() {", "Modified_Line": "        if(StringUtils.isEmpty(extraParams.trim())){\n            return \"jdbc:mysql://HOSTNAME:PORT/DATABASE\"\n                    .replace(\"HOSTNAME\", getHost().trim())\n                    .replace(\"PORT\", getPort().toString().trim())\n                    .replace(\"DATABASE\", getDataBase().trim());\n        }else {\n            return \"jdbc:mysql://HOSTNAME:PORT/DATABASE?EXTRA_PARAMS\"\n                    .replace(\"HOSTNAME\", getHost().trim())\n                    .replace(\"PORT\", getPort().toString().trim())\n                    .replace(\"DATABASE\", getDataBase().trim())\n                    .replace(\"EXTRA_PARAMS\", getExtraParams().trim());\n"}]}]}
{"num": 263, "cve": "CVE-2022-39309", "des": "GoCD is a continuous delivery server. GoCD helps you automate and streamline the build-test-release cycle for continuous delivery of your product. GoCD versions prior to 21.1.0 leak the symmetric key used to encrypt/decrypt any secure variables/secrets in GoCD configuration to authenticated agents. A malicious/compromised agent may then expose that key from memory, and potentially allow an attacker the ability to decrypt secrets intended for other agents/environments if they also are able to obtain access to encrypted configuration values from the GoCD server. This issue is fixed in GoCD version 21.1.0. There are currently no known workarounds.", "cwe_list": ["CWE-668"], "cwe_name_lst": ["Exposure of Resource to Wrong Sphere"], "url": "https://api.github.com/repos/gocd/gocd/commits/691b479f1310034992da141760e9c5d1f5b60e8a", "html_url": "https://github.com/gocd/gocd/commit/691b479f1310034992da141760e9c5d1f5b60e8a", "filename_list": ["./data/java/java_filter/263_1@gocd@gocd@830f2f64dab5e2c83c974ec5ab4703ad7f11a996@domain_src_main_java_com_thoughtworks_go_config_materials_ScmMaterial.java.txt"], "patch_list": [{"patch_file": "domain/src/main/java/com/thoughtworks/go/config/materials/ScmMaterial.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public ScmMaterial(String typeName, GoCipher goCipher) {", "Modified_Line": "        super(typeName);\n-        this.goCipher = goCipher;\n"}, {"Modified_Block_Num": "2", "Modified_Function": " private void setPasswordIfNotBlank(String password) {", "Modified_Line": "        this.password = StringUtils.stripToNull(password);\n        this.secretParamsForPassword = SecretParams.parse(password);}\n-        this.encryptedPassword = StringUtils.stripToNull(encryptedPassword);\n-        if (this.password == null) {\n-            return;\n-        }\n-        try {\n-            this.encryptedPassword = this.goCipher.encrypt(password);\n-        } catch (Exception e) {\n-            bomb(\"Password encryption failed. Please verify your cipher key.\", e);\n-        }\n-        this.password = null;\n"}]}]}
{"num": 264, "cve": "CVE-2022-39302", "des": "Ree6 is a moderation bot. This vulnerability would allow other server owners to create configurations such as \"Better-Audit-Logging\" which contain a channel from another server as a target. This would mean you could send log messages to another Guild channel and bypass raid and webhook protections. A specifically crafted log message could allow spamming and mass advertisements. This issue has been patched in version 1.9.9. There are currently no known workarounds.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/Ree6-Applications/Ree6/commits/459b5bc24f0ea27e50031f563373926e94b9aa0a", "html_url": "https://github.com/Ree6-Applications/Ree6/commit/459b5bc24f0ea27e50031f563373926e94b9aa0a", "filename_list": ["./data/java/java_filter/264_0@Ree6-Applications@Ree6@0f75bac524f3879199468a2574f687538d363a15@src_main_java_de_presti_ree6_commands_impl_community_InstagramNotifier.java.txt", "./data/java/java_filter/264_10@Ree6-Applications@Ree6@0f75bac524f3879199468a2574f687538d363a15@src_main_java_de_presti_ree6_sql_entities_webhook_WebhookNews.java.txt", "./data/java/java_filter/264_1@Ree6-Applications@Ree6@0f75bac524f3879199468a2574f687538d363a15@src_main_java_de_presti_ree6_commands_impl_community_RedditNotifier.java.txt", "./data/java/java_filter/264_2@Ree6-Applications@Ree6@0f75bac524f3879199468a2574f687538d363a15@src_main_java_de_presti_ree6_commands_impl_community_TwitchNotifier.java.txt", "./data/java/java_filter/264_3@Ree6-Applications@Ree6@0f75bac524f3879199468a2574f687538d363a15@src_main_java_de_presti_ree6_commands_impl_community_TwitterNotifier.java.txt", "./data/java/java_filter/264_4@Ree6-Applications@Ree6@0f75bac524f3879199468a2574f687538d363a15@src_main_java_de_presti_ree6_commands_impl_community_YouTubeNotifier.java.txt"], "patch_list": [{"patch_file": "src/main/java/de/presti/ree6/commands/impl/community/InstagramNotifier.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void onPerform(CommandEvent commandEvent) {", "Modified_Line": "-            if (commandEvent.getMessage().getMentions().getChannels(TextChannel.class).isEmpty()) {\n"}]}, {"patch_file": "src/main/java/de/presti/ree6/commands/impl/community/RedditNotifier.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void onPerform(CommandEvent commandEvent) {", "Modified_Line": "-            if (commandEvent.getMessage().getMentions().getChannels(TextChannel.class).isEmpty()) {\n"}]}, {"patch_file": "src/main/java/de/presti/ree6/commands/impl/community/TwitchNotifier.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void onPerform(CommandEvent commandEvent) {", "Modified_Line": "-            if (commandEvent.getMessage().getMentions().getChannels(TextChannel.class).isEmpty()) {\n"}]}, {"patch_file": "src/main/java/de/presti/ree6/commands/impl/community/TwitterNotifier.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void onPerform(CommandEvent commandEvent) {", "Modified_Line": "-            if (commandEvent.getMessage().getMentions().getChannels(TextChannel.class).isEmpty()) {\n"}]}, {"patch_file": "src/main/java/de/presti/ree6/commands/impl/community/YouTubeNotifier.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void onPerform(CommandEvent commandEvent) {", "Modified_Line": "-            if (commandEvent.getMessage().getMentions().getChannels(TextChannel.class).isEmpty()) {\n"}]}]}
{"num": 276, "cve": "CVE-2022-21126", "des": "The package com.github.samtools:htsjdk before 3.0.1 are vulnerable to Creation of Temporary File in Directory with Insecure Permissions due to the createTempDir() function in util/IOUtil.java not checking for the existence of the temporary directory before attempting to create it.", "cwe_list": ["CWE-668"], "cwe_name_lst": ["Exposure of Resource to Wrong Sphere"], "url": "https://api.github.com/repos/samtools/htsjdk/commits/4a4024a97ee3e87096df6ad9b22c8260bd527772", "html_url": "https://github.com/samtools/htsjdk/commit/4a4024a97ee3e87096df6ad9b22c8260bd527772", "filename_list": ["./data/java/java_filter/276_1@samtools@htsjdk@9fd0ecf212219d252ab273db0f7b845a59073d64@src_main_java_htsjdk_samtools_util_IOUtil.java.txt"], "patch_list": [{"patch_file": "src/main/java/htsjdk/samtools/util/IOUtil.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static File createTempDir(final String prefix, final String suffix) {", "Modified_Line": "-            final File tmp = File.createTempFile(prefix, suffix);\n-            if (!tmp.delete()) {\n-                throw new SAMException(\"Could not delete temporary file \" + tmp);\n-            }\n-            if (!tmp.mkdir()) {\n-                throw new SAMException(\"Could not create temporary directory \" + tmp);\n-            }\n-            return tmp;\n-        } catch (IOException e) {\n"}]}]}
{"num": 279, "cve": "CVE-2022-41946", "des": "pgjdbc is an open source postgresql JDBC Driver. In affected versions a prepared statement using either `PreparedStatement.setText(int, InputStream)` or `PreparedStatemet.setBytea(int, InputStream)` will create a temporary file if the InputStream is larger than 2k. This will create a temporary file which is readable by other users on Unix like systems, but not MacOS. On Unix like systems, the system's temporary directory is shared between all users on that system. Because of this, when files and directories are written into this directory they are, by default, readable by other users on that same system. This vulnerability does not allow other users to overwrite the contents of these directories or files. This is purely an information disclosure vulnerability. Because certain JDK file system APIs were only added in JDK 1.7, this this fix is dependent upon the version of the JDK you are using. Java 1.7 and higher users: this vulnerability is fixed in 4.5.0. Java 1.6 and lower users: no patch is available. If you are unable to patch, or are stuck running on Java 1.6, specifying the java.io.tmpdir system environment variable to a directory that is exclusively owned by the executing user will mitigate this vulnerability.", "cwe_list": ["CWE-668"], "cwe_name_lst": ["Exposure of Resource to Wrong Sphere"], "url": "https://api.github.com/repos/pgjdbc/pgjdbc/commits/9008dc9aade6dbfe4efafcd6872ebc55f4699cf5", "html_url": "https://github.com/pgjdbc/pgjdbc/commit/9008dc9aade6dbfe4efafcd6872ebc55f4699cf5", "filename_list": ["./data/java/java_filter/279_0@pgjdbc@pgjdbc@135be5a4395033a4ba23a1dd70ad76e0bd443a8d@pgjdbc_src_main_java_org_postgresql_util_StreamWrapper.java.txt"], "patch_list": [{"patch_file": "pgjdbc/src/main/java/org/postgresql/util/StreamWrapper.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public StreamWrapper(InputStream stream) throws PSQLException {", "Modified_Line": "-        final File tempFile = File.createTempFile(TEMP_FILE_PREFIX, null);\n"}]}]}
{"num": 284, "cve": "CVE-2022-41929", "des": "org.xwiki.platform:xwiki-platform-oldcore is missing authorization in User#setDisabledStatus, which may allow an incorrectly authorized user with only Script rights to enable or disable a user. This operation is meant to only be available for users with admin rights. This problem has been patched in XWiki 13.10.7, 14.4.2 and 14.5RC1.", "cwe_list": ["CWE-862"], "cwe_name_lst": ["Missing Authorization"], "url": "https://api.github.com/repos/xwiki/xwiki-platform/commits/0b732f2ef0224e2aaf10e2e1ef48dbd3fb6e10cd", "html_url": "https://github.com/xwiki/xwiki-platform/commit/0b732f2ef0224e2aaf10e2e1ef48dbd3fb6e10cd", "filename_list": ["./data/java/java_filter/284_0@xwiki@xwiki-platform@5be1cc0adf917bf10899c47723fa451e950271fa@xwiki-platform-core_xwiki-platform-oldcore_src_main_java_com_xpn_xwiki_api_User.java.txt"], "patch_list": [{"patch_file": "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/api/User.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public XWikiUser getUser()", "Modified_Line": "-        this.user.setDisabled(disabledStatus, getXWikiContext());\n"}]}]}
{"num": 287, "cve": "CVE-2022-41936", "des": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. The `modifications` rest endpoint does not filter out entries according to the user's rights. Therefore, information hidden from unauthorized users are exposed though the `modifications` rest endpoint (comments and page names etc). Users should upgrade to XWiki 14.6+, 14.4.3+, or 13.10.8+. Older versions have not been patched. There are no known workarounds.", "cwe_list": ["CWE-359"], "cwe_name_lst": ["Exposure of Private Personal Information to an Unauthorized Actor"], "url": "https://api.github.com/repos/xwiki/xwiki-platform/commits/38dc1aa1a4435f24d58f5b8e4566cbcb0971f8ff", "html_url": "https://github.com/xwiki/xwiki-platform/commit/38dc1aa1a4435f24d58f5b8e4566cbcb0971f8ff", "filename_list": ["./data/java/java_filter/287_0@xwiki@xwiki-platform@ba27f91dac80069a1a2e2e29e0f5f9ad68189310@xwiki-platform-core_xwiki-platform-rest_xwiki-platform-rest-server_src_main_java_org_xwiki_rest_internal_resources_ModificationsResourceImpl.java.txt"], "patch_list": [{"patch_file": "xwiki-platform-core/xwiki-platform-rest/xwiki-platform-rest-server/src/main/java/org/xwiki/rest/internal/resources/ModificationsResourceImpl.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public History getModifications(String wikiName, Integer start, Integer number,", "Modified_Line": "-                String language = (String) fields[2];\n-                if (language.equals(\"\")) {\n-                    language = null;\n-                }\n-                XWikiRCSNodeId nodeId = (XWikiRCSNodeId) fields[3];\n-                Timestamp timestamp = (Timestamp) fields[4];\n-                Date modified = new Date(timestamp.getTime());\n-                String modifier = (String) fields[5];\n-                String comment = (String) fields[6];\n-                HistorySummary historySummary = DomainObjectFactory.createHistorySummary(objectFactory,\n-                        uriInfo.getBaseUri(), wikiName, spaces, pageName, language, nodeId.getVersion(), modifier,\n-                        modified, comment, Utils.getXWikiApi(componentManager), withPrettyNames);\n-                history.getHistorySummaries().add(historySummary);\n"}]}]}
{"num": 288, "cve": "CVE-2022-4096", "des": "Server-Side Request Forgery (SSRF) in GitHub repository appsmithorg/appsmith prior to 1.8.2.", "cwe_list": ["CWE-918"], "cwe_name_lst": ["Server-Side Request Forgery (SSRF)"], "url": "https://api.github.com/repos/appsmithorg/appsmith/commits/769719ccfe667f059fe0b107a19ec9feb90f2e40", "html_url": "https://github.com/appsmithorg/appsmith/commit/769719ccfe667f059fe0b107a19ec9feb90f2e40", "filename_list": ["./data/java/java_filter/288_0@appsmithorg@appsmith@e3f90db3416303dea9dcbdc26c77339f2e359b30@app_server_appsmith-interfaces_src_main_java_com_appsmith_external_helpers_restApiUtils_helpers_TriggerUtils.java.txt", "./data/java/java_filter/288_1@appsmithorg@appsmith@e3f90db3416303dea9dcbdc26c77339f2e359b30@app_server_appsmith-interfaces_src_main_java_com_appsmith_external_helpers_restApiUtils_helpers_URIUtils.java.txt"], "patch_list": [{"patch_file": "app/server/appsmith-interfaces/src/main/java/com/appsmith/external/helpers/restApiUtils/helpers/TriggerUtils.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public boolean isHostDisallowed(URI uri) throws UnknownHostException {", "Modified_Line": "-        String host = uri.getHost();\n-        return StringUtils.isEmpty(host) || DISALLOWED_HOSTS.contains(host)\n-                || DISALLOWED_HOSTS.contains(InetAddress.getByName(host).getHostAddress());\n-    }\n"}]}]}
{"num": 290, "cve": "CVE-2022-3969", "des": "A vulnerability was found in OpenKM up to 6.3.11 and classified as problematic. Affected by this issue is the function getFileExtension of the file src/main/java/com/openkm/util/FileUtils.java. The manipulation leads to insecure temporary file. Upgrading to version 6.3.12 is able to address this issue. The name of the patch is c069e4d73ab8864345c25119d8459495f45453e1. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-213548.", "cwe_list": ["CWE-377"], "cwe_name_lst": ["Insecure Temporary File"], "url": "https://api.github.com/repos/openkm/document-management-system/commits/c069e4d73ab8864345c25119d8459495f45453e1", "html_url": "https://github.com/openkm/document-management-system/commit/c069e4d73ab8864345c25119d8459495f45453e1", "filename_list": ["./data/java/java_filter/290_0@openkm@document-management-system@e1ee4c0bececcb92ae23525d24de8d186f287cfd@src_main_java_com_openkm_util_FileUtils.java.txt"], "patch_list": [{"patch_file": "src/main/java/com/openkm/util/FileUtils.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static File createTempDir() throws IOException {", "Modified_Line": "-\t\tFile tmpFile = File.createTempFile(\"okm\", null);\n-\n-\t\tif (!tmpFile.delete())\n-\t\t\tthrow new IOException();\n-\t\tif (!tmpFile.mkdir())\n-\t\t\tthrow new IOException();\n-\t\treturn tmpFile;\n"}]}]}
{"num": 292, "cve": "CVE-2022-39368", "des": "Eclipse Californium is a Java implementation of RFC7252 - Constrained Application Protocol for IoT Cloud services. In versions prior to 3.7.0, and 2.7.4, Californium is vulnerable to a Denial of Service. Failing handshakes don't cleanup counters for throttling, causing the threshold to be reached without being released again. This results in permanently dropping records. The issue was reported for certificate based handshakes, but may also affect PSK based handshakes. It generally affects client and server as well. This issue is patched in version 3.7.0 and 2.7.4. There are no known workarounds. main: commit 726bac57659410da463dcf404b3e79a7312ac0b9 2.7.x: commit 5648a0c27c2c2667c98419254557a14bac2b1f3f", "cwe_list": ["CWE-404", "CWE-459"], "cwe_name_lst": ["Improper Resource Shutdown or Release", "Incomplete Cleanup"], "url": "https://api.github.com/repos/eclipse-californium/californium/commits/5648a0c27c2c2667c98419254557a14bac2b1f3f", "html_url": "https://github.com/eclipse-californium/californium/commit/5648a0c27c2c2667c98419254557a14bac2b1f3f", "filename_list": ["./data/java/java_filter/292_1@eclipse-californium@californium@9112803a20152d1386415a4418e639919f8ac12b@scandium-core_src_main_java_org_eclipse_californium_scandium_dtls_InMemoryConnectionStore.java.txt"], "patch_list": [{"patch_file": "scandium-core/src/main/java/org/eclipse/californium/scandium/dtls/InMemoryConnectionStore.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public boolean remove(final Connection connection) {", "Modified_Line": "\t\tboolean removed = connections.remove(connection.getConnectionId(), connection) == connection;\t\tif (removed) {-\t\t\tList<Runnable> pendings = connection.getExecutor().shutdownNow();\n\t\t\tif (LOG.isTraceEnabled()) {\n\t\t\t\tLOG.trace(\"{}connection: remove {} (size {}, left jobs: {})\", tag, connection, connections.size(),\n-\t\t\t\t\t\tpendings.size(), new Throwable(\"connection removed!\"));\n-\t\t\t} else if (pendings.isEmpty()) {\n\t\t\t\tLOG.debug(\"{}connection: remove {} (size {})\", tag, connection, connections.size());\n\t\t\t} else {\n\t\t\t\tLOG.debug(\"{}connection: remove {} (size {}, left jobs: {})\", tag, connection, connections.size(),\n-\t\t\t\t\t\tpendings.size());\n"}]}]}
{"num": 293, "cve": "CVE-2022-39387", "des": "XWiki OIDC has various tools to manipulate OpenID Connect protocol in XWiki. Prior to version 1.29.1, even if a wiki has an OpenID provider configured through its xwiki.properties, it is possible to provide a third party provider its details through request parameters. One can then bypass the XWiki authentication altogether by specifying its own provider through the oidc.endpoint.* request parameters (or by using an XWiki-based OpenID provider with oidc.xwikiprovider. With the same approach, one could also provide a specific group mapping through oidc.groups.mapping that would make his user automatically part of the XWikiAdminGroup. This issue has been patched, please upgrade to 1.29.1. There is no workaround, an upgrade of the authenticator is required.", "cwe_list": ["CWE-287"], "cwe_name_lst": ["Improper Authentication"], "url": "https://api.github.com/repos/xwiki-contrib/oidc/commits/0247af1417925b9734ab106ad7cd934ee870ac89", "html_url": "https://github.com/xwiki-contrib/oidc/commit/0247af1417925b9734ab106ad7cd934ee870ac89", "filename_list": ["./data/java/java_filter/293_0@xwiki-contrib@oidc@7d7cca1d5b30544e7f46cdcb6b2a17b6e01d9b34@oidc-authenticator_src_main_java_org_xwiki_contrib_oidc_auth_internal_OIDCClientConfiguration.java.txt"], "patch_list": [{"patch_file": "oidc-authenticator/src/main/java/org/xwiki/contrib/oidc/auth/internal/OIDCClientConfiguration.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected <T> T getProperty(String key, Class<T> valueClass)", "Modified_Line": "-        String requestValue = getRequestParameter(key);\n-        if (requestValue != null) {\n-            return this.converter.convert(valueClass, requestValue);\n"}, {"Modified_Block_Num": "2", "Modified_Function": "protected <T> T getProperty(String key, T def)", "Modified_Line": "-        String requestValue = getRequestParameter(key);\n-        if (requestValue != null) {\n-            return this.converter.convert(def.getClass(), requestValue);\n"}]}]}
{"num": 294, "cve": "CVE-2022-4859", "des": "A vulnerability, which was classified as problematic, has been found in Joget up to 7.0.33. This issue affects the function submitForm of the file wflow-core/src/main/java/org/joget/plugin/enterprise/UserProfileMenu.java of the component User Profile Menu. The manipulation of the argument firstName/lastName leads to cross site scripting. The attack may be initiated remotely. Upgrading to version 7.0.34 is able to address this issue. The patch is named 9a77f508a2bf8cf661d588f37a4cc29ecaea4fc8. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-217055.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/jogetworkflow/jw-community/commits/9a77f508a2bf8cf661d588f37a4cc29ecaea4fc8", "html_url": "https://github.com/jogetworkflow/jw-community/commit/9a77f508a2bf8cf661d588f37a4cc29ecaea4fc8", "filename_list": ["./data/java/java_filter/294_0@jogetworkflow@jw-community@2e33ea3bcaf33fd554a2cb5323b7ecf58975236a@wflow-core_src_main_java_org_joget_plugin_enterprise_UserProfileMenu.java.txt"], "patch_list": [{"patch_file": "wflow-core/src/main/java/org/joget/plugin/enterprise/UserProfileMenu.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private void submitForm() {", "Modified_Line": "-        if (\"\".equals(getPropertyString(\"f_firstName\"))) {\n-            currentUser.setFirstName(getRequestParameterString(\"firstName\"));\n        }\n        if (\"\".equals(getPropertyString(\"f_lastName\"))) {\n-            currentUser.setLastName(getRequestParameterString(\"lastName\"));\n"}]}]}
{"num": 296, "cve": "CVE-2021-4296", "des": "A vulnerability, which was classified as problematic, has been found in w3c Unicorn. This issue affects the function ValidatorNuMessage of the file src/org/w3c/unicorn/response/impl/ValidatorNuMessage.java. The manipulation of the argument message leads to cross site scripting. The attack may be initiated remotely. The name of the patch is 51f75c31f7fc33859a9a571311c67ae4e95d9c68. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-217019.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/w3c/Unicorn/commits/51f75c31f7fc33859a9a571311c67ae4e95d9c68", "html_url": "https://github.com/w3c/Unicorn/commit/51f75c31f7fc33859a9a571311c67ae4e95d9c68", "filename_list": ["./data/java/java_filter/296_0@w3c@Unicorn@676c72548236f3f639097a50fbe92b7f9f5d2e08@src_org_w3c_unicorn_response_impl_ValidatorNuMessage.java.txt"], "patch_list": [{"patch_file": "src/org/w3c/unicorn/response/impl/ValidatorNuMessage.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public ValidatorNuMessage(JsonObject jsonMessage, String uri) {", "Modified_Line": "-      title = jsonMessage.getString(\"message\");\n"}]}]}
{"num": 299, "cve": "CVE-2022-4773", "des": "** UNSUPPORTED WHEN ASSIGNED ** A vulnerability classified as problematic was found in cloudsync. Affected by this vulnerability is the function getItem of the file src/main/java/cloudsync/connector/LocalFilesystemConnector.java. The manipulation leads to path traversal. It is possible to launch the attack on the local host. The name of the patch is 3ad796833398af257c28e0ebeade68518e0e612a. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-216919. NOTE: This vulnerability only affects products that are no longer supported by the maintainer.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/HolgerHees/cloudsync/commits/3ad796833398af257c28e0ebeade68518e0e612a", "html_url": "https://github.com/HolgerHees/cloudsync/commit/3ad796833398af257c28e0ebeade68518e0e612a", "filename_list": ["./data/java/java_filter/299_0@HolgerHees@cloudsync@012e0ba694604a68244eee01fa22776e578b5ca7@src_main_java_cloudsync_connector_LocalFilesystemConnector.java.txt"], "patch_list": [{"patch_file": "src/main/java/cloudsync/connector/LocalFilesystemConnector.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public Item getItem(File file, final FollowLinkType followlinks, List<String> fo", "Modified_Line": "-                if (!followlinks.equals(FollowLinkType.NONE) && followlinks.equals(FollowLinkType.EXTERNAL) && !target.startsWith(localPath + Item.SEPARATOR) )\n"}]}]}
{"num": 300, "cve": "CVE-2020-36635", "des": "A vulnerability was found in OpenMRS Appointment Scheduling Module up to 1.12.x. It has been classified as problematic. This affects the function validateFieldName of the file api/src/main/java/org/openmrs/module/appointmentscheduling/validator/AppointmentTypeValidator.java. The manipulation leads to cross site scripting. It is possible to initiate the attack remotely. Upgrading to version 1.13.0 is able to address this issue. The name of the patch is 34213c3f6ea22df427573076fb62744694f601d8. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-216915.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/openmrs/openmrs-module-appointmentscheduling/commits/34213c3f6ea22df427573076fb62744694f601d8", "html_url": "https://github.com/openmrs/openmrs-module-appointmentscheduling/commit/34213c3f6ea22df427573076fb62744694f601d8", "filename_list": ["./data/java/java_filter/300_0@openmrs@openmrs-module-appointmentscheduling@30f9be016661c3985bba77689fbad0dabc785ead@api_src_main_java_org_openmrs_module_appointmentscheduling_validator_AppointmentTypeValidator.java.txt"], "patch_list": [{"patch_file": "api/src/main/java/org/openmrs/module/appointmentscheduling/validator/AppointmentTypeValidator.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private void validateFieldName(Errors errors, AppointmentType appointmentType) {", "Modified_Line": "\t\tValidationUtils.rejectIfEmptyOrWhitespace(errors, \"name\", \"error.name\");\n\t\tif (appointmentService.verifyDuplicatedAppointmentTypeName\n(appointmentType)) {\n\t\t\terrors.rejectValue(\"name\", \"appointmentscheduling.AppointmentType.nameDuplicated\");\n\t\t}\n\t\tif (verifyIfNameHasMoreThan100Characters(appointmentType.getName())) {\n\t\t\terrors.rejectValue(\"name\", \"appointmentscheduling.AppointmentType.longName.errorMessage\");\n"}]}]}
{"num": 301, "cve": "CVE-2022-4772", "des": "A vulnerability was found in Widoco and classified as critical. Affected by this issue is the function unZipIt of the file src/main/java/widoco/WidocoUtils.java. The manipulation leads to path traversal. It is possible to launch the attack on the local host. The name of the patch is f2279b76827f32190adfa9bd5229b7d5a147fa92. It is recommended to apply a patch to fix this issue. VDB-216914 is the identifier assigned to this vulnerability.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/dgarijo/Widoco/commits/f2279b76827f32190adfa9bd5229b7d5a147fa92", "html_url": "https://github.com/dgarijo/Widoco/commit/f2279b76827f32190adfa9bd5229b7d5a147fa92", "filename_list": ["./data/java/java_filter/301_0@dgarijo@Widoco@98a9ac99ae94e762cabd5d3d9b2d66b2e6cf6153@src_main_java_widoco_WidocoUtils.java.txt"], "patch_list": [{"patch_file": "src/main/java/widoco/WidocoUtils.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static void unZipIt(String resourceName, String outputFolder) {", "Modified_Line": "\t\t\t\tString fileName = ze.getName();-\t\t\t\tFile newFile = new File(outputFolder + File.separator + fileName);\n"}]}]}
{"num": 302, "cve": "CVE-2022-4727", "des": "A vulnerability, which was classified as problematic, was found in OpenMRS Appointment Scheduling Module up to 1.16.x. This affects the function getNotes of the file api/src/main/java/org/openmrs/module/appointmentscheduling/AppointmentRequest.java of the component Notes Handler. The manipulation of the argument notes leads to cross site scripting. It is possible to initiate the attack remotely. Upgrading to version 1.17.0 is able to address this issue. The name of the patch is 2ccbe39c020809765de41eeb8ee4c70b5ec49cc8. It is recommended to upgrade the affected component. The identifier VDB-216741 was assigned to this vulnerability.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/openmrs/openmrs-module-appointmentscheduling/commits/2ccbe39c020809765de41eeb8ee4c70b5ec49cc8", "html_url": "https://github.com/openmrs/openmrs-module-appointmentscheduling/commit/2ccbe39c020809765de41eeb8ee4c70b5ec49cc8", "filename_list": ["./data/java/java_filter/302_0@openmrs@openmrs-module-appointmentscheduling@731fb5851e17c2719d233885b615da03537bf55f@api_src_main_java_org_openmrs_module_appointmentscheduling_AppointmentRequest.java.txt"], "patch_list": [{"patch_file": "api/src/main/java/org/openmrs/module/appointmentscheduling/AppointmentRequest.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void setNotes(String notes) {", "Modified_Line": "-        this.notes = notes;\n"}]}]}
{"num": 304, "cve": "CVE-2021-4289", "des": "A vulnerability classified as problematic was found in OpenMRS openmrs-module-referenceapplication up to 2.11.x. Affected by this vulnerability is the function post of the file omod/src/main/java/org/openmrs/module/referenceapplication/page/controller/UserAppPageController.java of the component User App Page. The manipulation of the argument AppId leads to cross site scripting. The attack can be launched remotely. Upgrading to version 2.12.0 is able to address this issue. The name of the patch is 0410c091d46eed3c132fe0fcafe5964182659f74. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-216883.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/openmrs/openmrs-module-referenceapplication/commits/0410c091d46eed3c132fe0fcafe5964182659f74", "html_url": "https://github.com/openmrs/openmrs-module-referenceapplication/commit/0410c091d46eed3c132fe0fcafe5964182659f74", "filename_list": ["./data/java/java_filter/304_0@openmrs@openmrs-module-referenceapplication@db4f80bef85555ff9e540d971ea818cec106207d@omod_src_main_java_org_openmrs_module_referenceapplication_page_controller_UserAppPageController.java.txt"], "patch_list": [{"patch_file": "omod/src/main/java/org/openmrs/module/referenceapplication/page/controller/UserAppPageController.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public String post(PageModel model, @ModelAttribute(value = \"appId\") @BindParams", "Modified_Line": "-\t\t\t\t    ui.message(\"referenceapplication.app.userApp.save.success\", userApp.getAppId()));\n\t\t\t\treturn \"redirect:/referenceapplication/manageApps.page\";\n\t\t\t}\n\t\t}\n\t\tcatch (Exception e) {\n\t\t\tsession.setAttribute(UiCommonsConstants.\nSESSION_ATTRIBUTE_ERROR_MESSAGE,\n-\t\t\t    ui.message(\"referenceapplication.app.userApp.save.fail\", userApp.getAppId()));\n"}]}]}
{"num": 306, "cve": "CVE-2020-36634", "des": "A vulnerability classified as problematic has been found in Indeed Engineering util up to 1.0.33. Affected is the function visit/appendTo of the file varexport/src/main/java/com/indeed/util/varexport/servlet/ViewExportedVariablesServlet.java. The manipulation leads to cross site scripting. It is possible to launch the attack remotely. Upgrading to version 1.0.34 is able to address this issue. The name of the patch is c0952a9db51a880e9544d9fac2a2218a6bfc9c63. It is recommended to upgrade the affected component. VDB-216882 is the identifier assigned to this vulnerability.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/indeedeng/util/commits/c0952a9db51a880e9544d9fac2a2218a6bfc9c63", "html_url": "https://github.com/indeedeng/util/commit/c0952a9db51a880e9544d9fac2a2218a6bfc9c63", "filename_list": ["./data/java/java_filter/306_1@indeedeng@util@2125dd7b886b001a0859381f5ebb513194884b2f@varexport_src_main_java_com_indeed_util_varexport_servlet_ViewExportedVariablesServlet.java.txt"], "patch_list": [{"patch_file": "varexport/src/main/java/com/indeed/util/varexport/servlet/ViewExportedVariablesServlet.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private String buildIndex(final List<Variable> varList) {", "Modified_Line": "-        final SetMultimap<String, Integer> uniGram = buildNGramIndex(varList, 1);\n-        final SetMultimap<String, Integer> biGram = buildNGramIndex(varList, 2);\n-        final SetMultimap<String, Integer> triGram = buildNGramIndex(varList, 3);\n        final StringBuilder json = new StringBuilder();\n        json.append('{').append('\n');\n-        json.append(\"\"uniGram\":\").append('\n');\n-        appendTo(json, uniGram).append(',').append('\n');\n        json.append(\"\"biGram\":\").append('\n');\n-        appendTo(json, biGram).append(',').append('\n');;\n        json.append(\"\"triGram\":\").append('\n');\n-        appendTo(json, triGram);\n        json.append('}');\n        return json.toString();\n"}, {"Modified_Block_Num": "2", "Modified_Function": "private SetMultimap<String, Integer> buildNGramIndex(final List<Variable> varList, final int n) {", "Modified_Line": "-        final TreeMultimap<String, Integer> uniGram = TreeMultimap.create();\n-        for (int index = 0; index < varList.size(); index++) {\n-            final Variable var = varList.get(index);\n-            final String[] indexableNames = var.getIndexableNames();\n-            for (final String indexableName : indexableNames) {\n-                for (int i = 0; i < indexableName.length() - n + 1; i++) {\n-                    final String key = indexableName.substring(i, i + n);\n-                    uniGram.put(key, index);\n-                }\n-            }\n        }\n-        return uniGram;\n"}]}]}
{"num": 309, "cve": "CVE-2020-36628", "des": "A vulnerability classified as critical has been found in Calsign APDE. This affects the function handleExtract of the file APDE/src/main/java/com/calsignlabs/apde/build/dag/CopyBuildTask.java of the component ZIP File Handler. The manipulation leads to path traversal. Upgrading to version 0.5.2-pre2-alpha is able to address this issue. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-216747.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/Calsign/APDE/commits/c6d64cbe465348c1bfd211122d89e3117afadecf", "html_url": "https://github.com/Calsign/APDE/commit/c6d64cbe465348c1bfd211122d89e3117afadecf", "filename_list": ["./data/java/java_filter/309_0@Calsign@APDE@15bb52a4a2f69bff99425ccd9e8e183710522dd5@APDE_src_main_java_com_calsignlabs_apde_build_dag_CopyBuildTask.java.txt"], "patch_list": [{"patch_file": "APDE/src/main/java/com/calsignlabs/apde/build/dag/CopyBuildTask.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private static boolean handleExtract(InputStream inputStream, File folder) {", "Modified_Line": "\t\t\tzipIn = new ZipInputStream(inputStream);\n\t\t\tZipEntry zipEntry;\n\t\t\twhile ((zipEntry = zipIn.getNextEntry()) != null) {\n\t\t\t\tFile file = new File(folder, zipEntry.getName());\n\t\t\t\tif (zipEntry.isDirectory()) {\n\t\t\t\t\tif (!file.exists() && !file.mkdirs()) return false;\n\t\t\t\t} else {\n\t\t\t\t\tif (!file.getParentFile().exists() && !file.getParentFile().mkdirs()) return false;\n\t\t\t\t\tif (!handleStreamCopy(zipIn, new FileOutputStream(file), false, true)) return false;\n\t\t\t\t\tzipIn.closeEntry();\n"}]}]}
{"num": 310, "cve": "CVE-2022-4641", "des": "A vulnerability was found in pig-vector and classified as problematic. Affected by this issue is the function LogisticRegression of the file src/main/java/org/apache/mahout/pig/LogisticRegression.java. The manipulation leads to insecure temporary file. The attack needs to be approached locally. The name of the patch is 1e7bd9fab5401a2df18d2eabd802adcf0dcf1f15. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-216500.", "cwe_list": ["CWE-377"], "cwe_name_lst": ["Insecure Temporary File"], "url": "https://api.github.com/repos/tdunning/pig-vector/commits/1e7bd9fab5401a2df18d2eabd802adcf0dcf1f15", "html_url": "https://github.com/tdunning/pig-vector/commit/1e7bd9fab5401a2df18d2eabd802adcf0dcf1f15", "filename_list": ["./data/java/java_filter/310_0@tdunning@pig-vector@adf58aa492141c9abd768d3536479775badee8cc@src_main_java_org_apache_mahout_pig_LogisticRegression.java.txt"], "patch_list": [{"patch_file": "src/main/java/org/apache/mahout/pig/LogisticRegression.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public LogisticRegression(String modelParams) throws IOException {", "Modified_Line": "-            tmpFile = File.createTempFile(\"trainingData\", \"tmp\");\n"}]}]}
{"num": 311, "cve": "CVE-2022-4594", "des": "A vulnerability was found in drogatkin TJWS2. It has been declared as critical. Affected by this vulnerability is the function deployWar of the file 1.x/src/rogatkin/web/WarRoller.java. The manipulation leads to path traversal. The attack can be launched remotely. The name of the patch is 1bac15c496ec54efe21ad7fab4e17633778582fc. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-216187.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/drogatkin/TJWS2/commits/1bac15c496ec54efe21ad7fab4e17633778582fc", "html_url": "https://github.com/drogatkin/TJWS2/commit/1bac15c496ec54efe21ad7fab4e17633778582fc", "filename_list": ["./data/java/java_filter/311_0@drogatkin@TJWS2@6974a7ce78ec1491c35e3e8601384af24d6c3256@1.x_src_rogatkin_web_WarRoller.java.txt"], "patch_list": [{"patch_file": "1.x/src/rogatkin/web/WarRoller.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public boolean deployWar(File warFile, File deployTarDir) {", "Modified_Line": "\t\t    ZipEntry ze = entries.nextElement();\n\t\t    String en = ze.getName();\n\t\t    if (File.separatorChar == '/')\n\t\t\ten = en.replace('\\', File.separatorChar);\n\t\t    File outFile = new File(deployDir, en);\n"}]}]}
{"num": 312, "cve": "CVE-2022-4583", "des": "A vulnerability was found in jLEMS. It has been declared as critical. Affected by this vulnerability is the function unpackJar of the file src/main/java/org/lemsml/jlems/io/util/JUtil.java. The manipulation leads to path traversal. The attack can be launched remotely. The name of the patch is 8c224637d7d561076364a9e3c2c375daeaf463dc. It is recommended to apply a patch to fix this issue. The identifier VDB-216169 was assigned to this vulnerability.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/LEMS/jLEMS/commits/8c224637d7d561076364a9e3c2c375daeaf463dc", "html_url": "https://github.com/LEMS/jLEMS/commit/8c224637d7d561076364a9e3c2c375daeaf463dc", "filename_list": ["./data/java/java_filter/312_0@LEMS@jLEMS@a1c2c5a37f7687da38ef71cc81c1ef9f0eebb67c@src_main_java_org_lemsml_jlems_io_util_JUtil.java.txt"], "patch_list": [{"patch_file": "src/main/java/org/lemsml/jlems/io/util/JUtil.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static void unpackJar(File fjar, File fout) throws IOException {", "Modified_Line": "         JarEntry je = en.nextElement();\n         java.io.File f = new File(fout,  je.getName());\n         if (je.isDirectory()) {\n            f.mkdirs();\n            continue;\n"}]}]}
{"num": 314, "cve": "CVE-2022-4494", "des": "A vulnerability, which was classified as critical, has been found in bspkrs MCPMappingViewer. Affected by this issue is the function extractZip of the file src/main/java/bspkrs/mmv/RemoteZipHandler.java of the component ZIP File Handler. The manipulation leads to path traversal. The attack may be launched remotely. The name of the patch is 6e602746c96b4756c271d080dae7d22ad804a1bd. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-215804.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/bspkrs/MCPMappingViewer/commits/6e602746c96b4756c271d080dae7d22ad804a1bd", "html_url": "https://github.com/bspkrs/MCPMappingViewer/commit/6e602746c96b4756c271d080dae7d22ad804a1bd", "filename_list": ["./data/java/java_filter/314_0@bspkrs@MCPMappingViewer@cc754ad6e8502fa02c35de0fffad83c1a1956a03@src_main_java_bspkrs_mmv_RemoteZipHandler.java.txt"], "patch_list": [{"patch_file": "src/main/java/bspkrs/mmv/RemoteZipHandler.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static void extractZip(File zipFile, File destDir) throws IOException", "Modified_Line": "                String fileName = ze.getName();\n                File newFile = new File(destDir, fileName);\n                String fileName = ze.getName();\n                File newFile = new File(destDir, fileName);\n"}]}]}
{"num": 316, "cve": "CVE-2022-4454", "des": "A vulnerability, which was classified as critical, has been found in m0ver bible-online. Affected by this issue is the function query of the file src/main/java/custom/application/search.java of the component Search Handler. The manipulation leads to sql injection. The name of the patch is 6ef0aabfb2d4ccd53fcaa9707781303af357410e. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-215444.", "cwe_list": ["CWE-89"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "url": "https://api.github.com/repos/m0ver/bible-online/commits/6ef0aabfb2d4ccd53fcaa9707781303af357410e", "html_url": "https://github.com/m0ver/bible-online/commit/6ef0aabfb2d4ccd53fcaa9707781303af357410e", "filename_list": ["./data/java/java_filter/316_0@m0ver@bible-online@32c44270b77536026d7f927ebddfbc27a8fbc1a9@src_main_java_custom_application_search.java.txt"], "patch_list": [{"patch_file": "src/main/java/custom/application/search.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public Object query(String query) throws ApplicationException {", "Modified_Line": "-        StringBuffer condition = new StringBuffer();\n        int i = 0, j, k = 0;\n-        String _keyword;\n        while (i < keywords.length) {\n-            if (_keyword.trim().length() > 0) {\n-                if (condition.length() == 0) {\n-                    condition.append(\" bible.content like '%\" + _keyword + \"%' \");\n-                } else {\n-                    condition.append(\" AND bible.content like '%\" + _keyword + \"%' \");\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public Object query(String query) throws ApplicationException {", "Modified_Line": "        String SQL = \"SELECT bible.*,book.book_name FROM \" + bible.getTableName()\n                + \" as bible left join \" + book.getTableName()\n                + \" as book on bible.book_id=book.book_id where \" + condition\n                + \" order by bible.book_id,bible.chapter_id limit \" + startIndex + \",\"\n                + pageSize;\n        String look = \"SELECT count(bible.id) AS size FROM \" + bible.getTableName()\n                + \" as bible left join \" + book.getTableName()\n                + \" as book on bible.book_id=book.book_id where \" + condition;\n-        Table vtable = bible.find(SQL, new Object[]{});\n-        Row found = bible.findOne(look, new Object[]{});\n"}]}]}
{"num": 318, "cve": "CVE-2022-3509", "des": "A parsing issue similar to CVE-2022-3171, but with textformat in protobuf-java core and lite versions prior to 3.21.7, 3.20.3, 3.19.6 and 3.16.3 can lead to a denial of service attack. Inputs containing multiple instances of non-repeated embedded messages with repeated or unknown fields causes objects to be converted back-n-forth between mutable and immutable forms, resulting in potentially long garbage collection pauses. We recommend updating to the versions mentioned above.", "cwe_list": ["NVD-CWE-noinfo"], "cwe_name_lst": ["none"], "url": "https://api.github.com/repos/protocolbuffers/protobuf/commits/a3888f53317a8018e7a439bac4abeb8f3425d5e9", "html_url": "https://github.com/protocolbuffers/protobuf/commit/a3888f53317a8018e7a439bac4abeb8f3425d5e9", "filename_list": ["./data/java/java_filter/318_0@protocolbuffers@protobuf@3b5301c114121d036efe77e2816c44876c258c89@java_core_src_main_java_com_google_protobuf_MessageReflection.java.txt"], "patch_list": [{"patch_file": "java/core/src/main/java/com/google/protobuf/MessageReflection.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void mergeGroup(", "Modified_Line": "        CodedInputStream input,\n        ExtensionRegistryLite extensionRegistry,\n        FieldDescriptor field,\n        Message defaultInstance)\n        throws IOException {\n      if (!field.isRepeated()) {\n        if (hasField(field)) {\n-          input.readGroup(field.getNumber(), builder.getFieldBuilder(field), extensionRegistry);\n-          return;\n        }\n-        Message.Builder subBuilder = newMessageFieldInstance(field, defaultInstance);\n        input.readGroup(field.getNumber(), subBuilder, extensionRegistry);\n        Object unused = setField(field, subBuilder.buildPartial());\n      } else {\n        Message.Builder subBuilder = newMessageFieldInstance(field, defaultInstance);\n        input.readGroup(field.getNumber(), subBuilder, extensionRegistry);\n        Object unused = addRepeatedField(field, subBuilder.buildPartial());\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public void mergeMessage(", "Modified_Line": "        CodedInputStream input,\n        ExtensionRegistryLite extensionRegistry,\n        Descriptors.FieldDescriptor field,\n        Message defaultInstance)\n        throws IOException {\n      if (!field.isRepeated()) {\n        if (hasField(field)) {\n-          input.readMessage(builder.getFieldBuilder(field), extensionRegistry);\n-          return;\n        }\n-        Message.Builder subBuilder = newMessageFieldInstance(field, defaultInstance);\n        input.readMessage(subBuilder, extensionRegistry);\n        Object unused = setField(field, subBuilder.buildPartial());\n"}]}]}
{"num": 321, "cve": "CVE-2020-5428", "des": "In applications using Spring Cloud Task 2.2.4.RELEASE and below, may be vulnerable to SQL injection when exercising certain lookup queries in the TaskExplorer.", "cwe_list": ["CWE-89"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "url": "https://api.github.com/repos/spring-cloud/spring-cloud-task/commits/25592edb004eb5b059e9a093658437b18cff0979", "html_url": "https://github.com/spring-cloud/spring-cloud-task/commit/25592edb004eb5b059e9a093658437b18cff0979", "filename_list": ["./data/java/java_filter/321_0@spring-cloud@spring-cloud-task@b5f2a653eef3d9b2a1177aec50f66e79b3d35c91@spring-cloud-task-core_src_main_java_org_springframework_cloud_task_repository_dao_JdbcTaskExecutionDao.java.txt"], "patch_list": [{"patch_file": "spring-cloud-task-core/src/main/java/org/springframework/cloud/task/repository/dao/JdbcTaskExecutionDao.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private Page<TaskExecution> queryForPageableResults(Pageable pageable,", "Modified_Line": "\t\tif (sort != null) {\n\t\t\tfor (Sort.Order sortOrder : sort) {\n-\t\t\t\tsortOrderMap.put(sortOrder.getProperty(),\n-\t\t\t\t\t\tsortOrder.isAscending() ? Order.ASCENDING : Order.DESCENDING);\n"}]}]}
{"num": 324, "cve": "CVE-2021-21250", "des": "OneDev is an all-in-one devops platform. In OneDev before version 4.0.3, there is a critical vulnerability which may lead to arbitrary file read. When BuildSpec is provided in XML format, the spec is processed by XmlBuildSpecMigrator.migrate(buildSpecString); which processes the XML document without preventing the expansion of external entities. These entities can be configured to read arbitrary files from the file system and dump their contents in the final XML document to be migrated. If the files are dumped in properties included in the YAML file, it will be possible for an attacker to read them. If not, it is possible for an attacker to exfiltrate the contents of these files Out Of Band. This issue was addressed in 4.0.3 by ignoring ENTITY instructions in xml file.", "cwe_list": ["CWE-538"], "cwe_name_lst": ["Insertion of Sensitive Information into Externally-Accessible File or Directory"], "url": "https://api.github.com/repos/theonedev/onedev/commits/9196fd795e87dab069b4260a3590a0ea886e770f", "html_url": "https://github.com/theonedev/onedev/commit/9196fd795e87dab069b4260a3590a0ea886e770f", "filename_list": ["./data/java/java_filter/324_0@theonedev@onedev@d6fc4212b1ac1e9bbe3ce444e95f9af1e3ab8b66@server-core_src_main_java_io_onedev_server_migration_XmlBuildSpecMigrator.java.txt"], "patch_list": [{"patch_file": "server-core/src/main/java/io/onedev/server/migration/XmlBuildSpecMigrator.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static String migrate(String xml) {", "Modified_Line": "\t\tDocument xmlDoc;\n\t\ttry {\n-\t\t\txmlDoc = new SAXReader().read(new StringReader(xml));\n-\t\t} catch (DocumentException e) {\n"}]}]}
{"num": 325, "cve": "CVE-2021-21248", "des": "OneDev is an all-in-one devops platform. In OneDev before version 4.0.3, there is a critical vulnerability involving the build endpoint parameters. InputSpec is used to define parameters of a Build spec. It does so by using dynamically generated Groovy classes. A user able to control job parameters can run arbitrary code on OneDev's server by injecting arbitrary Groovy code. The ultimate result is in the injection of a static constructor that will run arbitrary code. For a full example refer to the referenced GHSA. This issue was addressed in 4.0.3 by escaping special characters such as quote from user input.", "cwe_list": ["CWE-94"], "cwe_name_lst": ["Improper Control of Generation of Code ('Code Injection')"], "url": "https://api.github.com/repos/theonedev/onedev/commits/39d95ab8122c5d9ed18e69dc024870cae08d2d60", "html_url": "https://github.com/theonedev/onedev/commit/39d95ab8122c5d9ed18e69dc024870cae08d2d60", "filename_list": ["./data/java/java_filter/325_1@theonedev@onedev@0df578ad840cba284f326325a5dedc82fce7c529@server-core_src_main_java_io_onedev_server_model_support_inputspec_textinput_TextInput.java.txt"], "patch_list": [{"patch_file": "server-core/src/main/java/io/onedev/server/model/support/inputspec/textinput/TextInput.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static String getPropertyDef(InputSpec inputSpec, Map<String, Integer> in", "Modified_Line": "\t\tint index = indexes.get(inputSpec.getName());\n\t\tStringBuffer buffer = new StringBuffer();\n\t\tinputSpec.appendField(buffer, index, \"String\");\n\t\tinputSpec.appendCommonAnnotations(buffer, index);\n\t\tif (!inputSpec.isAllowEmpty())\n\t\t\tbuffer.append(\"    @NotEmpty\n\");\n\t\tif (pattern != null)\n\t\t\tbuffer.append(\"    @Pattern(regexp=\"\" + pattern + \"\", message=\"Should match regular expression: \" + pattern + \"\")\n\");\n\t\tinputSpec.appendMethods(buffer, index, \"String\", null, defaultValueProvider);\n"}]}]}
{"num": 326, "cve": "CVE-2021-21249", "des": "OneDev is an all-in-one devops platform. In OneDev before version 4.0.3, there is an issue involving YAML parsing which can lead to post-auth remote code execution. In order to parse and process YAML files, OneDev uses SnakeYaml which by default (when not using `SafeConstructor`) allows the instantiation of arbitrary classes. We can leverage that to run arbitrary code by instantiating classes such as `javax.script.ScriptEngineManager` and using `URLClassLoader` to load the script engine provider, resulting in the instantiation of a user controlled class. For a full example refer to the referenced GHSA. This issue was addressed in 4.0.3 by only allowing certain known classes to be deserialized", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/theonedev/onedev/commits/d6fc4212b1ac1e9bbe3ce444e95f9af1e3ab8b66", "html_url": "https://github.com/theonedev/onedev/commit/d6fc4212b1ac1e9bbe3ce444e95f9af1e3ab8b66", "filename_list": ["./data/java/java_filter/326_0@theonedev@onedev@3674eaf4330e37836889669019ce0f19278bdf2b@server-core_src_main_java_io_onedev_server_migration_VersionedYamlDoc.java.txt"], "patch_list": [{"patch_file": "server-core/src/main/java/io/onedev/server/migration/VersionedYamlDoc.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected Class<?> getClassForNode(Node node) {", "Modified_Line": "-\t\t\tClass<?> type = node.getType();\r\n-\t\t\tif (type.getAnnotation(Editable.class) != null && !ClassUtils.isConcrete(type)) {\r\n-\t\t\t\tImplementationRegistry registry = OneDev.getInstance(ImplementationRegistry.class);\r\n-\t\t\t\tfor (Class<?> implementationClass: registry.getImplementations(node.getType())) {\r\n-\t\t\t\t\tString implementationTag = new Tag(\"!\" + implementationClass.getSimpleName()).getValue();\r\n-\t\t\t\t\tif (implementationTag.equals(node.getTag().getValue()))\r\n-\t\t\t\t\t\treturn implementationClass;\r\n\t\t\t\t}\r\n\t\t\t}\r\n-\t\t\treturn super.getClassForNode(node);\r\n"}]}]}
{"num": 327, "cve": "CVE-2021-21246", "des": "OneDev is an all-in-one devops platform. In OneDev before version 4.0.3, the REST UserResource endpoint performs a security check to make sure that only administrators can list user details. However for the `/users/{id}` endpoint there are no security checks enforced so it is possible to retrieve arbitrary user details including their Access Tokens! These access tokens can be used to access the API or clone code in the build spec via the HTTP(S) protocol. It has permissions to all projects accessible by the user account. This issue may lead to `Sensitive data leak` and leak the Access Token which can be used to impersonate the administrator or any other users. This issue was addressed in 4.0.3 by removing user info from restful api.", "cwe_list": ["CWE-862"], "cwe_name_lst": ["Missing Authorization"], "url": "https://api.github.com/repos/theonedev/onedev/commits/a4491e5f79dc6cc96eac20972eedc8905ddf6089", "html_url": "https://github.com/theonedev/onedev/commit/a4491e5f79dc6cc96eac20972eedc8905ddf6089", "filename_list": ["./data/java/java_filter/327_1@theonedev@onedev@0c060153fb97c0288a1917efdb17cc426934dacb@server-core_src_main_java_io_onedev_server_rest_UserResource.java.txt"], "patch_list": [{"patch_file": "server-core/src/main/java/io/onedev/server/rest/UserResource.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public User get(@PathParam(\"userId\") Long userId) {", "Modified_Line": "-    \treturn userManager.load(userId);\n"}]}]}
{"num": 328, "cve": "CVE-2021-21242", "des": "OneDev is an all-in-one devops platform. In OneDev before version 4.0.3, there is a critical vulnerability which can lead to pre-auth remote code execution. AttachmentUploadServlet deserializes untrusted data from the `Attachment-Support` header. This Servlet does not enforce any authentication or authorization checks. This issue may lead to pre-auth remote code execution. This issue was fixed in 4.0.3 by removing AttachmentUploadServlet and not using deserialization", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/theonedev/onedev/commits/f864053176c08f59ef2d97fea192ceca46a4d9be", "html_url": "https://github.com/theonedev/onedev/commit/f864053176c08f59ef2d97fea192ceca46a4d9be", "filename_list": ["./data/java/java_filter/328_2@theonedev@onedev@a7914f222a66988a48d73912503e918aca62eeb9@server-core_src_main_java_io_onedev_server_web_component_markdown_AttachmentUploadServlet.java.txt"], "patch_list": [{"patch_file": "server-core/src/main/java/io/onedev/server/web/component/markdown/AttachmentUploadServlet.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected void doPost(HttpServletRequest request, HttpServletResponse response)", "Modified_Line": "-\t\tAttachmentSupport attachmentSuppport = (AttachmentSupport) SerializationUtils\n-\t\t\t\t.deserialize(Base64.decodeBase64(request.getHeader(\"Attachment-Support\")));\n"}]}]}
{"num": 330, "cve": "CVE-2021-21244", "des": "OneDev is an all-in-one devops platform. In OneDev before version 4.0.3, There is a vulnerability that enabled pre-auth server side template injection via Bean validation message tampering. Full details in the reference GHSA. This issue was fixed in 4.0.3 by disabling validation interpolation completely.", "cwe_list": ["CWE-94"], "cwe_name_lst": ["Improper Control of Generation of Code ('Code Injection')"], "url": "https://api.github.com/repos/theonedev/onedev/commits/4f5dc6fb9e50f2c41c4929b0d8c5824b2cca3d65", "html_url": "https://github.com/theonedev/onedev/commit/4f5dc6fb9e50f2c41c4929b0d8c5824b2cca3d65", "filename_list": ["./data/java/java_filter/330_0@theonedev@onedev@4c2cf7af1362ee3f18d9cacc014a6700f196575d@server-core_src_main_java_io_onedev_server_CoreModule.java.txt"], "patch_list": [{"patch_file": "server-core/src/main/java/io/onedev/server/CoreModule.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public ValidatorFactory get() {", "Modified_Line": "-\t\t\t\tConfiguration<?> configuration = Validation.byDefaultProvider().configure();\r\n\t\t\t\treturn configuration.buildValidatorFactory();\r\n"}]}]}
{"num": 331, "cve": "CVE-2021-21243", "des": "OneDev is an all-in-one devops platform. In OneDev before version 4.0.3, a Kubernetes REST endpoint exposes two methods that deserialize untrusted data from the request body. These endpoints do not enforce any authentication or authorization checks. This issue may lead to pre-auth RCE. This issue was fixed in 4.0.3 by not using deserialization at KubernetesResource side.", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/theonedev/onedev/commits/9637fc8fa461c5777282a0021c3deb1e7a48f137", "html_url": "https://github.com/theonedev/onedev/commit/9637fc8fa461c5777282a0021c3deb1e7a48f137", "filename_list": ["./data/java/java_filter/331_0@theonedev@onedev@f864053176c08f59ef2d97fea192ceca46a4d9be@server-plugin_server-plugin-executor-kubernetes_src_main_java_io_onedev_server_plugin_executor_kubernetes_KubernetesResource.java.txt"], "patch_list": [{"patch_file": "server-plugin/server-plugin-executor-kubernetes/src/main/java/io/onedev/server/plugin/executor/kubernetes/KubernetesResource.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public byte[] allocateJobCaches(byte[] cacheAllocationRequestBytes) {", "Modified_Line": "-\t\tCacheAllocationRequest allocationRequest = (CacheAllocationRequest) SerializationUtils\n-\t\t\t\t.deserialize(cacheAllocationRequestBytes);\n\t\treturn SerializationUtils.serialize((Serializable) jobManager.allocateJobCaches(\n-\t\t\t\tgetJobToken(), allocationRequest.getCurrentTime(), allocationRequest.getInstances()));\n"},{"Modified_Block_Num": "2", "Modified_Function": "public void reportJobCaches(byte[] cacheInstanceBytes) {", "Modified_Line": "-\t\t@SuppressWarnings(\"unchecked\")\n-\t\tCollection<CacheInstance> cacheInstances = (Collection<CacheInstance>) SerializationUtils\n-\t\t\t\t.deserialize(cacheInstanceBytes);\n\t\tjobManager.reportJobCaches(getJobToken(), cacheInstances);\n"}]}]}
{"num": 334, "cve": "CVE-2021-0322", "des": "In onCreate of SlicePermissionActivity.java, there is a possible misleading string displayed due to improper input validation. This could lead to local information disclosure with User execution privileges needed. User interaction is needed for exploitation.Product: Android; Versions: Android-10, Android-11, Android-9; Android ID: A-159145361.", "cwe_list": ["CWE-20"], "cwe_name_lst": ["Improper Input Validation"], "url": "https://api.github.com/repos/aosp-mirror/platform_frameworks_base/commits/a185996c829a159bb27446697329b01464ab3c03", "html_url": "https://github.com/aosp-mirror/platform_frameworks_base/commit/a185996c829a159bb27446697329b01464ab3c03", "filename_list": ["./data/java/java_filter/334_1@aosp-mirror@platform_frameworks_base@e0b64f17785dc50771e73a8a1ef9bdd38d2df4b9@packages_SystemUI_src_com_android_systemui_SlicePermissionActivity.java.txt"], "patch_list": [{"patch_file": "packages/SystemUI/src/com/android/systemui/SlicePermissionActivity.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected void onCreate(Bundle savedInstanceState) {", "Modified_Line": "super.onCreate(savedInstanceState);\n-        mProviderPkg = getIntent().getStringExtra(SliceProvider.EXTRA_PROVIDER_PKG);\n"}]}]}
{"num": 336, "cve": "CVE-2021-0319", "des": "In checkCallerIsSystemOr of CompanionDeviceManagerService.java, there is a possible way to get a nearby Bluetooth device's MAC address without appropriate permissions due to a permissions bypass. This could lead to local escalation of privilege that grants access to nearby MAC addresses, with User execution privileges needed. User interaction is needed for exploitation. Product: Android; Versions: Android-8.0, Android-8.1, Android-9, Android-10, Android-11; Android ID: A-167244818.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/aosp-mirror/platform_frameworks_base/commits/0c17049d39b5a8867f030f6f36433564140e124a", "html_url": "https://github.com/aosp-mirror/platform_frameworks_base/commit/0c17049d39b5a8867f030f6f36433564140e124a", "filename_list": ["./data/java/java_filter/336_0@aosp-mirror@platform_frameworks_base@e237a83f95767f669b83508bb1f594091cbd6bac@services_companion_java_com_android_server_companion_CompanionDeviceManagerService.java.txt"], "patch_list": [{"patch_file": "services/companion/java/com/android/server/companion/CompanionDeviceManagerService.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private void checkCallerIsSystemOr(String pkg, int userId) throws RemoteExceptio", "Modified_Line": "-            mAppOpsManager.checkPackage(Binder.getCallingUid(), pkg);\n"}]}]}
{"num": 337, "cve": "CVE-2021-0317", "des": "In createOrUpdate of Permission.java and related code, there is possible permission escalation due to a logic error. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is needed for exploitation. Product: Android; Versions: Android-10, Android-11, Android-8.0, Android-8.1, Android-9; Android ID: A-168319670.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/aosp-mirror/platform_frameworks_base/commits/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47", "html_url": "https://github.com/aosp-mirror/platform_frameworks_base/commit/c4ce178c261e6a2dc1aa4c1e1d570f0efd980e47", "filename_list": ["./data/java/java_filter/337_0@aosp-mirror@platform_frameworks_base@03da463b2a94c36e3b46f0a110ec43710b82d404@services_core_java_com_android_server_pm_permission_BasePermission.java.txt"], "patch_list": [{"patch_file": "services/core/java/com/android/server/pm/permission/BasePermission.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "static BasePermission createOrUpdate(PackageManagerInternal packageManagerIntern", "Modified_Line": "-        boolean wasNormal = bp.isNormal();\n-        if (bp.isRuntime() && (ownerChanged || wasNormal)) {\n            bp.mPermissionDefinitionChanged = true;\n"}]}]}
{"num": 338, "cve": "CVE-2021-0315", "des": "In onCreate of GrantCredentialsPermissionActivity.java, there is a possible way to convince the user to grant an app access to an account due to a tapjacking/overlay attack. This could lead to local escalation of privilege with User execution privileges needed. User interaction is needed for exploitation. Product: Android; Versions: Android-8.1, Android-9, Android-10, Android-11, Android-8.0; Android ID: A-169763814.", "cwe_list": ["CWE-1021"], "cwe_name_lst": ["Improper Restriction of Rendered UI Layers or Frames"], "url": "https://api.github.com/repos/aosp-mirror/platform_frameworks_base/commits/828fe0b915f30e22fec03dc1ed2e66220ceebd3e", "html_url": "https://github.com/aosp-mirror/platform_frameworks_base/commit/828fe0b915f30e22fec03dc1ed2e66220ceebd3e", "filename_list": ["./data/java/java_filter/338_0@aosp-mirror@platform_frameworks_base@90cfe17643aa4ecbe7cbfb1c787217456f764e08@core_java_android_accounts_GrantCredentialsPermissionActivity.java.txt"], "patch_list": [{"patch_file": "core/java/android/accounts/GrantCredentialsPermissionActivity.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected void onCreate(Bundle savedInstanceState) {", "Modified_Line": "        super.onCreate(savedInstanceState);\n        setContentView(R.layout.grant_credentials_permission);\n        setTitle(R.string.grant_permissions_header_text);\n"}]}]}
{"num": 339, "cve": "CVE-2021-0306", "des": "In addAllPermissions of PermissionManagerService.java, there is a possible permissions bypass when upgrading major Android versions which allows an app to gain the android.permission.ACTIVITY_RECOGNITION permission without user confirmation. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation. Product: Android; Versions: Android-11, Android-8.0, Android-8.1, Android-9, Android-10; Android ID: A-154505240.", "cwe_list": ["CWE-269"], "cwe_name_lst": ["Improper Privilege Management"], "url": "https://api.github.com/repos/aosp-mirror/platform_frameworks_base/commits/03da463b2a94c36e3b46f0a110ec43710b82d404", "html_url": "https://github.com/aosp-mirror/platform_frameworks_base/commit/03da463b2a94c36e3b46f0a110ec43710b82d404", "filename_list": ["./data/java/java_filter/339_2@aosp-mirror@platform_frameworks_base@0c17049d39b5a8867f030f6f36433564140e124a@services_core_java_com_android_server_pm_permission_PermissionManagerService.java.txt"], "patch_list": [{"patch_file": "services/core/java/com/android/server/pm/permission/PermissionManagerService.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private void addAllPermissions(AndroidPackage pkg, boolean chatty) {", "Modified_Line": "        final int N = ArrayUtils.size(pkg.getPermissions());\n        for (int i=0; i<N; i++) {\n            ParsedPermission p = pkg.getPermissions().get(i);\n            p.setFlags(p.getFlags() & ~PermissionInfo.FLAG_INSTALLED);\n            synchronized (PermissionManagerService.this.mLock) {\n                if (pkg.getTargetSdkVersion() > Build.VERSION_CODES.LOLLIPOP_MR1) {\n                    p.setParsedPermissionGroup(mSettings.mPermissionGroups.get(p.getGroup()));\n                    if (DEBUG_PERMISSIONS\n                            && p.getGroup() != null && p.getParsedPermissionGroup() == null) {\n                        Slog.i(TAG, \"Permission \" + p.getName() + \" from package \"\n                                + p.getPackageName() + \" in an unknown group \" + p.getGroup());\n                    }\n                }\n                if (p.isTree()) {\n-                    final BasePermission bp = BasePermission.createOrUpdate(\n                            mPackageManagerInt,\n                            mSettings.getPermissionTreeLocked(p.getName()), p, pkg,\n                            mSettings.getAllPermissionTreesLocked(), chatty);\n                    mSettings.putPermissionTreeLocked(p.getName(), bp);\n                } else {\n-                    final BasePermission bp = BasePermission.createOrUpdate(\n                            mPackageManagerInt,\n                            mSettings.getPermissionLocked(p.getName()),\n                            p, pkg, mSettings.getAllPermissionTreesLocked(), chatty);\n                    mSettings.putPermissionLocked(p.getName(), bp);\n"}]}]}
{"num": 341, "cve": "CVE-2021-21234", "des": "spring-boot-actuator-logview in a library that adds a simple logfile viewer as spring boot actuator endpoint. It is maven package \"eu.hinsch:spring-boot-actuator-logview\". In spring-boot-actuator-logview before version 0.2.13 there is a directory traversal vulnerability. The nature of this library is to expose a log file directory via admin (spring boot actuator) HTTP endpoints. Both the filename to view and a base folder (relative to the logging folder root) can be specified via request parameters. While the filename parameter was checked to prevent directory traversal exploits (so that `filename=../somefile` would not work), the base folder parameter was not sufficiently checked, so that `filename=somefile&base=../` could access a file outside the logging base directory). The vulnerability has been patched in release 0.2.13. Any users of 0.2.12 should be able to update without any issues as there are no other changes in that release. There is no workaround to fix the vulnerability other than updating or removing the dependency. However, removing read access of the user the application is run with to any directory not required for running the application can limit the impact. Additionally, access to the logview endpoint can be limited by deploying the application behind a reverse proxy.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/lukashinsch/spring-boot-actuator-logview/commits/760acbb939a8d1f7d1a7dfcd51ca848eea04e772", "html_url": "https://github.com/lukashinsch/spring-boot-actuator-logview/commit/760acbb939a8d1f7d1a7dfcd51ca848eea04e772", "filename_list": ["./data/java/java_filter/341_0@lukashinsch@spring-boot-actuator-logview@a4bff618fc8e20fd2cd58859d24ca30c233688ac@lib_src_main_java_eu_hinsch_spring_boot_actuator_logview_LogViewEndpoint.java.txt"], "patch_list": [{"patch_file": "lib/src/main/java/eu/hinsch/spring/boot/actuator/logview/LogViewEndpoint.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public String list(Model model, // TODO model should no longer be injected", "Modified_Line": "-        securityCheck(base);\n        Path currentFolder = loggingPath(base);\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public void view(@RequestParam String filename,", "Modified_Line": "-        securityCheck(filename);\n-        response.setContentType(MediaType.TEXT_PLAIN_VALUE);\n        Path path = loggingPath(base);\n"}]}]}
{"num": 343, "cve": "CVE-2021-27582", "des": "org/mitre/oauth2/web/OAuthConfirmationController.java in the OpenID Connect server implementation for MITREid Connect through 1.3.3 contains a Mass Assignment (aka Autobinding) vulnerability. This arises due to unsafe usage of the @ModelAttribute annotation during the OAuth authorization flow, in which HTTP request parameters affect an authorizationRequest.", "cwe_list": ["CWE-1321"], "cwe_name_lst": ["Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution')"], "url": "https://api.github.com/repos/mitreid-connect/OpenID-Connect-Java-Spring-Server/commits/7eba3c12fed82388f917e8dd9b73e86e3a311e4c", "html_url": "https://github.com/mitreid-connect/OpenID-Connect-Java-Spring-Server/commit/7eba3c12fed82388f917e8dd9b73e86e3a311e4c", "filename_list": ["./data/java/java_filter/343_0@mitreid-connect@OpenID-Connect-Java-Spring-Server@0d4ef2cb4f77bea5df9e2d4f1cfff4dffb7045c0@openid-connect-server_src_main_java_org_mitre_oauth2_web_OAuthConfirmationController.java.txt"], "patch_list": [{"patch_file": "openid-connect-server/src/main/java/org/mitre/oauth2/web/OAuthConfirmationController.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public String confimAccess(Map<String, Object> model, @ModelAttribute(\"authorizationRequest\") AuthorizationRequest authRequest,", "Modified_Line": "-\tpublic String confimAccess(Map<String, Object> model, @ModelAttribute(\"authorizationRequest\") AuthorizationRequest authRequest,\n-\t\t\tPrincipal p) {\n"}]}]}
{"num": 347, "cve": "CVE-2021-21318", "des": "Opencast is a free, open-source platform to support the management of educational audio and video content. In Opencast before version 9.2 there is a vulnerability in which publishing an episode with strict access rules will overwrite the currently set series access. This allows for an easy denial of access for all users without superuser privileges, effectively hiding the series. Access to series and series metadata on the search service (shown in media module and player) depends on the events published which are part of the series. Publishing an event will automatically publish a series and update access to it. Removing an event or republishing the event should do the same. Affected versions of Opencast may not update the series access or remove a published series if an event is being removed. On removal of an episode, this may lead to an access control list for series metadata with broader access rules than the merged access rules of all remaining events, or the series metadata still being available although all episodes of that series have been removed. This problem is fixed in Opencast 9.2.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/opencast/opencast/commits/b18c6a7f81f08ed14884592a6c14c9ab611ad450", "html_url": "https://github.com/opencast/opencast/commit/b18c6a7f81f08ed14884592a6c14c9ab611ad450", "filename_list": ["./data/java/java_filter/347_0@opencast@opencast@29b08ceec87c926bfbb2961fee8288ec44cba7e8@modules_search-service-impl_src_main_java_org_opencastproject_search_impl_SearchServiceImpl.java.txt"], "patch_list": [{"patch_file": "modules/search-service-impl/src/main/java/org/opencastproject/search/impl/SearchServiceImpl.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void addSynchronously(MediaPackage mediaPackage) throws SearchException, MediaPackageException,", "Modified_Line": "    if (mediaPackage == null) {\n      throw new IllegalArgumentException(\"Unable to add a null mediapackage\");\n    }\n-    logger.debug(\"Attempting to add mediapackage {} to search index\", mediaPackage.getIdentifier());\n    AccessControlList acl = authorizationService.getActiveAcl(mediaPackage).getA();\n    Date now = new Date();\n    try {\n-      if (indexManager.add(mediaPackage, acl, now)) {\n-        logger.info(\"Added mediapackage `{}` to the search index, using ACL `{}`\", mediaPackage, acl);\n      } else {\n-        logger.warn(\"Failed to add mediapackage {} to the search index\", mediaPackage.getIdentifier());\n      }\n    } catch (SolrServerException e) {\n      throw new SearchException(e);\n    }\n    try {\n      persistence.storeMediaPackage(mediaPackage, acl, now);\n    } catch (SearchServiceDatabaseException e) {\n-      logger.error(\"Could not store media package to search database {}: {}\", mediaPackage.getIdentifier(), e);\n-      throw new SearchException(e);\n"}]}]}
{"num": 351, "cve": "CVE-2021-21292", "des": "Traccar is an open source GPS tracking system. In Traccar before version 4.12 there is an unquoted Windows binary path vulnerability. Only Windows versions are impacted. Attacker needs write access to the filesystem on the host machine. If Java path includes a space, then attacker can lift their privilege to the same as Traccar service (system). This is fixed in version 4.12.", "cwe_list": ["CWE-428"], "cwe_name_lst": ["Unquoted Search Path or Element"], "url": "https://api.github.com/repos/traccar/traccar/commits/cc69a9907ac9878db3750aa14ffedb28626455da", "html_url": "https://github.com/traccar/traccar/commit/cc69a9907ac9878db3750aa14ffedb28626455da", "filename_list": ["./data/java/java_filter/351_0@traccar@traccar@5d0bacea7ebdd169d55c7da0f7d6f3ae1ecf372f@src_main_java_org_traccar_WindowsService.java.txt"], "patch_list": [{"patch_file": "src/main/java/org/traccar/WindowsService.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void install(", "Modified_Line": "        String javaHome = System.getProperty(\"java.home\");\n-        String javaBinary = javaHome + \"\\\\bin\\\\java.exe\";\n"}]}]}
{"num": 353, "cve": "CVE-2020-15097", "des": "loklak is an open-source server application which is able to collect messages from various sources, including twitter. The server contains a search index and a peer-to-peer index sharing interface. All messages are stored in an elasticsearch index. In loklak less than or equal to commit 5f48476, a path traversal vulnerability exists. Insufficient input validation in the APIs exposed by the loklak server allowed a directory traversal vulnerability. Any admin configuration and files readable by the app available on the hosted file system can be retrieved by the attacker. Furthermore, user-controlled content could be written to any admin config and files readable by the application. This has been patched in commit 50dd692. Users will need to upgrade their hosted instances of loklak to not be vulnerable to this exploit.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/loklak/loklak_server/commits/50dd69230d3cd71dab0bfa7156682ffeca8ed8b9", "html_url": "https://github.com/loklak/loklak_server/commit/50dd69230d3cd71dab0bfa7156682ffeca8ed8b9", "filename_list": ["./data/java/java_filter/353_0@loklak@loklak_server@5f48476d6f06dc00d87d25def5f789db703dfe3e@src_org_loklak_data_DAO.java.txt"], "patch_list": [{"patch_file": "src/org/loklak/data/DAO.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static void init(Map<String, String> configMap, Path dataPath) throws Exc", "Modified_Line": "        File datadir = dataPath.toFile();\n-        assets = new File(datadir, \"assets\");\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public static File getAssetFile(String screen_name, String id_str, String file) {", "Modified_Line": "        String letter0 = (\"\" + screen_name.charAt(0)).toLowerCase();\n        String letter1 = (\"\" + screen_name.charAt(1)).toLowerCase();\n-        File storage_path = new File(new File(new File(assets, letter0), letter1), screen_name);\n-        return new File(storage_path, id_str + \"_\" + file); // all assets for one user in one file\n"}]}]}
{"num": 359, "cve": "CVE-2021-21363", "des": "swagger-codegen is an open-source project which contains a template-driven engine to generate documentation, API clients and server stubs in different languages by parsing your OpenAPI / Swagger definition. In swagger-codegen before version 2.4.19, on Unix like systems, the system's temporary directory is shared between all users on that system. A collocated user can observe the process of creating a temporary sub directory in the shared temporary directory and race to complete the creation of the temporary subdirectory. This vulnerability is local privilege escalation because the contents of the `outputFolder` can be appended to by an attacker. As such, code written to this directory, when executed can be attacker controlled. For more details refer to the referenced GitHub Security Advisory. This vulnerability is fixed in version 2.4.19. Note this is a distinct vulnerability from CVE-2021-21364.", "cwe_list": ["CWE-379", "CWE-378"], "cwe_name_lst": ["Creation of Temporary File in Directory with Insecure Permissions", "Creation of Temporary File With Insecure Permissions"], "url": "https://api.github.com/repos/swagger-api/swagger-codegen/commits/987ea7a30b463cc239580d6ad166c707ae942a89", "html_url": "https://github.com/swagger-api/swagger-codegen/commit/987ea7a30b463cc239580d6ad166c707ae942a89", "filename_list": ["./data/java/java_filter/359_0@swagger-api@swagger-codegen@a4b766beb6141ed66dbe1be23bce32366b5f9486@modules_swagger-generator_src_main_java_io_swagger_generator_online_Generator.java.txt"], "patch_list": [{"patch_file": "modules/swagger-generator/src/main/java/io/swagger/generator/online/Generator.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected static File getTmpFolder() {", "Modified_Line": "-            File outputFolder = File.createTempFile(\"codegen-\", \"-tmp\");\n-            outputFolder.delete();\n-            outputFolder.mkdir();\n"}]}]}
{"num": 360, "cve": "CVE-2021-21369", "des": "Hyperledger Besu is an open-source, MainNet compatible, Ethereum client written in Java. In Besu before version 1.5.1 there is a denial-of-service vulnerability involving the HTTP JSON-RPC API service. If username and password authentication is enabled for the HTTP JSON-RPC API service, then prior to making any requests to an API endpoint the requestor must use the login endpoint to obtain a JSON web token (JWT) using their credentials. A single user can readily overload the login endpoint with invalid requests (incorrect password). As the supplied password is checked for validity on the main vertx event loop and takes a relatively long time this can cause the processing of other valid requests to fail. A valid username is required for this vulnerability to be exposed. This has been fixed in version 1.5.1.", "cwe_list": ["CWE-400"], "cwe_name_lst": ["Uncontrolled Resource Consumption"], "url": "https://api.github.com/repos/hyperledger/besu/commits/06e35a58c07a30c0fbdc0aae45a3e8b06b53c022", "html_url": "https://github.com/hyperledger/besu/commit/06e35a58c07a30c0fbdc0aae45a3e8b06b53c022", "filename_list": ["./data/java/java_filter/360_0@hyperledger@besu@a9bdd29128eca70d1922b282aa2b479ab492b563@ethereum_api_src_main_java_org_hyperledger_besu_ethereum_api_jsonrpc_authentication_AuthenticationUtils.java.txt"], "patch_list": [{"patch_file": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/authentication/AuthenticationUtils.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static boolean isPermitted(", "Modified_Line": "-    if (authenticationService.isPresent()) {\n-      if (optionalUser.isPresent()) {\n-        User user = optionalUser.get();\n-        for (String perm : jsonRpcMethod.getPermissions()) {\n-          user.isAuthorized(\n-              perm,\n-              (authed) -> {\n-                if (authed.result()) {\n-                  LOG.trace(\n-                      \"user {} authorized : {} via permission {}\",\n-                      user,\n-                      jsonRpcMethod.getName(),\n-                      perm);\n-                  foundMatchingPermission.set(true);\n-                }\n-              });\n        }\n      }\n-    } else {\n-      // no auth provider configured thus anything is permitted\n-      foundMatchingPermission.set(true);\n"}]}]}
{"num": 361, "cve": "CVE-2020-27838", "des": "A flaw was found in keycloak in versions prior to 13.0.0. The client registration endpoint allows fetching information about PUBLIC clients (like client secret) without authentication which could be an issue if the same PUBLIC client changed to CONFIDENTIAL later. The highest threat from this vulnerability is to data confidentiality.", "cwe_list": ["CWE-287"], "cwe_name_lst": ["Improper Authentication"], "url": "https://api.github.com/repos/keycloak/keycloak/commits/9356843c6c3d7097d010b3bb6f91e25fcaba378c", "html_url": "https://github.com/keycloak/keycloak/commit/9356843c6c3d7097d010b3bb6f91e25fcaba378c", "filename_list": ["./data/java/java_filter/361_5@keycloak@keycloak@750f5fdb0a8e9a87ec14f256d42f81ece74748d4@services_src_main_java_org_keycloak_services_clientregistration_AbstractClientRegistrationProvider.java.txt"], "patch_list": [{"patch_file": "services/src/main/java/org/keycloak/services/clientregistration/AbstractClientRegistrationProvider.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public ClientRepresentation get(ClientModel client) {", "Modified_Line": "ClientRepresentation rep = ModelToRepresentation.toRepresentation(client, session);\n-        if (client.getSecret() != null) {\n            rep.setSecret(client.getSecret());\n"}]}]}
{"num": 362, "cve": "CVE-2021-31407", "des": "Vulnerability in OSGi integration in com.vaadin:flow-server versions 1.2.0 through 2.4.7 (Vaadin 12.0.0 through 14.4.9), and 6.0.0 through 6.0.1 (Vaadin 19.0.0) allows attacker to access application classes and resources on the server via crafted HTTP request.", "cwe_list": ["CWE-668"], "cwe_name_lst": ["Exposure of Resource to Wrong Sphere"], "url": "https://api.github.com/repos/vaadin/flow/commits/37e5a0ff0bb7365aa4485f2550fa6aa99f78974c", "html_url": "https://github.com/vaadin/flow/commit/37e5a0ff0bb7365aa4485f2550fa6aa99f78974c", "filename_list": ["./data/java/java_filter/362_0@vaadin@flow@37bb24cc6e7a3c75ca125b0d2aa7c095357f132b@flow-server_src_main_java_com_vaadin_flow_server_StaticFileServer.java.txt"], "patch_list": [{"patch_file": "flow-server/src/main/java/com/vaadin/flow/server/StaticFileServer.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public boolean isStaticResourceRequest(HttpServletRequest request) {", "Modified_Line": "-        resource = servletService.getStaticResource(requestFilename);\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public boolean serveStaticResource(HttpServletRequest request,", "Modified_Line": "        if (resourceUrl == null) {\n-            resourceUrl = servletService.getStaticResource(filenameWithPath);\n        }\n        if (resourceUrl == null && shouldFixIncorrectWebjarPaths()\n                && isIncorrectWebjarPath(filenameWithPath)) {\n-            resourceUrl = servletService.getStaticResource(\n"}]}]}
{"num": 364, "cve": "CVE-2021-31406", "des": "Non-constant-time comparison of CSRF tokens in endpoint request handler in com.vaadin:flow-server versions 3.0.0 through 5.0.3 (Vaadin 15.0.0 through 18.0.6), and com.vaadin:fusion-endpoint version 6.0.0 (Vaadin 19.0.0) allows attacker to guess a security token for Fusion endpoints via timing attack.", "cwe_list": ["CWE-203"], "cwe_name_lst": ["Observable Discrepancy"], "url": "https://api.github.com/repos/vaadin/flow/commits/11a6ad2ddf9b9bf91dd28515784d26c9ff5c6274", "html_url": "https://github.com/vaadin/flow/commit/11a6ad2ddf9b9bf91dd28515784d26c9ff5c6274", "filename_list": ["./data/java/java_filter/364_0@vaadin@flow@bd7f0ea8da1de2729c77095496bf81fdd2f84268@fusion-endpoint_src_main_java_com_vaadin_flow_server_connect_auth_VaadinConnectAccessChecker.java.txt"], "patch_list": [{"patch_file": "fusion-endpoint/src/main/java/com/vaadin/flow/server/connect/auth/VaadinConnectAccessChecker.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private boolean requestForbidden(HttpServletRequest request) {", "Modified_Line": "        String csrfTokenInSession = (String) session\n                .getAttribute(VaadinService.getCsrfTokenAttributeName());\n-        if (!csrfTokenInSession.equals(request.getHeader(\"X-CSRF-Token\"))) {\n"}]}]}
{"num": 365, "cve": "CVE-2020-36319", "des": "Insecure configuration of default ObjectMapper in com.vaadin:flow-server versions 3.0.0 through 3.0.5 (Vaadin 15.0.0 through 15.0.4) may expose sensitive data if the application also uses e.g. @RestController", "cwe_list": ["CWE-668"], "cwe_name_lst": ["Exposure of Resource to Wrong Sphere"], "url": "https://api.github.com/repos/vaadin/flow/commits/7222c96b1c5da51e56061cc5ae6d32f9a5876bc3", "html_url": "https://github.com/vaadin/flow/commit/7222c96b1c5da51e56061cc5ae6d32f9a5876bc3", "filename_list": ["./data/java/java_filter/365_0@vaadin@flow@0fb8c094773109bab179c8c1e175f4102f617f46@flow-server_src_main_java_com_vaadin_flow_server_connect_VaadinConnectController.java.txt"], "patch_list": [{"patch_file": "flow-server/src/main/java/com/vaadin/flow/server/connect/VaadinConnectController.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public class VaadinConnectController {", "Modified_Line": "    public VaadinConnectController(\n-            @Autowired(required = false) @Qualifier(VAADIN_ENDPOINT_MAPPER_BEAN_QUALIFIER) ObjectMapper vaadinEndpointMapper,\n            VaadinConnectAccessChecker accessChecker,\n            EndpointNameChecker endpointNameChecker,\n            ExplicitNullableTypeChecker explicitNullableTypeChecker,\n            ApplicationContext context,\n            ServletContext servletContext) {\n-        this.vaadinEndpointMapper = vaadinEndpointMapper != null\n-                ? vaadinEndpointMapper\n-                : getDefaultObjectMapper(context);\n"}]}]}
{"num": 366, "cve": "CVE-2021-31404", "des": "Non-constant-time comparison of CSRF tokens in UIDL request handler in com.vaadin:flow-server versions 1.0.0 through 1.0.13 (Vaadin 10.0.0 through 10.0.16), 1.1.0 prior to 2.0.0 (Vaadin 11 prior to 14), 2.0.0 through 2.4.6 (Vaadin 14.0.0 through 14.4.6), 3.0.0 prior to 5.0.0 (Vaadin 15 prior to 18), and 5.0.0 through 5.0.2 (Vaadin 18.0.0 through 18.0.5) allows attacker to guess a security token via timing attack.", "cwe_list": ["CWE-203"], "cwe_name_lst": ["Observable Discrepancy"], "url": "https://api.github.com/repos/vaadin/flow/commits/292b3a0b1d68b34d9b824e5afe62deb7b32e1ebb", "html_url": "https://github.com/vaadin/flow/commit/292b3a0b1d68b34d9b824e5afe62deb7b32e1ebb", "filename_list": ["./data/java/java_filter/366_0@vaadin@flow@61df7f739ae85dc4b6c6e262c4da7554973dd250@flow-server_src_main_java_com_vaadin_flow_server_VaadinService.java.txt"], "patch_list": [{"patch_file": "flow-server/src/main/java/com/vaadin/flow/server/VaadinService.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static boolean isCsrfTokenValid(UI ui, String requestToken) {", "Modified_Line": "            String uiToken = ui.getCsrfToken();\n-            if (uiToken == null || !uiToken.equals(requestToken)) {\n                return false;\n"}]}]}
{"num": 367, "cve": "CVE-2021-29455", "des": "Grassroot Platform is an application to make it faster, cheaper and easier to persistently organize and mobilize people in low-income communities. Grassroot Platform before master deployment as of 2021-04-16 did not properly verify the signature of JSON Web Tokens when refreshing an existing JWT. This allows to forge a valid JWT. The problem has been patched in version 1.3.1 by deprecating the JWT refresh function, which was an overdue deprecation regardless (the \"refresh\" flow is no longer used).", "cwe_list": ["CWE-347"], "cwe_name_lst": ["Improper Verification of Cryptographic Signature"], "url": "https://api.github.com/repos/grassrootza/grassroot-platform/commits/a2e6e885f8183a066d938cf909fd813a7af7d67f", "html_url": "https://github.com/grassrootza/grassroot-platform/commit/a2e6e885f8183a066d938cf909fd813a7af7d67f", "filename_list": ["./data/java/java_filter/367_1@grassrootza@grassroot-platform@c66703dbb5cc87c03e489bf8854dc2178239d006@grassroot-integration_src_main_java_za_org_grassroot_integration_authentication_JwtServiceImpl.java.txt"], "patch_list": [{"patch_file": "grassroot-integration/src/main/java/za/org/grassroot/integration/authentication/JwtServiceImpl.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public String refreshToken(String oldToken, JwtType jwtType, Long shortExpiryMillis) {", "Modified_Line": "-    @Override\n-    public String refreshToken(String oldToken, JwtType jwtType, Long shortExpiryMillis) {\n-        boolean isTokenStillValid = false;\n-        Date expirationTime = null;\n-        String newToken = null;\n-        String userId = null;\n-        String systemRoles = null;\n-        try {\n-            Jwt<Header, Claims> jwt = Jwts.parser().setSigningKey(keyPairProvider.getJWTKey().getPublic()).parseClaimsJws(oldToken);\n-            userId = jwt.getBody().get(USER_UID_KEY, String.class);\n-            systemRoles = jwt.getBody().get(SYSTEM_ROLE_KEY, String.class);\n-            isTokenStillValid = true;\n-        }\n-        catch (ExpiredJwtException e) {\n-            logger.error(\"Token validation failed. The token is expired.\", e);\n-            expirationTime = e.getClaims().getExpiration();\n-        }\n-        if (isTokenStillValid || expirationTime != null\n-                && expirationTime.toInstant().plus(jwtTokenExpiryGracePeriodInMilliseconds, ChronoUnit.MILLIS).isAfter(new Date().toInstant())) {\n-            CreateJwtTokenRequest cjtRequest = new CreateJwtTokenRequest(jwtType, shortExpiryMillis, userId, systemRoles);\n-            newToken = createJwt(cjtRequest);\n-        }\n-        return newToken;\n-    }\n"}]}]}
{"num": 368, "cve": "CVE-2021-29451", "des": "Portofino is an open source web development framework. Portofino before version 5.2.1 did not properly verify the signature of JSON Web Tokens. This allows forging a valid JWT. The issue will be patched in the upcoming 5.2.1 release.", "cwe_list": ["CWE-347"], "cwe_name_lst": ["Improper Verification of Cryptographic Signature"], "url": "https://api.github.com/repos/ManyDesigns/Portofino/commits/8c754a0ad234555e813dcbf9e57d637f9f23d8fb", "html_url": "https://github.com/ManyDesigns/Portofino/commit/8c754a0ad234555e813dcbf9e57d637f9f23d8fb", "filename_list": ["./data/java/java_filter/368_0@ManyDesigns@Portofino@cc3aebd9e61073b3bd88be0dc354bbc92aa83168@dispatcher_src_main_java_com_manydesigns_portofino_dispatcher_security_jwt_JWTRealm.java.txt", "./data/java/java_filter/368_1@ManyDesigns@Portofino@cc3aebd9e61073b3bd88be0dc354bbc92aa83168@portofino-core_src_main_java_com_manydesigns_portofino_shiro_AbstractPortofinoRealm.java.txt"], "patch_list": [{"patch_file": "dispatcher/src/main/java/com/manydesigns/portofino/dispatcher/security/jwt/JWTRealm.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token)", "Modified_Line": "-        Jwt jwt = Jwts.parser().\n                setSigningKey(key).\n-                parse((String) token.getPrincipal());\n        Map<String, Serializable> principal = getPrincipal(jwt);\n        return new SimpleAuthenticationInfo(principal, ((String) token.getCredentials()).toCharArray(), getName());\n"}]}, {"patch_file": "portofino-core/src/main/java/com/manydesigns/portofino/shiro/AbstractPortofinoRealm.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public AuthenticationInfo loadAuthenticationInfo(JSONWebToken token) {", "Modified_Line": "        Key key = getJWTKey();\n-        Jwt jwt;\n        try {\n-            jwt = Jwts.parser().setSigningKey(key).parse(token.getPrincipal());\n"}]}]}
{"num": 369, "cve": "CVE-2021-25924", "des": "In GoCD, versions 19.6.0 to 21.1.0 are vulnerable to Cross-Site Request Forgery due to missing CSRF protection at the `/go/api/config/backup` endpoint. An attacker can trick a victim to click on a malicious link which could change backup configurations or execute system commands in the post_backup_script field.", "cwe_list": ["CWE-352"], "cwe_name_lst": ["Cross-Site Request Forgery (CSRF)"], "url": "https://api.github.com/repos/gocd/gocd/commits/7d0baab0d361c377af84994f95ba76c280048548", "html_url": "https://github.com/gocd/gocd/commit/7d0baab0d361c377af84994f95ba76c280048548", "filename_list": ["./data/java/java_filter/369_0@gocd@gocd@ae5618922e9249eb51349242f713a1f4f1e3f3fb@api_api-backup-config-v1_src_main_java_com_thoughtworks_go_apiv1_backupconfig_BackupConfigControllerV1.java.txt"], "patch_list": [{"patch_file": "api/api-backup-config-v1/src/main/java/com/thoughtworks/go/apiv1/backupconfig/BackupConfigControllerV1.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": " public void setupRoutes() {", "Modified_Line": "        path(controllerBasePath(), () -> {\n            before(\"\", mimeType, this::setContentType);\n            before(\"\", mimeType, this.apiAuthenticationHelper::checkAdminUserAnd403);\n            get(\"\", mimeType, this::show);\n            post(\"\", mimeType, this::createOrUpdate);\n            put(\"\", mimeType, this::createOrUpdate);\n            delete(\"\", mimeType, this::deleteBackupConfig);\n"}]}]}
{"num": 370, "cve": "CVE-2021-32620", "des": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. In versions prior to 11.10.13, 12.6.7, and 12.10.2, a user disabled on a wiki using email verification for registration canouldre-activate themself by using the activation link provided for his registration. The problem has been patched in the following versions of XWiki: 11.10.13, 12.6.7, 12.10.2, 13.0. It is possible to workaround the issue by resetting the `validkey` property of the disabled XWiki users. This can be done by editing the user profile with object editor.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/xwiki/xwiki-platform/commits/f9a677408ffb06f309be46ef9d8df1915d9099a4", "html_url": "https://github.com/xwiki/xwiki-platform/commit/f9a677408ffb06f309be46ef9d8df1915d9099a4", "filename_list": ["./data/java/java_filter/370_0@xwiki@xwiki-platform@e4dec4ea301dc42c25c129665ce0f55a2142324a@xwiki-platform-core_xwiki-platform-oldcore_src_main_java_com_xpn_xwiki_XWiki.java.txt"], "patch_list": [{"patch_file": "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/XWiki.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public int validateUser(boolean withConfirmEmail, XWikiContext context) throws X", "Modified_Line": "            if ((!storedKey.equals(\"\") && (storedKey.equals(validationKey)))) {\n                XWikiUser xWikiUser = new XWikiUser(userDocument.getDocumentReference());\n                xWikiUser.setDisabled(false, context);\n                xWikiUser.setEmailChecked(true, context);\n-                saveDocument(userDocument, context);\n"}]}]}
{"num": 371, "cve": "CVE-2021-32621", "des": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. In versions prior to 12.6.7 and 12.10.3, a user without Script or Programming right is able to execute script requiring privileges by editing gadget titles in the dashboard. The issue has been patched in XWiki 12.6.7, 12.10.3 and 13.0RC1.", "cwe_list": ["CWE-94"], "cwe_name_lst": ["Improper Control of Generation of Code ('Code Injection')"], "url": "https://api.github.com/repos/xwiki/xwiki-platform/commits/bb7068bd911f91e5511f3cfb03276c7ac81100bc", "html_url": "https://github.com/xwiki/xwiki-platform/commit/bb7068bd911f91e5511f3cfb03276c7ac81100bc", "filename_list": ["./data/java/java_filter/371_0@xwiki@xwiki-platform@5308f7d8cdb5c61e8ae29c53fcc8075cfc6576fb@xwiki-platform-core_xwiki-platform-dashboard_xwiki-platform-dashboard-macro_src_main_java_org_xwiki_rendering_internal_macro_dashboard_DefaultGadgetSource.java.txt"], "patch_list": [{"patch_file": "xwiki-platform-core/xwiki-platform-dashboard/xwiki-platform-dashboard-macro/src/main/java/org/xwiki/rendering/internal/macro/dashboard/DefaultGadgetSource.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private List<Gadget> prepareGadgets(List<BaseObject> objects, Syntax sourceSynta", "Modified_Line": "                this.progress.startStep(this, \"dashboard.progress.prepareGadget\", \"Prepare gadget [{}:{}]\",\n                    xObject.getDocumentReference(), xObject.getNumber());\n                String title = xObject.getStringValue(\"title\");\n                String content = xObject.getLargeStringValue(\"content\");\n                String position = xObject.getStringValue(\"position\");\n                String id = xObject.getNumber() + \"\";\n-                StringWriter writer = new StringWriter();\n-                velocityEngine.evaluate(velocityContext, writer, key, title);\n-                String gadgetTitle = writer.toString();\n                List<Block> titleBlocks =\n                    renderGadgetProperty(gadgetTitle, sourceSyntax, xObject.getDocumentReference(),\n-                        xObject.getOwnerDocument(), context);\n                List<Block> contentBlocks =\n                    renderGadgetProperty(content, sourceSyntax, xObject.getDocumentReference(),\n-                        xObject.getOwnerDocument(), context);\n"}]}]}
{"num": 379, "cve": "CVE-2021-33562", "des": "A reflected cross-site scripting (XSS) vulnerability in Shopizer before 2.17.0 allows remote attackers to inject arbitrary web script or HTML via the ref parameter to a page about an arbitrary product, e.g., a product/insert-product-name-here.html/ref= URL.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/shopizer-ecommerce/shopizer/commits/197f8c78c8f673b957e41ca2c823afc654c19271", "html_url": "https://github.com/shopizer-ecommerce/shopizer/commit/197f8c78c8f673b957e41ca2c823afc654c19271", "filename_list": ["./data/java/java_filter/379_3@shopizer-ecommerce@shopizer@b46f134256121baee60aadab4bb2e7ec8142842b@sm-shop_src_main_java_com_salesmanager_shop_store_controller_category_ShoppingCategoryController.java.txt"], "patch_list": [{"patch_file": "sm-shop/src/main/java/com/salesmanager/shop/store/controller/category/ShoppingCategoryController.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private String displayCategory(final String friendlyUrl, final String ref, Model", "Modified_Line": "-\t\trequest.setAttribute(\"ref\", ref);\n"}]}]}
{"num": 389, "cve": "CVE-2021-29506", "des": "GraphHopper is an open-source Java routing engine. In GrassHopper from version 2.0 and before version 2.4, there is a regular expression injection vulnerability that may lead to Denial of Service. This has been patched in 2.4 and 3.0 See this pull request for the fix: https://github.com/graphhopper/graphhopper/pull/2304", "cwe_list": ["CWE-400"], "cwe_name_lst": ["Uncontrolled Resource Consumption"], "url": "https://api.github.com/repos/graphhopper/graphhopper/commits/eb189be1fa7443ebf4ae881e737a18f818c95f41", "html_url": "https://github.com/graphhopper/graphhopper/commit/eb189be1fa7443ebf4ae881e737a18f818c95f41", "filename_list": ["./data/java/java_filter/389_0@graphhopper@graphhopper@744f0e2535355e67aefbb6906303332b8aff0a7f@navigation_src_main_java_com_graphhopper_navigation_NavigateResource.java.txt"], "patch_list": [{"patch_file": "navigation/src/main/java/com/graphhopper/navigation/NavigateResource.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private List<GHPoint> getPointsFromRequest(HttpServletRequest httpServletRequest, String profile) {", "Modified_Line": "        String url = httpServletRequest.getRequestURI();\n-        url = url.replaceFirst(\"/navigate/directions/v5/gh/\" + profile + \"/\", \"\");\n-        url = url.replaceAll(\"\\\\?[*]\", \"\");\n"}]}]}
{"num": 390, "cve": "CVE-2021-20202", "des": "A flaw was found in keycloak. Directories can be created prior to the Java process creating them in the temporary directory, but with wider user permissions, allowing the attacker to have access to the contents that keycloak stores in this directory. The highest threat from this vulnerability is to data confidentiality and integrity.", "cwe_list": ["CWE-377"], "cwe_name_lst": ["Insecure Temporary File"], "url": "https://api.github.com/repos/keycloak/keycloak/commits/853a6d73276849877819f2dc23133557f6e1e601", "html_url": "https://github.com/keycloak/keycloak/commit/853a6d73276849877819f2dc23133557f6e1e601", "filename_list": ["./data/java/java_filter/390_0@keycloak@keycloak@82fc4012983ea3f6dc2a24f157ab7ced57150465@quarkus_runtime_src_main_java_org_keycloak_configuration_KeycloakConfigSourceProvider.java.txt", "./data/java/java_filter/390_2@keycloak@keycloak@82fc4012983ea3f6dc2a24f157ab7ced57150465@services_src_main_java_org_keycloak_encoding_GzipResourceEncodingProviderFactory.java.txt", "./data/java/java_filter/390_3@keycloak@keycloak@82fc4012983ea3f6dc2a24f157ab7ced57150465@services_src_main_java_org_keycloak_exportimport_dir_DirExportProvider.java.txt", "./data/java/java_filter/390_4@keycloak@keycloak@82fc4012983ea3f6dc2a24f157ab7ced57150465@services_src_main_java_org_keycloak_exportimport_dir_DirImportProvider.java.txt"], "patch_list": [{"patch_file": "quarkus/runtime/src/main/java/org/keycloak/configuration/KeycloakConfigSourceProvider.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static Path getPersistedConfigFile() {", "Modified_Line": "-            return Paths.get(System.getProperty(\"java.io.tmpdir\"), PersistedConfigSource.KEYCLOAK_PROPERTIES);\n"}]}, {"patch_file": "services/src/main/java/org/keycloak/encoding/GzipResourceEncodingProviderFactory.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private synchronized File initCacheDir() {", "Modified_Line": "-        File cacheRoot = new File(System.getProperty(\"java.io.tmpdir\"), \"kc-gzip-cache\");\n"}]}, {"patch_file": "services/src/main/java/org/keycloak/exportimport/dir/DirExportProvider.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public DirExportProvider() {", "Modified_Line": "-        String tempDir = System.getProperty(\"java.io.tmpdir\");\n-        this.rootDirectory = new File(tempDir + \"/keycloak-export\");\n"}]}, {"patch_file": "services/src/main/java/org/keycloak/exportimport/dir/DirImportProvider.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public DirImportProvider() {", "Modified_Line": "-        String tempDir = System.getProperty(\"java.io.tmpdir\");\n-        this.rootDirectory = new File(tempDir + \"/keycloak-export\");\n"}]}]}
{"num": 391, "cve": "CVE-2021-31409", "des": "Unsafe validation RegEx in EmailValidator component in com.vaadin:vaadin-compatibility-server versions 8.0.0 through 8.12.4 (Vaadin versions 8.0.0 through 8.12.4) allows attackers to cause uncontrolled resource consumption by submitting malicious email addresses.", "cwe_list": ["CWE-400"], "cwe_name_lst": ["Uncontrolled Resource Consumption"], "url": "https://api.github.com/repos/vaadin/framework/commits/754ca011d79af3dd4fa9046ff0ade5367f5e6246", "html_url": "https://github.com/vaadin/framework/commit/754ca011d79af3dd4fa9046ff0ade5367f5e6246", "filename_list": ["./data/java/java_filter/391_0@vaadin@framework@9978eec85cb95df26170006a04d2285cfd7bcc7d@compatibility-server_src_main_java_com_vaadin_v7_data_validator_EmailValidator.java.txt"], "patch_list": [{"patch_file": "compatibility-server/src/main/java/com/vaadin/v7/data/validator/EmailValidator.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public EmailValidator(String errorMessage) {", "Modified_Line": "-        super(\"^([a-zA-Z0-9_\\\\.\\\\-+])+@(([a-zA-Z0-9-])+\\\\.)+([a-zA-Z0-9]{2,4})+$\",\n-                true, errorMessage);\n"}]}]}
{"num": 392, "cve": "CVE-2021-32700", "des": "Ballerina is an open source programming language and platform for cloud application programmers. Ballerina versions 1.2.x and SL releases up to alpha 3 have a potential for a supply chain attack via MiTM against users. Http connections did not make use of TLS and certificate checking was ignored. The vulnerability allows an attacker to substitute or modify packages retrieved from BC thus allowing to inject malicious code into ballerina executables. This has been patched in Ballerina 1.2.14 and Ballerina SwanLake alpha4.", "cwe_list": ["CWE-306"], "cwe_name_lst": ["Missing Authentication for Critical Function"], "url": "https://api.github.com/repos/ballerina-platform/ballerina-lang/commits/4609ffee1744ecd16aac09303b1783bf0a525816", "html_url": "https://github.com/ballerina-platform/ballerina-lang/commit/4609ffee1744ecd16aac09303b1783bf0a525816", "filename_list": ["./data/java/java_filter/392_4@ballerina-platform@ballerina-lang@a3bac058c55c6820ce55bf0f9638ae052769891b@cli_ballerina-cli-module_src_main_java_org_ballerinalang_cli_module_util_Utils.java.txt"], "patch_list": [{"patch_file": "cli/ballerina-cli-module/src/main/java/org/ballerinalang/cli/module/util/Utils.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static void initializeSsl() {", "Modified_Line": "-        try {\n-            SSLContext sc = SSLContext.getInstance(SSL);\n-            sc.init(null, trustAllCerts, new java.security.SecureRandom());\n-            HttpsURLConnection.setDefaultSSLSocketFactory(sc.getSocketFactory());\n-        } catch (NoSuchAlgorithmException | KeyManagementException e) {\n-            throw ErrorUtil.createCommandException(\"initializing SSL failed: \" + e.getMessage());\n-        }\n-    }\n"}]}]}
{"num": 395, "cve": "CVE-2021-32658", "des": "Nextcloud Android is the Android client for the Nextcloud open source home cloud system. Due to a timeout issue the Android client may not properly clean all sensitive data on account removal. This could include sensitive key material such as the End-to-End encryption keys. It is recommended that the Nextcloud Android App is upgraded to 3.16.1", "cwe_list": ["CWE-212"], "cwe_name_lst": ["Improper Removal of Sensitive Information Before Storage or Transfer"], "url": "https://api.github.com/repos/nextcloud/android/commits/355f3c745b464b741b20a3b96597303490c26333", "html_url": "https://github.com/nextcloud/android/commit/355f3c745b464b741b20a3b96597303490c26333", "filename_list": ["./data/java/java_filter/395_0@nextcloud@android@4f36e9ea8d8b3950027ef53be060a701ff375242@src_main_java_com_owncloud_android_ui_dialog_SetupEncryptionDialogFragment.java.txt"], "patch_list": [{"patch_file": "src/main/java/com/owncloud/android/ui/dialog/SetupEncryptionDialogFragment.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void onClick(View view) {", "Modified_Line": "-                                    arbitraryDataProvider.storeOrUpdateKeyValue(user.getAccountName(), EncryptionUtils.MNEMONIC,\n-                                            mnemonicUnchanged);\n"}]}]}
{"num": 396, "cve": "CVE-2021-32651", "des": "OneDev is a development operations platform. If the LDAP external authentication mechanism is enabled in OneDev versions 4.4.1 and prior, an attacker can manipulate a user search filter to send forged queries to the application and explore the LDAP tree using Blind LDAP Injection techniques. The specific payload depends on how the User Search Filter property is configured in OneDev. This issue was fixed in version 4.4.2.", "cwe_list": ["CWE-90"], "cwe_name_lst": ["Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')"], "url": "https://api.github.com/repos/theonedev/onedev/commits/4440f0c57e440488d7e653417b2547eaae8ad19c", "html_url": "https://github.com/theonedev/onedev/commit/4440f0c57e440488d7e653417b2547eaae8ad19c", "filename_list": ["./data/java/java_filter/396_0@theonedev@onedev@a61e1a016c20f4f3eafb257640883edb19771578@server-plugin_server-plugin-authenticator-ldap_src_main_java_io_onedev_server_plugin_authenticator_ldap_LdapAuthenticator.java.txt"], "patch_list": [{"patch_file": "server-plugin/server-plugin-authenticator-ldap/src/main/java/io/onedev/server/plugin/authenticator/ldap/LdapAuthenticator.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public Authenticated authenticate(UsernamePasswordToken token) {", "Modified_Line": "-        String userSearchFilter = StringUtils.replace(getUserSearchFilter(), \"{0}\", token.getUsername());\n"}]}]}
{"num": 400, "cve": "CVE-2021-32631", "des": "Common is a package of common modules that can be accessed by NIMBLE services. Common before commit number 3b96cb0293d3443b870351945f41d7d55cb34b53 did not properly verify the signature of JSON Web Tokens. This allows someone to forge a valid JWT. Being able to forge JWTs may lead to authentication bypasses. Commit number 3b96cb0293d3443b870351945f41d7d55cb34b53 contains a patch for the issue. As a workaround, one may use the parseClaimsJws method to correctly verify the signature of a JWT.", "cwe_list": ["CWE-290"], "cwe_name_lst": ["Authentication Bypass by Spoofing"], "url": "https://api.github.com/repos/nimble-platform/common/commits/a59ad46733912a5580530e39cac0e6ebc83cc563", "html_url": "https://github.com/nimble-platform/common/commit/a59ad46733912a5580530e39cac0e6ebc83cc563", "filename_list": ["./data/java/java_filter/400_0@nimble-platform@common@12197a755bd524559bf4e16475595a2c6fcd34db@utility_src_main_java_eu_nimble_utility_validation_ValidationUtil.java.txt"], "patch_list": [{"patch_file": "utility/src/main/java/eu/nimble/utility/validation/ValidationUtil.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public Claims validateToken(String token) throws AuthenticationException {", "Modified_Line": "            RsaKeyUtil rsaKeyUtil = new RsaKeyUtil();\n            PublicKey publicKey = rsaKeyUtil.fromPemEncoded(keycloakPublicKey);\n-            return Jwts.parser().setSigningKey(publicKey).parseJws(token.replace(\"Bearer \", \"\")).getBody();\n"}]}]}
{"num": 403, "cve": "CVE-2021-22144", "des": "In Elasticsearch versions before 7.13.3 and 6.8.17 an uncontrolled recursion vulnerability that could lead to a denial of service attack was identified in the Elasticsearch Grok parser. A user with the ability to submit arbitrary queries to Elasticsearch could create a malicious Grok query that will crash the Elasticsearch node.", "cwe_list": ["CWE-674"], "cwe_name_lst": ["Uncontrolled Recursion"], "url": "https://api.github.com/repos/elastic/elasticsearch/commits/206f6a2512f2ca690999b77a5c759ab214536b82", "html_url": "https://github.com/elastic/elasticsearch/commit/206f6a2512f2ca690999b77a5c759ab214536b82", "filename_list": ["./data/java/java_filter/403_0@elastic@elasticsearch@fc90c8878877aae38cec24ee1c4cb15966951b08@libs_grok_src_main_java_org_elasticsearch_grok_Grok.java.txt"], "patch_list": [{"patch_file": "libs/grok/src/main/java/org/elasticsearch/grok/Grok.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private void forbidCircularReferences(String patternName, List<String> path, String pattern) {", "Modified_Line": "-        innerForbidCircularReferences(patternName, path, pattern);\n"}, {"Modified_Block_Num": "2", "Modified_Function": "private void innerForbidCircularReferences(String patternName, List<String> path", "Modified_Line": "-            forbidCircularReferences(patternName, path, patternBank.get(otherPatternName));\n"}]}]}
{"num": 404, "cve": "CVE-2021-32769", "des": "Micronaut is a JVM-based, full stack Java framework designed for building JVM applications. A path traversal vulnerability exists in versions prior to 2.5.9. With a basic configuration, it is possible to access any file from a filesystem, using \"/../../\" in the URL. This occurs because Micronaut does not restrict file access to configured paths. The vulnerability is patched in version 2.5.9. As a workaround, do not use `**` in mapping, use only `*`, which exposes only flat structure of a directory not allowing traversal. If using Linux, another workaround is to run micronaut in chroot.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/micronaut-projects/micronaut-core/commits/a0cfeb13bf1ef5d692d16d4a3b91b34b7456bb11", "html_url": "https://github.com/micronaut-projects/micronaut-core/commit/a0cfeb13bf1ef5d692d16d4a3b91b34b7456bb11", "filename_list": ["./data/java/java_filter/404_0@micronaut-projects@micronaut-core@d481bee3e407624a9c1ef645667dae1ee5b13c74@core_src_main_java_io_micronaut_core_io_file_DefaultFileSystemResourceLoader.java.txt"], "patch_list": [{"patch_file": "core/src/main/java/io/micronaut/core/io/file/DefaultFileSystemResourceLoader.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private Path getFilePath(String path) {", "Modified_Line": "-        return baseDirPath.map(dir -> dir.resolve(path)).orElseGet(() -> Paths.get(path));\n"}]}]}
{"num": 405, "cve": "CVE-2021-0518", "des": "In Wi-Fi, there is a possible leak of location-sensitive data due to a missing permission check. This could lead to local information disclosure with no additional execution privileges needed. User interaction is not needed for exploitation.Product: AndroidVersions: Android-13Android ID: A-176541017", "cwe_list": ["CWE-862"], "cwe_name_lst": ["Missing Authorization"], "url": "https://api.github.com/repos/aosp-mirror/platform_frameworks_base/commits/cff8340c84ad1d6c0b3deae6a42f781e7db64082", "html_url": "https://github.com/aosp-mirror/platform_frameworks_base/commit/cff8340c84ad1d6c0b3deae6a42f781e7db64082", "filename_list": ["./data/java/java_filter/405_1@aosp-mirror@platform_frameworks_base@0ec06d7b1112fe46bea6aaba303b7c85d08a3b1e@services_core_java_com_android_server_display_WifiDisplayAdapter.java.txt"], "patch_list": [{"patch_file": "services/core/java/com/android/server/display/WifiDisplayAdapter.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private void handleSendStatusChangeBroadcast() {", "Modified_Line": "-        getContext().sendBroadcastAsUser(intent, UserHandle.ALL);\n"}]}]}
{"num": 412, "cve": "CVE-2021-25958", "des": "In Apache Ofbiz, versions v17.12.01 to v17.12.07 implement a try catch exception to handle errors at multiple locations but leaks out sensitive table info which may aid the attacker for further recon. A user can register with a very long password, but when he tries to login with it an exception occurs.", "cwe_list": ["CWE-209"], "cwe_name_lst": ["Generation of Error Message Containing Sensitive Information"], "url": "https://api.github.com/repos/apache/ofbiz-framework/commits/2f5b8d33e32c4d9a48243cf9e503236acd5aec5c", "html_url": "https://github.com/apache/ofbiz-framework/commit/2f5b8d33e32c4d9a48243cf9e503236acd5aec5c", "filename_list": ["./data/java/java_filter/412_0@apache@ofbiz-framework@326e0f12a48736f5c101724c7947c7ce4b907ca1@framework_common_src_main_java_org_apache_ofbiz_common_login_LoginServices.java.txt"], "patch_list": [{"patch_file": "framework/common/src/main/java/org/apache/ofbiz/common/login/LoginServices.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static Map<String, Object> userLogin(DispatchContext ctx, Map<String, ?>", "Modified_Line": "-                                        if (\"N\".equals(successfulLogin) && !\"false\".equals(EntityUtilProperties.getPropertyValue(\"security\", \"store.login.history.incorrect.password\", delegator))) {\n-                                            ulhCreateMap.put(\"passwordUsed\", password);\n"}]}]}
{"num": 413, "cve": "CVE-2021-3642", "des": "A flaw was found in Wildfly Elytron in versions prior to 1.10.14.Final, prior to 1.15.5.Final and prior to 1.16.1.Final where ScramServer may be susceptible to Timing Attack if enabled. The highest threat of this vulnerability is confidentiality.", "cwe_list": ["CWE-203"], "cwe_name_lst": ["Observable Discrepancy"], "url": "https://api.github.com/repos/wildfly-security/wildfly-elytron/commits/07e29be6f854bb167d7d30f915459dd4bd53d2de", "html_url": "https://github.com/wildfly-security/wildfly-elytron/commit/07e29be6f854bb167d7d30f915459dd4bd53d2de", "filename_list": ["./data/java/java_filter/413_0@wildfly-security@wildfly-elytron@feb4bb0f7c84b645884d74bb09f7f7c5755f0a52@mechanism_scram_src_main_java_org_wildfly_security_mechanism_scram_ScramServer.java.txt"], "patch_list": [{"patch_file": "mechanism/scram/src/main/java/org/wildfly/security/mechanism/scram/ScramServer.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public ScramFinalClientMessage parseFinalClientMessage(final ScramInitialClientM", "Modified_Line": "            final byte[] clientNonce = initialResponse.getRawNonce();\n            final byte[] serverNonce = initialChallenge.getRawServerNonce();\n-            if (! bi.delimitedBy(',').limitedTo(clientNonce.length).contentEquals(ByteIterator.ofBytes(clientNonce)) ||\n-                ! bi.delimitedBy(',').limitedTo(serverNonce.length).contentEquals(ByteIterator.ofBytes(serverNonce))) {\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public ScramFinalServerMessage evaluateFinalClientMessage(final ScramInitialServ", "Modified_Line": "            byte[] recoveredClientKey = clientSignature.clone();\n-            if (! Arrays.equals(recoveredClientKey, clientKey)) {\n"}]}]}
{"num": 415, "cve": "CVE-2021-41096", "des": "Rucky is a USB HID Rubber Ducky Launch Pad for Android. Versions 2.2 and earlier for release builds and versions 425 and earlier for nightly builds suffer from . The issue will be patched in v2.3 for release builds and 426 onwards for nightly builds. As a workaround, one may disable an advance security feature if not required.", "cwe_list": ["CWE-327"], "cwe_name_lst": ["Use of a Broken or Risky Cryptographic Algorithm"], "url": "https://api.github.com/repos/mayankmetha/Rucky/commits/5e3a477365009f488a73efd26a91168502de1b93", "html_url": "https://github.com/mayankmetha/Rucky/commit/5e3a477365009f488a73efd26a91168502de1b93", "filename_list": ["./data/java/java_filter/415_2@mayankmetha@Rucky@7fccfb71fd170332d9f14a1de07c29365aa7cbae@app_src_main_java_com_mayank_rucky_utils_Randoms.java.txt"], "patch_list": [{"patch_file": "app/src/main/java/com/mayank/rucky/utils/Randoms.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "", "Modified_Line": "public class Randoms {\n-    Random random;\n    Randoms() {\n-        random = new Random();\n        Date date = new Date();\n        random.setSeed(date.getTime());\n"}]}]}
{"num": 416, "cve": "CVE-2021-39196", "des": "pcapture is an open source dumpcap web service interface . In affected versions this vulnerability allows an authenticated but unprivileged user to use the REST API to capture and download packets with no capture filter and without adequate permissions. This is important because the capture filters can effectively limit the scope of information that a user can see in the data captures. If no filter is present, then all data on the local network segment where the program is running can be captured and downloaded. v3.12 fixes this problem. There is no workaround, you must upgrade to v3.12 or greater.", "cwe_list": ["CWE-754"], "cwe_name_lst": ["Improper Check for Unusual or Exceptional Conditions"], "url": "https://api.github.com/repos/jdhwpgmbca/pcapture/commits/0f74f431e0970a2e5784dbd955cfa4760e3b1ef7", "html_url": "https://github.com/jdhwpgmbca/pcapture/commit/0f74f431e0970a2e5784dbd955cfa4760e3b1ef7", "filename_list": ["./data/java/java_filter/416_0@jdhwpgmbca@pcapture@b1f307ee21d2331dd4459d217a5e230b3aba2280@src_main_java_com_rtds_svc_CaptureTypeService.java.txt"], "patch_list": [{"patch_file": "src/main/java/com/rtds/svc/CaptureTypeService.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public String findFilter( String url_suffix )", "Modified_Line": "-        if( type != null )\n        {\n-            return type.getCaptureFilter();\n        }\n-        return null;\n"}]}]}
{"num": 418, "cve": "CVE-2021-41189", "des": "DSpace is an open source turnkey repository application. In version 7.0, any community or collection administrator can escalate their permission up to become system administrator. This vulnerability only exists in 7.0 and does not impact 6.x or below. This issue is patched in version 7.1. As a workaround, users of 7.0 may temporarily disable the ability for community or collection administrators to manage permissions or workflows settings.", "cwe_list": ["CWE-863"], "cwe_name_lst": ["Incorrect Authorization"], "url": "https://api.github.com/repos/DSpace/DSpace/commits/c3bea16ab911606e15ae96c97a1575e1ffb14f8a", "html_url": "https://github.com/DSpace/DSpace/commit/c3bea16ab911606e15ae96c97a1575e1ffb14f8a", "filename_list": ["./data/java/java_filter/418_2@DSpace@DSpace@f21b16c25534b31b7b77a7eb950f9283537afb42@dspace-api_src_main_java_org_dspace_eperson_GroupServiceImpl.java.txt"], "patch_list": [{"patch_file": "dspace-api/src/main/java/org/dspace/eperson/GroupServiceImpl.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public DSpaceObject getParentObject(Context context, Group group) throws SQLExce", "Modified_Line": "                            List<ResourcePolicy> policies = resourcePolicyService.find(context, null, groups,\n                                                            Constants.DEFAULT_ITEM_READ, Constants.COLLECTION);\n-                            if (policies.size() > 0) {\n-                                return policies.get(0).getdSpaceObject();\n                            }\n                            policies = resourcePolicyService.find(context, null, groups,\n                                                             Constants.DEFAULT_BITSTREAM_READ, Constants.COLLECTION);\n-                            if (policies.size() > 0) {\n-                                return policies.get(0).getdSpaceObject();\n"}]}]}
{"num": 422, "cve": "CVE-2021-41152", "des": "OpenOlat is a web-based e-learning platform for teaching, learning, assessment and communication, an LMS, a learning management system. In affected versions by manipulating the HTTP request an attacker can modify the path of a requested file download in the folder component to point to anywhere on the target system. The attack could be used to read any file accessible in the web root folder or outside, depending on the configuration of the system and the properly configured permission of the application server user. The attack requires an OpenOlat user account or the enabled guest user feature together with the usage of the folder component in a course. The attack does not allow writing of arbitrary files, it allows only reading of files and also only ready of files that the attacker knows the exact path which is very unlikely at least for OpenOlat data files. The problem is fixed in version 15.5.8 and 16.0.1 It is advised to upgrade to version 16.0.x. There are no known workarounds to fix this problem, an upgrade is necessary.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/OpenOLAT/OpenOLAT/commits/418bb509ffcb0e25ab4390563c6c47f0458583eb", "html_url": "https://github.com/OpenOLAT/OpenOLAT/commit/418bb509ffcb0e25ab4390563c6c47f0458583eb", "filename_list": ["./data/java/java_filter/422_0@OpenOLAT@OpenOLAT@53086dc0d3f400b9f6bd3e74d49d6a35945b2344@src_main_java_org_olat_core_commons_modules_bc_FileSelection.java.txt"], "patch_list": [{"patch_file": "src/main/java/org/olat/core/commons/modules/bc/FileSelection.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private void parse(UserRequest ureq) {", "Modified_Line": "\t\tString[] sFiles = ureq.getHttpReq().getParameterValues(FORM_ID);\n-\t\tif (sFiles == null || sFiles.length == 0) return;\n-\t\tfiles = Arrays.asList(sFiles);\n"}]}]}
{"num": 424, "cve": "CVE-2021-25738", "des": "Loading specially-crafted yaml with the Kubernetes Java Client library can lead to code execution.", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/kubernetes-client/java/commits/80d3d3838c3bf5405c3b0070951584646ed3ce7a", "html_url": "https://github.com/kubernetes-client/java/commit/80d3d3838c3bf5405c3b0070951584646ed3ce7a", "filename_list": ["./data/java/java_filter/424_0@kubernetes-client@java@7f69d7f51ad415edf977c941c103aa2e9d985551@util_src_main_java_io_kubernetes_client_util_Yaml.java.txt"], "patch_list": [{"patch_file": "util/src/main/java/io/kubernetes/client/util/Yaml.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static org.yaml.snakeyaml.Yaml getSnakeYaml() {", "Modified_Line": "-    return new org.yaml.snakeyaml.Yaml(new CustomConstructor(), new CustomRepresenter());\n"}]}]}
{"num": 425, "cve": "CVE-2021-41110", "des": "cwlviewer is a web application to view and share Common Workflow Language workflows. Versions prior to 1.3.1 contain a Deserialization of Untrusted Data vulnerability. Commit number f6066f09edb70033a2ce80200e9fa9e70a5c29de (dated 2021-09-30) contains a patch. There are no available workarounds aside from installing the patch. The SnakeYaml constructor, by default, allows any data to be parsed. To fix the issue the object needs to be created with a `SafeConstructor` object, as seen in the patch.", "cwe_list": ["CWE-502"], "cwe_name_lst": ["Deserialization of Untrusted Data"], "url": "https://api.github.com/repos/common-workflow-language/cwlviewer/commits/f6066f09edb70033a2ce80200e9fa9e70a5c29de", "html_url": "https://github.com/common-workflow-language/cwlviewer/commit/f6066f09edb70033a2ce80200e9fa9e70a5c29de", "filename_list": ["./data/java/java_filter/425_0@common-workflow-language@cwlviewer@7b8eb67642222b84da6425b1c6ebdf864aa779df@src_main_java_org_commonwl_view_cwl_CWLService.java.txt"], "patch_list": [{"patch_file": "src/main/java/org/commonwl/view/cwl/CWLService.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private JsonNode yamlPathToJson(Path path) throws IOException {", "Modified_Line": "-        Yaml reader = new Yaml();\n        ObjectMapper mapper = new ObjectMapper();\n-        Path p;\n"}, {"Modified_Block_Num": "2", "Modified_Function": "private JsonNode yamlStreamToJson(InputStream yamlStream) {", "Modified_Line": "-        Yaml reader = new Yaml();\n        ObjectMapper mapper = new ObjectMapper();\n\t\treturn mapper.valueToTree(reader.load(yamlStream));\n"}]}]}
{"num": 426, "cve": "CVE-2021-41256", "des": "nextcloud news-android is an Android client for the Nextcloud news/feed reader app. In affected versions the Nextcloud News for Android app has a security issue by which a malicious application installed on the same device can send it an arbitrary Intent that gets reflected back, unintentionally giving read and write access to non-exported Content Providers in Nextcloud News for Android. Users should upgrade to version 0.9.9.63 or higher as soon as possible.", "cwe_list": ["CWE-829"], "cwe_name_lst": ["Inclusion of Functionality from Untrusted Control Sphere"], "url": "https://api.github.com/repos/nextcloud/news-android/commits/05449cb666059af7de2302df9d5c02997a23df85", "html_url": "https://github.com/nextcloud/news-android/commit/05449cb666059af7de2302df9d5c02997a23df85", "filename_list": ["./data/java/java_filter/426_1@nextcloud@news-android@4cac4d5003c5282ba179ee2af2d7ddca31632ede@News-Android-App_src_main_java_de_luhmer_owncloudnewsreader_SettingsActivity.java.txt"], "patch_list": [{"patch_file": "News-Android-App/src/main/java/de/luhmer/owncloudnewsreader/SettingsActivity.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected void onStart() {", "Modified_Line": "        super.onStart();\n-        Intent intent = getIntent();\n-        intent.putExtra(\n-                SettingsActivity.SP_FEED_LIST_LAYOUT,\n-                mPrefs.getString(SettingsActivity.SP_FEED_LIST_LAYOUT, \"0\")\n-        );\n-        setResult(RESULT_OK,intent);\n"}]}]}
{"num": 428, "cve": "CVE-2021-41269", "des": "cron-utils is a Java library to define, parse, validate, migrate crons as well as get human readable descriptions for them. In affected versions A template Injection was identified in cron-utils enabling attackers to inject arbitrary Java EL expressions, leading to unauthenticated Remote Code Execution (RCE) vulnerability. Versions up to 9.1.2 are susceptible to this vulnerability. Please note, that only projects using the @Cron annotation to validate untrusted Cron expressions are affected. The issue was patched and a new version was released. Please upgrade to version 9.1.6. There are no known workarounds known.", "cwe_list": ["CWE-94"], "cwe_name_lst": ["Improper Control of Generation of Code ('Code Injection')"], "url": "https://api.github.com/repos/jmrozanec/cron-utils/commits/cfd2880f80e62ea74b92fa83474c2aabdb9899da", "html_url": "https://github.com/jmrozanec/cron-utils/commit/cfd2880f80e62ea74b92fa83474c2aabdb9899da", "filename_list": ["./data/java/java_filter/428_0@jmrozanec@cron-utils@d6707503ec2f20947f79e38f861dba93b39df9da@src_main_java_com_cronutils_parser_CronParser.java.txt"], "patch_list": [{"patch_file": "src/main/java/com/cronutils/parser/CronParser.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public Cron parse(final String expression) {", "Modified_Line": "            } catch (final IllegalArgumentException e) {\n-                throw new IllegalArgumentException(String.format(\"Failed to parse '%s'. %s\", expression, e.getMessage()), e);\n"}]}]}
{"num": 429, "cve": "CVE-2021-45890", "des": "basic/BasicAuthProvider.java in AuthGuard before 0.9.0 allows authentication via an inactive identifier.", "cwe_list": ["CWE-287"], "cwe_name_lst": ["Improper Authentication"], "url": "https://api.github.com/repos/AuthGuard/AuthGuard/commits/9783b1143da6576028de23e15a1f198b1f937b82", "html_url": "https://github.com/AuthGuard/AuthGuard/commit/9783b1143da6576028de23e15a1f198b1f937b82", "filename_list": ["./data/java/java_filter/429_0@AuthGuard@AuthGuard@87611fb75f564c30e30c1b53d2d2828de72edd46@basic-auth_src_main_java_com_nexblocks_authguard_basic_BasicAuthProvider.java.txt"], "patch_list": [{"patch_file": "basic-auth/src/main/java/com/nexblocks/authguard/basic/BasicAuthProvider.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private Either<Exception, AccountBO> verifyCredentialsAndGetAccount(final String username, final String password) {", "Modified_Line": "        final Optional<CredentialsBO> credentials = credentialsService.getByUsernameUnsafe(username);\n        if (credentials.isPresent()) {\n            if (securePassword.verify(password, credentials.get().getHashedPassword())) {\n                return getAccountById(credentials.get().getAccountId());\n            } else {\n                return Either.left(new ServiceAuthorizationException(ErrorCode.PASSWORDS_DO_NOT_MATCH,\n                        \"Passwords do not match\", EntityType.ACCOUNT, credentials.get().getAccountId()));\n            }\n        } else {\n            return Either.left(new ServiceAuthorizationException(ErrorCode.CREDENTIALS_DOES_NOT_EXIST,\n                    \"Identifier \" + username + \" does not exist\"));\n"}, {"Modified_Block_Num": "2", "Modified_Function": "private Either<Exception, AccountBO> verifyCredentialsAndGetAccount(final String username) {", "Modified_Line": "        final Optional<CredentialsBO> credentials = credentialsService.getByUsernameUnsafe(username);\n        if (credentials.isPresent()) {\n            return getAccountById(credentials.get().getAccountId());\n        } else {\n            return Either.left(new ServiceAuthorizationException(ErrorCode.\nCREDENTIALS_DOES_NOT_EXIST,\n                    \"Identifier \" + username + \" does not exist\"));\n"}]}]}
{"num": 430, "cve": "CVE-2021-43821", "des": "Opencast is an Open Source Lecture Capture & Video Management for Education. Opencast before version 9.10 or 10.6 allows references to local file URLs in ingested media packages, allowing attackers to include local files from Opencast's host machines and making them available via the web interface. Before Opencast 9.10 and 10.6, Opencast would open and include local files during ingests. Attackers could exploit this to include most local files the process has read access to, extracting secrets from the host machine. An attacker would need to have the privileges required to add new media to exploit this. But these are often widely given. The issue has been fixed in Opencast 10.6 and 11.0. You can mitigate this issue by narrowing down the read access Opencast has to files on the file system using UNIX permissions or mandatory access control systems like SELinux. This cannot prevent access to files Opencast needs to read though and we highly recommend updating.", "cwe_list": ["CWE-552"], "cwe_name_lst": ["Files or Directories Accessible to External Parties"], "url": "https://api.github.com/repos/opencast/opencast/commits/65c46b9d3e8f045c544881059923134571897764", "html_url": "https://github.com/opencast/opencast/commit/65c46b9d3e8f045c544881059923134571897764", "filename_list": ["./data/java/java_filter/430_0@opencast@opencast@776d5588f39c61eb04c03bb955416c4f77629d51@modules_ingest-service-impl_src_main_java_org_opencastproject_ingest_impl_IngestServiceImpl.java.txt"], "patch_list": [{"patch_file": "modules/ingest-service-impl/src/main/java/org/opencastproject/ingest/impl/IngestServiceImpl.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "protected URI addContentToRepo(MediaPackage mp, String elementId, URI uri) throw", "Modified_Line": "        int httpStatusCode = response.getStatusLine().getStatusCode();\n        if (httpStatusCode != 200) {\n          throw new IOException(uri + \" returns http \" + httpStatusCode);\n        }\n        in = response.getEntity().getContent();\n-      } else {\n        in = uri.toURL().openStream();\n"}]}]}
{"num": 433, "cve": "CVE-2021-3836", "des": "dbeaver is vulnerable to Improper Restriction of XML External Entity Reference", "cwe_list": ["CWE-611"], "cwe_name_lst": ["Improper Restriction of XML External Entity Reference"], "url": "https://api.github.com/repos/dbeaver/dbeaver/commits/4debf8f25184b7283681ed3fb5e9e887d9d4fe22", "html_url": "https://github.com/dbeaver/dbeaver/commit/4debf8f25184b7283681ed3fb5e9e887d9d4fe22", "filename_list": ["./data/java/java_filter/433_0@dbeaver@dbeaver@db626f48bd3490e8c1c61d94b8b9c726316ae739@bundles_org.jkiss.utils_src_org_jkiss_utils_xml_XMLUtils.java.txt"], "patch_list": [{"patch_file": "bundles/org.jkiss.utils/src/org/jkiss/utils/xml/XMLUtils.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static Document parseDocument(InputSource source) throws XMLException {", "Modified_Line": "        try {\n            DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n            DocumentBuilder xmlBuilder = dbf.newDocumentBuilder();\n            return xmlBuilder.parse(source);\n"}]}]}
{"num": 434, "cve": "CVE-2021-41272", "des": "Besu is an Ethereum client written in Java. Starting in version 21.10.0, changes in the implementation of the SHL, SHR, and SAR operations resulted in the introduction of a signed type coercion error in values that represent negative values for 32 bit signed integers. Smart contracts that ask for shifts between approximately 2 billion and 4 billion bits (nonsensical but valid values for the operation) will fail to execute and hence fail to validate. In networks where vulnerable versions are mining with other clients or non-vulnerable versions this will result in a fork and the relevant transactions will not be included in the fork. In networks where vulnerable versions are not mining (such as Rinkeby) no fork will result and the validator nodes will stop accepting blocks. In networks where only vulnerable versions are mining the relevant transaction will not be included in any blocks. When the network adds a non-vulnerable version the network will act as in the first case. Besu 21.10.2 contains a patch for this issue. Besu 21.7.4 is not vulnerable and clients can roll back to that version. There is a workaround available: Once a transaction with the relevant shift operations is included in the canonical chain, the only remediation is to make sure all nodes are on non-vulnerable versions.", "cwe_list": ["CWE-681"], "cwe_name_lst": ["Incorrect Conversion between Numeric Types"], "url": "https://api.github.com/repos/hyperledger/besu/commits/4170524ac3b45185704fcfbdeeb71b0b05dfa0a1", "html_url": "https://github.com/hyperledger/besu/commit/4170524ac3b45185704fcfbdeeb71b0b05dfa0a1", "filename_list": ["./data/java/java_filter/434_0@hyperledger@besu@00b81b6c4b392d8fbc00576ab66ebfd3da586db7@evm_src_main_java_org_hyperledger_besu_evm_operation_SarOperation.java.txt", "./data/java/java_filter/434_1@hyperledger@besu@00b81b6c4b392d8fbc00576ab66ebfd3da586db7@evm_src_main_java_org_hyperledger_besu_evm_operation_ShlOperation.java.txt", "./data/java/java_filter/434_2@hyperledger@besu@00b81b6c4b392d8fbc00576ab66ebfd3da586db7@evm_src_main_java_org_hyperledger_besu_evm_operation_ShrOperation.java.txt"], "patch_list": [{"patch_file": "evm/src/main/java/org/hyperledger/besu/evm/operation/SarOperation.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public Operation.OperationResult executeFixedCostOperation(", "Modified_Line": "-      if (shiftAmountInt >= 256) {\n        frame.pushStackItem(negativeNumber ? ALL_BITS : UInt256.ZERO);\n"}]}, {"patch_file": "evm/src/main/java/org/hyperledger/besu/evm/operation/ShlOperation.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public Operation.OperationResult executeFixedCostOperation(", "Modified_Line": "-      if (shiftAmountInt >= 256) {\n        frame.pushStackItem(UInt256.ZERO);\n"}]}, {"patch_file": "evm/src/main/java/org/hyperledger/besu/evm/operation/ShrOperation.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public Operation.OperationResult executeFixedCostOperation(", "Modified_Line": "-      if (shiftAmountInt >= 256) {\n        frame.pushStackItem(UInt256.ZERO);\n"}]}]}
{"num": 435, "cve": "CVE-2021-41242", "des": "OpenOlat is a web-basedlearning management system. A path traversal vulnerability exists in OpenOlat prior to versions 15.5.12 and 16.0.5. By providing a filename that contains a relative path as a parameter in some REST methods, it is possible to create directory structures and write files anywhere on the target system. The attack could be used to write files anywhere in the web root folder or outside, depending on the configuration of the system and the properly configured permission of the application server user. The attack requires an OpenOlat user account, an enabled REST API and the rights on a business object to call the vulnerable REST calls. The problem is fixed in version 15.5.12 and 16.0.5. There is a workaround available. The vulnerability requires the REST module to be enabled. Disabling the REST module or limiting the REST module via some firewall or web-server access rules to be accessed only be trusted systems will mitigate the risk.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/OpenOLAT/OpenOLAT/commits/c450df7d7ffe6afde39ebca6da9136f1caa16ec4", "html_url": "https://github.com/OpenOLAT/OpenOLAT/commit/c450df7d7ffe6afde39ebca6da9136f1caa16ec4", "filename_list": ["./data/java/java_filter/435_0@OpenOLAT@OpenOLAT@a9d9115110a3db75d7a0a204add8ddb44770d50a@src_main_java_org_olat_core_util_vfs_LocalFolderImpl.java.txt"], "patch_list": [{"patch_file": "src/main/java/org/olat/core/util/vfs/LocalFolderImpl.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public VFSContainer createChildContainer(String name) {", "Modified_Line": "\t\tFile fNewFile = new File(getBasefile(), name);-\t\tif (!fNewFile.mkdir()) return null;\n\t\tLocalFolderImpl locFI =  new LocalFolderImpl(fNewFile, this);\n\t\tlocFI.setDefaultItemFilter(defaultFilter);\n\t\treturn locFI;\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public VFSLeaf createChildLeaf(String name) {", "Modified_Line": "\t\tFile fNewFile = new File(getBasefile(), name);\n\t\ttry {\n\t\t\tif(!fNewFile.getParentFile().exists()) {\n\t\t\t\tfNewFile.getParentFile().mkdirs();\n\t\t\t}\n\t\t\tif (!fNewFile.createNewFile()) {\n-\t\t\t\tlog.warn(\"Could not create a new leaf::\" + name + \" in container::\" + getBasefile().getAbsolutePath() + \" - file alreay exists\");\n\t\t\t\treturn null;\n\t\t\t} \n\t\t} catch (Exception e) {\n-\t\t\tlog.error(\"Error while creating child leaf::\" + name + \" in container::\" + getBasefile().getAbsolutePath(), e);\n"}]}]}
{"num": 442, "cve": "CVE-2020-5230", "des": "Opencast before 8.1 and 7.6 allows almost arbitrary identifiers for media packages and elements to be used. This can be problematic for operation and security since such identifiers are sometimes used for file system operations which may lead to an attacker being able to escape working directories and write files to other locations. In addition, Opencast's Id.toString(…) vs Id.compact(…) behavior, the latter trying to mitigate some of the file system problems, can cause errors due to identifier mismatch since an identifier may unintentionally change. This issue is fixed in Opencast 7.6 and 8.1.", "cwe_list": ["CWE-74"], "cwe_name_lst": ["Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')"], "url": "https://api.github.com/repos/opencast/opencast/commits/bbb473f34ab95497d6c432c81285efb0c739f317", "html_url": "https://github.com/opencast/opencast/commit/bbb473f34ab95497d6c432c81285efb0c739f317", "filename_list": ["./data/java/java_filter/442_1@opencast@opencast@74bfb708a6c0b8ffe3e8ab67e1a78dacbb6f2225@modules_common_src_main_java_org_opencastproject_mediapackage_identifier_IdImpl.java.txt"], "patch_list": [{"patch_file": "modules/common/src/main/java/org/opencastproject/mediapackage/identifier/IdImpl.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public IdImpl(String id) {", "Modified_Line": "-  public IdImpl(String id) {\n    this.id = id;\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public String compact() {", "Modified_Line": "-    return id.replaceAll(\"/\", \"-\").replaceAll(\"\\\\\\\\\", \"-\");\n"}]}]}
{"num": 446, "cve": "CVE-2020-5206", "des": "In Opencast before 7.6 and 8.1, using a remember-me cookie with an arbitrary username can cause Opencast to assume proper authentication for that user even if the remember-me cookie was incorrect given that the attacked endpoint also allows anonymous access. This way, an attacker can, for example, fake a remember-me token, assume the identity of the global system administrator and request non-public content from the search service without ever providing any proper authentication. This problem is fixed in Opencast 7.6 and Opencast 8.1", "cwe_list": ["CWE-287"], "cwe_name_lst": ["Improper Authentication"], "url": "https://api.github.com/repos/opencast/opencast/commits/b157e1fb3b35991ca7bf59f0730329fbe7ce82e8", "html_url": "https://github.com/opencast/opencast/commit/b157e1fb3b35991ca7bf59f0730329fbe7ce82e8", "filename_list": ["./data/java/java_filter/446_0@opencast@opencast@1a7172c95af8d542a77ae5b153e4c834dd4788a6@modules_kernel_src_main_java_org_opencastproject_kernel_security_SecurityServiceSpringImpl.java.txt"], "patch_list": [{"patch_file": "modules/kernel/src/main/java/org/opencastproject/kernel/security/SecurityServiceSpringImpl.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public User getUser() throws IllegalStateException {", "Modified_Line": "-    Authentication auth = SecurityContextHolder.getContext().getAuthentication();\n    JaxbOrganization jaxbOrganization = JaxbOrganization.fromOrganization(org);\n    if (auth != null) {\n      Object principal = auth.getPrincipal();\n-      if ((principal != null) && (principal instanceof UserDetails)) {\n"}]}]}
{"num": 448, "cve": "CVE-2020-5281", "des": "In Perun before version 3.9.1, VO or group manager can modify configuration of the LDAP extSource to retrieve all from Perun LDAP. Issue is fixed in version 3.9.1 by sanitisation of the input.", "cwe_list": ["CWE-732"], "cwe_name_lst": ["Incorrect Permission Assignment for Critical Resource"], "url": "https://api.github.com/repos/CESNET/perun/commits/ac527bc3225a64208ee5cee59e5918ee360ca039", "html_url": "https://github.com/CESNET/perun/commit/ac527bc3225a64208ee5cee59e5918ee360ca039", "filename_list": ["./data/java/java_filter/448_0@CESNET@perun@4e4b5c9061679341c3fb7294bb26cb2c1dfb7d50@perun-core_src_main_java_cz_metacentrum_perun_core_impl_ExtSourceLdap.java.txt"], "patch_list": [{"patch_file": "perun-core/src/main/java/cz/metacentrum/perun/core/impl/ExtSourceLdap.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public List<Map<String,String>> findSubjectsLogins(String searchString, int maxResults) throws InternalErrorException {", "Modified_Line": "\t\tString query = getAttributes().get(\"query\");\n\t\tif (query == null) {\n\t\t\tthrow new InternalErrorException(\"query attributes is required\");\n\t\t}\n-\t\tquery = query.replaceAll(\"\\\\?\", searchString);\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public Map<String, String> getSubjectByLogin(String login) throws InternalErrorException, SubjectNotExistsException {", "Modified_Line": "\t\tString query = getAttributes().get(\"loginQuery\");\n\t\tif (query == null) {\n\t\t\tthrow new InternalErrorException(\"loginQuery attributes is required\");\n\t\t}\n-\t\tquery = query.replaceAll(\"\\\\?\", login);\n"}]}]}
{"num": 450, "cve": "CVE-2020-10194", "des": "cs/service/account/AutoCompleteGal.java in Zimbra zm-mailbox before 8.8.15.p8 allows authenticated users to request any GAL account. This differs from the intended behavior in which the domain of the authenticated user must match the domain of the galsync account in the request.", "cwe_list": ["CWE-862"], "cwe_name_lst": ["Missing Authorization"], "url": "https://api.github.com/repos/Zimbra/zm-mailbox/commits/1df440e0efa624d1772a05fb6d397d9beb4bda1e", "html_url": "https://github.com/Zimbra/zm-mailbox/commit/1df440e0efa624d1772a05fb6d397d9beb4bda1e", "filename_list": ["./data/java/java_filter/450_0@Zimbra@zm-mailbox@9e80c509c4217573d7cc9f207ec16d9eed8afe3d@store_src_java_com_zimbra_cs_service_account_AutoCompleteGal.java.txt"], "patch_list": [{"patch_file": "store/src/java/com/zimbra/cs/service/account/AutoCompleteGal.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public Element handle(Element request, Map<String, Object> context) throws Servi", "Modified_Line": "-        if (galAcctId != null)\n-            params.setGalSyncAccount(Provisioning.getInstance().getAccountById(galAcctId));\n"}]}]}
{"num": 454, "cve": "CVE-2020-11007", "des": "In Shopizer before version 2.11.0, using API or Controller based versions negative quantity is not adequately validated hence creating incorrect shopping cart and order total. This vulnerability makes it possible to create a negative total in the shopping cart. This has been patched in version 2.11.0.", "cwe_list": ["CWE-20"], "cwe_name_lst": ["Improper Input Validation"], "url": "https://api.github.com/repos/shopizer-ecommerce/shopizer/commits/929ca0839a80c6f4dad087e0259089908787ad2a", "html_url": "https://github.com/shopizer-ecommerce/shopizer/commit/929ca0839a80c6f4dad087e0259089908787ad2a", "filename_list": ["./data/java/java_filter/454_0@shopizer-ecommerce@shopizer@de8a8e3183f8c5fed4695f889e309a6fff70adae@sm-shop_src_main_java_com_salesmanager_shop_store_controller_shoppingCart_facade_ShoppingCartFacadeImpl.java.txt"], "patch_list": [{"patch_file": "sm-shop/src/main/java/com/salesmanager/shop/store/controller/shoppingCart/facade/ShoppingCartFacadeImpl.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private com.salesmanager.core.model.shoppingcart.ShoppingCartItem createCartItem", "Modified_Line": "        for(ProductAvailability availability : availabilities) {-        \tif(availability.getProductQuantity() == null || availability.getProductQuantity().intValue() ==0) {\n"}]}]}
{"num": 459, "cve": "CVE-2020-1732", "des": "A flaw was found in Soteria before 1.0.1, in a way that multiple requests occurring concurrently causing security identity corruption across concurrent threads when using EE Security with WildFly Elytron which can lead to the possibility of being handled using the identity from another request.", "cwe_list": ["CWE-20"], "cwe_name_lst": ["Improper Input Validation"], "url": "https://api.github.com/repos/wildfly-security/soteria/commits/c2479f8c39d7d661341fdcaff7f5e97c5eea1a54", "html_url": "https://github.com/wildfly-security/soteria/commit/c2479f8c39d7d661341fdcaff7f5e97c5eea1a54", "filename_list": ["./data/java/java_filter/459_0@wildfly-security@soteria@f637fa0dc325d298a99d95ac13c469cfd46ed63a@impl_src_main_java_org_glassfish_soteria_mechanisms_jaspic_DefaultAuthConfigProvider.java.txt", "./data/java/java_filter/459_3@wildfly-security@soteria@f637fa0dc325d298a99d95ac13c469cfd46ed63a@impl_src_main_java_org_glassfish_soteria_mechanisms_jaspic_Jaspic.java.txt"], "patch_list": [{"patch_file": "impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/DefaultAuthConfigProvider.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public DefaultAuthConfigProvider(ServerAuthModule serverAuthModule) {", "Modified_Line": "-    private ServerAuthModule serverAuthModule;\n-    public DefaultAuthConfigProvider(ServerAuthModule serverAuthModule) {\n-        this.serverAuthModule = serverAuthModule;\n"}]}, {"patch_file": "impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/Jaspic.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public static String registerServerAuthModule(ServerAuthModule serverAuthModule, ServletContext servletContext) {", "Modified_Line": "-\tpublic static String registerServerAuthModule(ServerAuthModule serverAuthModule, ServletContext servletContext) {\n-\t\t\n\t    String registrationId = AccessController.doPrivileged(new PrivilegedAction<String>() {\n\t        public String run() {\n\t            return AuthConfigFactory.getFactory().registerConfigProvider(\n-\t                    new DefaultAuthConfigProvider(serverAuthModule),\n-\t                    \"HttpServlet\", \n-\t                    getAppContextID(servletContext), \n"}]}]}
{"num": 461, "cve": "CVE-2020-4070", "des": "In CSS Validator less than or equal to commit 54d68a1, there is a cross-site scripting vulnerability in handling URIs. A user would have to click on a specifically crafted validator link to trigger it. This has been patched in commit e5c09a9.", "cwe_list": ["CWE-79"], "cwe_name_lst": ["Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "url": "https://api.github.com/repos/w3c/css-validator/commits/e5c09a9119167d3064db786d5f00d730b584a53b", "html_url": "https://github.com/w3c/css-validator/commit/e5c09a9119167d3064db786d5f00d730b584a53b", "filename_list": ["./data/java/java_filter/461_0@w3c@css-validator@97a40444cbe0a6c209eb14b131afc2b7b76f0bb2@org_w3c_css_css_StyleSheetParser.java.txt"], "patch_list": [{"patch_file": "org/w3c/css/css/StyleSheetParser.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public void parseURL(ApplContext ac, URL url, String title,", "Modified_Line": "            Errors er = new Errors();\n            er.addError(new org.w3c.css.parser.CssError(Messages.escapeString(url.toString()),\n-                    -1, e));\n"}]}]}
{"num": 463, "cve": "CVE-2020-25023", "des": "An issue was discovered in Noise-Java through 2020-08-27. AESGCMOnCtrCipherState.encryptWithAd() allows out-of-bounds access.", "cwe_list": ["CWE-125", "CWE-787"], "cwe_name_lst": ["Out-of-bounds Read", "Out-of-bounds Write"], "url": "https://api.github.com/repos/rweather/noise-java/commits/18e86b6f8bea7326934109aa9ffa705ebf4bde90", "html_url": "https://github.com/rweather/noise-java/commit/18e86b6f8bea7326934109aa9ffa705ebf4bde90", "filename_list": ["./data/java/java_filter/463_1@rweather@noise-java@a8dce061f60259e05b002918462fc4f876100a65@src_main_java_com_southernstorm_noise_protocol_AESGCMOnCtrCipherState.java.txt"], "patch_list": [{"patch_file": "src/main/java/com/southernstorm/noise/protocol/AESGCMOnCtrCipherState.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public int encryptWithAd(byte[] ad, byte[] plaintext, int plaintextOffset,", "Modified_Line": "-\t\tif (ciphertextOffset > ciphertext.length)\n-\t\t\tspace = 0;\n-\t\telse\n-\t\t\tspace = ciphertext.length - ciphertextOffset;\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public int decryptWithAd(byte[] ad, byte[] ciphertext,", "Modified_Line": "-\t\tif (ciphertextOffset > ciphertext.length)\n-\t\t\tspace = 0;\n\t\telse\n\t\t\tspace = ciphertext.length - ciphertextOffset;\n\t\tif (length > space)\n\t\t\tthrow new ShortBufferException();\n-\t\tif (plaintextOffset > plaintext.length)\n-\t\t\tspace = 0;\n-\t\telse\n-\t\t\tspace = plaintext.length - plaintextOffset;\n"}]}]}
{"num": 464, "cve": "CVE-2020-25022", "des": "An issue was discovered in Noise-Java through 2020-08-27. AESGCMFallbackCipherState.encryptWithAd() allows out-of-bounds access.", "cwe_list": ["CWE-125", "CWE-787"], "cwe_name_lst": ["Out-of-bounds Read", "Out-of-bounds Write"], "url": "https://api.github.com/repos/rweather/noise-java/commits/18e86b6f8bea7326934109aa9ffa705ebf4bde90", "html_url": "https://github.com/rweather/noise-java/commit/18e86b6f8bea7326934109aa9ffa705ebf4bde90", "filename_list": ["./data/java/java_filter/464_0@rweather@noise-java@a8dce061f60259e05b002918462fc4f876100a65@src_main_java_com_southernstorm_noise_protocol_AESGCMFallbackCipherState.java.txt"], "patch_list": [{"patch_file": "src/main/java/com/southernstorm/noise/protocol/AESGCMFallbackCipherState.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "public int encryptWithAd(byte[] ad, byte[] plaintext, int plaintextOffset,", "Modified_Line": "-\t\tif (ciphertextOffset > ciphertext.length)\n-\t\t\tspace = 0;\n-\t\telse\n-\t\t\tspace = ciphertext.length - ciphertextOffset;\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public int decryptWithAd(byte[] ad, byte[] ciphertext,", "Modified_Line": "-\t\tif (ciphertextOffset > ciphertext.length)\n-\t\t\tspace = 0;\n\t\telse\n\t\t\tspace = ciphertext.length - ciphertextOffset;\n\t\tif (length > space)\n\t\t\tthrow new ShortBufferException();\n-\t\tif (plaintextOffset > plaintext.length)\n-\t\t\tspace = 0;\n-\t\telse\n-\t\t\tspace = plaintext.length - plaintextOffset;\n"}]}]}
{"num": 465, "cve": "CVE-2020-25021", "des": "An issue was discovered in Noise-Java through 2020-08-27. ChaChaPolyCipherState.encryptWithAd() allows out-of-bounds access.", "cwe_list": ["CWE-125", "CWE-787"], "cwe_name_lst": ["Out-of-bounds Read", "Out-of-bounds Write"], "url": "https://api.github.com/repos/rweather/noise-java/commits/18e86b6f8bea7326934109aa9ffa705ebf4bde90", "html_url": "https://github.com/rweather/noise-java/commit/18e86b6f8bea7326934109aa9ffa705ebf4bde90", "filename_list": ["./data/java/java_filter/465_2@rweather@noise-java@a8dce061f60259e05b002918462fc4f876100a65@src_main_java_com_southernstorm_noise_protocol_ChaChaPolyCipherState.java.txt"], "patch_list": [{"patch_file": "src/main/java/com/southernstorm/noise/protocol/ChaChaPolyCipherState.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private void encrypt(byte[] plaintext, int plaintextOffset,", "Modified_Line": "-\t\tif (ciphertextOffset > ciphertext.length)\n-\t\t\tspace = 0;\n-\t\telse\n-\t\t\tspace = ciphertext.length - ciphertextOffset;\n"}, {"Modified_Block_Num": "2", "Modified_Function": "public int decryptWithAd(byte[] ad, byte[] ciphertext,", "Modified_Line": "-\t\tif (ciphertextOffset > ciphertext.length)\n-\t\t\tspace = 0;\n\t\telse\n\t\t\tspace = ciphertext.length - ciphertextOffset;\n\t\tif (length > space)\n\t\t\tthrow new ShortBufferException();\n-\t\tif (plaintextOffset > plaintext.length)\n-\t\t\tspace = 0;\n-\t\telse\n-\t\t\tspace = plaintext.length - plaintextOffset;\n"}]}]}
{"num": 475, "cve": "CVE-2020-35460", "des": "common/InputStreamHelper.java in Packwood MPXJ before 8.3.5 allows directory traversal in the zip stream handler flow, leading to the writing of files to arbitrary locations.", "cwe_list": ["CWE-22"], "cwe_name_lst": ["Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"], "url": "https://api.github.com/repos/joniles/mpxj/commits/8eaf4225048ea5ba7e59ef4556dab2098fcc4a1d", "html_url": "https://github.com/joniles/mpxj/commit/8eaf4225048ea5ba7e59ef4556dab2098fcc4a1d", "filename_list": ["./data/java/java_filter/475_0@joniles@mpxj@1eed5f01ac8e49b433e0538bdc079caeda7d6fd7@src_main_java_net_sf_mpxj_common_InputStreamHelper.java.txt"], "patch_list": [{"patch_file": "src/main/java/net/sf/mpxj/common/InputStreamHelper.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private static void processZipStream(File dir, InputStream inputStream) throws I", "Modified_Line": "      ZipInputStream zip = new ZipInputStream(inputStream);\n      while (true)\n      {\n         ZipEntry entry = zip.getNextEntry();\n         if (entry == null)\n         {\n            break;\n         }\n         File file = new File(dir, entry.getName());\n         if (entry.isDirectory())\n         {\n            FileHelper.mkdirsQuietly(file);\n            continue;\n         }\n"}]}]}
{"num": 478, "cve": "CVE-2020-26234", "des": "Opencast before versions 8.9 and 7.9 disables HTTPS hostname verification of its HTTP client used for a large portion of Opencast's HTTP requests. Hostname verification is an important part when using HTTPS to ensure that the presented certificate is valid for the host. Disabling it can allow for man-in-the-middle attacks. This problem is fixed in Opencast 7.9 and Opencast 8.8 Please be aware that fixing the problem means that Opencast will not simply accept any self-signed certificates any longer without properly importing them. If you need those, please make sure to import them into the Java key store. Better yet, get a valid certificate.", "cwe_list": ["CWE-346"], "cwe_name_lst": ["Origin Validation Error"], "url": "https://api.github.com/repos/opencast/opencast/commits/4225bf90af74557deaf8fb6b80b0705c9621acfc", "html_url": "https://github.com/opencast/opencast/commit/4225bf90af74557deaf8fb6b80b0705c9621acfc", "filename_list": ["./data/java/java_filter/478_0@opencast@opencast@4b905437e90bd19700a6a6688f227f9efb20e153@modules_kernel_src_main_java_org_opencastproject_kernel_http_impl_HttpClientImpl.java.txt"], "patch_list": [{"patch_file": "modules/kernel/src/main/java/org/opencastproject/kernel/http/impl/HttpClientImpl.java", "patch_content": [{"Modified_Block_Num": "1", "Modified_Function": "private DefaultHttpClient makeHttpClient() {", "Modified_Line": "-    DefaultHttpClient defaultHttpClient = new DefaultHttpClient();\n-    try {\n-      logger.debug(\"Installing forgiving hostname verifier and trust managers\");\n-      X509TrustManager trustManager = createTrustManager();\n-      X509HostnameVerifier hostNameVerifier = createHostNameVerifier();\n-      SSLContext sslContext = SSLContext.getInstance(\"TLS\");\n-      sslContext.init(null, new TrustManager[] { trustManager }, new SecureRandom());\n-      SSLSocketFactory ssf = new SSLSocketFactory(sslContext, hostNameVerifier);\n-      ClientConnectionManager ccm = defaultHttpClient.getConnectionManager();\n-      SchemeRegistry sr = ccm.getSchemeRegistry();\n-      sr.register(new Scheme(\"https\", 443, ssf));\n-    } catch (NoSuchAlgorithmException e) {\n-      logger.error(\"Error creating context to handle TLS connections: {}\", e.getMessage());\n-    } catch (KeyManagementException e) {\n-      logger.error(\"Error creating context to handle TLS connections: {}\", e.getMessage());\n-    }\n-    return defaultHttpClient;\n-  }\n"},{"Modified_Block_Num": "2", "Modified_Function": "private X509TrustManager createTrustManager() {", "Modified_Line": "-    X509TrustManager trustManager = new X509TrustManager() {\n-      public void checkClientTrusted(X509Certificate[] xcs, String string) throws CertificateException {\n-        logger.trace(\"Skipping trust check on client certificate {}\", string);\n-      }\n-      public void checkServerTrusted(X509Certificate[] xcs, String string) throws CertificateException {\n-        logger.trace(\"Skipping trust check on server certificate {}\", string);\n-      }\n-      public X509Certificate[] getAcceptedIssuers() {\n-        logger.trace(\"Returning empty list of accepted issuers\");\n-        return null;\n-      }\n-    };\n-    return trustManager;\n-  }\n"},{"Modified_Block_Num": "3", "Modified_Function": "private X509HostnameVerifier createHostNameVerifier() {", "Modified_Line": "-    X509HostnameVerifier verifier = new X509HostnameVerifier() {\n-      public void verify(String host, SSLSocket ssl) throws IOException {\n-        logger.trace(\"Skipping SSL host name check on {}\", host);\n-      }\n-      public void verify(String host, X509Certificate xc) throws SSLException {\n-        logger.trace(\"Skipping X509 certificate host name check on {}\", host);\n-      }\n-      public void verify(String host, String[] cns, String[] subjectAlts) throws SSLException {\n-        logger.trace(\"Skipping DNS host name check on {}\", host);\n-      }-      public boolean verify(String host, SSLSession ssl) {\n-        logger.trace(\"Skipping SSL session host name check on {}\", host);\n-        return true;\n-      }\n-    };\n-    return verifier;\n-  }\n"}]}]}